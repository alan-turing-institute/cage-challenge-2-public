{"episode_reward_max": -12.199999999999985, "episode_reward_min": -965.7999999999987, "episode_reward_mean": -130.5349999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.59999999999974, -84.1, -64.30000000000007, -92.8, -86.1999999999998, -152.89999999999972, -61.70000000000008, -207.09999999999974, -60.200000000000024, -206.2, -15.199999999999989, -35.3, -249.99999999999986, -113.79999999999983, -219.79999999999998, -83.6999999999999, -180.2000000000002, -168.3, -117.6, -107.59999999999972, -965.7999999999987, -79.3, -69.00000000000011, -18.2, -131.5, -123.60000000000014, -257.7, -83.10000000000002, -84.00000000000001, -146.9999999999998, -12.199999999999985, -149.2, -120.10000000000002, -123.29999999999983, -104.79999999999987, -79.10000000000002, -17.49999999999999, -14.099999999999987, -12.499999999999993, -131.7999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5781744695013685, "mean_inference_ms": 0.6315192709085912, "mean_action_processing_ms": 0.028323721986983724, "mean_env_wait_ms": 2.854530050348741, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 4000, "timesteps_this_iter": 0, "agent_timesteps_total": 4000, "timers": {"sample_time_ms": 16409.083, "sample_throughput": 243.767, "load_time_ms": 0.23, "load_throughput": 17367718.427, "learn_time_ms": 4253.224, "learn_throughput": 940.463}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 87.39602511786725, "policy_loss": 0.0009207637670139472, "vf_loss": 8739.36986733816, "vf_explained_var": -0.010108080602461291, "kl": 0.007039019845860234, "entropy": 1.3793882855805017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4000, "num_agent_steps_sampled": 4000, "num_steps_trained": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 40, "training_iteration": 1, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-02-44", "timestamp": 1651060964, "time_this_iter_s": 20.646526098251343, "time_total_s": 20.646526098251343, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 20.646526098251343, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.157142857142855, "ram_util_percent": 95.30714285714286}}
{"episode_reward_max": -12.199999999999985, "episode_reward_min": -965.7999999999987, "episode_reward_mean": -124.43874999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.59999999999974, -84.1, -64.30000000000007, -92.8, -86.1999999999998, -152.89999999999972, -61.70000000000008, -207.09999999999974, -60.200000000000024, -206.2, -15.199999999999989, -35.3, -249.99999999999986, -113.79999999999983, -219.79999999999998, -83.6999999999999, -180.2000000000002, -168.3, -117.6, -107.59999999999972, -965.7999999999987, -79.3, -69.00000000000011, -18.2, -131.5, -123.60000000000014, -257.7, -83.10000000000002, -84.00000000000001, -146.9999999999998, -12.199999999999985, -149.2, -120.10000000000002, -123.29999999999983, -104.79999999999987, -79.10000000000002, -17.49999999999999, -14.099999999999987, -12.499999999999993, -131.7999999999998, -13.599999999999987, -163.0000000000001, -63.300000000000054, -51.7, -138.2, -176.99999999999972, -131.00000000000006, -235.30000000000027, -131.49999999999974, -80.79999999999994, -176.6, -107.00000000000003, -132.5, -156.6, -101.90000000000003, -100.8, -69.20000000000003, -78.7, -65.70000000000009, -124.5, -141.59999999999982, -289.0, -134.99999999999997, -94.1, -95.79999999999986, -226.79999999999998, -20.39999999999999, -115.9, -133.79999999999984, -112.80000000000007, -97.6, -177.39999999999995, -106.39999999999989, -43.6, -136.79999999999973, -94.40000000000002, -136.7, -136.70000000000002, -12.69999999999999, -127.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5816091160420502, "mean_inference_ms": 0.6444937856565363, "mean_action_processing_ms": 0.02871373792600481, "mean_env_wait_ms": 2.8845551882753204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 8000, "timesteps_this_iter": 0, "agent_timesteps_total": 8000, "timers": {"sample_time_ms": 18909.953, "sample_throughput": 211.529, "load_time_ms": 0.229, "load_throughput": 17449002.6, "learn_time_ms": 4319.442, "learn_throughput": 926.046}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 20.187853480035297, "policy_loss": 0.003843980908433917, "vf_loss": 2018.20506663989, "vf_explained_var": -0.0012361285507038076, "kl": 0.009796882454707495, "entropy": 1.3575164320648359, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 8000, "num_agent_steps_sampled": 8000, "num_steps_trained": 8000, "num_agent_steps_trained": 8000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 80, "training_iteration": 2, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-03-05", "timestamp": 1651060985, "time_this_iter_s": 21.525754928588867, "time_total_s": 42.17228102684021, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 42.17228102684021, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 16.93793103448276, "ram_util_percent": 95.46551724137932}}
{"episode_reward_max": -11.39999999999999, "episode_reward_min": -965.7999999999987, "episode_reward_mean": -118.75499999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-965.7999999999987, -79.3, -69.00000000000011, -18.2, -131.5, -123.60000000000014, -257.7, -83.10000000000002, -84.00000000000001, -146.9999999999998, -12.199999999999985, -149.2, -120.10000000000002, -123.29999999999983, -104.79999999999987, -79.10000000000002, -17.49999999999999, -14.099999999999987, -12.499999999999993, -131.7999999999998, -13.599999999999987, -163.0000000000001, -63.300000000000054, -51.7, -138.2, -176.99999999999972, -131.00000000000006, -235.30000000000027, -131.49999999999974, -80.79999999999994, -176.6, -107.00000000000003, -132.5, -156.6, -101.90000000000003, -100.8, -69.20000000000003, -78.7, -65.70000000000009, -124.5, -141.59999999999982, -289.0, -134.99999999999997, -94.1, -95.79999999999986, -226.79999999999998, -20.39999999999999, -115.9, -133.79999999999984, -112.80000000000007, -97.6, -177.39999999999995, -106.39999999999989, -43.6, -136.79999999999973, -94.40000000000002, -136.7, -136.70000000000002, -12.69999999999999, -127.3, -116.5, -94.50000000000006, -118.19999999999968, -133.6999999999998, -119.9, -111.4, -15.199999999999994, -12.39999999999999, -116.79999999999968, -11.39999999999999, -162.7, -153.8000000000002, -100.9, -128.99999999999994, -119.80000000000001, -112.4, -153.7999999999997, -14.199999999999994, -84.3, -96.39999999999974, -85.3, -98.1, -45.10000000000007, -313.6000000000006, -129.70000000000005, -94.4, -102.2, -318.80000000000075, -84.5, -112.2, -119.3, -27.300000000000036, -81.4, -100.4, -17.200000000000006, -54.00000000000004, -117.79999999999995, -142.69999999999962, -323.7999999999998, -72.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5908052602819365, "mean_inference_ms": 0.6772081602652572, "mean_action_processing_ms": 0.02990280479645353, "mean_env_wait_ms": 2.94363881448981, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 12000, "timesteps_this_iter": 0, "agent_timesteps_total": 12000, "timers": {"sample_time_ms": 20408.251, "sample_throughput": 195.999, "load_time_ms": 0.309, "load_throughput": 12925436.055, "learn_time_ms": 4578.473, "learn_throughput": 873.654}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 20.632952455551393, "policy_loss": 0.0022253031091343974, "vf_loss": 2062.8211935063846, "vf_explained_var": 0.006972456427030666, "kl": 0.012578186105134592, "entropy": 1.322739795587396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 12000, "num_agent_steps_sampled": 12000, "num_steps_trained": 12000, "num_agent_steps_trained": 12000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 120, "training_iteration": 3, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-03-29", "timestamp": 1651061009, "time_this_iter_s": 24.09121608734131, "time_total_s": 66.26349711418152, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 66.26349711418152, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.58125, "ram_util_percent": 95.371875}}
{"episode_reward_max": -9.199999999999994, "episode_reward_min": -323.7999999999998, "episode_reward_mean": -104.37999999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-141.59999999999982, -289.0, -134.99999999999997, -94.1, -95.79999999999986, -226.79999999999998, -20.39999999999999, -115.9, -133.79999999999984, -112.80000000000007, -97.6, -177.39999999999995, -106.39999999999989, -43.6, -136.79999999999973, -94.40000000000002, -136.7, -136.70000000000002, -12.69999999999999, -127.3, -116.5, -94.50000000000006, -118.19999999999968, -133.6999999999998, -119.9, -111.4, -15.199999999999994, -12.39999999999999, -116.79999999999968, -11.39999999999999, -162.7, -153.8000000000002, -100.9, -128.99999999999994, -119.80000000000001, -112.4, -153.7999999999997, -14.199999999999994, -84.3, -96.39999999999974, -85.3, -98.1, -45.10000000000007, -313.6000000000006, -129.70000000000005, -94.4, -102.2, -318.80000000000075, -84.5, -112.2, -119.3, -27.300000000000036, -81.4, -100.4, -17.200000000000006, -54.00000000000004, -117.79999999999995, -142.69999999999962, -323.7999999999998, -72.9, -82.29999999999994, -86.00000000000001, -16.99999999999999, -102.10000000000002, -74.9, -43.700000000000074, -87.7999999999999, -51.199999999999996, -149.79999999999964, -87.09999999999991, -100.79999999999998, -43.30000000000003, -13.899999999999988, -99.99999999999994, -137.6, -130.5, -19.099999999999987, -142.2, -93.49999999999999, -118.49999999999987, -84.5, -87.00000000000004, -77.10000000000001, -92.79999999999988, -77.40000000000002, -92.39999999999992, -74.3, -204.19999999999996, -107.99999999999986, -213.39999999999986, -128.3, -79.7, -91.29999999999986, -107.30000000000001, -65.60000000000001, -120.1999999999999, -113.79999999999981, -13.199999999999994, -64.20000000000003, -9.199999999999994], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6095664824016225, "mean_inference_ms": 0.7211598094555766, "mean_action_processing_ms": 0.031383382429027065, "mean_env_wait_ms": 3.0161825654423557, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 16000, "timesteps_this_iter": 0, "agent_timesteps_total": 16000, "timers": {"sample_time_ms": 21402.957, "sample_throughput": 186.89, "load_time_ms": 0.395, "load_throughput": 10117422.584, "learn_time_ms": 4538.364, "learn_throughput": 881.375}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 8.044353938359086, "policy_loss": 0.003915445838043446, "vf_loss": 803.7388166284048, "vf_explained_var": 0.01028633822676956, "kl": 0.01525262812026198, "entropy": 1.2758798386460992, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 16000, "num_agent_steps_sampled": 16000, "num_steps_trained": 16000, "num_agent_steps_trained": 16000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 160, "training_iteration": 4, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-03-53", "timestamp": 1651061033, "time_this_iter_s": 23.688459873199463, "time_total_s": 89.95195698738098, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 89.95195698738098, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 14.648484848484848, "ram_util_percent": 95.15151515151516}}
{"episode_reward_max": -9.199999999999994, "episode_reward_min": -557.5000000000005, "episode_reward_mean": -98.56299999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-85.3, -98.1, -45.10000000000007, -313.6000000000006, -129.70000000000005, -94.4, -102.2, -318.80000000000075, -84.5, -112.2, -119.3, -27.300000000000036, -81.4, -100.4, -17.200000000000006, -54.00000000000004, -117.79999999999995, -142.69999999999962, -323.7999999999998, -72.9, -82.29999999999994, -86.00000000000001, -16.99999999999999, -102.10000000000002, -74.9, -43.700000000000074, -87.7999999999999, -51.199999999999996, -149.79999999999964, -87.09999999999991, -100.79999999999998, -43.30000000000003, -13.899999999999988, -99.99999999999994, -137.6, -130.5, -19.099999999999987, -142.2, -93.49999999999999, -118.49999999999987, -84.5, -87.00000000000004, -77.10000000000001, -92.79999999999988, -77.40000000000002, -92.39999999999992, -74.3, -204.19999999999996, -107.99999999999986, -213.39999999999986, -128.3, -79.7, -91.29999999999986, -107.30000000000001, -65.60000000000001, -120.1999999999999, -113.79999999999981, -13.199999999999994, -64.20000000000003, -9.199999999999994, -110.3, -22.400000000000016, -105.9, -10.199999999999996, -68.30000000000003, -23.700000000000017, -59.50000000000001, -127.6, -108.79999999999983, -557.5000000000005, -167.8000000000002, -72.69999999999999, -130.39999999999975, -105.7, -153.20000000000027, -10.299999999999988, -76.3, -44.70000000000001, -61.90000000000007, -13.499999999999982, -64.1, -71.40000000000002, -15.099999999999989, -21.10000000000001, -87.69999999999997, -39.3, -67.5, -76.8, -81.9, -57.7, -89.3, -213.00000000000026, -21.80000000000002, -119.59999999999978, -54.70000000000001, -186.89999999999998, -78.00000000000001, -106.1, -118.29999999999977, -229.39999999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6221114242353017, "mean_inference_ms": 0.7540294376285184, "mean_action_processing_ms": 0.03238480521563842, "mean_env_wait_ms": 3.0679133331571533, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 20000, "timesteps_this_iter": 0, "agent_timesteps_total": 20000, "timers": {"sample_time_ms": 21771.944, "sample_throughput": 183.723, "load_time_ms": 0.365, "load_throughput": 10949755.907, "learn_time_ms": 4641.574, "learn_throughput": 861.777}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 27.724429163112436, "policy_loss": 0.001830906785463774, "vf_loss": 2772.1743028538203, "vf_explained_var": -0.03873966714387299, "kl": 0.004278514764221556, "entropy": 1.273465564686765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 20000, "num_agent_steps_sampled": 20000, "num_steps_trained": 20000, "num_agent_steps_trained": 20000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 200, "training_iteration": 5, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-04-17", "timestamp": 1651061057, "time_this_iter_s": 23.861250162124634, "time_total_s": 113.81320714950562, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 113.81320714950562, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 23.671875, "ram_util_percent": 94.75625}}
{"episode_reward_max": -9.199999999999994, "episode_reward_min": -557.5000000000005, "episode_reward_mean": -90.517, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-84.5, -87.00000000000004, -77.10000000000001, -92.79999999999988, -77.40000000000002, -92.39999999999992, -74.3, -204.19999999999996, -107.99999999999986, -213.39999999999986, -128.3, -79.7, -91.29999999999986, -107.30000000000001, -65.60000000000001, -120.1999999999999, -113.79999999999981, -13.199999999999994, -64.20000000000003, -9.199999999999994, -110.3, -22.400000000000016, -105.9, -10.199999999999996, -68.30000000000003, -23.700000000000017, -59.50000000000001, -127.6, -108.79999999999983, -557.5000000000005, -167.8000000000002, -72.69999999999999, -130.39999999999975, -105.7, -153.20000000000027, -10.299999999999988, -76.3, -44.70000000000001, -61.90000000000007, -13.499999999999982, -64.1, -71.40000000000002, -15.099999999999989, -21.10000000000001, -87.69999999999997, -39.3, -67.5, -76.8, -81.9, -57.7, -89.3, -213.00000000000026, -21.80000000000002, -119.59999999999978, -54.70000000000001, -186.89999999999998, -78.00000000000001, -106.1, -118.29999999999977, -229.39999999999995, -13.999999999999993, -80.4, -87.40000000000009, -145.9, -137.99999999999974, -113.90000000000003, -126.29999999999998, -79.2, -121.69999999999973, -105.20000000000002, -111.59999999999997, -17.599999999999998, -14.49999999999999, -99.6, -156.2, -55.9, -42.00000000000001, -105.99999999999979, -48.1, -70.5, -62.7, -22.7, -150.5, -47.1, -45.00000000000001, -66.60000000000004, -118.9, -96.5, -11.899999999999988, -178.59999999999997, -74.40000000000002, -14.099999999999982, -55.50000000000001, -129.3, -104.80000000000001, -59.79999999999999, -39.89999999999999, -133.5, -122.1, -49.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6289288977736248, "mean_inference_ms": 0.778073326130202, "mean_action_processing_ms": 0.03306236867336808, "mean_env_wait_ms": 3.1119062297572486, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 24000, "timesteps_this_iter": 0, "agent_timesteps_total": 24000, "timers": {"sample_time_ms": 22372.942, "sample_throughput": 178.787, "load_time_ms": 0.34, "load_throughput": 11762479.084, "learn_time_ms": 4690.127, "learn_throughput": 852.855}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 6.937680861898648, "policy_loss": 0.001652288108423192, "vf_loss": 693.3989743960801, "vf_explained_var": -0.11512443436089383, "kl": 0.020389803758184652, "entropy": 1.168739389988684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 24000, "num_agent_steps_sampled": 24000, "num_steps_trained": 24000, "num_agent_steps_trained": 24000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 240, "training_iteration": 6, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-04-42", "timestamp": 1651061082, "time_this_iter_s": 25.238500118255615, "time_total_s": 139.05170726776123, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 139.05170726776123, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 28.261764705882356, "ram_util_percent": 94.07058823529412}}
{"episode_reward_max": -9.899999999999995, "episode_reward_min": -229.39999999999995, "episode_reward_mean": -78.95099999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.1, -71.40000000000002, -15.099999999999989, -21.10000000000001, -87.69999999999997, -39.3, -67.5, -76.8, -81.9, -57.7, -89.3, -213.00000000000026, -21.80000000000002, -119.59999999999978, -54.70000000000001, -186.89999999999998, -78.00000000000001, -106.1, -118.29999999999977, -229.39999999999995, -13.999999999999993, -80.4, -87.40000000000009, -145.9, -137.99999999999974, -113.90000000000003, -126.29999999999998, -79.2, -121.69999999999973, -105.20000000000002, -111.59999999999997, -17.599999999999998, -14.49999999999999, -99.6, -156.2, -55.9, -42.00000000000001, -105.99999999999979, -48.1, -70.5, -62.7, -22.7, -150.5, -47.1, -45.00000000000001, -66.60000000000004, -118.9, -96.5, -11.899999999999988, -178.59999999999997, -74.40000000000002, -14.099999999999982, -55.50000000000001, -129.3, -104.80000000000001, -59.79999999999999, -39.89999999999999, -133.5, -122.1, -49.5, -80.5, -90.19999999999995, -97.9, -68.0, -66.80000000000001, -23.200000000000003, -181.0999999999999, -14.699999999999996, -85.90000000000016, -53.80000000000001, -45.30000000000001, -104.4, -86.3, -72.8, -19.000000000000004, -129.79999999999978, -65.80000000000013, -112.1, -13.399999999999983, -12.999999999999991, -129.40000000000003, -47.40000000000008, -61.89999999999999, -86.79999999999995, -96.3999999999998, -67.30000000000003, -97.69999999999996, -29.500000000000014, -81.60000000000002, -13.399999999999988, -74.59999999999994, -113.7, -70.19999999999997, -82.09999999999981, -46.800000000000004, -21.300000000000008, -54.20000000000002, -149.9, -19.900000000000002, -9.899999999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6311200752061591, "mean_inference_ms": 0.7959141041898675, "mean_action_processing_ms": 0.03361710649130076, "mean_env_wait_ms": 3.1431523380181225, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 28000, "timesteps_this_iter": 0, "agent_timesteps_total": 28000, "timers": {"sample_time_ms": 22593.384, "sample_throughput": 177.043, "load_time_ms": 0.328, "load_throughput": 12213031.614, "learn_time_ms": 4691.401, "learn_throughput": 852.624}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 4.112914956641454, "policy_loss": -0.0016584625813148676, "vf_loss": 411.3043187623383, "vf_explained_var": 0.013596478649365005, "kl": 0.010202119274583246, "entropy": 1.114554541021265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 28000, "num_agent_steps_sampled": 28000, "num_steps_trained": 28000, "num_agent_steps_trained": 28000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 280, "training_iteration": 7, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-05-06", "timestamp": 1651061106, "time_this_iter_s": 23.662081956863403, "time_total_s": 162.71378922462463, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 162.71378922462463, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 25.62121212121212, "ram_util_percent": 94.3030303030303}}
{"episode_reward_max": -9.899999999999995, "episode_reward_min": -181.0999999999999, "episode_reward_mean": -71.83, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.7, -22.7, -150.5, -47.1, -45.00000000000001, -66.60000000000004, -118.9, -96.5, -11.899999999999988, -178.59999999999997, -74.40000000000002, -14.099999999999982, -55.50000000000001, -129.3, -104.80000000000001, -59.79999999999999, -39.89999999999999, -133.5, -122.1, -49.5, -80.5, -90.19999999999995, -97.9, -68.0, -66.80000000000001, -23.200000000000003, -181.0999999999999, -14.699999999999996, -85.90000000000016, -53.80000000000001, -45.30000000000001, -104.4, -86.3, -72.8, -19.000000000000004, -129.79999999999978, -65.80000000000013, -112.1, -13.399999999999983, -12.999999999999991, -129.40000000000003, -47.40000000000008, -61.89999999999999, -86.79999999999995, -96.3999999999998, -67.30000000000003, -97.69999999999996, -29.500000000000014, -81.60000000000002, -13.399999999999988, -74.59999999999994, -113.7, -70.19999999999997, -82.09999999999981, -46.800000000000004, -21.300000000000008, -54.20000000000002, -149.9, -19.900000000000002, -9.899999999999995, -62.20000000000005, -40.4, -58.3, -91.30000000000001, -87.9, -61.300000000000004, -60.4, -50.0, -101.6, -16.09999999999999, -54.9, -62.00000000000008, -94.29999999999993, -143.2, -50.70000000000003, -34.699999999999996, -149.4, -79.00000000000001, -56.900000000000006, -18.299999999999997, -13.199999999999992, -54.40000000000007, -121.69999999999999, -40.30000000000001, -104.8, -106.99999999999997, -60.60000000000001, -74.20000000000002, -53.500000000000014, -36.60000000000005, -89.5, -69.30000000000007, -69.80000000000001, -87.7, -74.2, -10.899999999999995, -55.20000000000002, -131.99999999999994, -101.79999999999986, -92.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6334741284905175, "mean_inference_ms": 0.8090766949158172, "mean_action_processing_ms": 0.03404233259055499, "mean_env_wait_ms": 3.15762739049071, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 32000, "timesteps_this_iter": 0, "agent_timesteps_total": 32000, "timers": {"sample_time_ms": 22731.563, "sample_throughput": 175.967, "load_time_ms": 0.316, "load_throughput": 12640584.668, "learn_time_ms": 4673.459, "learn_throughput": 855.897}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 3.7919182900459534, "policy_loss": -0.005151534903674356, "vf_loss": 379.5434702473302, "vf_explained_var": 0.08541445924389747, "kl": 0.010901374189335247, "entropy": 1.0967018794628882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 32000, "num_agent_steps_sampled": 32000, "num_steps_trained": 32000, "num_agent_steps_trained": 32000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 320, "training_iteration": 8, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-05-29", "timestamp": 1651061129, "time_this_iter_s": 23.53001308441162, "time_total_s": 186.24380230903625, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 186.24380230903625, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 28.5, "ram_util_percent": 94.33125000000001}}
{"episode_reward_max": -9.899999999999995, "episode_reward_min": -253.7, "episode_reward_mean": -76.649, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-129.40000000000003, -47.40000000000008, -61.89999999999999, -86.79999999999995, -96.3999999999998, -67.30000000000003, -97.69999999999996, -29.500000000000014, -81.60000000000002, -13.399999999999988, -74.59999999999994, -113.7, -70.19999999999997, -82.09999999999981, -46.800000000000004, -21.300000000000008, -54.20000000000002, -149.9, -19.900000000000002, -9.899999999999995, -62.20000000000005, -40.4, -58.3, -91.30000000000001, -87.9, -61.300000000000004, -60.4, -50.0, -101.6, -16.09999999999999, -54.9, -62.00000000000008, -94.29999999999993, -143.2, -50.70000000000003, -34.699999999999996, -149.4, -79.00000000000001, -56.900000000000006, -18.299999999999997, -13.199999999999992, -54.40000000000007, -121.69999999999999, -40.30000000000001, -104.8, -106.99999999999997, -60.60000000000001, -74.20000000000002, -53.500000000000014, -36.60000000000005, -89.5, -69.30000000000007, -69.80000000000001, -87.7, -74.2, -10.899999999999995, -55.20000000000002, -131.99999999999994, -101.79999999999986, -92.0, -62.6, -144.69999999999976, -92.49999999999993, -46.10000000000007, -21.39999999999999, -85.19999999999995, -226.99999999999983, -76.79999999999997, -159.79999999999973, -93.8, -153.2, -29.200000000000024, -35.40000000000005, -253.7, -147.79999999999976, -108.7, -113.99999999999996, -107.0, -94.99999999999996, -76.2, -54.80000000000005, -56.5000000000001, -55.9, -115.4, -110.6, -28.00000000000001, -49.60000000000007, -15.999999999999995, -54.4, -62.699999999999996, -49.900000000000006, -55.7, -70.8, -101.09999999999992, -78.50000000000007, -95.4, -13.899999999999993, -48.2, -48.80000000000009, -192.9999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6332681443640584, "mean_inference_ms": 0.8134018512044182, "mean_action_processing_ms": 0.03414778761311377, "mean_env_wait_ms": 3.1558085413652326, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 36000, "timesteps_this_iter": 0, "agent_timesteps_total": 36000, "timers": {"sample_time_ms": 22716.723, "sample_throughput": 176.082, "load_time_ms": 0.305, "load_throughput": 13122007.821, "learn_time_ms": 4668.267, "learn_throughput": 856.849}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 8.159934142680578, "policy_loss": 0.0063448817459165405, "vf_loss": 815.2534904356926, "vf_explained_var": 0.05701221214827671, "kl": 0.007029819183705235, "entropy": 1.0353448079478356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 36000, "num_agent_steps_sampled": 36000, "num_steps_trained": 36000, "num_agent_steps_trained": 36000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 360, "training_iteration": 9, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-05-52", "timestamp": 1651061152, "time_this_iter_s": 22.658118963241577, "time_total_s": 208.90192127227783, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 208.90192127227783, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 16.851612903225806, "ram_util_percent": 94.30000000000001}}
{"episode_reward_max": -10.899999999999995, "episode_reward_min": -253.7, "episode_reward_mean": -71.79299999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.199999999999992, -54.40000000000007, -121.69999999999999, -40.30000000000001, -104.8, -106.99999999999997, -60.60000000000001, -74.20000000000002, -53.500000000000014, -36.60000000000005, -89.5, -69.30000000000007, -69.80000000000001, -87.7, -74.2, -10.899999999999995, -55.20000000000002, -131.99999999999994, -101.79999999999986, -92.0, -62.6, -144.69999999999976, -92.49999999999993, -46.10000000000007, -21.39999999999999, -85.19999999999995, -226.99999999999983, -76.79999999999997, -159.79999999999973, -93.8, -153.2, -29.200000000000024, -35.40000000000005, -253.7, -147.79999999999976, -108.7, -113.99999999999996, -107.0, -94.99999999999996, -76.2, -54.80000000000005, -56.5000000000001, -55.9, -115.4, -110.6, -28.00000000000001, -49.60000000000007, -15.999999999999995, -54.4, -62.699999999999996, -49.900000000000006, -55.7, -70.8, -101.09999999999992, -78.50000000000007, -95.4, -13.899999999999993, -48.2, -48.80000000000009, -192.9999999999998, -50.6, -32.0, -52.40000000000005, -41.7, -15.19999999999999, -47.00000000000001, -35.7, -27.700000000000035, -64.0, -89.59999999999994, -46.70000000000008, -116.60000000000004, -16.299999999999986, -60.600000000000065, -59.300000000000004, -69.3, -47.5, -41.5, -52.30000000000007, -51.90000000000004, -43.9, -125.4, -118.5, -18.599999999999994, -64.50000000000001, -59.100000000000044, -71.6000000000001, -16.59999999999999, -60.8, -38.10000000000001, -24.30000000000002, -109.69999999999982, -72.00000000000003, -55.1, -66.1, -54.50000000000004, -29.10000000000004, -66.50000000000006, -48.3, -80.69999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6320242916567773, "mean_inference_ms": 0.8119293557217782, "mean_action_processing_ms": 0.034049251665080056, "mean_env_wait_ms": 3.147888302780046, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 40000, "timesteps_this_iter": 0, "agent_timesteps_total": 40000, "timers": {"sample_time_ms": 22694.31, "sample_throughput": 176.256, "load_time_ms": 0.298, "load_throughput": 13433594.363, "learn_time_ms": 4670.176, "learn_throughput": 856.499}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 2.703528397890829, "policy_loss": -3.9939388071977966e-05, "vf_loss": 270.2348149207331, "vf_explained_var": -0.0247120722006726, "kl": 0.008134973167473589, "entropy": 1.0306793292363485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 40000, "num_agent_steps_sampled": 40000, "num_steps_trained": 40000, "num_agent_steps_trained": 40000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 400, "training_iteration": 10, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-06-15", "timestamp": 1651061175, "time_this_iter_s": 22.525118350982666, "time_total_s": 231.4270396232605, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 231.4270396232605, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.86, "ram_util_percent": 94.2766666666667}}
{"episode_reward_max": -13.599999999999984, "episode_reward_min": -192.9999999999998, "episode_reward_mean": -60.662000000000006, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.80000000000005, -56.5000000000001, -55.9, -115.4, -110.6, -28.00000000000001, -49.60000000000007, -15.999999999999995, -54.4, -62.699999999999996, -49.900000000000006, -55.7, -70.8, -101.09999999999992, -78.50000000000007, -95.4, -13.899999999999993, -48.2, -48.80000000000009, -192.9999999999998, -50.6, -32.0, -52.40000000000005, -41.7, -15.19999999999999, -47.00000000000001, -35.7, -27.700000000000035, -64.0, -89.59999999999994, -46.70000000000008, -116.60000000000004, -16.299999999999986, -60.600000000000065, -59.300000000000004, -69.3, -47.5, -41.5, -52.30000000000007, -51.90000000000004, -43.9, -125.4, -118.5, -18.599999999999994, -64.50000000000001, -59.100000000000044, -71.6000000000001, -16.59999999999999, -60.8, -38.10000000000001, -24.30000000000002, -109.69999999999982, -72.00000000000003, -55.1, -66.1, -54.50000000000004, -29.10000000000004, -66.50000000000006, -48.3, -80.69999999999999, -70.10000000000012, -71.80000000000003, -50.900000000000055, -70.50000000000001, -13.599999999999984, -73.9, -53.90000000000006, -31.299999999999997, -14.099999999999985, -15.999999999999988, -69.6, -52.00000000000001, -68.60000000000002, -46.200000000000045, -56.300000000000026, -46.500000000000014, -111.7, -74.5, -29.60000000000003, -73.6, -69.9, -35.80000000000004, -85.89999999999989, -71.69999999999999, -92.19999999999985, -71.1, -54.90000000000008, -64.3, -47.50000000000001, -93.4, -100.7999999999999, -71.7, -101.79999999999994, -86.0, -61.8, -61.50000000000005, -23.80000000000001, -72.3, -40.50000000000001, -64.10000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6346109602022383, "mean_inference_ms": 0.810638032712882, "mean_action_processing_ms": 0.03398678651823499, "mean_env_wait_ms": 3.3136552278532134, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 44000, "timesteps_this_iter": 0, "agent_timesteps_total": 44000, "timers": {"sample_time_ms": 23525.228, "sample_throughput": 170.03, "load_time_ms": 0.334, "load_throughput": 11982869.795, "learn_time_ms": 4673.805, "learn_throughput": 855.834}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 1.9967333447228195, "policy_loss": -0.006129902805031467, "vf_loss": 200.19672646061068, "vf_explained_var": 0.04191402632703063, "kl": 0.0059734759685727895, "entropy": 0.9611132533960445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 44000, "num_agent_steps_sampled": 44000, "num_steps_trained": 44000, "num_agent_steps_trained": 44000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 440, "training_iteration": 11, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-06-57", "timestamp": 1651061217, "time_this_iter_s": 42.26689410209656, "time_total_s": 273.69393372535706, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 273.69393372535706, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 28.928125, "ram_util_percent": 94.603125}}
{"episode_reward_max": -11.399999999999991, "episode_reward_min": -165.7, "episode_reward_mean": -65.25200000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.9, -125.4, -118.5, -18.599999999999994, -64.50000000000001, -59.100000000000044, -71.6000000000001, -16.59999999999999, -60.8, -38.10000000000001, -24.30000000000002, -109.69999999999982, -72.00000000000003, -55.1, -66.1, -54.50000000000004, -29.10000000000004, -66.50000000000006, -48.3, -80.69999999999999, -70.10000000000012, -71.80000000000003, -50.900000000000055, -70.50000000000001, -13.599999999999984, -73.9, -53.90000000000006, -31.299999999999997, -14.099999999999985, -15.999999999999988, -69.6, -52.00000000000001, -68.60000000000002, -46.200000000000045, -56.300000000000026, -46.500000000000014, -111.7, -74.5, -29.60000000000003, -73.6, -69.9, -35.80000000000004, -85.89999999999989, -71.69999999999999, -92.19999999999985, -71.1, -54.90000000000008, -64.3, -47.50000000000001, -93.4, -100.7999999999999, -71.7, -101.79999999999994, -86.0, -61.8, -61.50000000000005, -23.80000000000001, -72.3, -40.50000000000001, -64.10000000000001, -91.0, -80.9, -39.099999999999994, -165.7, -13.699999999999983, -127.70000000000006, -68.9, -103.4, -69.4, -69.0, -36.700000000000024, -52.10000000000004, -84.7, -48.70000000000001, -91.6, -58.50000000000006, -16.79999999999999, -57.60000000000006, -95.10000000000002, -139.7999999999999, -11.399999999999991, -21.80000000000002, -44.60000000000005, -125.79999999999974, -15.599999999999985, -83.90000000000002, -48.60000000000001, -77.1, -130.79999999999976, -36.900000000000055, -71.90000000000003, -78.3, -89.20000000000002, -64.90000000000009, -65.00000000000006, -59.8, -86.29999999999997, -85.40000000000012, -75.9, -52.500000000000085], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6372560583838555, "mean_inference_ms": 0.8045946913288091, "mean_action_processing_ms": 0.03379465596204827, "mean_env_wait_ms": 3.458402112433697, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 48000, "timesteps_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"sample_time_ms": 23448.913, "sample_throughput": 170.584, "load_time_ms": 0.343, "load_throughput": 11675167.711, "learn_time_ms": 4647.595, "learn_throughput": 860.66}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 4.13778579526691, "policy_loss": -0.0006961859462241973, "vf_loss": 413.7397283041349, "vf_explained_var": 0.1134118297407704, "kl": 0.007231886033522899, "entropy": 0.9323560399393882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 48000, "num_steps_trained": 48000, "num_agent_steps_trained": 48000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 480, "training_iteration": 12, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-07-17", "timestamp": 1651061237, "time_this_iter_s": 20.45856785774231, "time_total_s": 294.15250158309937, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 294.15250158309937, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 10.142857142857142, "ram_util_percent": 94.62499999999999}}
{"episode_reward_max": -11.299999999999988, "episode_reward_min": -165.7, "episode_reward_mean": -63.75199999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-69.9, -35.80000000000004, -85.89999999999989, -71.69999999999999, -92.19999999999985, -71.1, -54.90000000000008, -64.3, -47.50000000000001, -93.4, -100.7999999999999, -71.7, -101.79999999999994, -86.0, -61.8, -61.50000000000005, -23.80000000000001, -72.3, -40.50000000000001, -64.10000000000001, -91.0, -80.9, -39.099999999999994, -165.7, -13.699999999999983, -127.70000000000006, -68.9, -103.4, -69.4, -69.0, -36.700000000000024, -52.10000000000004, -84.7, -48.70000000000001, -91.6, -58.50000000000006, -16.79999999999999, -57.60000000000006, -95.10000000000002, -139.7999999999999, -11.399999999999991, -21.80000000000002, -44.60000000000005, -125.79999999999974, -15.599999999999985, -83.90000000000002, -48.60000000000001, -77.1, -130.79999999999976, -36.900000000000055, -71.90000000000003, -78.3, -89.20000000000002, -64.90000000000009, -65.00000000000006, -59.8, -86.29999999999997, -85.40000000000012, -75.9, -52.500000000000085, -117.4, -101.5, -50.90000000000001, -131.39999999999975, -55.10000000000001, -125.8, -15.599999999999985, -46.000000000000114, -69.8000000000001, -11.299999999999988, -73.3000000000001, -77.60000000000002, -15.29999999999999, -82.1, -14.49999999999998, -51.00000000000002, -29.600000000000012, -40.099999999999994, -48.5, -56.699999999999996, -50.00000000000003, -17.200000000000003, -42.4, -62.300000000000004, -51.50000000000001, -108.79999999999984, -26.9, -43.00000000000001, -63.000000000000064, -41.2, -28.999999999999996, -15.699999999999987, -89.6, -45.1, -13.799999999999995, -50.20000000000007, -31.4, -59.40000000000009, -61.7, -52.400000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6361534674899665, "mean_inference_ms": 0.7941248350813008, "mean_action_processing_ms": 0.03346050199409418, "mean_env_wait_ms": 3.4997574331011925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 52000, "timesteps_this_iter": 0, "agent_timesteps_total": 52000, "timers": {"sample_time_ms": 23168.232, "sample_throughput": 172.65, "load_time_ms": 0.321, "load_throughput": 12467277.997, "learn_time_ms": 4552.252, "learn_throughput": 878.686}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.15, "cur_lr": 0.00010000000000000003, "total_loss": 2.720760790346771, "policy_loss": 0.0014712470313233714, "vf_loss": 271.85874160848635, "vf_explained_var": 0.021894993384679158, "kl": 0.004681287134634035, "entropy": 0.9156976797247446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 52000, "num_agent_steps_sampled": 52000, "num_steps_trained": 52000, "num_agent_steps_trained": 52000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 520, "training_iteration": 13, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-07-38", "timestamp": 1651061258, "time_this_iter_s": 20.59860920906067, "time_total_s": 314.75111079216003, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 314.75111079216003, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 9.157142857142857, "ram_util_percent": 94.55714285714284}}
{"episode_reward_max": -11.299999999999988, "episode_reward_min": -150.59999999999974, "episode_reward_mean": -56.88400000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.399999999999991, -21.80000000000002, -44.60000000000005, -125.79999999999974, -15.599999999999985, -83.90000000000002, -48.60000000000001, -77.1, -130.79999999999976, -36.900000000000055, -71.90000000000003, -78.3, -89.20000000000002, -64.90000000000009, -65.00000000000006, -59.8, -86.29999999999997, -85.40000000000012, -75.9, -52.500000000000085, -117.4, -101.5, -50.90000000000001, -131.39999999999975, -55.10000000000001, -125.8, -15.599999999999985, -46.000000000000114, -69.8000000000001, -11.299999999999988, -73.3000000000001, -77.60000000000002, -15.29999999999999, -82.1, -14.49999999999998, -51.00000000000002, -29.600000000000012, -40.099999999999994, -48.5, -56.699999999999996, -50.00000000000003, -17.200000000000003, -42.4, -62.300000000000004, -51.50000000000001, -108.79999999999984, -26.9, -43.00000000000001, -63.000000000000064, -41.2, -28.999999999999996, -15.699999999999987, -89.6, -45.1, -13.799999999999995, -50.20000000000007, -31.4, -59.40000000000009, -61.7, -52.400000000000006, -49.600000000000044, -88.89999999999996, -34.300000000000026, -78.69999999999999, -49.1, -84.7, -39.5, -64.80000000000001, -54.80000000000008, -44.0, -139.79999999999973, -58.00000000000009, -59.50000000000006, -90.69999999999996, -25.400000000000027, -12.19999999999998, -49.80000000000004, -65.0, -37.9, -53.5, -56.300000000000004, -38.6, -41.80000000000005, -61.9, -53.80000000000001, -11.899999999999984, -39.199999999999996, -39.7, -60.300000000000004, -69.30000000000004, -122.29999999999976, -19.00000000000002, -47.80000000000008, -42.30000000000006, -60.30000000000002, -18.59999999999999, -150.59999999999974, -36.1, -11.799999999999988, -32.8], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6323514197096218, "mean_inference_ms": 0.7807551056297121, "mean_action_processing_ms": 0.03306347923186876, "mean_env_wait_ms": 3.4502092430563933, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 56000, "timesteps_this_iter": 0, "agent_timesteps_total": 56000, "timers": {"sample_time_ms": 22771.198, "sample_throughput": 175.66, "load_time_ms": 0.279, "load_throughput": 14350539.731, "learn_time_ms": 4515.912, "learn_throughput": 885.757}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 2.167312397919996, "policy_loss": 3.1466123407646535e-05, "vf_loss": 216.6662154002856, "vf_explained_var": 0.14225511852131095, "kl": 0.008251119196781792, "entropy": 0.8860404253005981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 56000, "num_agent_steps_sampled": 56000, "num_steps_trained": 56000, "num_agent_steps_trained": 56000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 560, "training_iteration": 14, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-07-58", "timestamp": 1651061278, "time_this_iter_s": 20.311026334762573, "time_total_s": 335.0621371269226, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 335.0621371269226, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 12.378571428571428, "ram_util_percent": 94.50714285714285}}
{"episode_reward_max": -11.799999999999988, "episode_reward_min": -150.59999999999974, "episode_reward_mean": -54.269000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000003, -17.200000000000003, -42.4, -62.300000000000004, -51.50000000000001, -108.79999999999984, -26.9, -43.00000000000001, -63.000000000000064, -41.2, -28.999999999999996, -15.699999999999987, -89.6, -45.1, -13.799999999999995, -50.20000000000007, -31.4, -59.40000000000009, -61.7, -52.400000000000006, -49.600000000000044, -88.89999999999996, -34.300000000000026, -78.69999999999999, -49.1, -84.7, -39.5, -64.80000000000001, -54.80000000000008, -44.0, -139.79999999999973, -58.00000000000009, -59.50000000000006, -90.69999999999996, -25.400000000000027, -12.19999999999998, -49.80000000000004, -65.0, -37.9, -53.5, -56.300000000000004, -38.6, -41.80000000000005, -61.9, -53.80000000000001, -11.899999999999984, -39.199999999999996, -39.7, -60.300000000000004, -69.30000000000004, -122.29999999999976, -19.00000000000002, -47.80000000000008, -42.30000000000006, -60.30000000000002, -18.59999999999999, -150.59999999999974, -36.1, -11.799999999999988, -32.8, -135.4, -15.899999999999984, -32.1, -70.79999999999995, -96.49999999999987, -118.29999999999998, -73.3, -52.300000000000004, -12.499999999999988, -88.3999999999999, -16.399999999999984, -74.59999999999991, -52.10000000000012, -30.200000000000003, -30.500000000000068, -13.699999999999989, -53.200000000000074, -55.599999999999994, -33.5, -15.399999999999988, -54.900000000000034, -49.90000000000001, -61.200000000000045, -40.2, -29.9, -39.80000000000007, -47.100000000000065, -68.59999999999998, -93.59999999999982, -30.7, -66.20000000000003, -144.49999999999977, -45.50000000000007, -78.59999999999995, -66.20000000000003, -57.20000000000006, -66.20000000000002, -31.6, -53.00000000000001, -82.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6287230332463243, "mean_inference_ms": 0.7684693465142902, "mean_action_processing_ms": 0.03272337393026372, "mean_env_wait_ms": 3.406976839427928, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 60000, "timesteps_this_iter": 0, "agent_timesteps_total": 60000, "timers": {"sample_time_ms": 22464.953, "sample_throughput": 178.055, "load_time_ms": 0.28, "load_throughput": 14280912.496, "learn_time_ms": 4438.098, "learn_throughput": 901.287}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 2.4888003557439773, "policy_loss": -0.010137869534833777, "vf_loss": 249.85463541092412, "vf_explained_var": 0.04921974110346968, "kl": 0.005225615656675739, "entropy": 0.8362402042394044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 60000, "num_agent_steps_sampled": 60000, "num_steps_trained": 60000, "num_agent_steps_trained": 60000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 600, "training_iteration": 15, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-08-19", "timestamp": 1651061299, "time_this_iter_s": 20.389185190200806, "time_total_s": 355.4513223171234, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 355.4513223171234, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 10.892857142857144, "ram_util_percent": 94.5}}
{"episode_reward_max": -9.89999999999998, "episode_reward_min": -150.59999999999974, "episode_reward_mean": -59.03999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.300000000000004, -38.6, -41.80000000000005, -61.9, -53.80000000000001, -11.899999999999984, -39.199999999999996, -39.7, -60.300000000000004, -69.30000000000004, -122.29999999999976, -19.00000000000002, -47.80000000000008, -42.30000000000006, -60.30000000000002, -18.59999999999999, -150.59999999999974, -36.1, -11.799999999999988, -32.8, -135.4, -15.899999999999984, -32.1, -70.79999999999995, -96.49999999999987, -118.29999999999998, -73.3, -52.300000000000004, -12.499999999999988, -88.3999999999999, -16.399999999999984, -74.59999999999991, -52.10000000000012, -30.200000000000003, -30.500000000000068, -13.699999999999989, -53.200000000000074, -55.599999999999994, -33.5, -15.399999999999988, -54.900000000000034, -49.90000000000001, -61.200000000000045, -40.2, -29.9, -39.80000000000007, -47.100000000000065, -68.59999999999998, -93.59999999999982, -30.7, -66.20000000000003, -144.49999999999977, -45.50000000000007, -78.59999999999995, -66.20000000000003, -57.20000000000006, -66.20000000000002, -31.6, -53.00000000000001, -82.1, -14.799999999999985, -69.10000000000004, -37.50000000000004, -45.2, -44.0, -108.9, -39.70000000000003, -133.2, -45.400000000000006, -149.49999999999974, -127.8999999999998, -67.70000000000005, -43.6, -106.49999999999984, -26.899999999999995, -112.5, -64.20000000000006, -51.70000000000006, -94.80000000000004, -9.89999999999998, -44.00000000000001, -41.20000000000001, -117.79999999999977, -16.49999999999999, -64.2, -109.79999999999988, -24.799999999999997, -53.300000000000004, -65.60000000000012, -81.2, -26.800000000000015, -38.10000000000005, -73.70000000000003, -56.40000000000001, -72.50000000000006, -133.2, -57.20000000000001, -50.3, -69.50000000000007, -22.80000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6263560245942705, "mean_inference_ms": 0.7581969477680386, "mean_action_processing_ms": 0.032442896662377894, "mean_env_wait_ms": 3.368782819457756, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 64000, "timesteps_this_iter": 0, "agent_timesteps_total": 64000, "timers": {"sample_time_ms": 22002.806, "sample_throughput": 181.795, "load_time_ms": 0.313, "load_throughput": 12792387.343, "learn_time_ms": 4350.355, "learn_throughput": 919.465}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 3.3032072543937674, "policy_loss": -0.001896331015653828, "vf_loss": 330.44969650186516, "vf_explained_var": 0.0716156255814337, "kl": 0.008089155323278904, "entropy": 0.848693932512755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 64000, "num_agent_steps_sampled": 64000, "num_steps_trained": 64000, "num_agent_steps_trained": 64000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 640, "training_iteration": 16, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-08-39", "timestamp": 1651061319, "time_this_iter_s": 20.519407987594604, "time_total_s": 375.970730304718, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 375.970730304718, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.010714285714286, "ram_util_percent": 94.49285714285715}}
{"episode_reward_max": -9.89999999999998, "episode_reward_min": -149.49999999999974, "episode_reward_mean": -59.925, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.900000000000034, -49.90000000000001, -61.200000000000045, -40.2, -29.9, -39.80000000000007, -47.100000000000065, -68.59999999999998, -93.59999999999982, -30.7, -66.20000000000003, -144.49999999999977, -45.50000000000007, -78.59999999999995, -66.20000000000003, -57.20000000000006, -66.20000000000002, -31.6, -53.00000000000001, -82.1, -14.799999999999985, -69.10000000000004, -37.50000000000004, -45.2, -44.0, -108.9, -39.70000000000003, -133.2, -45.400000000000006, -149.49999999999974, -127.8999999999998, -67.70000000000005, -43.6, -106.49999999999984, -26.899999999999995, -112.5, -64.20000000000006, -51.70000000000006, -94.80000000000004, -9.89999999999998, -44.00000000000001, -41.20000000000001, -117.79999999999977, -16.49999999999999, -64.2, -109.79999999999988, -24.799999999999997, -53.300000000000004, -65.60000000000012, -81.2, -26.800000000000015, -38.10000000000005, -73.70000000000003, -56.40000000000001, -72.50000000000006, -133.2, -57.20000000000001, -50.3, -69.50000000000007, -22.80000000000001, -32.8, -10.89999999999999, -38.60000000000003, -38.70000000000006, -41.800000000000004, -105.30000000000001, -66.6, -96.99999999999996, -24.200000000000003, -54.0, -54.50000000000001, -144.79999999999976, -48.699999999999996, -40.00000000000007, -85.70000000000002, -35.2, -39.8, -55.80000000000005, -22.599999999999994, -46.4, -38.40000000000007, -73.4, -12.999999999999984, -18.9, -39.9, -47.3, -129.9, -48.70000000000006, -96.7999999999999, -35.8, -39.10000000000001, -52.9, -40.2, -144.2, -25.9, -26.799999999999997, -11.299999999999985, -111.49999999999989, -56.70000000000008, -39.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6242672971096979, "mean_inference_ms": 0.750064469240634, "mean_action_processing_ms": 0.032197125684694364, "mean_env_wait_ms": 3.3347672950315244, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 68000, "timesteps_this_iter": 0, "agent_timesteps_total": 68000, "timers": {"sample_time_ms": 21640.586, "sample_throughput": 184.838, "load_time_ms": 0.312, "load_throughput": 12818777.506, "learn_time_ms": 4287.059, "learn_throughput": 933.041}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 2.4194462466158813, "policy_loss": -0.0001620519265372266, "vf_loss": 241.917144016553, "vf_explained_var": 0.04814122665312982, "kl": 0.005825675111356657, "entropy": 0.8724660962499599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 68000, "num_agent_steps_sampled": 68000, "num_steps_trained": 68000, "num_agent_steps_trained": 68000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 680, "training_iteration": 17, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-09-00", "timestamp": 1651061340, "time_this_iter_s": 20.284970998764038, "time_total_s": 396.25570130348206, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 396.25570130348206, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.900000000000002, "ram_util_percent": 94.47857142857141}}
{"episode_reward_max": -10.89999999999999, "episode_reward_min": -381.5, "episode_reward_mean": -61.031000000000006, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.00000000000001, -41.20000000000001, -117.79999999999977, -16.49999999999999, -64.2, -109.79999999999988, -24.799999999999997, -53.300000000000004, -65.60000000000012, -81.2, -26.800000000000015, -38.10000000000005, -73.70000000000003, -56.40000000000001, -72.50000000000006, -133.2, -57.20000000000001, -50.3, -69.50000000000007, -22.80000000000001, -32.8, -10.89999999999999, -38.60000000000003, -38.70000000000006, -41.800000000000004, -105.30000000000001, -66.6, -96.99999999999996, -24.200000000000003, -54.0, -54.50000000000001, -144.79999999999976, -48.699999999999996, -40.00000000000007, -85.70000000000002, -35.2, -39.8, -55.80000000000005, -22.599999999999994, -46.4, -38.40000000000007, -73.4, -12.999999999999984, -18.9, -39.9, -47.3, -129.9, -48.70000000000006, -96.7999999999999, -35.8, -39.10000000000001, -52.9, -40.2, -144.2, -25.9, -26.799999999999997, -11.299999999999985, -111.49999999999989, -56.70000000000008, -39.5, -41.0, -59.5, -84.29999999999983, -22.300000000000033, -60.10000000000008, -48.1, -48.10000000000001, -381.5, -20.200000000000003, -59.9, -104.39999999999992, -81.00000000000011, -33.0, -17.09999999999999, -37.900000000000006, -47.00000000000001, -107.69999999999992, -36.80000000000001, -62.10000000000001, -67.50000000000006, -94.2, -73.40000000000005, -69.9, -42.0, -60.7, -43.3, -19.400000000000002, -62.1, -11.699999999999989, -29.500000000000007, -85.99999999999999, -19.900000000000013, -60.70000000000006, -82.4, -67.90000000000003, -146.2, -45.20000000000001, -151.89999999999975, -61.60000000000006, -63.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6240008173124655, "mean_inference_ms": 0.7408692036865929, "mean_action_processing_ms": 0.03192184043601258, "mean_env_wait_ms": 3.3030119500449557, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 72000, "timesteps_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"sample_time_ms": 21267.102, "sample_throughput": 188.084, "load_time_ms": 0.335, "load_throughput": 11952137.921, "learn_time_ms": 4232.193, "learn_throughput": 945.136}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 6.343096272727495, "policy_loss": -0.00035618986754167465, "vf_loss": 634.2967282161918, "vf_explained_var": 0.004886628863632038, "kl": 0.00647098089532901, "entropy": 0.8050696081371718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 72000, "num_agent_steps_sampled": 72000, "num_steps_trained": 72000, "num_agent_steps_trained": 72000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 720, "training_iteration": 18, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-09-20", "timestamp": 1651061360, "time_this_iter_s": 19.880022764205933, "time_total_s": 416.135724067688, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 416.135724067688, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 12.734615384615385, "ram_util_percent": 94.49615384615385}}
{"episode_reward_max": -11.299999999999985, "episode_reward_min": -381.5, "episode_reward_mean": -61.020999999999994, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.40000000000007, -73.4, -12.999999999999984, -18.9, -39.9, -47.3, -129.9, -48.70000000000006, -96.7999999999999, -35.8, -39.10000000000001, -52.9, -40.2, -144.2, -25.9, -26.799999999999997, -11.299999999999985, -111.49999999999989, -56.70000000000008, -39.5, -41.0, -59.5, -84.29999999999983, -22.300000000000033, -60.10000000000008, -48.1, -48.10000000000001, -381.5, -20.200000000000003, -59.9, -104.39999999999992, -81.00000000000011, -33.0, -17.09999999999999, -37.900000000000006, -47.00000000000001, -107.69999999999992, -36.80000000000001, -62.10000000000001, -67.50000000000006, -94.2, -73.40000000000005, -69.9, -42.0, -60.7, -43.3, -19.400000000000002, -62.1, -11.699999999999989, -29.500000000000007, -85.99999999999999, -19.900000000000013, -60.70000000000006, -82.4, -67.90000000000003, -146.2, -45.20000000000001, -151.89999999999975, -61.60000000000006, -63.1, -28.299999999999997, -25.299999999999997, -63.2, -35.7, -24.099999999999994, -39.8, -78.30000000000008, -26.80000000000002, -61.000000000000036, -72.39999999999999, -101.10000000000002, -19.999999999999993, -13.399999999999988, -150.59999999999974, -65.80000000000004, -26.200000000000003, -23.200000000000003, -49.70000000000009, -137.70000000000005, -77.8, -20.200000000000003, -48.400000000000055, -46.20000000000001, -39.800000000000004, -94.59999999999994, -28.800000000000082, -20.300000000000004, -127.0, -119.69999999999976, -63.00000000000007, -88.80000000000004, -15.699999999999992, -40.70000000000005, -75.90000000000003, -54.60000000000002, -59.3, -52.900000000000084, -16.199999999999996, -49.40000000000008, -119.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6227373049194321, "mean_inference_ms": 0.7316113835127731, "mean_action_processing_ms": 0.03164450295290777, "mean_env_wait_ms": 3.2748855008127147, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 76000, "timesteps_this_iter": 0, "agent_timesteps_total": 76000, "timers": {"sample_time_ms": 21007.993, "sample_throughput": 190.404, "load_time_ms": 0.337, "load_throughput": 11853338.985, "learn_time_ms": 4179.102, "learn_throughput": 957.143}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 2.865916086701296, "policy_loss": -0.0015391356311738491, "vf_loss": 286.700545805244, "vf_explained_var": -0.017960505780353343, "kl": 0.005997783017007204, "entropy": 0.895261723187662, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 76000, "num_agent_steps_sampled": 76000, "num_steps_trained": 76000, "num_agent_steps_trained": 76000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 760, "training_iteration": 19, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-09-40", "timestamp": 1651061380, "time_this_iter_s": 20.08725118637085, "time_total_s": 436.22297525405884, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 436.22297525405884, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 10.433333333333334, "ram_util_percent": 94.4962962962963}}
{"episode_reward_max": -11.699999999999989, "episode_reward_min": -151.89999999999975, "episode_reward_mean": -56.51000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-94.2, -73.40000000000005, -69.9, -42.0, -60.7, -43.3, -19.400000000000002, -62.1, -11.699999999999989, -29.500000000000007, -85.99999999999999, -19.900000000000013, -60.70000000000006, -82.4, -67.90000000000003, -146.2, -45.20000000000001, -151.89999999999975, -61.60000000000006, -63.1, -28.299999999999997, -25.299999999999997, -63.2, -35.7, -24.099999999999994, -39.8, -78.30000000000008, -26.80000000000002, -61.000000000000036, -72.39999999999999, -101.10000000000002, -19.999999999999993, -13.399999999999988, -150.59999999999974, -65.80000000000004, -26.200000000000003, -23.200000000000003, -49.70000000000009, -137.70000000000005, -77.8, -20.200000000000003, -48.400000000000055, -46.20000000000001, -39.800000000000004, -94.59999999999994, -28.800000000000082, -20.300000000000004, -127.0, -119.69999999999976, -63.00000000000007, -88.80000000000004, -15.699999999999992, -40.70000000000005, -75.90000000000003, -54.60000000000002, -59.3, -52.900000000000084, -16.199999999999996, -49.40000000000008, -119.4, -54.80000000000006, -33.8, -62.900000000000006, -59.7, -28.3, -52.80000000000008, -53.80000000000009, -46.00000000000001, -60.5, -37.80000000000007, -30.300000000000004, -37.4, -55.500000000000064, -61.000000000000014, -56.8000000000001, -96.70000000000007, -22.200000000000028, -38.599999999999994, -51.400000000000055, -41.3, -37.80000000000001, -13.999999999999991, -62.20000000000004, -58.40000000000006, -73.19999999999999, -25.1, -52.10000000000002, -50.40000000000002, -52.70000000000006, -144.2, -36.40000000000007, -57.3, -28.90000000000004, -61.800000000000075, -17.7, -47.8, -57.80000000000003, -68.29999999999998, -16.799999999999994, -114.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6212785901389417, "mean_inference_ms": 0.7241973070797991, "mean_action_processing_ms": 0.03140876022288237, "mean_env_wait_ms": 3.249607495604965, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 80000, "timesteps_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"sample_time_ms": 20787.395, "sample_throughput": 192.424, "load_time_ms": 0.34, "load_throughput": 11776790.678, "learn_time_ms": 4123.447, "learn_throughput": 970.062}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 1.7150344532023194, "policy_loss": -0.0010690659665132081, "vf_loss": 171.53230737255467, "vf_explained_var": 0.17363267002567168, "kl": 0.010406543788229939, "entropy": 0.7480697837568099, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 80000, "num_agent_steps_sampled": 80000, "num_steps_trained": 80000, "num_agent_steps_trained": 80000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 800, "training_iteration": 20, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-10-00", "timestamp": 1651061400, "time_this_iter_s": 20.28690195083618, "time_total_s": 456.509877204895, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 456.509877204895, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 16.52857142857143, "ram_util_percent": 94.50357142857142}}
{"episode_reward_max": -9.299999999999988, "episode_reward_min": -144.2, "episode_reward_mean": -54.012000000000015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.200000000000003, -48.400000000000055, -46.20000000000001, -39.800000000000004, -94.59999999999994, -28.800000000000082, -20.300000000000004, -127.0, -119.69999999999976, -63.00000000000007, -88.80000000000004, -15.699999999999992, -40.70000000000005, -75.90000000000003, -54.60000000000002, -59.3, -52.900000000000084, -16.199999999999996, -49.40000000000008, -119.4, -54.80000000000006, -33.8, -62.900000000000006, -59.7, -28.3, -52.80000000000008, -53.80000000000009, -46.00000000000001, -60.5, -37.80000000000007, -30.300000000000004, -37.4, -55.500000000000064, -61.000000000000014, -56.8000000000001, -96.70000000000007, -22.200000000000028, -38.599999999999994, -51.400000000000055, -41.3, -37.80000000000001, -13.999999999999991, -62.20000000000004, -58.40000000000006, -73.19999999999999, -25.1, -52.10000000000002, -50.40000000000002, -52.70000000000006, -144.2, -36.40000000000007, -57.3, -28.90000000000004, -61.800000000000075, -17.7, -47.8, -57.80000000000003, -68.29999999999998, -16.799999999999994, -114.1, -43.60000000000007, -20.60000000000001, -50.10000000000005, -22.000000000000025, -55.20000000000007, -44.400000000000006, -71.80000000000004, -37.60000000000004, -18.599999999999998, -85.40000000000002, -13.99999999999999, -9.299999999999988, -25.8, -49.000000000000036, -50.300000000000004, -108.20000000000002, -20.89999999999999, -20.800000000000033, -135.1, -19.60000000000003, -18.099999999999994, -69.20000000000007, -51.40000000000007, -62.70000000000007, -76.30000000000005, -54.20000000000007, -36.6, -143.4, -65.00000000000007, -45.70000000000009, -54.0, -13.399999999999986, -33.900000000000006, -53.900000000000034, -132.60000000000002, -45.199999999999996, -97.49999999999986, -141.6, -20.8, -43.90000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6222603731039007, "mean_inference_ms": 0.7238157042772556, "mean_action_processing_ms": 0.03138920802662473, "mean_env_wait_ms": 3.235916902636583, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 84000, "timesteps_this_iter": 0, "agent_timesteps_total": 84000, "timers": {"sample_time_ms": 20698.998, "sample_throughput": 193.246, "load_time_ms": 0.31, "load_throughput": 12908529.661, "learn_time_ms": 4173.39, "learn_throughput": 958.453}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 2.7869995323240118, "policy_loss": -0.001632711451540711, "vf_loss": 278.79153241393385, "vf_explained_var": -0.13227549983609108, "kl": 0.009559712701363706, "entropy": 0.7486794142312901, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 84000, "num_agent_steps_sampled": 84000, "num_steps_trained": 84000, "num_agent_steps_trained": 84000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 840, "training_iteration": 21, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-10-24", "timestamp": 1651061424, "time_this_iter_s": 24.465535163879395, "time_total_s": 480.9754123687744, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 480.9754123687744, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 27.060606060606062, "ram_util_percent": 94.81515151515151}}
{"episode_reward_max": -9.299999999999988, "episode_reward_min": -144.2, "episode_reward_mean": -53.219000000000015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.80000000000001, -13.999999999999991, -62.20000000000004, -58.40000000000006, -73.19999999999999, -25.1, -52.10000000000002, -50.40000000000002, -52.70000000000006, -144.2, -36.40000000000007, -57.3, -28.90000000000004, -61.800000000000075, -17.7, -47.8, -57.80000000000003, -68.29999999999998, -16.799999999999994, -114.1, -43.60000000000007, -20.60000000000001, -50.10000000000005, -22.000000000000025, -55.20000000000007, -44.400000000000006, -71.80000000000004, -37.60000000000004, -18.599999999999998, -85.40000000000002, -13.99999999999999, -9.299999999999988, -25.8, -49.000000000000036, -50.300000000000004, -108.20000000000002, -20.89999999999999, -20.800000000000033, -135.1, -19.60000000000003, -18.099999999999994, -69.20000000000007, -51.40000000000007, -62.70000000000007, -76.30000000000005, -54.20000000000007, -36.6, -143.4, -65.00000000000007, -45.70000000000009, -54.0, -13.399999999999986, -33.900000000000006, -53.900000000000034, -132.60000000000002, -45.199999999999996, -97.49999999999986, -141.6, -20.8, -43.90000000000002, -29.600000000000055, -51.50000000000007, -36.30000000000007, -42.2, -12.799999999999981, -33.8, -144.09999999999977, -63.40000000000008, -66.30000000000004, -57.600000000000016, -71.60000000000004, -51.800000000000004, -113.39999999999986, -21.5, -54.40000000000003, -83.40000000000003, -52.60000000000002, -42.30000000000001, -62.2, -39.800000000000075, -56.400000000000006, -33.5, -40.099999999999994, -33.099999999999994, -17.199999999999992, -41.900000000000034, -103.7, -41.300000000000004, -50.40000000000007, -46.20000000000006, -77.79999999999995, -76.6, -15.49999999999999, -29.1, -34.30000000000001, -47.00000000000001, -51.6, -63.00000000000007, -49.50000000000005, -44.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6259006341347196, "mean_inference_ms": 0.7275583755416289, "mean_action_processing_ms": 0.03151336568307679, "mean_env_wait_ms": 3.2327506662182723, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 88000, "timesteps_this_iter": 0, "agent_timesteps_total": 88000, "timers": {"sample_time_ms": 21062.107, "sample_throughput": 189.915, "load_time_ms": 0.306, "load_throughput": 13090836.454, "learn_time_ms": 4194.063, "learn_throughput": 953.729}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 1.8351043911470521, "policy_loss": -0.0010682095423020343, "vf_loss": 183.5753391552997, "vf_explained_var": 0.06561489457725196, "kl": 0.005590021384068513, "entropy": 0.6231007988094002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 88000, "num_agent_steps_sampled": 88000, "num_steps_trained": 88000, "num_agent_steps_trained": 88000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 880, "training_iteration": 22, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-10-48", "timestamp": 1651061448, "time_this_iter_s": 23.785321950912476, "time_total_s": 504.7607343196869, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 504.7607343196869, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 19.946875000000002, "ram_util_percent": 94.890625}}
{"episode_reward_max": -10.799999999999978, "episode_reward_min": -243.8999999999997, "episode_reward_mean": -52.56400000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.099999999999994, -69.20000000000007, -51.40000000000007, -62.70000000000007, -76.30000000000005, -54.20000000000007, -36.6, -143.4, -65.00000000000007, -45.70000000000009, -54.0, -13.399999999999986, -33.900000000000006, -53.900000000000034, -132.60000000000002, -45.199999999999996, -97.49999999999986, -141.6, -20.8, -43.90000000000002, -29.600000000000055, -51.50000000000007, -36.30000000000007, -42.2, -12.799999999999981, -33.8, -144.09999999999977, -63.40000000000008, -66.30000000000004, -57.600000000000016, -71.60000000000004, -51.800000000000004, -113.39999999999986, -21.5, -54.40000000000003, -83.40000000000003, -52.60000000000002, -42.30000000000001, -62.2, -39.800000000000075, -56.400000000000006, -33.5, -40.099999999999994, -33.099999999999994, -17.199999999999992, -41.900000000000034, -103.7, -41.300000000000004, -50.40000000000007, -46.20000000000006, -77.79999999999995, -76.6, -15.49999999999999, -29.1, -34.30000000000001, -47.00000000000001, -51.6, -63.00000000000007, -49.50000000000005, -44.4, -27.7, -36.5, -62.20000000000006, -243.8999999999997, -42.800000000000004, -20.799999999999997, -25.200000000000003, -63.80000000000005, -43.100000000000065, -67.80000000000007, -22.80000000000002, -136.39999999999978, -11.399999999999997, -12.899999999999995, -28.300000000000022, -67.20000000000002, -33.50000000000004, -75.9, -40.20000000000003, -61.50000000000007, -15.59999999999999, -62.6, -16.499999999999993, -67.7, -36.80000000000002, -16.49999999999999, -60.900000000000034, -43.10000000000006, -49.60000000000008, -44.300000000000075, -62.9, -47.400000000000055, -16.999999999999996, -59.200000000000095, -33.8, -10.799999999999978, -41.90000000000008, -54.00000000000007, -34.9, -14.399999999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6279620634685975, "mean_inference_ms": 0.7283940069052564, "mean_action_processing_ms": 0.0315482289915996, "mean_env_wait_ms": 3.2271426063208524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 92000, "timesteps_this_iter": 0, "agent_timesteps_total": 92000, "timers": {"sample_time_ms": 21059.601, "sample_throughput": 189.937, "load_time_ms": 0.304, "load_throughput": 13179274.156, "learn_time_ms": 4189.351, "learn_throughput": 954.802}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 3.463115607598616, "policy_loss": -0.0015489317672026735, "vf_loss": 346.4210712412352, "vf_explained_var": 0.001600352923075358, "kl": 0.0060527382172944205, "entropy": 0.6890302036077746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 92000, "num_agent_steps_sampled": 92000, "num_steps_trained": 92000, "num_agent_steps_trained": 92000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 920, "training_iteration": 23, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-11-09", "timestamp": 1651061469, "time_this_iter_s": 20.319344758987427, "time_total_s": 525.0800790786743, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 525.0800790786743, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 14.860714285714286, "ram_util_percent": 94.83571428571427}}
{"episode_reward_max": -9.89999999999998, "episode_reward_min": -243.8999999999997, "episode_reward_mean": -49.41999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.400000000000006, -33.5, -40.099999999999994, -33.099999999999994, -17.199999999999992, -41.900000000000034, -103.7, -41.300000000000004, -50.40000000000007, -46.20000000000006, -77.79999999999995, -76.6, -15.49999999999999, -29.1, -34.30000000000001, -47.00000000000001, -51.6, -63.00000000000007, -49.50000000000005, -44.4, -27.7, -36.5, -62.20000000000006, -243.8999999999997, -42.800000000000004, -20.799999999999997, -25.200000000000003, -63.80000000000005, -43.100000000000065, -67.80000000000007, -22.80000000000002, -136.39999999999978, -11.399999999999997, -12.899999999999995, -28.300000000000022, -67.20000000000002, -33.50000000000004, -75.9, -40.20000000000003, -61.50000000000007, -15.59999999999999, -62.6, -16.499999999999993, -67.7, -36.80000000000002, -16.49999999999999, -60.900000000000034, -43.10000000000006, -49.60000000000008, -44.300000000000075, -62.9, -47.400000000000055, -16.999999999999996, -59.200000000000095, -33.8, -10.799999999999978, -41.90000000000008, -54.00000000000007, -34.9, -14.399999999999995, -50.700000000000024, -49.70000000000006, -22.800000000000004, -99.59999999999991, -44.40000000000005, -54.000000000000064, -38.80000000000002, -18.400000000000002, -27.90000000000001, -18.799999999999994, -23.1, -27.500000000000007, -38.40000000000002, -75.49999999999994, -95.20000000000006, -43.700000000000074, -42.00000000000007, -52.40000000000001, -19.1, -57.900000000000006, -9.89999999999998, -50.700000000000045, -27.200000000000006, -16.499999999999986, -74.60000000000002, -15.899999999999995, -10.19999999999999, -131.5, -20.100000000000005, -137.6999999999998, -50.8, -46.500000000000014, -80.99999999999997, -43.30000000000001, -12.499999999999982, -54.8, -185.3999999999996, -44.6, -35.40000000000006, -127.09999999999985], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6266472876430988, "mean_inference_ms": 0.7245237457678618, "mean_action_processing_ms": 0.03143286722821255, "mean_env_wait_ms": 3.2147074240475706, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 96000, "timesteps_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"sample_time_ms": 21034.51, "sample_throughput": 190.164, "load_time_ms": 0.305, "load_throughput": 13107200.0, "learn_time_ms": 4191.84, "learn_throughput": 954.235}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 3.0487771531106325, "policy_loss": -0.0009307554477365106, "vf_loss": 304.9277753358246, "vf_explained_var": -0.044172706527094686, "kl": 0.005736259073689877, "entropy": 0.6630721584122669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 96000, "num_steps_trained": 96000, "num_agent_steps_trained": 96000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 960, "training_iteration": 24, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-11-29", "timestamp": 1651061489, "time_this_iter_s": 20.130540132522583, "time_total_s": 545.2106192111969, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 545.2106192111969, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 11.14074074074074, "ram_util_percent": 94.69999999999999}}
{"episode_reward_max": -9.89999999999998, "episode_reward_min": -185.3999999999996, "episode_reward_mean": -44.85999999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.59999999999999, -62.6, -16.499999999999993, -67.7, -36.80000000000002, -16.49999999999999, -60.900000000000034, -43.10000000000006, -49.60000000000008, -44.300000000000075, -62.9, -47.400000000000055, -16.999999999999996, -59.200000000000095, -33.8, -10.799999999999978, -41.90000000000008, -54.00000000000007, -34.9, -14.399999999999995, -50.700000000000024, -49.70000000000006, -22.800000000000004, -99.59999999999991, -44.40000000000005, -54.000000000000064, -38.80000000000002, -18.400000000000002, -27.90000000000001, -18.799999999999994, -23.1, -27.500000000000007, -38.40000000000002, -75.49999999999994, -95.20000000000006, -43.700000000000074, -42.00000000000007, -52.40000000000001, -19.1, -57.900000000000006, -9.89999999999998, -50.700000000000045, -27.200000000000006, -16.499999999999986, -74.60000000000002, -15.899999999999995, -10.19999999999999, -131.5, -20.100000000000005, -137.6999999999998, -50.8, -46.500000000000014, -80.99999999999997, -43.30000000000001, -12.499999999999982, -54.8, -185.3999999999996, -44.6, -35.40000000000006, -127.09999999999985, -60.20000000000008, -18.99999999999999, -21.599999999999994, -74.40000000000002, -46.59999999999994, -44.599999999999994, -72.10000000000005, -51.400000000000055, -18.199999999999996, -137.29999999999978, -101.20000000000003, -38.300000000000026, -25.200000000000006, -43.200000000000045, -47.70000000000005, -30.90000000000005, -22.099999999999994, -28.400000000000006, -25.799999999999997, -51.20000000000004, -32.8, -22.8, -33.5, -17.800000000000004, -39.700000000000024, -58.40000000000009, -18.6, -25.60000000000001, -26.20000000000005, -12.699999999999974, -50.700000000000045, -21.9, -54.99999999999999, -28.400000000000077, -61.50000000000003, -44.000000000000064, -42.3, -30.9, -15.399999999999997, -22.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6241530109454605, "mean_inference_ms": 0.7195912160627933, "mean_action_processing_ms": 0.03127283314441808, "mean_env_wait_ms": 3.1982957337867877, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 100000, "timesteps_this_iter": 0, "agent_timesteps_total": 100000, "timers": {"sample_time_ms": 21031.452, "sample_throughput": 190.191, "load_time_ms": 0.303, "load_throughput": 13183416.627, "learn_time_ms": 4177.683, "learn_throughput": 957.468}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.075, "cur_lr": 0.00010000000000000003, "total_loss": 1.4680542952421132, "policy_loss": 0.003110293997952374, "vf_loss": 146.46435039684337, "vf_explained_var": -0.24892854318823865, "kl": 0.004007102170031589, "entropy": 0.6674336835902225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 100000, "num_agent_steps_sampled": 100000, "num_steps_trained": 100000, "num_agent_steps_trained": 100000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1000, "training_iteration": 25, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-11-49", "timestamp": 1651061509, "time_this_iter_s": 20.19255304336548, "time_total_s": 565.4031722545624, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 565.4031722545624, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 15.717857142857142, "ram_util_percent": 94.6392857142857}}
{"episode_reward_max": -9.89999999999998, "episode_reward_min": -756.5000000000011, "episode_reward_mean": -55.58700000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.89999999999998, -50.700000000000045, -27.200000000000006, -16.499999999999986, -74.60000000000002, -15.899999999999995, -10.19999999999999, -131.5, -20.100000000000005, -137.6999999999998, -50.8, -46.500000000000014, -80.99999999999997, -43.30000000000001, -12.499999999999982, -54.8, -185.3999999999996, -44.6, -35.40000000000006, -127.09999999999985, -60.20000000000008, -18.99999999999999, -21.599999999999994, -74.40000000000002, -46.59999999999994, -44.599999999999994, -72.10000000000005, -51.400000000000055, -18.199999999999996, -137.29999999999978, -101.20000000000003, -38.300000000000026, -25.200000000000006, -43.200000000000045, -47.70000000000005, -30.90000000000005, -22.099999999999994, -28.400000000000006, -25.799999999999997, -51.20000000000004, -32.8, -22.8, -33.5, -17.800000000000004, -39.700000000000024, -58.40000000000009, -18.6, -25.60000000000001, -26.20000000000005, -12.699999999999974, -50.700000000000045, -21.9, -54.99999999999999, -28.400000000000077, -61.50000000000003, -44.000000000000064, -42.3, -30.9, -15.399999999999997, -22.9, -67.60000000000004, -79.5, -32.0, -31.199999999999996, -21.10000000000001, -151.59999999999974, -38.0, -17.299999999999997, -59.5, -49.20000000000004, -81.5, -75.2, -66.59999999999992, -54.200000000000095, -33.90000000000002, -52.10000000000006, -70.40000000000006, -49.70000000000006, -34.1, -34.90000000000001, -36.90000000000005, -57.000000000000064, -33.5, -60.400000000000084, -42.6, -44.5, -55.40000000000007, -20.299999999999997, -11.999999999999984, -11.599999999999984, -123.7, -41.40000000000006, -21.1, -13.099999999999982, -68.5, -49.20000000000005, -147.29999999999976, -42.300000000000004, -756.5000000000011, -25.600000000000048], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6211937581013021, "mean_inference_ms": 0.7150417146136683, "mean_action_processing_ms": 0.031117550054668604, "mean_env_wait_ms": 3.182515997823188, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 104000, "timesteps_this_iter": 0, "agent_timesteps_total": 104000, "timers": {"sample_time_ms": 20950.284, "sample_throughput": 190.928, "load_time_ms": 0.273, "load_throughput": 14656430.506, "learn_time_ms": 4181.783, "learn_throughput": 956.53}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0375, "cur_lr": 0.00010000000000000003, "total_loss": 35.795413461175336, "policy_loss": -0.0022197601415457264, "vf_loss": 3579.7231732747887, "vf_explained_var": 0.01912139263204349, "kl": 0.01073122756485722, "entropy": 0.6832153655508513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 104000, "num_agent_steps_sampled": 104000, "num_steps_trained": 104000, "num_agent_steps_trained": 104000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1040, "training_iteration": 26, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-12-09", "timestamp": 1651061529, "time_this_iter_s": 19.887343883514404, "time_total_s": 585.2905161380768, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 585.2905161380768, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 16.800000000000004, "ram_util_percent": 94.59999999999998}}
{"episode_reward_max": -10.999999999999988, "episode_reward_min": -756.5000000000011, "episode_reward_mean": -56.379000000000026, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.8, -22.8, -33.5, -17.800000000000004, -39.700000000000024, -58.40000000000009, -18.6, -25.60000000000001, -26.20000000000005, -12.699999999999974, -50.700000000000045, -21.9, -54.99999999999999, -28.400000000000077, -61.50000000000003, -44.000000000000064, -42.3, -30.9, -15.399999999999997, -22.9, -67.60000000000004, -79.5, -32.0, -31.199999999999996, -21.10000000000001, -151.59999999999974, -38.0, -17.299999999999997, -59.5, -49.20000000000004, -81.5, -75.2, -66.59999999999992, -54.200000000000095, -33.90000000000002, -52.10000000000006, -70.40000000000006, -49.70000000000006, -34.1, -34.90000000000001, -36.90000000000005, -57.000000000000064, -33.5, -60.400000000000084, -42.6, -44.5, -55.40000000000007, -20.299999999999997, -11.999999999999984, -11.599999999999984, -123.7, -41.40000000000006, -21.1, -13.099999999999982, -68.5, -49.20000000000005, -147.29999999999976, -42.300000000000004, -756.5000000000011, -25.600000000000048, -20.100000000000005, -18.9, -156.09999999999977, -100.5, -51.60000000000008, -69.5, -123.7, -87.2, -58.699999999999996, -91.6, -107.5, -10.999999999999988, -102.7, -21.10000000000001, -33.70000000000002, -20.199999999999996, -49.60000000000006, -54.800000000000004, -54.7, -46.60000000000007, -44.50000000000006, -104.6, -34.3, -16.89999999999999, -48.599999999999994, -34.900000000000006, -24.100000000000048, -58.900000000000084, -49.10000000000001, -51.50000000000006, -39.20000000000005, -16.299999999999986, -55.50000000000003, -34.099999999999994, -91.50000000000013, -36.6, -56.50000000000007, -82.49999999999991, -16.399999999999977, -38.50000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6185036070067974, "mean_inference_ms": 0.711257655899451, "mean_action_processing_ms": 0.030988715260682965, "mean_env_wait_ms": 3.1684239346207073, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 108000, "timesteps_this_iter": 0, "agent_timesteps_total": 108000, "timers": {"sample_time_ms": 20964.635, "sample_throughput": 190.798, "load_time_ms": 0.274, "load_throughput": 14596499.043, "learn_time_ms": 4189.681, "learn_throughput": 954.727}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0375, "cur_lr": 0.00010000000000000003, "total_loss": 2.6590806358443793, "policy_loss": 0.00030010672766835457, "vf_loss": 265.85879872229793, "vf_explained_var": -0.06852733749215321, "kl": 0.005136394561947923, "entropy": 0.8198226517246615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 108000, "num_agent_steps_sampled": 108000, "num_steps_trained": 108000, "num_agent_steps_trained": 108000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1080, "training_iteration": 27, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-12-29", "timestamp": 1651061549, "time_this_iter_s": 20.468496084213257, "time_total_s": 605.75901222229, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 605.75901222229, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 12.35714285714286, "ram_util_percent": 94.54642857142856}}
{"episode_reward_max": -10.099999999999996, "episode_reward_min": -756.5000000000011, "episode_reward_mean": -59.502000000000024, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-36.90000000000005, -57.000000000000064, -33.5, -60.400000000000084, -42.6, -44.5, -55.40000000000007, -20.299999999999997, -11.999999999999984, -11.599999999999984, -123.7, -41.40000000000006, -21.1, -13.099999999999982, -68.5, -49.20000000000005, -147.29999999999976, -42.300000000000004, -756.5000000000011, -25.600000000000048, -20.100000000000005, -18.9, -156.09999999999977, -100.5, -51.60000000000008, -69.5, -123.7, -87.2, -58.699999999999996, -91.6, -107.5, -10.999999999999988, -102.7, -21.10000000000001, -33.70000000000002, -20.199999999999996, -49.60000000000006, -54.800000000000004, -54.7, -46.60000000000007, -44.50000000000006, -104.6, -34.3, -16.89999999999999, -48.599999999999994, -34.900000000000006, -24.100000000000048, -58.900000000000084, -49.10000000000001, -51.50000000000006, -39.20000000000005, -16.299999999999986, -55.50000000000003, -34.099999999999994, -91.50000000000013, -36.6, -56.50000000000007, -82.49999999999991, -16.399999999999977, -38.50000000000007, -15.399999999999983, -34.60000000000001, -54.600000000000065, -52.50000000000006, -49.5, -65.6000000000001, -56.400000000000006, -52.50000000000005, -55.8, -68.8, -41.4, -65.30000000000001, -11.399999999999974, -58.800000000000075, -54.20000000000007, -13.899999999999999, -52.699999999999996, -50.39999999999999, -126.5, -26.60000000000001, -10.099999999999996, -28.099999999999998, -47.10000000000006, -27.6, -53.800000000000004, -37.900000000000006, -45.29999999999999, -86.5, -159.4, -43.20000000000006, -50.90000000000001, -23.199999999999996, -19.299999999999997, -56.699999999999996, -134.9, -50.500000000000014, -40.10000000000001, -53.2, -55.70000000000008, -42.60000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6159274839779346, "mean_inference_ms": 0.707956656707005, "mean_action_processing_ms": 0.030894796492469324, "mean_env_wait_ms": 3.1568505615647977, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 112000, "timesteps_this_iter": 0, "agent_timesteps_total": 112000, "timers": {"sample_time_ms": 21021.663, "sample_throughput": 190.28, "load_time_ms": 0.251, "load_throughput": 15934291.956, "learn_time_ms": 4199.818, "learn_throughput": 952.422}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0375, "cur_lr": 0.00010000000000000003, "total_loss": 2.434670408759066, "policy_loss": -0.0015579528225365506, "vf_loss": 243.59936399357292, "vf_explained_var": 0.04807204008102417, "kl": 0.006260899483258144, "entropy": 0.854477192830014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 112000, "num_agent_steps_sampled": 112000, "num_steps_trained": 112000, "num_agent_steps_trained": 112000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1120, "training_iteration": 28, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-12-50", "timestamp": 1651061570, "time_this_iter_s": 20.47111201286316, "time_total_s": 626.2301242351532, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 626.2301242351532, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.442857142857143, "ram_util_percent": 94.52499999999999}}
{"episode_reward_max": -10.099999999999996, "episode_reward_min": -159.4, "episode_reward_mean": -54.84500000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.50000000000006, -104.6, -34.3, -16.89999999999999, -48.599999999999994, -34.900000000000006, -24.100000000000048, -58.900000000000084, -49.10000000000001, -51.50000000000006, -39.20000000000005, -16.299999999999986, -55.50000000000003, -34.099999999999994, -91.50000000000013, -36.6, -56.50000000000007, -82.49999999999991, -16.399999999999977, -38.50000000000007, -15.399999999999983, -34.60000000000001, -54.600000000000065, -52.50000000000006, -49.5, -65.6000000000001, -56.400000000000006, -52.50000000000005, -55.8, -68.8, -41.4, -65.30000000000001, -11.399999999999974, -58.800000000000075, -54.20000000000007, -13.899999999999999, -52.699999999999996, -50.39999999999999, -126.5, -26.60000000000001, -10.099999999999996, -28.099999999999998, -47.10000000000006, -27.6, -53.800000000000004, -37.900000000000006, -45.29999999999999, -86.5, -159.4, -43.20000000000006, -50.90000000000001, -23.199999999999996, -19.299999999999997, -56.699999999999996, -134.9, -50.500000000000014, -40.10000000000001, -53.2, -55.70000000000008, -42.60000000000007, -83.3, -61.400000000000006, -116.50000000000003, -86.00000000000003, -15.69999999999999, -72.5, -65.80000000000003, -41.3, -76.0, -48.400000000000006, -48.199999999999996, -117.1, -45.3, -88.0, -73.49999999999999, -73.4, -73.50000000000003, -15.699999999999994, -73.10000000000002, -44.20000000000006, -59.60000000000008, -58.000000000000036, -21.89999999999999, -90.70000000000014, -77.00000000000006, -28.100000000000044, -51.10000000000001, -75.39999999999998, -16.399999999999988, -82.19999999999999, -84.60000000000002, -81.69999999999993, -13.29999999999999, -89.5, -29.0, -82.30000000000003, -32.10000000000001, -48.5, -79.70000000000002, -57.00000000000011], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6139488337999481, "mean_inference_ms": 0.7049551845472601, "mean_action_processing_ms": 0.030819850840463837, "mean_env_wait_ms": 3.1459030703333646, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 116000, "timesteps_this_iter": 0, "agent_timesteps_total": 116000, "timers": {"sample_time_ms": 21045.627, "sample_throughput": 190.063, "load_time_ms": 0.251, "load_throughput": 15944892.606, "learn_time_ms": 4237.08, "learn_throughput": 944.046}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0375, "cur_lr": 0.00010000000000000003, "total_loss": 2.2824669223639273, "policy_loss": -0.0005961882040625619, "vf_loss": 228.27450103759764, "vf_explained_var": 0.07571520459267402, "kl": 0.008483821278593881, "entropy": 0.8220850818900651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 116000, "num_agent_steps_sampled": 116000, "num_steps_trained": 116000, "num_agent_steps_trained": 116000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1160, "training_iteration": 29, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-13-10", "timestamp": 1651061590, "time_this_iter_s": 20.589524030685425, "time_total_s": 646.8196482658386, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 646.8196482658386, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 11.821428571428571, "ram_util_percent": 94.58214285714284}}
{"episode_reward_max": -10.099999999999996, "episode_reward_min": -159.4, "episode_reward_mean": -54.884000000000015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.099999999999996, -28.099999999999998, -47.10000000000006, -27.6, -53.800000000000004, -37.900000000000006, -45.29999999999999, -86.5, -159.4, -43.20000000000006, -50.90000000000001, -23.199999999999996, -19.299999999999997, -56.699999999999996, -134.9, -50.500000000000014, -40.10000000000001, -53.2, -55.70000000000008, -42.60000000000007, -83.3, -61.400000000000006, -116.50000000000003, -86.00000000000003, -15.69999999999999, -72.5, -65.80000000000003, -41.3, -76.0, -48.400000000000006, -48.199999999999996, -117.1, -45.3, -88.0, -73.49999999999999, -73.4, -73.50000000000003, -15.699999999999994, -73.10000000000002, -44.20000000000006, -59.60000000000008, -58.000000000000036, -21.89999999999999, -90.70000000000014, -77.00000000000006, -28.100000000000044, -51.10000000000001, -75.39999999999998, -16.399999999999988, -82.19999999999999, -84.60000000000002, -81.69999999999993, -13.29999999999999, -89.5, -29.0, -82.30000000000003, -32.10000000000001, -48.5, -79.70000000000002, -57.00000000000011, -24.30000000000006, -47.2, -34.50000000000006, -24.20000000000001, -15.399999999999991, -63.60000000000009, -51.00000000000005, -73.80000000000001, -19.599999999999998, -26.200000000000003, -44.5, -11.499999999999986, -46.800000000000054, -101.70000000000005, -81.49999999999999, -27.300000000000068, -75.9, -18.5, -20.599999999999994, -35.4, -54.80000000000001, -56.10000000000002, -40.3, -62.0, -26.00000000000002, -56.0, -79.40000000000013, -78.10000000000002, -11.199999999999994, -134.7, -22.1, -149.3, -21.300000000000022, -15.699999999999987, -58.500000000000036, -89.79999999999984, -20.9, -45.10000000000001, -47.300000000000004, -33.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6129080505275446, "mean_inference_ms": 0.702647051866264, "mean_action_processing_ms": 0.9838277356946896, "mean_env_wait_ms": 3.451005108898197, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"sample_time_ms": 21181.013, "sample_throughput": 188.848, "load_time_ms": 0.272, "load_throughput": 14702669.354, "learn_time_ms": 4392.805, "learn_throughput": 910.58}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0375, "cur_lr": 0.00010000000000000003, "total_loss": 1.9332755300146278, "policy_loss": 0.004548119440154042, "vf_loss": 192.84092291144916, "vf_explained_var": 0.09189301915066217, "kl": 0.008486074491521372, "entropy": 0.874422699469392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 120000, "num_steps_trained": 120000, "num_agent_steps_trained": 120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1200, "training_iteration": 30, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-19-53", "timestamp": 1651061993, "time_this_iter_s": 402.9511160850525, "time_total_s": 1049.770764350891, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1049.770764350891, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 40.48064516129033, "ram_util_percent": 94.80645161290323}}
{"episode_reward_max": -11.199999999999994, "episode_reward_min": -149.3, "episode_reward_mean": -54.43800000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-59.60000000000008, -58.000000000000036, -21.89999999999999, -90.70000000000014, -77.00000000000006, -28.100000000000044, -51.10000000000001, -75.39999999999998, -16.399999999999988, -82.19999999999999, -84.60000000000002, -81.69999999999993, -13.29999999999999, -89.5, -29.0, -82.30000000000003, -32.10000000000001, -48.5, -79.70000000000002, -57.00000000000011, -24.30000000000006, -47.2, -34.50000000000006, -24.20000000000001, -15.399999999999991, -63.60000000000009, -51.00000000000005, -73.80000000000001, -19.599999999999998, -26.200000000000003, -44.5, -11.499999999999986, -46.800000000000054, -101.70000000000005, -81.49999999999999, -27.300000000000068, -75.9, -18.5, -20.599999999999994, -35.4, -54.80000000000001, -56.10000000000002, -40.3, -62.0, -26.00000000000002, -56.0, -79.40000000000013, -78.10000000000002, -11.199999999999994, -134.7, -22.1, -149.3, -21.300000000000022, -15.699999999999987, -58.500000000000036, -89.79999999999984, -20.9, -45.10000000000001, -47.300000000000004, -33.2, -115.99999999999989, -28.50000000000007, -55.8, -38.0, -16.19999999999999, -112.3, -45.0, -22.300000000000008, -73.00000000000004, -40.0, -22.400000000000013, -67.90000000000002, -66.5, -64.00000000000006, -66.90000000000005, -55.2, -70.39999999999999, -60.599999999999994, -56.80000000000001, -75.0, -18.0, -19.2, -54.99999999999999, -51.20000000000003, -12.199999999999982, -75.69999999999996, -65.49999999999989, -131.5, -97.49999999999999, -43.500000000000085, -18.699999999999996, -82.00000000000003, -41.1, -119.5, -70.00000000000007, -58.7, -70.30000000000007, -59.40000000000009, -50.9, -47.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6136753915222591, "mean_inference_ms": 0.7031420442526937, "mean_action_processing_ms": 1.9061627787198105, "mean_env_wait_ms": 3.7495321521367906, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 124000, "timesteps_this_iter": 0, "agent_timesteps_total": 124000, "timers": {"sample_time_ms": 21222.79, "sample_throughput": 188.477, "load_time_ms": 0.272, "load_throughput": 14707825.02, "learn_time_ms": 4316.761, "learn_throughput": 926.621}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0375, "cur_lr": 0.00010000000000000003, "total_loss": 2.2791590830972117, "policy_loss": 0.0006920437709057843, "vf_loss": 227.80373446556828, "vf_explained_var": 0.040039081599122735, "kl": 0.011459761531957225, "entropy": 0.8099141922689254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 124000, "num_agent_steps_sampled": 124000, "num_steps_trained": 124000, "num_agent_steps_trained": 124000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1240, "training_iteration": 31, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-20-16", "timestamp": 1651062016, "time_this_iter_s": 22.550055742263794, "time_total_s": 1072.320820093155, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1072.320820093155, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 28.120000000000005, "ram_util_percent": 95.4266666666667}}
{"episode_reward_max": -10.09999999999999, "episode_reward_min": -206.2, "episode_reward_mean": -55.61, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.80000000000001, -56.10000000000002, -40.3, -62.0, -26.00000000000002, -56.0, -79.40000000000013, -78.10000000000002, -11.199999999999994, -134.7, -22.1, -149.3, -21.300000000000022, -15.699999999999987, -58.500000000000036, -89.79999999999984, -20.9, -45.10000000000001, -47.300000000000004, -33.2, -115.99999999999989, -28.50000000000007, -55.8, -38.0, -16.19999999999999, -112.3, -45.0, -22.300000000000008, -73.00000000000004, -40.0, -22.400000000000013, -67.90000000000002, -66.5, -64.00000000000006, -66.90000000000005, -55.2, -70.39999999999999, -60.599999999999994, -56.80000000000001, -75.0, -18.0, -19.2, -54.99999999999999, -51.20000000000003, -12.199999999999982, -75.69999999999996, -65.49999999999989, -131.5, -97.49999999999999, -43.500000000000085, -18.699999999999996, -82.00000000000003, -41.1, -119.5, -70.00000000000007, -58.7, -70.30000000000007, -59.40000000000009, -50.9, -47.7, -96.3, -48.7, -76.10000000000002, -18.200000000000003, -28.300000000000043, -72.39999999999995, -30.900000000000002, -16.899999999999988, -47.200000000000074, -33.9, -19.1, -52.800000000000004, -51.00000000000004, -21.000000000000004, -67.10000000000014, -78.9, -79.80000000000001, -25.299999999999994, -116.6, -46.10000000000004, -22.90000000000002, -61.30000000000002, -29.999999999999993, -55.50000000000004, -54.300000000000054, -131.7, -94.2, -35.10000000000002, -22.1, -206.2, -60.6, -70.79999999999997, -25.5, -29.599999999999998, -16.9, -10.09999999999999, -35.800000000000004, -20.0, -64.70000000000007, -44.90000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6134111356276425, "mean_inference_ms": 0.7031816556807808, "mean_action_processing_ms": 2.3231095301324314, "mean_env_wait_ms": 3.880466702236729, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 128000, "timesteps_this_iter": 0, "agent_timesteps_total": 128000, "timers": {"sample_time_ms": 20762.261, "sample_throughput": 192.657, "load_time_ms": 0.268, "load_throughput": 14939640.249, "learn_time_ms": 4284.214, "learn_throughput": 933.66}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0375, "cur_lr": 0.00010000000000000003, "total_loss": 4.075689552195611, "policy_loss": -0.008266863576386885, "vf_loss": 408.35650860366, "vf_explained_var": -0.11046650480198604, "kl": 0.010437838004296186, "entropy": 0.7466962888676633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 128000, "num_agent_steps_sampled": 128000, "num_steps_trained": 128000, "num_agent_steps_trained": 128000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1280, "training_iteration": 32, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-20-36", "timestamp": 1651062036, "time_this_iter_s": 19.62794303894043, "time_total_s": 1091.9487631320953, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1091.9487631320953, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.803703703703704, "ram_util_percent": 95.19629629629628}}
{"episode_reward_max": -10.09999999999999, "episode_reward_min": -206.2, "episode_reward_mean": -52.24500000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.0, -19.2, -54.99999999999999, -51.20000000000003, -12.199999999999982, -75.69999999999996, -65.49999999999989, -131.5, -97.49999999999999, -43.500000000000085, -18.699999999999996, -82.00000000000003, -41.1, -119.5, -70.00000000000007, -58.7, -70.30000000000007, -59.40000000000009, -50.9, -47.7, -96.3, -48.7, -76.10000000000002, -18.200000000000003, -28.300000000000043, -72.39999999999995, -30.900000000000002, -16.899999999999988, -47.200000000000074, -33.9, -19.1, -52.800000000000004, -51.00000000000004, -21.000000000000004, -67.10000000000014, -78.9, -79.80000000000001, -25.299999999999994, -116.6, -46.10000000000004, -22.90000000000002, -61.30000000000002, -29.999999999999993, -55.50000000000004, -54.300000000000054, -131.7, -94.2, -35.10000000000002, -22.1, -206.2, -60.6, -70.79999999999997, -25.5, -29.599999999999998, -16.9, -10.09999999999999, -35.800000000000004, -20.0, -64.70000000000007, -44.90000000000003, -73.6, -38.90000000000006, -22.600000000000048, -71.90000000000002, -15.699999999999982, -64.1000000000001, -35.7, -44.89999999999999, -39.80000000000007, -53.40000000000006, -102.49999999999993, -31.800000000000043, -43.20000000000001, -91.69999999999999, -18.60000000000001, -27.0, -19.60000000000002, -47.8, -21.60000000000001, -28.9, -54.90000000000006, -19.2, -33.4, -23.3, -47.099999999999994, -42.3, -101.99999999999993, -50.40000000000007, -63.80000000000001, -23.700000000000006, -33.4, -28.099999999999998, -22.900000000000013, -83.9, -31.200000000000067, -93.60000000000001, -110.79999999999986, -49.4, -58.5, -52.90000000000008], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6117156961033574, "mean_inference_ms": 0.7008329767685396, "mean_action_processing_ms": 2.251751404059176, "mean_env_wait_ms": 3.8480884984721535, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 132000, "timesteps_this_iter": 0, "agent_timesteps_total": 132000, "timers": {"sample_time_ms": 20671.35, "sample_throughput": 193.505, "load_time_ms": 0.268, "load_throughput": 14938310.035, "learn_time_ms": 4270.162, "learn_throughput": 936.733}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0375, "cur_lr": 0.00010000000000000003, "total_loss": 1.6308578918017047, "policy_loss": -0.002390956295834434, "vf_loss": 163.29538971480503, "vf_explained_var": 0.13274808660630258, "kl": 0.007866394760846692, "entropy": 0.6770603391431993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 132000, "num_agent_steps_sampled": 132000, "num_steps_trained": 132000, "num_agent_steps_trained": 132000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1320, "training_iteration": 33, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-20-55", "timestamp": 1651062055, "time_this_iter_s": 19.59867811203003, "time_total_s": 1111.5474412441254, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1111.5474412441254, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 6.7153846153846155, "ram_util_percent": 95.09615384615383}}
{"episode_reward_max": -10.09999999999999, "episode_reward_min": -206.2, "episode_reward_mean": -52.408, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.90000000000002, -61.30000000000002, -29.999999999999993, -55.50000000000004, -54.300000000000054, -131.7, -94.2, -35.10000000000002, -22.1, -206.2, -60.6, -70.79999999999997, -25.5, -29.599999999999998, -16.9, -10.09999999999999, -35.800000000000004, -20.0, -64.70000000000007, -44.90000000000003, -73.6, -38.90000000000006, -22.600000000000048, -71.90000000000002, -15.699999999999982, -64.1000000000001, -35.7, -44.89999999999999, -39.80000000000007, -53.40000000000006, -102.49999999999993, -31.800000000000043, -43.20000000000001, -91.69999999999999, -18.60000000000001, -27.0, -19.60000000000002, -47.8, -21.60000000000001, -28.9, -54.90000000000006, -19.2, -33.4, -23.3, -47.099999999999994, -42.3, -101.99999999999993, -50.40000000000007, -63.80000000000001, -23.700000000000006, -33.4, -28.099999999999998, -22.900000000000013, -83.9, -31.200000000000067, -93.60000000000001, -110.79999999999986, -49.4, -58.5, -52.90000000000008, -34.70000000000005, -45.00000000000008, -57.40000000000003, -51.7, -53.50000000000004, -92.9, -140.99999999999977, -23.50000000000005, -48.50000000000007, -50.400000000000055, -67.80000000000004, -11.799999999999988, -29.20000000000001, -58.40000000000007, -51.80000000000006, -98.69999999999989, -47.40000000000004, -86.19999999999999, -57.20000000000001, -27.000000000000007, -22.0, -40.0, -58.29999999999999, -42.20000000000004, -19.39999999999999, -158.69999999999973, -102.79999999999987, -16.4, -88.69999999999999, -57.20000000000003, -70.50000000000001, -57.800000000000054, -34.9, -113.4, -57.10000000000004, -16.199999999999996, -54.599999999999994, -10.199999999999985, -27.400000000000006, -48.60000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6091363020136301, "mean_inference_ms": 0.6968551988562532, "mean_action_processing_ms": 2.1846574894886666, "mean_env_wait_ms": 3.8166791609295787, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 136000, "timesteps_this_iter": 0, "agent_timesteps_total": 136000, "timers": {"sample_time_ms": 20640.709, "sample_throughput": 193.792, "load_time_ms": 0.267, "load_throughput": 14998405.149, "learn_time_ms": 4267.76, "learn_throughput": 937.26}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0375, "cur_lr": 0.00010000000000000003, "total_loss": 2.184280403126632, "policy_loss": 0.0014030664748642394, "vf_loss": 218.26921794645247, "vf_explained_var": 0.04338588477462851, "kl": 0.004939107392651033, "entropy": 0.6349083196091395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 136000, "num_agent_steps_sampled": 136000, "num_steps_trained": 136000, "num_agent_steps_trained": 136000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1360, "training_iteration": 34, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-21-15", "timestamp": 1651062075, "time_this_iter_s": 19.93303108215332, "time_total_s": 1131.4804723262787, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1131.4804723262787, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 9.146428571428572, "ram_util_percent": 95.01785714285714}}
{"episode_reward_max": -10.199999999999985, "episode_reward_min": -158.69999999999973, "episode_reward_mean": -50.56600000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.90000000000006, -19.2, -33.4, -23.3, -47.099999999999994, -42.3, -101.99999999999993, -50.40000000000007, -63.80000000000001, -23.700000000000006, -33.4, -28.099999999999998, -22.900000000000013, -83.9, -31.200000000000067, -93.60000000000001, -110.79999999999986, -49.4, -58.5, -52.90000000000008, -34.70000000000005, -45.00000000000008, -57.40000000000003, -51.7, -53.50000000000004, -92.9, -140.99999999999977, -23.50000000000005, -48.50000000000007, -50.400000000000055, -67.80000000000004, -11.799999999999988, -29.20000000000001, -58.40000000000007, -51.80000000000006, -98.69999999999989, -47.40000000000004, -86.19999999999999, -57.20000000000001, -27.000000000000007, -22.0, -40.0, -58.29999999999999, -42.20000000000004, -19.39999999999999, -158.69999999999973, -102.79999999999987, -16.4, -88.69999999999999, -57.20000000000003, -70.50000000000001, -57.800000000000054, -34.9, -113.4, -57.10000000000004, -16.199999999999996, -54.599999999999994, -10.199999999999985, -27.400000000000006, -48.60000000000007, -37.0, -109.40000000000002, -18.700000000000006, -26.900000000000006, -39.40000000000009, -49.90000000000004, -19.599999999999994, -32.80000000000005, -76.70000000000003, -25.2, -54.80000000000008, -38.800000000000026, -17.000000000000004, -10.299999999999994, -36.3, -29.70000000000001, -39.500000000000014, -10.199999999999985, -139.90000000000003, -48.60000000000001, -25.700000000000067, -95.79999999999986, -58.20000000000006, -46.90000000000006, -39.800000000000004, -19.599999999999994, -95.40000000000002, -44.80000000000001, -121.9, -39.099999999999994, -49.90000000000007, -23.700000000000003, -20.300000000000004, -23.80000000000001, -29.599999999999994, -16.4, -48.5, -44.100000000000044, -33.1, -64.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6077558956365915, "mean_inference_ms": 0.6934003051273333, "mean_action_processing_ms": 2.1215158088776147, "mean_env_wait_ms": 3.7874909494508855, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 140000, "timesteps_this_iter": 0, "agent_timesteps_total": 140000, "timers": {"sample_time_ms": 20656.037, "sample_throughput": 193.648, "load_time_ms": 0.265, "load_throughput": 15105083.281, "learn_time_ms": 4260.165, "learn_throughput": 938.931}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.01875, "cur_lr": 0.00010000000000000003, "total_loss": 2.0655351857664765, "policy_loss": -0.0004896868661206256, "vf_loss": 206.58835671127483, "vf_explained_var": -0.13419682389946394, "kl": 0.007539110639706394, "entropy": 0.7063131406422585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 140000, "num_agent_steps_sampled": 140000, "num_steps_trained": 140000, "num_agent_steps_trained": 140000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1400, "training_iteration": 35, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-21-36", "timestamp": 1651062096, "time_this_iter_s": 20.295451879501343, "time_total_s": 1151.77592420578, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1151.77592420578, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 12.488888888888889, "ram_util_percent": 94.94814814814816}}
{"episode_reward_max": -10.199999999999985, "episode_reward_min": -331.1999999999998, "episode_reward_mean": -50.379000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.0, -40.0, -58.29999999999999, -42.20000000000004, -19.39999999999999, -158.69999999999973, -102.79999999999987, -16.4, -88.69999999999999, -57.20000000000003, -70.50000000000001, -57.800000000000054, -34.9, -113.4, -57.10000000000004, -16.199999999999996, -54.599999999999994, -10.199999999999985, -27.400000000000006, -48.60000000000007, -37.0, -109.40000000000002, -18.700000000000006, -26.900000000000006, -39.40000000000009, -49.90000000000004, -19.599999999999994, -32.80000000000005, -76.70000000000003, -25.2, -54.80000000000008, -38.800000000000026, -17.000000000000004, -10.299999999999994, -36.3, -29.70000000000001, -39.500000000000014, -10.199999999999985, -139.90000000000003, -48.60000000000001, -25.700000000000067, -95.79999999999986, -58.20000000000006, -46.90000000000006, -39.800000000000004, -19.599999999999994, -95.40000000000002, -44.80000000000001, -121.9, -39.099999999999994, -49.90000000000007, -23.700000000000003, -20.300000000000004, -23.80000000000001, -29.599999999999994, -16.4, -48.5, -44.100000000000044, -33.1, -64.0, -51.20000000000005, -28.800000000000004, -46.40000000000004, -11.999999999999991, -42.60000000000004, -105.90000000000016, -47.800000000000054, -23.199999999999996, -51.90000000000006, -23.20000000000001, -13.299999999999997, -48.699999999999996, -46.800000000000054, -17.099999999999994, -17.999999999999986, -41.90000000000001, -35.70000000000001, -50.900000000000006, -58.000000000000014, -15.599999999999989, -26.5, -59.20000000000006, -62.60000000000003, -331.1999999999998, -20.7, -34.1, -30.699999999999996, -105.99999999999991, -73.4, -73.7, -24.30000000000001, -53.8, -42.80000000000003, -28.499999999999954, -52.80000000000007, -155.5, -55.8, -56.20000000000002, -18.000000000000004, -55.400000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6075197676474801, "mean_inference_ms": 0.6907385419420232, "mean_action_processing_ms": 2.06198842339629, "mean_env_wait_ms": 3.759514184134882, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 144000, "timesteps_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"sample_time_ms": 20689.052, "sample_throughput": 193.339, "load_time_ms": 0.265, "load_throughput": 15098286.537, "learn_time_ms": 4260.16, "learn_throughput": 938.932}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.01875, "cur_lr": 0.00010000000000000003, "total_loss": 7.200754346354033, "policy_loss": -0.0017590891539810164, "vf_loss": 720.2394383850918, "vf_explained_var": -0.06891017626690608, "kl": 0.006360685679105362, "entropy": 0.6079836401567664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 144000, "num_agent_steps_sampled": 144000, "num_steps_trained": 144000, "num_agent_steps_trained": 144000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1440, "training_iteration": 36, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-21-56", "timestamp": 1651062116, "time_this_iter_s": 20.285685062408447, "time_total_s": 1172.0616092681885, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1172.0616092681885, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 15.125, "ram_util_percent": 94.91785714285717}}
{"episode_reward_max": -11.999999999999991, "episode_reward_min": -331.1999999999998, "episode_reward_mean": -53.095000000000006, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.700000000000067, -95.79999999999986, -58.20000000000006, -46.90000000000006, -39.800000000000004, -19.599999999999994, -95.40000000000002, -44.80000000000001, -121.9, -39.099999999999994, -49.90000000000007, -23.700000000000003, -20.300000000000004, -23.80000000000001, -29.599999999999994, -16.4, -48.5, -44.100000000000044, -33.1, -64.0, -51.20000000000005, -28.800000000000004, -46.40000000000004, -11.999999999999991, -42.60000000000004, -105.90000000000016, -47.800000000000054, -23.199999999999996, -51.90000000000006, -23.20000000000001, -13.299999999999997, -48.699999999999996, -46.800000000000054, -17.099999999999994, -17.999999999999986, -41.90000000000001, -35.70000000000001, -50.900000000000006, -58.000000000000014, -15.599999999999989, -26.5, -59.20000000000006, -62.60000000000003, -331.1999999999998, -20.7, -34.1, -30.699999999999996, -105.99999999999991, -73.4, -73.7, -24.30000000000001, -53.8, -42.80000000000003, -28.499999999999954, -52.80000000000007, -155.5, -55.8, -56.20000000000002, -18.000000000000004, -55.400000000000006, -74.60000000000005, -19.499999999999996, -42.90000000000006, -54.800000000000026, -54.30000000000001, -44.1, -35.0, -28.1, -18.7, -115.79999999999983, -33.10000000000005, -13.599999999999987, -22.300000000000004, -150.1, -28.700000000000006, -24.5, -35.60000000000001, -45.10000000000001, -45.80000000000008, -94.79999999999988, -12.899999999999991, -65.2, -26.5, -76.70000000000005, -38.60000000000001, -50.400000000000034, -74.79999999999991, -52.80000000000006, -153.19999999999976, -68.4, -124.7, -60.30000000000008, -50.1, -36.000000000000064, -115.50000000000003, -24.90000000000005, -49.000000000000014, -40.10000000000008, -57.7, -69.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6071298445728891, "mean_inference_ms": 0.6884927226977428, "mean_action_processing_ms": 2.0057611225718954, "mean_env_wait_ms": 3.7334405289394312, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 148000, "timesteps_this_iter": 0, "agent_timesteps_total": 148000, "timers": {"sample_time_ms": 20678.795, "sample_throughput": 193.435, "load_time_ms": 0.264, "load_throughput": 15177506.785, "learn_time_ms": 4271.45, "learn_throughput": 936.45}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.01875, "cur_lr": 0.00010000000000000003, "total_loss": 2.6400373919075855, "policy_loss": 0.0013850359957144466, "vf_loss": 263.855809539877, "vf_explained_var": 0.056600662649318734, "kl": 0.005031092241124633, "entropy": 0.6338766737330345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 148000, "num_agent_steps_sampled": 148000, "num_steps_trained": 148000, "num_agent_steps_trained": 148000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1480, "training_iteration": 37, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-22-16", "timestamp": 1651062136, "time_this_iter_s": 20.478118896484375, "time_total_s": 1192.5397281646729, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1192.5397281646729, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 12.671428571428573, "ram_util_percent": 94.89285714285715}}
{"episode_reward_max": -12.899999999999991, "episode_reward_min": -331.1999999999998, "episode_reward_mean": -55.391000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.5, -59.20000000000006, -62.60000000000003, -331.1999999999998, -20.7, -34.1, -30.699999999999996, -105.99999999999991, -73.4, -73.7, -24.30000000000001, -53.8, -42.80000000000003, -28.499999999999954, -52.80000000000007, -155.5, -55.8, -56.20000000000002, -18.000000000000004, -55.400000000000006, -74.60000000000005, -19.499999999999996, -42.90000000000006, -54.800000000000026, -54.30000000000001, -44.1, -35.0, -28.1, -18.7, -115.79999999999983, -33.10000000000005, -13.599999999999987, -22.300000000000004, -150.1, -28.700000000000006, -24.5, -35.60000000000001, -45.10000000000001, -45.80000000000008, -94.79999999999988, -12.899999999999991, -65.2, -26.5, -76.70000000000005, -38.60000000000001, -50.400000000000034, -74.79999999999991, -52.80000000000006, -153.19999999999976, -68.4, -124.7, -60.30000000000008, -50.1, -36.000000000000064, -115.50000000000003, -24.90000000000005, -49.000000000000014, -40.10000000000008, -57.7, -69.5, -43.00000000000003, -42.20000000000007, -18.900000000000002, -29.9, -85.10000000000002, -49.10000000000009, -49.1, -60.60000000000003, -39.2, -44.10000000000002, -21.19999999999999, -37.7, -60.8000000000001, -51.40000000000007, -28.200000000000003, -13.199999999999998, -49.800000000000054, -35.300000000000054, -34.7, -38.300000000000004, -21.00000000000002, -80.8, -19.199999999999996, -30.0, -100.9, -44.8, -56.40000000000008, -30.00000000000001, -152.3, -55.800000000000054, -24.400000000000002, -67.1, -104.80000000000001, -86.39999999999999, -48.0, -68.9, -54.5, -27.3, -25.000000000000036, -19.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6088420385300575, "mean_inference_ms": 0.6901180735861417, "mean_action_processing_ms": 1.952658709397934, "mean_env_wait_ms": 4.251404846343938, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 152000, "timesteps_this_iter": 0, "agent_timesteps_total": 152000, "timers": {"sample_time_ms": 21220.06, "sample_throughput": 188.501, "load_time_ms": 0.266, "load_throughput": 15058985.728, "learn_time_ms": 4307.444, "learn_throughput": 928.625}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.01875, "cur_lr": 0.00010000000000000003, "total_loss": 1.8200858123840824, "policy_loss": 0.002168407809910595, "vf_loss": 181.78613225260088, "vf_explained_var": -0.00027684107903511293, "kl": 0.002993545658203802, "entropy": 0.5831496296710865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 152000, "num_agent_steps_sampled": 152000, "num_steps_trained": 152000, "num_agent_steps_trained": 152000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1520, "training_iteration": 38, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-26-05", "timestamp": 1651062365, "time_this_iter_s": 229.13770294189453, "time_total_s": 1421.6774311065674, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1421.6774311065674, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 31.44, "ram_util_percent": 95.18}}
{"episode_reward_max": -12.099999999999996, "episode_reward_min": -153.19999999999976, "episode_reward_mean": -50.03800000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.899999999999991, -65.2, -26.5, -76.70000000000005, -38.60000000000001, -50.400000000000034, -74.79999999999991, -52.80000000000006, -153.19999999999976, -68.4, -124.7, -60.30000000000008, -50.1, -36.000000000000064, -115.50000000000003, -24.90000000000005, -49.000000000000014, -40.10000000000008, -57.7, -69.5, -43.00000000000003, -42.20000000000007, -18.900000000000002, -29.9, -85.10000000000002, -49.10000000000009, -49.1, -60.60000000000003, -39.2, -44.10000000000002, -21.19999999999999, -37.7, -60.8000000000001, -51.40000000000007, -28.200000000000003, -13.199999999999998, -49.800000000000054, -35.300000000000054, -34.7, -38.300000000000004, -21.00000000000002, -80.8, -19.199999999999996, -30.0, -100.9, -44.8, -56.40000000000008, -30.00000000000001, -152.3, -55.800000000000054, -24.400000000000002, -67.1, -104.80000000000001, -86.39999999999999, -48.0, -68.9, -54.5, -27.3, -25.000000000000036, -19.799999999999997, -13.099999999999989, -36.1, -33.600000000000044, -55.90000000000006, -15.699999999999992, -30.7, -21.200000000000017, -37.099999999999994, -70.60000000000005, -59.00000000000002, -19.299999999999994, -57.0, -32.40000000000003, -64.40000000000003, -61.50000000000005, -55.7, -12.099999999999996, -22.300000000000004, -18.9, -41.40000000000005, -103.69999999999987, -70.19999999999999, -60.6, -93.29999999999995, -20.999999999999996, -127.09999999999982, -20.500000000000007, -17.799999999999997, -54.60000000000005, -59.70000000000007, -25.4, -43.40000000000007, -86.80000000000001, -28.299999999999997, -49.400000000000034, -46.000000000000036, -57.70000000000006, -29.900000000000023, -36.30000000000006, -17.60000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6104582334276292, "mean_inference_ms": 0.6922093551674493, "mean_action_processing_ms": 1.9023496045935615, "mean_env_wait_ms": 4.757795853630113, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 156000, "timesteps_this_iter": 0, "agent_timesteps_total": 156000, "timers": {"sample_time_ms": 21320.686, "sample_throughput": 187.611, "load_time_ms": 0.266, "load_throughput": 15032000.717, "learn_time_ms": 4305.064, "learn_throughput": 929.138}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 1.678774066910308, "policy_loss": -0.0007303552621955513, "vf_loss": 167.94481594741984, "vf_explained_var": 0.07382584630802114, "kl": 0.006006709035170587, "entropy": 0.617118759501365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 156000, "num_agent_steps_sampled": 156000, "num_steps_trained": 156000, "num_agent_steps_trained": 156000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1560, "training_iteration": 39, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-26-27", "timestamp": 1651062387, "time_this_iter_s": 21.21197009086609, "time_total_s": 1442.8894011974335, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1442.8894011974335, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 15.114285714285714, "ram_util_percent": 95.28571428571425}}
{"episode_reward_max": -10.499999999999996, "episode_reward_min": -152.3, "episode_reward_mean": -46.63000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.00000000000002, -80.8, -19.199999999999996, -30.0, -100.9, -44.8, -56.40000000000008, -30.00000000000001, -152.3, -55.800000000000054, -24.400000000000002, -67.1, -104.80000000000001, -86.39999999999999, -48.0, -68.9, -54.5, -27.3, -25.000000000000036, -19.799999999999997, -13.099999999999989, -36.1, -33.600000000000044, -55.90000000000006, -15.699999999999992, -30.7, -21.200000000000017, -37.099999999999994, -70.60000000000005, -59.00000000000002, -19.299999999999994, -57.0, -32.40000000000003, -64.40000000000003, -61.50000000000005, -55.7, -12.099999999999996, -22.300000000000004, -18.9, -41.40000000000005, -103.69999999999987, -70.19999999999999, -60.6, -93.29999999999995, -20.999999999999996, -127.09999999999982, -20.500000000000007, -17.799999999999997, -54.60000000000005, -59.70000000000007, -25.4, -43.40000000000007, -86.80000000000001, -28.299999999999997, -49.400000000000034, -46.000000000000036, -57.70000000000006, -29.900000000000023, -36.30000000000006, -17.60000000000001, -54.69999999999991, -36.7, -56.70000000000006, -14.999999999999995, -18.799999999999997, -12.19999999999999, -34.8, -40.40000000000004, -64.80000000000004, -71.19999999999993, -67.2, -33.1, -19.80000000000001, -18.7, -68.40000000000005, -20.799999999999997, -50.0, -43.70000000000005, -19.0, -79.40000000000003, -39.6, -21.300000000000004, -32.90000000000005, -47.60000000000008, -114.79999999999981, -22.1, -52.30000000000007, -43.00000000000001, -19.800000000000004, -79.2, -38.70000000000007, -97.2, -67.1, -10.499999999999996, -12.59999999999999, -20.0, -30.30000000000003, -46.6, -18.800000000000004, -98.49999999999993], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6111256585728383, "mean_inference_ms": 0.6926350739494681, "mean_action_processing_ms": 1.8545725969181794, "mean_env_wait_ms": 4.980885027959682, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 160000, "timesteps_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"sample_time_ms": 21243.943, "sample_throughput": 188.289, "load_time_ms": 0.243, "load_throughput": 16453090.125, "learn_time_ms": 4152.887, "learn_throughput": 963.185}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 1.6037901940525219, "policy_loss": -0.012561635086963814, "vf_loss": 161.6295086481238, "vf_explained_var": -0.02776226253919704, "kl": 0.006057055251824864, "entropy": 0.5719236473562896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 160000, "num_agent_steps_sampled": 160000, "num_steps_trained": 160000, "num_agent_steps_trained": 160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1600, "training_iteration": 40, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-26-47", "timestamp": 1651062407, "time_this_iter_s": 20.546766996383667, "time_total_s": 1463.4361681938171, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1463.4361681938171, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 13.439285714285715, "ram_util_percent": 95.13928571428569}}
{"episode_reward_max": -10.499999999999996, "episode_reward_min": -127.09999999999982, "episode_reward_mean": -45.77, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-103.69999999999987, -70.19999999999999, -60.6, -93.29999999999995, -20.999999999999996, -127.09999999999982, -20.500000000000007, -17.799999999999997, -54.60000000000005, -59.70000000000007, -25.4, -43.40000000000007, -86.80000000000001, -28.299999999999997, -49.400000000000034, -46.000000000000036, -57.70000000000006, -29.900000000000023, -36.30000000000006, -17.60000000000001, -54.69999999999991, -36.7, -56.70000000000006, -14.999999999999995, -18.799999999999997, -12.19999999999999, -34.8, -40.40000000000004, -64.80000000000004, -71.19999999999993, -67.2, -33.1, -19.80000000000001, -18.7, -68.40000000000005, -20.799999999999997, -50.0, -43.70000000000005, -19.0, -79.40000000000003, -39.6, -21.300000000000004, -32.90000000000005, -47.60000000000008, -114.79999999999981, -22.1, -52.30000000000007, -43.00000000000001, -19.800000000000004, -79.2, -38.70000000000007, -97.2, -67.1, -10.499999999999996, -12.59999999999999, -20.0, -30.30000000000003, -46.6, -18.800000000000004, -98.49999999999993, -47.00000000000006, -51.70000000000007, -29.400000000000013, -106.99999999999989, -20.10000000000001, -37.7, -21.700000000000024, -73.50000000000004, -16.1, -20.299999999999997, -28.4, -26.3, -33.1, -54.00000000000002, -120.79999999999984, -38.60000000000004, -24.499999999999996, -15.599999999999994, -32.6, -52.5, -39.00000000000006, -55.30000000000007, -44.5, -73.80000000000001, -27.8, -50.700000000000045, -20.999999999999993, -64.2, -35.300000000000054, -43.900000000000006, -94.89999999999999, -54.20000000000001, -16.199999999999996, -78.50000000000001, -33.199999999999974, -57.10000000000004, -44.20000000000007, -13.999999999999991, -36.70000000000004, -54.000000000000014], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6110346429211886, "mean_inference_ms": 0.6909246369680426, "mean_action_processing_ms": 1.8091257855341, "mean_env_wait_ms": 4.927835519202387, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 164000, "timesteps_this_iter": 0, "agent_timesteps_total": 164000, "timers": {"sample_time_ms": 20875.498, "sample_throughput": 191.612, "load_time_ms": 0.249, "load_throughput": 16070130.268, "learn_time_ms": 4164.35, "learn_throughput": 960.534}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 1.3813139642653887, "policy_loss": 0.008450728364449035, "vf_loss": 137.28280216545187, "vf_explained_var": 0.10967898054789471, "kl": 0.0037594807433325647, "entropy": 0.5033593872221568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 164000, "num_agent_steps_sampled": 164000, "num_steps_trained": 164000, "num_agent_steps_trained": 164000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1640, "training_iteration": 41, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-27-08", "timestamp": 1651062428, "time_this_iter_s": 20.52506184577942, "time_total_s": 1483.9612300395966, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1483.9612300395966, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 14.028571428571427, "ram_util_percent": 95.12142857142854}}
{"episode_reward_max": -10.499999999999996, "episode_reward_min": -126.59999999999982, "episode_reward_mean": -45.70700000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.6, -21.300000000000004, -32.90000000000005, -47.60000000000008, -114.79999999999981, -22.1, -52.30000000000007, -43.00000000000001, -19.800000000000004, -79.2, -38.70000000000007, -97.2, -67.1, -10.499999999999996, -12.59999999999999, -20.0, -30.30000000000003, -46.6, -18.800000000000004, -98.49999999999993, -47.00000000000006, -51.70000000000007, -29.400000000000013, -106.99999999999989, -20.10000000000001, -37.7, -21.700000000000024, -73.50000000000004, -16.1, -20.299999999999997, -28.4, -26.3, -33.1, -54.00000000000002, -120.79999999999984, -38.60000000000004, -24.499999999999996, -15.599999999999994, -32.6, -52.5, -39.00000000000006, -55.30000000000007, -44.5, -73.80000000000001, -27.8, -50.700000000000045, -20.999999999999993, -64.2, -35.300000000000054, -43.900000000000006, -94.89999999999999, -54.20000000000001, -16.199999999999996, -78.50000000000001, -33.199999999999974, -57.10000000000004, -44.20000000000007, -13.999999999999991, -36.70000000000004, -54.000000000000014, -59.00000000000005, -119.39999999999985, -58.50000000000001, -78.70000000000005, -69.80000000000007, -66.10000000000001, -32.70000000000005, -23.10000000000001, -24.800000000000022, -18.099999999999994, -50.10000000000004, -57.9, -29.500000000000007, -36.0, -25.300000000000004, -25.5, -52.30000000000006, -51.00000000000007, -86.39999999999989, -63.300000000000026, -34.70000000000001, -36.90000000000005, -51.900000000000034, -25.5, -28.299999999999997, -89.19999999999993, -16.699999999999996, -37.60000000000006, -21.799999999999997, -31.000000000000043, -21.200000000000003, -81.19999999999999, -22.799999999999997, -36.000000000000036, -126.59999999999982, -21.199999999999996, -22.400000000000013, -51.600000000000044, -28.2, -56.10000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6112512945612038, "mean_inference_ms": 0.6889294480913961, "mean_action_processing_ms": 1.7658770613021095, "mean_env_wait_ms": 4.876109630090504, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 168000, "timesteps_this_iter": 0, "agent_timesteps_total": 168000, "timers": {"sample_time_ms": 20926.864, "sample_throughput": 191.142, "load_time_ms": 0.261, "load_throughput": 15306282.274, "learn_time_ms": 4170.376, "learn_throughput": 959.146}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0046875, "cur_lr": 0.00010000000000000003, "total_loss": 1.8841113600038712, "policy_loss": -0.002763895107613456, "vf_loss": 188.6855149689541, "vf_explained_var": -0.017171045080307992, "kl": 0.004296930745292964, "entropy": 0.552972146131659, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 168000, "num_agent_steps_sampled": 168000, "num_steps_trained": 168000, "num_agent_steps_trained": 168000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1680, "training_iteration": 42, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-27-28", "timestamp": 1651062448, "time_this_iter_s": 20.089381217956543, "time_total_s": 1504.050611257553, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1504.050611257553, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 10.403571428571428, "ram_util_percent": 95.08214285714284}}
{"episode_reward_max": -12.499999999999996, "episode_reward_min": -155.59999999999974, "episode_reward_mean": -47.23000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.00000000000006, -55.30000000000007, -44.5, -73.80000000000001, -27.8, -50.700000000000045, -20.999999999999993, -64.2, -35.300000000000054, -43.900000000000006, -94.89999999999999, -54.20000000000001, -16.199999999999996, -78.50000000000001, -33.199999999999974, -57.10000000000004, -44.20000000000007, -13.999999999999991, -36.70000000000004, -54.000000000000014, -59.00000000000005, -119.39999999999985, -58.50000000000001, -78.70000000000005, -69.80000000000007, -66.10000000000001, -32.70000000000005, -23.10000000000001, -24.800000000000022, -18.099999999999994, -50.10000000000004, -57.9, -29.500000000000007, -36.0, -25.300000000000004, -25.5, -52.30000000000006, -51.00000000000007, -86.39999999999989, -63.300000000000026, -34.70000000000001, -36.90000000000005, -51.900000000000034, -25.5, -28.299999999999997, -89.19999999999993, -16.699999999999996, -37.60000000000006, -21.799999999999997, -31.000000000000043, -21.200000000000003, -81.19999999999999, -22.799999999999997, -36.000000000000036, -126.59999999999982, -21.199999999999996, -22.400000000000013, -51.600000000000044, -28.2, -56.10000000000001, -38.0, -56.90000000000001, -52.400000000000034, -25.700000000000006, -41.5, -155.59999999999974, -52.90000000000002, -58.60000000000007, -56.90000000000007, -23.90000000000002, -61.500000000000014, -100.79999999999987, -51.80000000000005, -25.300000000000004, -41.00000000000003, -33.10000000000002, -70.3, -94.49999999999996, -29.700000000000006, -25.700000000000006, -16.699999999999996, -54.200000000000045, -29.90000000000001, -29.10000000000001, -67.50000000000006, -54.600000000000016, -30.200000000000006, -145.09999999999977, -33.20000000000002, -20.499999999999996, -27.400000000000038, -14.099999999999994, -100.1, -13.099999999999987, -30.1, -54.20000000000014, -38.300000000000004, -28.500000000000007, -20.7, -12.499999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.611761224207738, "mean_inference_ms": 0.6867994914498503, "mean_action_processing_ms": 1.72466956965762, "mean_env_wait_ms": 4.825920753505958, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 172000, "timesteps_this_iter": 0, "agent_timesteps_total": 172000, "timers": {"sample_time_ms": 20971.405, "sample_throughput": 190.736, "load_time_ms": 0.262, "load_throughput": 15293724.704, "learn_time_ms": 4179.592, "learn_throughput": 957.031}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00234375, "cur_lr": 0.00010000000000000003, "total_loss": 2.232743511901748, "policy_loss": -0.0009769331143107466, "vf_loss": 223.37058432384202, "vf_explained_var": -0.22861303449958884, "kl": 0.00625207127200176, "entropy": 0.5649167548905136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 172000, "num_agent_steps_sampled": 172000, "num_steps_trained": 172000, "num_agent_steps_trained": 172000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1720, "training_iteration": 43, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-27-48", "timestamp": 1651062468, "time_this_iter_s": 20.072591066360474, "time_total_s": 1524.1232023239136, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1524.1232023239136, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 12.25925925925926, "ram_util_percent": 95.0037037037037}}
{"episode_reward_max": -11.199999999999992, "episode_reward_min": -177.09999999999977, "episode_reward_mean": -45.617999999999995, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.70000000000001, -36.90000000000005, -51.900000000000034, -25.5, -28.299999999999997, -89.19999999999993, -16.699999999999996, -37.60000000000006, -21.799999999999997, -31.000000000000043, -21.200000000000003, -81.19999999999999, -22.799999999999997, -36.000000000000036, -126.59999999999982, -21.199999999999996, -22.400000000000013, -51.600000000000044, -28.2, -56.10000000000001, -38.0, -56.90000000000001, -52.400000000000034, -25.700000000000006, -41.5, -155.59999999999974, -52.90000000000002, -58.60000000000007, -56.90000000000007, -23.90000000000002, -61.500000000000014, -100.79999999999987, -51.80000000000005, -25.300000000000004, -41.00000000000003, -33.10000000000002, -70.3, -94.49999999999996, -29.700000000000006, -25.700000000000006, -16.699999999999996, -54.200000000000045, -29.90000000000001, -29.10000000000001, -67.50000000000006, -54.600000000000016, -30.200000000000006, -145.09999999999977, -33.20000000000002, -20.499999999999996, -27.400000000000038, -14.099999999999994, -100.1, -13.099999999999987, -30.1, -54.20000000000014, -38.300000000000004, -28.500000000000007, -20.7, -12.499999999999996, -31.60000000000003, -14.799999999999992, -34.80000000000001, -35.400000000000006, -32.60000000000001, -36.100000000000016, -77.2, -73.30000000000004, -24.300000000000022, -21.70000000000001, -15.299999999999994, -82.10000000000004, -20.2, -13.799999999999994, -32.800000000000004, -102.79999999999983, -93.39999999999995, -177.09999999999977, -66.7, -12.199999999999998, -26.800000000000004, -39.80000000000006, -55.40000000000006, -111.79999999999981, -34.800000000000054, -26.100000000000026, -15.599999999999984, -19.599999999999994, -50.500000000000014, -50.199999999999996, -40.800000000000075, -30.000000000000004, -11.199999999999992, -18.6, -11.699999999999994, -51.90000000000001, -45.40000000000004, -15.59999999999999, -82.39999999999988, -68.39999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.611669497508725, "mean_inference_ms": 0.6854650919062659, "mean_action_processing_ms": 1.6853825760231183, "mean_env_wait_ms": 4.778884657174378, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 176000, "timesteps_this_iter": 0, "agent_timesteps_total": 176000, "timers": {"sample_time_ms": 21055.248, "sample_throughput": 189.976, "load_time_ms": 0.262, "load_throughput": 15282579.705, "learn_time_ms": 4198.61, "learn_throughput": 952.696}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00234375, "cur_lr": 0.00010000000000000003, "total_loss": 1.9537746520412544, "policy_loss": -0.002266706406108795, "vf_loss": 195.60209825372183, "vf_explained_var": -0.061107857637507944, "kl": 0.0087143186235863, "entropy": 0.5331588257064102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 176000, "num_agent_steps_sampled": 176000, "num_steps_trained": 176000, "num_agent_steps_trained": 176000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1760, "training_iteration": 44, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-28-09", "timestamp": 1651062489, "time_this_iter_s": 20.878238916397095, "time_total_s": 1545.0014412403107, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1545.0014412403107, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.765517241379307, "ram_util_percent": 95.15862068965514}}
{"episode_reward_max": -11.199999999999992, "episode_reward_min": -177.09999999999977, "episode_reward_mean": -42.632, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.699999999999996, -54.200000000000045, -29.90000000000001, -29.10000000000001, -67.50000000000006, -54.600000000000016, -30.200000000000006, -145.09999999999977, -33.20000000000002, -20.499999999999996, -27.400000000000038, -14.099999999999994, -100.1, -13.099999999999987, -30.1, -54.20000000000014, -38.300000000000004, -28.500000000000007, -20.7, -12.499999999999996, -31.60000000000003, -14.799999999999992, -34.80000000000001, -35.400000000000006, -32.60000000000001, -36.100000000000016, -77.2, -73.30000000000004, -24.300000000000022, -21.70000000000001, -15.299999999999994, -82.10000000000004, -20.2, -13.799999999999994, -32.800000000000004, -102.79999999999983, -93.39999999999995, -177.09999999999977, -66.7, -12.199999999999998, -26.800000000000004, -39.80000000000006, -55.40000000000006, -111.79999999999981, -34.800000000000054, -26.100000000000026, -15.599999999999984, -19.599999999999994, -50.500000000000014, -50.199999999999996, -40.800000000000075, -30.000000000000004, -11.199999999999992, -18.6, -11.699999999999994, -51.90000000000001, -45.40000000000004, -15.59999999999999, -82.39999999999988, -68.39999999999998, -16.899999999999988, -37.30000000000006, -57.40000000000002, -27.40000000000003, -13.29999999999999, -30.00000000000005, -17.999999999999993, -34.20000000000004, -56.10000000000009, -70.40000000000006, -20.599999999999998, -54.8, -63.4, -176.69999999999973, -16.499999999999996, -28.4, -25.9, -29.6, -47.400000000000006, -19.800000000000004, -42.70000000000006, -28.700000000000006, -15.999999999999993, -14.4, -111.19999999999999, -59.00000000000008, -26.800000000000004, -40.000000000000064, -14.399999999999999, -59.20000000000006, -36.1, -47.099999999999994, -21.799999999999997, -63.2, -34.20000000000002, -31.10000000000005, -54.50000000000006, -31.800000000000058, -48.2, -13.899999999999991], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6119521955253973, "mean_inference_ms": 0.6841511075101251, "mean_action_processing_ms": 1.647876717505654, "mean_env_wait_ms": 4.734435991055436, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 180000, "timesteps_this_iter": 0, "agent_timesteps_total": 180000, "timers": {"sample_time_ms": 21088.604, "sample_throughput": 189.676, "load_time_ms": 0.265, "load_throughput": 15087424.46, "learn_time_ms": 4225.621, "learn_throughput": 946.606}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00234375, "cur_lr": 0.00010000000000000003, "total_loss": 1.9185641491525276, "policy_loss": -0.0015426719240764135, "vf_loss": 192.0088325910671, "vf_explained_var": -0.0629996233729906, "kl": 0.007899516537012966, "entropy": 0.46675573347076293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 180000, "num_agent_steps_sampled": 180000, "num_steps_trained": 180000, "num_agent_steps_trained": 180000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1800, "training_iteration": 45, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-28-30", "timestamp": 1651062510, "time_this_iter_s": 20.6943199634552, "time_total_s": 1565.6957612037659, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1565.6957612037659, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 21.09642857142857, "ram_util_percent": 95.21071428571427}}
{"episode_reward_max": -11.199999999999992, "episode_reward_min": -176.69999999999973, "episode_reward_mean": -40.083, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.800000000000004, -39.80000000000006, -55.40000000000006, -111.79999999999981, -34.800000000000054, -26.100000000000026, -15.599999999999984, -19.599999999999994, -50.500000000000014, -50.199999999999996, -40.800000000000075, -30.000000000000004, -11.199999999999992, -18.6, -11.699999999999994, -51.90000000000001, -45.40000000000004, -15.59999999999999, -82.39999999999988, -68.39999999999998, -16.899999999999988, -37.30000000000006, -57.40000000000002, -27.40000000000003, -13.29999999999999, -30.00000000000005, -17.999999999999993, -34.20000000000004, -56.10000000000009, -70.40000000000006, -20.599999999999998, -54.8, -63.4, -176.69999999999973, -16.499999999999996, -28.4, -25.9, -29.6, -47.400000000000006, -19.800000000000004, -42.70000000000006, -28.700000000000006, -15.999999999999993, -14.4, -111.19999999999999, -59.00000000000008, -26.800000000000004, -40.000000000000064, -14.399999999999999, -59.20000000000006, -36.1, -47.099999999999994, -21.799999999999997, -63.2, -34.20000000000002, -31.10000000000005, -54.50000000000006, -31.800000000000058, -48.2, -13.899999999999991, -14.199999999999996, -17.199999999999996, -16.39999999999999, -34.70000000000006, -57.500000000000085, -127.19999999999982, -29.00000000000001, -26.800000000000004, -50.79999999999993, -66.30000000000001, -70.89999999999998, -33.80000000000001, -39.7, -13.89999999999999, -39.39999999999999, -47.80000000000007, -11.59999999999999, -29.5, -16.79999999999999, -39.199999999999996, -14.499999999999993, -50.60000000000003, -94.09999999999995, -40.500000000000036, -21.3, -37.300000000000004, -36.199999999999996, -58.60000000000007, -49.300000000000004, -30.000000000000004, -30.60000000000001, -22.400000000000038, -34.7, -45.400000000000055, -42.40000000000005, -25.8, -28.099999999999998, -22.700000000000006, -11.899999999999999, -84.19999999999993], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6125374297260804, "mean_inference_ms": 0.6829356674530926, "mean_action_processing_ms": 1.6120339734989926, "mean_env_wait_ms": 4.692063845265319, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 184000, "timesteps_this_iter": 0, "agent_timesteps_total": 184000, "timers": {"sample_time_ms": 21149.511, "sample_throughput": 189.13, "load_time_ms": 0.265, "load_throughput": 15087424.46, "learn_time_ms": 4238.912, "learn_throughput": 943.638}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00234375, "cur_lr": 0.00010000000000000003, "total_loss": 1.2893612120146563, "policy_loss": 0.009059686027467252, "vf_loss": 128.02888414321407, "vf_explained_var": -0.0560631408486315, "kl": 0.005426701987336709, "entropy": 0.38238988995391837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 184000, "num_agent_steps_sampled": 184000, "num_steps_trained": 184000, "num_agent_steps_trained": 184000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1840, "training_iteration": 46, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-28-50", "timestamp": 1651062530, "time_this_iter_s": 20.76497197151184, "time_total_s": 1586.4607331752777, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1586.4607331752777, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 18.09642857142857, "ram_util_percent": 95.21428571428568}}
{"episode_reward_max": -8.499999999999996, "episode_reward_min": -127.19999999999982, "episode_reward_mean": -39.23500000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-42.70000000000006, -28.700000000000006, -15.999999999999993, -14.4, -111.19999999999999, -59.00000000000008, -26.800000000000004, -40.000000000000064, -14.399999999999999, -59.20000000000006, -36.1, -47.099999999999994, -21.799999999999997, -63.2, -34.20000000000002, -31.10000000000005, -54.50000000000006, -31.800000000000058, -48.2, -13.899999999999991, -14.199999999999996, -17.199999999999996, -16.39999999999999, -34.70000000000006, -57.500000000000085, -127.19999999999982, -29.00000000000001, -26.800000000000004, -50.79999999999993, -66.30000000000001, -70.89999999999998, -33.80000000000001, -39.7, -13.89999999999999, -39.39999999999999, -47.80000000000007, -11.59999999999999, -29.5, -16.79999999999999, -39.199999999999996, -14.499999999999993, -50.60000000000003, -94.09999999999995, -40.500000000000036, -21.3, -37.300000000000004, -36.199999999999996, -58.60000000000007, -49.300000000000004, -30.000000000000004, -30.60000000000001, -22.400000000000038, -34.7, -45.400000000000055, -42.40000000000005, -25.8, -28.099999999999998, -22.700000000000006, -11.899999999999999, -84.19999999999993, -72.90000000000005, -24.700000000000003, -15.999999999999993, -46.9, -30.800000000000043, -31.300000000000004, -75.59999999999998, -35.50000000000002, -14.499999999999995, -53.60000000000005, -80.69999999999996, -54.40000000000008, -26.3, -13.099999999999987, -33.500000000000014, -70.80000000000003, -54.2, -26.099999999999998, -22.200000000000006, -33.100000000000044, -28.300000000000015, -8.499999999999996, -30.50000000000005, -55.700000000000074, -24.800000000000008, -55.700000000000024, -24.60000000000002, -19.799999999999994, -85.70000000000005, -30.199999999999964, -17.39999999999999, -29.30000000000001, -34.699999999999974, -22.300000000000043, -79.4, -59.800000000000054, -36.200000000000045, -38.10000000000006, -40.000000000000036, -28.700000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6128818936753908, "mean_inference_ms": 0.6815794465627918, "mean_action_processing_ms": 1.5777386041874109, "mean_env_wait_ms": 4.651816051059036, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 188000, "timesteps_this_iter": 0, "agent_timesteps_total": 188000, "timers": {"sample_time_ms": 21185.288, "sample_throughput": 188.81, "load_time_ms": 0.262, "load_throughput": 15242314.891, "learn_time_ms": 4235.225, "learn_throughput": 944.46}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00234375, "cur_lr": 0.00010000000000000003, "total_loss": 0.9272666985880063, "policy_loss": 0.0028564529773849314, "vf_loss": 92.43987438858197, "vf_explained_var": -0.12020261736326321, "kl": 0.004916271691237038, "entropy": 0.4376416261077568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 188000, "num_agent_steps_sampled": 188000, "num_steps_trained": 188000, "num_agent_steps_trained": 188000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1880, "training_iteration": 47, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-29-11", "timestamp": 1651062551, "time_this_iter_s": 20.66273283958435, "time_total_s": 1607.123466014862, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1607.123466014862, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 19.689285714285717, "ram_util_percent": 95.22499999999998}}
{"episode_reward_max": -8.499999999999996, "episode_reward_min": -393.8000000000012, "episode_reward_mean": -41.85800000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.499999999999993, -50.60000000000003, -94.09999999999995, -40.500000000000036, -21.3, -37.300000000000004, -36.199999999999996, -58.60000000000007, -49.300000000000004, -30.000000000000004, -30.60000000000001, -22.400000000000038, -34.7, -45.400000000000055, -42.40000000000005, -25.8, -28.099999999999998, -22.700000000000006, -11.899999999999999, -84.19999999999993, -72.90000000000005, -24.700000000000003, -15.999999999999993, -46.9, -30.800000000000043, -31.300000000000004, -75.59999999999998, -35.50000000000002, -14.499999999999995, -53.60000000000005, -80.69999999999996, -54.40000000000008, -26.3, -13.099999999999987, -33.500000000000014, -70.80000000000003, -54.2, -26.099999999999998, -22.200000000000006, -33.100000000000044, -28.300000000000015, -8.499999999999996, -30.50000000000005, -55.700000000000074, -24.800000000000008, -55.700000000000024, -24.60000000000002, -19.799999999999994, -85.70000000000005, -30.199999999999964, -17.39999999999999, -29.30000000000001, -34.699999999999974, -22.300000000000043, -79.4, -59.800000000000054, -36.200000000000045, -38.10000000000006, -40.000000000000036, -28.700000000000006, -25.30000000000003, -33.80000000000001, -14.499999999999988, -15.199999999999992, -37.400000000000055, -11.79999999999999, -53.199999999999996, -48.800000000000075, -15.799999999999985, -35.600000000000016, -32.30000000000005, -61.1, -17.3, -33.699999999999996, -66.80000000000004, -25.80000000000001, -42.9, -49.20000000000002, -42.80000000000001, -41.000000000000014, -36.30000000000004, -28.00000000000005, -33.2, -32.90000000000001, -36.20000000000005, -13.6, -60.4000000000001, -56.50000000000008, -34.900000000000006, -58.5, -37.10000000000004, -86.99999999999996, -14.899999999999995, -38.5, -57.70000000000006, -28.70000000000001, -45.100000000000044, -393.8000000000012, -27.000000000000007, -14.699999999999985], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6128367999327328, "mean_inference_ms": 0.6806767987551958, "mean_action_processing_ms": 1.5449075897642157, "mean_env_wait_ms": 4.613734459232438, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 192000, "timesteps_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"sample_time_ms": 20683.223, "sample_throughput": 193.393, "load_time_ms": 0.26, "load_throughput": 15399005.048, "learn_time_ms": 4210.556, "learn_throughput": 949.993}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001171875, "cur_lr": 0.00010000000000000003, "total_loss": 7.000075452878911, "policy_loss": -0.0044103763096274866, "vf_loss": 700.4478864710818, "vf_explained_var": -0.01387356327426049, "kl": 0.006086462861232055, "entropy": 0.37336984795908773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 192000, "num_agent_steps_sampled": 192000, "num_steps_trained": 192000, "num_agent_steps_trained": 192000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1920, "training_iteration": 48, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-29-32", "timestamp": 1651062572, "time_this_iter_s": 20.898356914520264, "time_total_s": 1628.0218229293823, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1628.0218229293823, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 16.2, "ram_util_percent": 95.22758620689653}}
{"episode_reward_max": -8.499999999999996, "episode_reward_min": -393.8000000000012, "episode_reward_mean": -42.35400000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.300000000000015, -8.499999999999996, -30.50000000000005, -55.700000000000074, -24.800000000000008, -55.700000000000024, -24.60000000000002, -19.799999999999994, -85.70000000000005, -30.199999999999964, -17.39999999999999, -29.30000000000001, -34.699999999999974, -22.300000000000043, -79.4, -59.800000000000054, -36.200000000000045, -38.10000000000006, -40.000000000000036, -28.700000000000006, -25.30000000000003, -33.80000000000001, -14.499999999999988, -15.199999999999992, -37.400000000000055, -11.79999999999999, -53.199999999999996, -48.800000000000075, -15.799999999999985, -35.600000000000016, -32.30000000000005, -61.1, -17.3, -33.699999999999996, -66.80000000000004, -25.80000000000001, -42.9, -49.20000000000002, -42.80000000000001, -41.000000000000014, -36.30000000000004, -28.00000000000005, -33.2, -32.90000000000001, -36.20000000000005, -13.6, -60.4000000000001, -56.50000000000008, -34.900000000000006, -58.5, -37.10000000000004, -86.99999999999996, -14.899999999999995, -38.5, -57.70000000000006, -28.70000000000001, -45.100000000000044, -393.8000000000012, -27.000000000000007, -14.699999999999985, -87.70000000000009, -33.5, -36.8, -34.400000000000034, -21.1, -15.69999999999999, -93.7, -14.399999999999999, -49.40000000000006, -54.400000000000055, -58.10000000000009, -32.80000000000001, -36.99999999999999, -26.40000000000004, -14.899999999999983, -22.40000000000002, -39.90000000000004, -116.39999999999988, -55.70000000000006, -17.1, -26.700000000000003, -26.6, -70.40000000000003, -59.300000000000054, -21.10000000000003, -29.300000000000008, -87.3, -42.70000000000002, -33.600000000000016, -15.899999999999988, -14.099999999999985, -19.10000000000001, -26.40000000000005, -54.20000000000003, -45.50000000000008, -41.80000000000003, -45.10000000000001, -72.39999999999999, -39.400000000000006, -13.699999999999985], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6127687632192393, "mean_inference_ms": 0.679895382206295, "mean_action_processing_ms": 1.5134435655485792, "mean_env_wait_ms": 4.577422344219059, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 196000, "timesteps_this_iter": 0, "agent_timesteps_total": 196000, "timers": {"sample_time_ms": 20641.904, "sample_throughput": 193.781, "load_time_ms": 0.26, "load_throughput": 15380652.732, "learn_time_ms": 4181.578, "learn_throughput": 956.577}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001171875, "cur_lr": 0.00010000000000000003, "total_loss": 1.376325196916017, "policy_loss": 0.0016630217913658387, "vf_loss": 137.46562735034573, "vf_explained_var": 0.0447289756549302, "kl": 0.00505625383988396, "entropy": 0.34560071012826377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 196000, "num_agent_steps_sampled": 196000, "num_steps_trained": 196000, "num_agent_steps_trained": 196000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1960, "training_iteration": 49, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-29-53", "timestamp": 1651062593, "time_this_iter_s": 20.763357877731323, "time_total_s": 1648.7851808071136, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1648.7851808071136, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 24.27142857142857, "ram_util_percent": 95.23214285714282}}
{"episode_reward_max": -9.599999999999994, "episode_reward_min": -393.8000000000012, "episode_reward_mean": -46.574000000000034, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-36.30000000000004, -28.00000000000005, -33.2, -32.90000000000001, -36.20000000000005, -13.6, -60.4000000000001, -56.50000000000008, -34.900000000000006, -58.5, -37.10000000000004, -86.99999999999996, -14.899999999999995, -38.5, -57.70000000000006, -28.70000000000001, -45.100000000000044, -393.8000000000012, -27.000000000000007, -14.699999999999985, -87.70000000000009, -33.5, -36.8, -34.400000000000034, -21.1, -15.69999999999999, -93.7, -14.399999999999999, -49.40000000000006, -54.400000000000055, -58.10000000000009, -32.80000000000001, -36.99999999999999, -26.40000000000004, -14.899999999999983, -22.40000000000002, -39.90000000000004, -116.39999999999988, -55.70000000000006, -17.1, -26.700000000000003, -26.6, -70.40000000000003, -59.300000000000054, -21.10000000000003, -29.300000000000008, -87.3, -42.70000000000002, -33.600000000000016, -15.899999999999988, -14.099999999999985, -19.10000000000001, -26.40000000000005, -54.20000000000003, -45.50000000000008, -41.80000000000003, -45.10000000000001, -72.39999999999999, -39.400000000000006, -13.699999999999985, -10.999999999999995, -14.899999999999999, -43.50000000000005, -31.90000000000002, -35.80000000000005, -23.300000000000004, -36.2, -72.00000000000001, -258.79999999999995, -147.7, -58.1000000000001, -51.80000000000003, -140.6999999999998, -47.40000000000008, -10.399999999999991, -20.39999999999999, -34.70000000000004, -23.1, -67.0, -28.199999999999992, -30.80000000000001, -75.50000000000001, -14.299999999999995, -9.599999999999994, -39.90000000000005, -40.600000000000016, -42.50000000000001, -47.10000000000008, -32.1, -14.799999999999992, -20.999999999999993, -56.50000000000007, -53.600000000000044, -16.499999999999996, -11.099999999999996, -69.60000000000002, -30.000000000000004, -37.40000000000003, -28.10000000000007, -48.10000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.612756843959236, "mean_inference_ms": 0.6793251016784333, "mean_action_processing_ms": 1.4832653516173964, "mean_env_wait_ms": 4.542468906193769, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 200000, "timesteps_this_iter": 0, "agent_timesteps_total": 200000, "timers": {"sample_time_ms": 20634.127, "sample_throughput": 193.854, "load_time_ms": 0.261, "load_throughput": 15334261.95, "learn_time_ms": 4185.004, "learn_throughput": 955.794}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001171875, "cur_lr": 0.00010000000000000003, "total_loss": 6.346979506958717, "policy_loss": -0.001912927249025914, "vf_loss": 634.8885454485493, "vf_explained_var": -0.13629122139305197, "kl": 0.006156432605441857, "entropy": 0.3640502093219629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 200000, "num_agent_steps_sampled": 200000, "num_steps_trained": 200000, "num_agent_steps_trained": 200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2000, "training_iteration": 50, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-30-14", "timestamp": 1651062614, "time_this_iter_s": 20.820289134979248, "time_total_s": 1669.605469942093, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1669.605469942093, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 21.299999999999997, "ram_util_percent": 95.22413793103445}}
{"episode_reward_max": -9.599999999999994, "episode_reward_min": -258.79999999999995, "episode_reward_mean": -46.87800000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.700000000000003, -26.6, -70.40000000000003, -59.300000000000054, -21.10000000000003, -29.300000000000008, -87.3, -42.70000000000002, -33.600000000000016, -15.899999999999988, -14.099999999999985, -19.10000000000001, -26.40000000000005, -54.20000000000003, -45.50000000000008, -41.80000000000003, -45.10000000000001, -72.39999999999999, -39.400000000000006, -13.699999999999985, -10.999999999999995, -14.899999999999999, -43.50000000000005, -31.90000000000002, -35.80000000000005, -23.300000000000004, -36.2, -72.00000000000001, -258.79999999999995, -147.7, -58.1000000000001, -51.80000000000003, -140.6999999999998, -47.40000000000008, -10.399999999999991, -20.39999999999999, -34.70000000000004, -23.1, -67.0, -28.199999999999992, -30.80000000000001, -75.50000000000001, -14.299999999999995, -9.599999999999994, -39.90000000000005, -40.600000000000016, -42.50000000000001, -47.10000000000008, -32.1, -14.799999999999992, -20.999999999999993, -56.50000000000007, -53.600000000000044, -16.499999999999996, -11.099999999999996, -69.60000000000002, -30.000000000000004, -37.40000000000003, -28.10000000000007, -48.10000000000006, -55.70000000000009, -40.100000000000016, -51.6, -31.000000000000014, -125.3, -129.5, -108.60000000000002, -18.10000000000001, -19.7, -84.99999999999997, -30.300000000000004, -50.700000000000095, -14.799999999999999, -35.50000000000001, -154.5, -31.0, -31.000000000000043, -60.70000000000005, -24.600000000000005, -48.800000000000004, -38.60000000000007, -37.60000000000004, -47.30000000000009, -97.19999999999996, -91.79999999999995, -26.500000000000053, -53.60000000000005, -58.60000000000005, -58.30000000000007, -13.39999999999999, -18.20000000000001, -16.099999999999998, -36.200000000000045, -53.10000000000004, -73.6, -19.800000000000015, -33.70000000000006, -16.69999999999999, -60.30000000000009, -30.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6131216602050018, "mean_inference_ms": 0.6790288264001488, "mean_action_processing_ms": 1.4543051028528682, "mean_env_wait_ms": 4.509083156795787, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 204000, "timesteps_this_iter": 0, "agent_timesteps_total": 204000, "timers": {"sample_time_ms": 20706.823, "sample_throughput": 193.173, "load_time_ms": 0.251, "load_throughput": 15932778.727, "learn_time_ms": 4191.847, "learn_throughput": 954.233}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001171875, "cur_lr": 0.00010000000000000003, "total_loss": 2.5231509277081337, "policy_loss": -0.00047057978733773195, "vf_loss": 252.36166137162076, "vf_explained_var": -0.0692150140321383, "kl": 0.00422114457826453, "entropy": 0.3390874412992308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 204000, "num_agent_steps_sampled": 204000, "num_steps_trained": 204000, "num_agent_steps_trained": 204000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2040, "training_iteration": 51, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-30-35", "timestamp": 1651062635, "time_this_iter_s": 21.275291681289673, "time_total_s": 1690.8807616233826, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1690.8807616233826, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 23.613793103448277, "ram_util_percent": 95.24137931034484}}
{"episode_reward_max": -9.3, "episode_reward_min": -156.6, "episode_reward_mean": -44.23300000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.80000000000001, -75.50000000000001, -14.299999999999995, -9.599999999999994, -39.90000000000005, -40.600000000000016, -42.50000000000001, -47.10000000000008, -32.1, -14.799999999999992, -20.999999999999993, -56.50000000000007, -53.600000000000044, -16.499999999999996, -11.099999999999996, -69.60000000000002, -30.000000000000004, -37.40000000000003, -28.10000000000007, -48.10000000000006, -55.70000000000009, -40.100000000000016, -51.6, -31.000000000000014, -125.3, -129.5, -108.60000000000002, -18.10000000000001, -19.7, -84.99999999999997, -30.300000000000004, -50.700000000000095, -14.799999999999999, -35.50000000000001, -154.5, -31.0, -31.000000000000043, -60.70000000000005, -24.600000000000005, -48.800000000000004, -38.60000000000007, -37.60000000000004, -47.30000000000009, -97.19999999999996, -91.79999999999995, -26.500000000000053, -53.60000000000005, -58.60000000000005, -58.30000000000007, -13.39999999999999, -18.20000000000001, -16.099999999999998, -36.200000000000045, -53.10000000000004, -73.6, -19.800000000000015, -33.70000000000006, -16.69999999999999, -60.30000000000009, -30.1, -26.600000000000005, -26.20000000000001, -32.10000000000001, -60.29999999999996, -156.6, -9.3, -37.80000000000006, -25.40000000000005, -54.60000000000006, -72.60000000000001, -30.3, -28.30000000000001, -33.8, -58.50000000000007, -17.9, -39.90000000000003, -28.10000000000001, -28.900000000000002, -52.60000000000002, -37.2, -54.400000000000034, -57.70000000000007, -37.30000000000004, -19.2, -27.4, -94.59999999999994, -26.000000000000032, -38.4, -50.10000000000001, -20.699999999999992, -33.0, -18.400000000000002, -24.500000000000004, -36.90000000000001, -21.500000000000007, -52.000000000000036, -51.600000000000065, -52.600000000000016, -49.29999999999993, -54.40000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6129638360848613, "mean_inference_ms": 0.6789791247647404, "mean_action_processing_ms": 1.4264767869427053, "mean_env_wait_ms": 4.477409982672069, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 208000, "timesteps_this_iter": 0, "agent_timesteps_total": 208000, "timers": {"sample_time_ms": 20778.679, "sample_throughput": 192.505, "load_time_ms": 0.239, "load_throughput": 16710374.502, "learn_time_ms": 4208.449, "learn_throughput": 950.469}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0005859375, "cur_lr": 0.00010000000000000003, "total_loss": 1.5408195603839172, "policy_loss": 0.00665932172729123, "vf_loss": 153.41576886228336, "vf_explained_var": 0.06503043277289278, "kl": 0.004440578583500178, "entropy": 0.2672188935581074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 208000, "num_agent_steps_sampled": 208000, "num_steps_trained": 208000, "num_agent_steps_trained": 208000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2080, "training_iteration": 52, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-30-56", "timestamp": 1651062656, "time_this_iter_s": 20.90482497215271, "time_total_s": 1711.7855865955353, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1711.7855865955353, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 15.89642857142857, "ram_util_percent": 95.23571428571427}}
{"episode_reward_max": -9.3, "episode_reward_min": -156.6, "episode_reward_mean": -41.62400000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.60000000000007, -37.60000000000004, -47.30000000000009, -97.19999999999996, -91.79999999999995, -26.500000000000053, -53.60000000000005, -58.60000000000005, -58.30000000000007, -13.39999999999999, -18.20000000000001, -16.099999999999998, -36.200000000000045, -53.10000000000004, -73.6, -19.800000000000015, -33.70000000000006, -16.69999999999999, -60.30000000000009, -30.1, -26.600000000000005, -26.20000000000001, -32.10000000000001, -60.29999999999996, -156.6, -9.3, -37.80000000000006, -25.40000000000005, -54.60000000000006, -72.60000000000001, -30.3, -28.30000000000001, -33.8, -58.50000000000007, -17.9, -39.90000000000003, -28.10000000000001, -28.900000000000002, -52.60000000000002, -37.2, -54.400000000000034, -57.70000000000007, -37.30000000000004, -19.2, -27.4, -94.59999999999994, -26.000000000000032, -38.4, -50.10000000000001, -20.699999999999992, -33.0, -18.400000000000002, -24.500000000000004, -36.90000000000001, -21.500000000000007, -52.000000000000036, -51.600000000000065, -52.600000000000016, -49.29999999999993, -54.40000000000007, -52.70000000000004, -29.5, -40.7, -100.0, -58.20000000000008, -83.40000000000003, -31.799999999999997, -94.49999999999997, -24.50000000000003, -57.20000000000005, -85.79999999999991, -36.1, -36.099999999999994, -38.000000000000064, -20.40000000000001, -13.599999999999994, -15.599999999999993, -77.80000000000003, -20.499999999999982, -51.80000000000008, -34.10000000000005, -17.499999999999993, -20.30000000000004, -19.40000000000001, -26.3, -31.70000000000001, -82.4, -20.600000000000012, -43.90000000000007, -27.100000000000048, -26.200000000000003, -47.2, -16.89999999999999, -15.399999999999993, -34.00000000000005, -39.300000000000054, -42.60000000000002, -32.70000000000005, -29.0, -29.900000000000013], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6122232668483466, "mean_inference_ms": 0.6795683959404761, "mean_action_processing_ms": 1.3997266889782487, "mean_env_wait_ms": 4.448186678439921, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 212000, "timesteps_this_iter": 0, "agent_timesteps_total": 212000, "timers": {"sample_time_ms": 20945.869, "sample_throughput": 190.968, "load_time_ms": 0.24, "load_throughput": 16634162.205, "learn_time_ms": 4229.364, "learn_throughput": 945.769}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00029296875, "cur_lr": 0.00010000000000000003, "total_loss": 1.442026770374267, "policy_loss": 7.295351555590988e-05, "vf_loss": 144.19531553432506, "vf_explained_var": -0.027220490927337318, "kl": 0.0023612298368731305, "entropy": 0.29573586871547086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 212000, "num_agent_steps_sampled": 212000, "num_steps_trained": 212000, "num_agent_steps_trained": 212000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2120, "training_iteration": 53, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-31-18", "timestamp": 1651062678, "time_this_iter_s": 21.78439712524414, "time_total_s": 1733.5699837207794, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1733.5699837207794, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 31.986666666666668, "ram_util_percent": 95.24000000000001}}
{"episode_reward_max": -13.599999999999994, "episode_reward_min": -146.5, "episode_reward_mean": -42.06300000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.400000000000034, -57.70000000000007, -37.30000000000004, -19.2, -27.4, -94.59999999999994, -26.000000000000032, -38.4, -50.10000000000001, -20.699999999999992, -33.0, -18.400000000000002, -24.500000000000004, -36.90000000000001, -21.500000000000007, -52.000000000000036, -51.600000000000065, -52.600000000000016, -49.29999999999993, -54.40000000000007, -52.70000000000004, -29.5, -40.7, -100.0, -58.20000000000008, -83.40000000000003, -31.799999999999997, -94.49999999999997, -24.50000000000003, -57.20000000000005, -85.79999999999991, -36.1, -36.099999999999994, -38.000000000000064, -20.40000000000001, -13.599999999999994, -15.599999999999993, -77.80000000000003, -20.499999999999982, -51.80000000000008, -34.10000000000005, -17.499999999999993, -20.30000000000004, -19.40000000000001, -26.3, -31.70000000000001, -82.4, -20.600000000000012, -43.90000000000007, -27.100000000000048, -26.200000000000003, -47.2, -16.89999999999999, -15.399999999999993, -34.00000000000005, -39.300000000000054, -42.60000000000002, -32.70000000000005, -29.0, -29.900000000000013, -56.500000000000014, -23.400000000000013, -114.1, -18.80000000000001, -48.80000000000007, -27.700000000000035, -29.70000000000001, -52.50000000000005, -27.49999999999996, -34.0, -61.00000000000006, -26.30000000000003, -13.799999999999997, -58.10000000000005, -57.100000000000094, -25.600000000000005, -104.29999999999981, -31.500000000000007, -39.80000000000005, -18.9, -41.500000000000036, -55.900000000000084, -19.900000000000006, -55.30000000000008, -36.60000000000001, -38.10000000000002, -73.30000000000004, -35.60000000000005, -26.2, -34.4, -146.5, -33.300000000000026, -39.900000000000006, -31.500000000000007, -110.1999999999999, -39.10000000000001, -30.00000000000001, -25.0, -22.400000000000027, -17.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.611210622754475, "mean_inference_ms": 0.6799510916554731, "mean_action_processing_ms": 1.3739779534839178, "mean_env_wait_ms": 4.420554605067937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 216000, "timesteps_this_iter": 0, "agent_timesteps_total": 216000, "timers": {"sample_time_ms": 20991.356, "sample_throughput": 190.555, "load_time_ms": 0.241, "load_throughput": 16627567.889, "learn_time_ms": 4235.007, "learn_throughput": 944.508}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000146484375, "cur_lr": 0.00010000000000000003, "total_loss": 1.76053975413964, "policy_loss": -0.0009041260367119184, "vf_loss": 176.14434697961295, "vf_explained_var": -0.04177403578194239, "kl": 0.0031672091656280445, "entropy": 0.27613972423057404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 216000, "num_agent_steps_sampled": 216000, "num_steps_trained": 216000, "num_agent_steps_trained": 216000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2160, "training_iteration": 54, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-31-39", "timestamp": 1651062699, "time_this_iter_s": 21.164010047912598, "time_total_s": 1754.733993768692, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1754.733993768692, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 23.28275862068965, "ram_util_percent": 95.23793103448274}}
{"episode_reward_max": -10.199999999999996, "episode_reward_min": -146.5, "episode_reward_mean": -40.41700000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.10000000000005, -17.499999999999993, -20.30000000000004, -19.40000000000001, -26.3, -31.70000000000001, -82.4, -20.600000000000012, -43.90000000000007, -27.100000000000048, -26.200000000000003, -47.2, -16.89999999999999, -15.399999999999993, -34.00000000000005, -39.300000000000054, -42.60000000000002, -32.70000000000005, -29.0, -29.900000000000013, -56.500000000000014, -23.400000000000013, -114.1, -18.80000000000001, -48.80000000000007, -27.700000000000035, -29.70000000000001, -52.50000000000005, -27.49999999999996, -34.0, -61.00000000000006, -26.30000000000003, -13.799999999999997, -58.10000000000005, -57.100000000000094, -25.600000000000005, -104.29999999999981, -31.500000000000007, -39.80000000000005, -18.9, -41.500000000000036, -55.900000000000084, -19.900000000000006, -55.30000000000008, -36.60000000000001, -38.10000000000002, -73.30000000000004, -35.60000000000005, -26.2, -34.4, -146.5, -33.300000000000026, -39.900000000000006, -31.500000000000007, -110.1999999999999, -39.10000000000001, -30.00000000000001, -25.0, -22.400000000000027, -17.5, -34.7, -39.60000000000002, -43.800000000000004, -52.60000000000003, -34.30000000000001, -103.40000000000002, -23.599999999999998, -22.200000000000024, -51.50000000000003, -35.000000000000064, -20.500000000000007, -38.10000000000006, -16.699999999999992, -51.40000000000003, -27.600000000000037, -51.20000000000007, -49.6, -122.89999999999985, -18.200000000000003, -21.0, -21.800000000000008, -10.199999999999996, -22.8, -25.000000000000032, -45.10000000000011, -30.299999999999997, -26.800000000000004, -67.2, -39.90000000000006, -41.00000000000003, -79.40000000000003, -34.19999999999998, -32.30000000000001, -46.49999999999999, -32.00000000000005, -18.5, -15.899999999999999, -30.7, -33.900000000000006, -112.19999999999987], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6107940396693327, "mean_inference_ms": 0.6799841778181147, "mean_action_processing_ms": 1.3491753375762585, "mean_env_wait_ms": 4.393434195367767, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 220000, "timesteps_this_iter": 0, "agent_timesteps_total": 220000, "timers": {"sample_time_ms": 21060.969, "sample_throughput": 189.925, "load_time_ms": 0.239, "load_throughput": 16727034.895, "learn_time_ms": 4275.136, "learn_throughput": 935.643}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.32421875e-05, "cur_lr": 0.00010000000000000003, "total_loss": 1.518414737676741, "policy_loss": -0.0037242329569273096, "vf_loss": 152.2138566909298, "vf_explained_var": -0.03105310740009431, "kl": 0.0059602015098177835, "entropy": 0.2856815429224122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 220000, "num_agent_steps_sampled": 220000, "num_steps_trained": 220000, "num_agent_steps_trained": 220000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2200, "training_iteration": 55, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-32-01", "timestamp": 1651062721, "time_this_iter_s": 21.667536735534668, "time_total_s": 1776.4015305042267, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1776.4015305042267, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 18.76206896551724, "ram_util_percent": 95.18620689655174}}
{"episode_reward_max": -9.099999999999998, "episode_reward_min": -146.5, "episode_reward_mean": -39.79000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.500000000000036, -55.900000000000084, -19.900000000000006, -55.30000000000008, -36.60000000000001, -38.10000000000002, -73.30000000000004, -35.60000000000005, -26.2, -34.4, -146.5, -33.300000000000026, -39.900000000000006, -31.500000000000007, -110.1999999999999, -39.10000000000001, -30.00000000000001, -25.0, -22.400000000000027, -17.5, -34.7, -39.60000000000002, -43.800000000000004, -52.60000000000003, -34.30000000000001, -103.40000000000002, -23.599999999999998, -22.200000000000024, -51.50000000000003, -35.000000000000064, -20.500000000000007, -38.10000000000006, -16.699999999999992, -51.40000000000003, -27.600000000000037, -51.20000000000007, -49.6, -122.89999999999985, -18.200000000000003, -21.0, -21.800000000000008, -10.199999999999996, -22.8, -25.000000000000032, -45.10000000000011, -30.299999999999997, -26.800000000000004, -67.2, -39.90000000000006, -41.00000000000003, -79.40000000000003, -34.19999999999998, -32.30000000000001, -46.49999999999999, -32.00000000000005, -18.5, -15.899999999999999, -30.7, -33.900000000000006, -112.19999999999987, -35.9, -31.400000000000034, -37.20000000000006, -46.600000000000065, -50.1, -46.70000000000008, -50.90000000000004, -25.200000000000006, -43.30000000000002, -37.50000000000002, -18.800000000000008, -13.899999999999995, -23.799999999999997, -128.19999999999976, -17.199999999999996, -35.60000000000004, -36.000000000000036, -36.00000000000001, -39.10000000000005, -51.600000000000044, -43.80000000000007, -49.60000000000005, -34.70000000000001, -13.699999999999998, -16.799999999999997, -17.3, -68.50000000000004, -40.60000000000006, -17.199999999999996, -19.400000000000006, -9.099999999999998, -13.799999999999999, -62.900000000000055, -50.40000000000005, -20.599999999999998, -15.599999999999998, -27.900000000000013, -32.89999999999997, -17.49999999999999, -65.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6105450158812117, "mean_inference_ms": 0.6800581156329933, "mean_action_processing_ms": 1.3252673525330059, "mean_env_wait_ms": 4.366863378899397, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 224000, "timesteps_this_iter": 0, "agent_timesteps_total": 224000, "timers": {"sample_time_ms": 21154.549, "sample_throughput": 189.085, "load_time_ms": 0.239, "load_throughput": 16707046.405, "learn_time_ms": 4280.551, "learn_throughput": 934.459}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.32421875e-05, "cur_lr": 0.00010000000000000003, "total_loss": 1.0911796715789004, "policy_loss": -0.004699563059294897, "vf_loss": 109.58788519008185, "vf_explained_var": -0.16379467614235416, "kl": 0.005403855299920138, "entropy": 0.29102063178615545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 224000, "num_agent_steps_sampled": 224000, "num_steps_trained": 224000, "num_agent_steps_trained": 224000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2240, "training_iteration": 56, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-32-22", "timestamp": 1651062742, "time_this_iter_s": 21.353162050247192, "time_total_s": 1797.7546925544739, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1797.7546925544739, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 13.973333333333333, "ram_util_percent": 95.10666666666667}}
{"episode_reward_max": -5.100000000000001, "episode_reward_min": -128.19999999999976, "episode_reward_mean": -38.12000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.800000000000008, -10.199999999999996, -22.8, -25.000000000000032, -45.10000000000011, -30.299999999999997, -26.800000000000004, -67.2, -39.90000000000006, -41.00000000000003, -79.40000000000003, -34.19999999999998, -32.30000000000001, -46.49999999999999, -32.00000000000005, -18.5, -15.899999999999999, -30.7, -33.900000000000006, -112.19999999999987, -35.9, -31.400000000000034, -37.20000000000006, -46.600000000000065, -50.1, -46.70000000000008, -50.90000000000004, -25.200000000000006, -43.30000000000002, -37.50000000000002, -18.800000000000008, -13.899999999999995, -23.799999999999997, -128.19999999999976, -17.199999999999996, -35.60000000000004, -36.000000000000036, -36.00000000000001, -39.10000000000005, -51.600000000000044, -43.80000000000007, -49.60000000000005, -34.70000000000001, -13.699999999999998, -16.799999999999997, -17.3, -68.50000000000004, -40.60000000000006, -17.199999999999996, -19.400000000000006, -9.099999999999998, -13.799999999999999, -62.900000000000055, -50.40000000000005, -20.599999999999998, -15.599999999999998, -27.900000000000013, -32.89999999999997, -17.49999999999999, -65.9, -16.999999999999986, -32.400000000000034, -11.899999999999997, -61.00000000000008, -28.000000000000007, -57.200000000000024, -35.00000000000002, -58.40000000000006, -25.7, -122.79999999999983, -34.300000000000004, -18.399999999999995, -32.00000000000005, -17.89999999999999, -19.20000000000002, -52.80000000000005, -90.8000000000001, -40.300000000000075, -41.10000000000006, -21.700000000000006, -30.7, -53.900000000000055, -10.399999999999999, -69.70000000000006, -29.500000000000004, -20.8, -42.10000000000007, -96.09999999999994, -26.40000000000001, -40.900000000000006, -26.900000000000006, -70.70000000000003, -102.29999999999993, -5.100000000000001, -30.2, -35.000000000000014, -19.4, -29.000000000000014, -13.799999999999995, -32.300000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6104031010279083, "mean_inference_ms": 0.6805662761035621, "mean_action_processing_ms": 1.3022216160786053, "mean_env_wait_ms": 4.341054811316552, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 228000, "timesteps_this_iter": 0, "agent_timesteps_total": 228000, "timers": {"sample_time_ms": 21226.302, "sample_throughput": 188.445, "load_time_ms": 0.293, "load_throughput": 13647780.037, "learn_time_ms": 4295.153, "learn_throughput": 931.282}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.32421875e-05, "cur_lr": 0.00010000000000000003, "total_loss": 1.3590475729521445, "policy_loss": -0.0012509128829884914, "vf_loss": 136.029826353955, "vf_explained_var": 0.03901893490104265, "kl": 0.00350969005876202, "entropy": 0.3053535839282377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 228000, "num_agent_steps_sampled": 228000, "num_steps_trained": 228000, "num_agent_steps_trained": 228000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2280, "training_iteration": 57, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-32-44", "timestamp": 1651062764, "time_this_iter_s": 21.47566795349121, "time_total_s": 1819.230360507965, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1819.230360507965, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 21.672413793103452, "ram_util_percent": 94.88965517241382}}
{"episode_reward_max": -5.100000000000001, "episode_reward_min": -122.79999999999983, "episode_reward_mean": -36.42100000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.80000000000007, -49.60000000000005, -34.70000000000001, -13.699999999999998, -16.799999999999997, -17.3, -68.50000000000004, -40.60000000000006, -17.199999999999996, -19.400000000000006, -9.099999999999998, -13.799999999999999, -62.900000000000055, -50.40000000000005, -20.599999999999998, -15.599999999999998, -27.900000000000013, -32.89999999999997, -17.49999999999999, -65.9, -16.999999999999986, -32.400000000000034, -11.899999999999997, -61.00000000000008, -28.000000000000007, -57.200000000000024, -35.00000000000002, -58.40000000000006, -25.7, -122.79999999999983, -34.300000000000004, -18.399999999999995, -32.00000000000005, -17.89999999999999, -19.20000000000002, -52.80000000000005, -90.8000000000001, -40.300000000000075, -41.10000000000006, -21.700000000000006, -30.7, -53.900000000000055, -10.399999999999999, -69.70000000000006, -29.500000000000004, -20.8, -42.10000000000007, -96.09999999999994, -26.40000000000001, -40.900000000000006, -26.900000000000006, -70.70000000000003, -102.29999999999993, -5.100000000000001, -30.2, -35.000000000000014, -19.4, -29.000000000000014, -13.799999999999995, -32.300000000000004, -39.5, -40.800000000000004, -36.6, -14.899999999999999, -20.700000000000003, -51.000000000000036, -34.90000000000005, -45.800000000000075, -41.699999999999996, -50.800000000000004, -49.10000000000006, -54.20000000000007, -50.400000000000034, -30.5, -18.19999999999999, -15.299999999999999, -30.100000000000023, -20.599999999999994, -23.400000000000055, -40.800000000000004, -23.900000000000013, -52.90000000000005, -13.4, -52.90000000000006, -32.8, -37.90000000000007, -24.800000000000026, -35.400000000000006, -32.50000000000001, -37.9, -14.0, -37.10000000000005, -86.5, -25.800000000000004, -19.7, -38.0, -28.70000000000004, -21.300000000000004, -33.7, -42.300000000000075], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.610234167282223, "mean_inference_ms": 0.681055841849933, "mean_action_processing_ms": 1.2799870612956097, "mean_env_wait_ms": 4.31607781168861, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 232000, "timesteps_this_iter": 0, "agent_timesteps_total": 232000, "timers": {"sample_time_ms": 21266.957, "sample_throughput": 188.085, "load_time_ms": 0.294, "load_throughput": 13603515.771, "learn_time_ms": 4297.66, "learn_throughput": 930.739}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.662109375e-05, "cur_lr": 0.00010000000000000003, "total_loss": 0.6468697124159575, "policy_loss": -0.004416055488650517, "vf_loss": 65.12855803992159, "vf_explained_var": 0.03502419956268803, "kl": 0.005684028220480796, "entropy": 0.24063057931520607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 232000, "num_agent_steps_sampled": 232000, "num_steps_trained": 232000, "num_agent_steps_trained": 232000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2320, "training_iteration": 58, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-33-05", "timestamp": 1651062785, "time_this_iter_s": 21.181702852249146, "time_total_s": 1840.4120633602142, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1840.4120633602142, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 20.631034482758622, "ram_util_percent": 94.82413793103451}}
{"episode_reward_max": -5.100000000000001, "episode_reward_min": -130.4, "episode_reward_mean": -40.56400000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.7, -53.900000000000055, -10.399999999999999, -69.70000000000006, -29.500000000000004, -20.8, -42.10000000000007, -96.09999999999994, -26.40000000000001, -40.900000000000006, -26.900000000000006, -70.70000000000003, -102.29999999999993, -5.100000000000001, -30.2, -35.000000000000014, -19.4, -29.000000000000014, -13.799999999999995, -32.300000000000004, -39.5, -40.800000000000004, -36.6, -14.899999999999999, -20.700000000000003, -51.000000000000036, -34.90000000000005, -45.800000000000075, -41.699999999999996, -50.800000000000004, -49.10000000000006, -54.20000000000007, -50.400000000000034, -30.5, -18.19999999999999, -15.299999999999999, -30.100000000000023, -20.599999999999994, -23.400000000000055, -40.800000000000004, -23.900000000000013, -52.90000000000005, -13.4, -52.90000000000006, -32.8, -37.90000000000007, -24.800000000000026, -35.400000000000006, -32.50000000000001, -37.9, -14.0, -37.10000000000005, -86.5, -25.800000000000004, -19.7, -38.0, -28.70000000000004, -21.300000000000004, -33.7, -42.300000000000075, -31.700000000000006, -35.799999999999976, -43.30000000000001, -39.500000000000064, -17.5, -31.100000000000062, -15.6, -14.099999999999989, -35.30000000000001, -57.70000000000009, -130.4, -55.99999999999999, -54.50000000000004, -53.60000000000007, -56.50000000000005, -52.800000000000026, -19.9, -31.200000000000024, -46.40000000000006, -51.500000000000014, -19.499999999999996, -65.70000000000006, -38.30000000000002, -40.200000000000074, -24.700000000000006, -97.59999999999994, -27.900000000000013, -56.400000000000055, -28.800000000000058, -14.899999999999988, -105.29999999999995, -32.7, -25.100000000000005, -54.50000000000004, -113.39999999999988, -29.000000000000014, -128.39999999999984, -22.999999999999996, -52.90000000000007, -17.700000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6102812519235937, "mean_inference_ms": 0.6811323527132399, "mean_action_processing_ms": 1.2585083927230665, "mean_env_wait_ms": 4.291580121776357, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 236000, "timesteps_this_iter": 0, "agent_timesteps_total": 236000, "timers": {"sample_time_ms": 21284.959, "sample_throughput": 187.926, "load_time_ms": 0.294, "load_throughput": 13607929.272, "learn_time_ms": 4295.48, "learn_throughput": 931.211}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.662109375e-05, "cur_lr": 0.00010000000000000003, "total_loss": 2.2004092937796025, "policy_loss": -0.0005860724896993688, "vf_loss": 220.0995233945949, "vf_explained_var": 0.09162413798352724, "kl": 0.004997391719288732, "entropy": 0.269449962963981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 236000, "num_agent_steps_sampled": 236000, "num_steps_trained": 236000, "num_agent_steps_trained": 236000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2360, "training_iteration": 59, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-33-26", "timestamp": 1651062806, "time_this_iter_s": 20.88287377357483, "time_total_s": 1861.294937133789, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1861.294937133789, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 20.096551724137928, "ram_util_percent": 94.8344827586207}}
{"episode_reward_max": -13.4, "episode_reward_min": -130.4, "episode_reward_mean": -43.49700000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.900000000000013, -52.90000000000005, -13.4, -52.90000000000006, -32.8, -37.90000000000007, -24.800000000000026, -35.400000000000006, -32.50000000000001, -37.9, -14.0, -37.10000000000005, -86.5, -25.800000000000004, -19.7, -38.0, -28.70000000000004, -21.300000000000004, -33.7, -42.300000000000075, -31.700000000000006, -35.799999999999976, -43.30000000000001, -39.500000000000064, -17.5, -31.100000000000062, -15.6, -14.099999999999989, -35.30000000000001, -57.70000000000009, -130.4, -55.99999999999999, -54.50000000000004, -53.60000000000007, -56.50000000000005, -52.800000000000026, -19.9, -31.200000000000024, -46.40000000000006, -51.500000000000014, -19.499999999999996, -65.70000000000006, -38.30000000000002, -40.200000000000074, -24.700000000000006, -97.59999999999994, -27.900000000000013, -56.400000000000055, -28.800000000000058, -14.899999999999988, -105.29999999999995, -32.7, -25.100000000000005, -54.50000000000004, -113.39999999999988, -29.000000000000014, -128.39999999999984, -22.999999999999996, -52.90000000000007, -17.700000000000003, -40.00000000000002, -53.10000000000006, -39.400000000000006, -15.599999999999993, -30.00000000000001, -53.90000000000006, -36.50000000000005, -16.899999999999984, -50.40000000000004, -39.10000000000006, -29.500000000000046, -124.39999999999984, -51.90000000000005, -40.500000000000036, -26.0, -38.60000000000004, -36.40000000000004, -38.10000000000006, -23.5, -48.10000000000001, -13.699999999999998, -43.20000000000004, -38.30000000000004, -40.200000000000074, -24.900000000000006, -68.79999999999998, -32.9, -108.39999999999989, -29.0, -119.89999999999985, -39.4, -32.000000000000014, -37.40000000000001, -27.800000000000036, -15.999999999999996, -15.59999999999999, -31.500000000000018, -51.40000000000004, -128.39999999999984, -57.10000000000008], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6102039403621283, "mean_inference_ms": 0.6810530841165662, "mean_action_processing_ms": 1.2377457936896095, "mean_env_wait_ms": 4.2675113824592605, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 240000, "timesteps_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"sample_time_ms": 21282.483, "sample_throughput": 187.948, "load_time_ms": 0.295, "load_throughput": 13562826.192, "learn_time_ms": 4291.154, "learn_throughput": 932.15}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.8310546875e-05, "cur_lr": 0.00010000000000000003, "total_loss": 1.8736735232574966, "policy_loss": 0.004490146353360145, "vf_loss": 186.9183356192804, "vf_explained_var": -0.039521123260580084, "kl": 0.0032381603743259595, "entropy": 0.2730379650028803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 240000, "num_steps_trained": 240000, "num_agent_steps_trained": 240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2400, "training_iteration": 60, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-33-46", "timestamp": 1651062826, "time_this_iter_s": 20.77427911758423, "time_total_s": 1882.0692162513733, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1882.0692162513733, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 22.96428571428571, "ram_util_percent": 94.87500000000001}}
{"episode_reward_max": -12.299999999999999, "episode_reward_min": -142.39999999999978, "episode_reward_mean": -45.61300000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.499999999999996, -65.70000000000006, -38.30000000000002, -40.200000000000074, -24.700000000000006, -97.59999999999994, -27.900000000000013, -56.400000000000055, -28.800000000000058, -14.899999999999988, -105.29999999999995, -32.7, -25.100000000000005, -54.50000000000004, -113.39999999999988, -29.000000000000014, -128.39999999999984, -22.999999999999996, -52.90000000000007, -17.700000000000003, -40.00000000000002, -53.10000000000006, -39.400000000000006, -15.599999999999993, -30.00000000000001, -53.90000000000006, -36.50000000000005, -16.899999999999984, -50.40000000000004, -39.10000000000006, -29.500000000000046, -124.39999999999984, -51.90000000000005, -40.500000000000036, -26.0, -38.60000000000004, -36.40000000000004, -38.10000000000006, -23.5, -48.10000000000001, -13.699999999999998, -43.20000000000004, -38.30000000000004, -40.200000000000074, -24.900000000000006, -68.79999999999998, -32.9, -108.39999999999989, -29.0, -119.89999999999985, -39.4, -32.000000000000014, -37.40000000000001, -27.800000000000036, -15.999999999999996, -15.59999999999999, -31.500000000000018, -51.40000000000004, -128.39999999999984, -57.10000000000008, -12.299999999999999, -24.800000000000004, -52.2, -20.4, -17.399999999999988, -53.100000000000065, -31.80000000000001, -49.10000000000007, -53.900000000000034, -28.100000000000012, -40.400000000000034, -52.20000000000005, -51.600000000000044, -62.50000000000005, -21.0, -120.39999999999984, -35.000000000000036, -33.50000000000005, -54.000000000000064, -52.50000000000003, -46.80000000000003, -46.20000000000004, -22.600000000000037, -110.59999999999988, -37.199999999999996, -35.700000000000045, -142.39999999999978, -58.700000000000045, -51.600000000000065, -43.900000000000006, -22.700000000000045, -55.00000000000008, -25.7, -26.90000000000002, -38.30000000000006, -19.40000000000001, -26.60000000000002, -31.1, -34.30000000000003, -35.59999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6098678824009193, "mean_inference_ms": 0.6806696262794987, "mean_action_processing_ms": 1.217661732956482, "mean_env_wait_ms": 4.244362409291962, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 244000, "timesteps_this_iter": 0, "agent_timesteps_total": 244000, "timers": {"sample_time_ms": 21227.764, "sample_throughput": 188.432, "load_time_ms": 0.293, "load_throughput": 13664453.494, "learn_time_ms": 4291.625, "learn_throughput": 932.048}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.1552734375e-06, "cur_lr": 0.00010000000000000003, "total_loss": 1.8085567477089102, "policy_loss": -0.001512633721213988, "vf_loss": 181.00694028997933, "vf_explained_var": 0.05403795947310745, "kl": 0.00268767483118749, "entropy": 0.22071197337360793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 244000, "num_agent_steps_sampled": 244000, "num_steps_trained": 244000, "num_agent_steps_trained": 244000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2440, "training_iteration": 61, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-34-07", "timestamp": 1651062847, "time_this_iter_s": 20.786624908447266, "time_total_s": 1902.8558411598206, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1902.8558411598206, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 12.841379310344829, "ram_util_percent": 94.83103448275865}}
{"episode_reward_max": -9.799999999999999, "episode_reward_min": -142.39999999999978, "episode_reward_mean": -41.911000000000016, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.699999999999998, -43.20000000000004, -38.30000000000004, -40.200000000000074, -24.900000000000006, -68.79999999999998, -32.9, -108.39999999999989, -29.0, -119.89999999999985, -39.4, -32.000000000000014, -37.40000000000001, -27.800000000000036, -15.999999999999996, -15.59999999999999, -31.500000000000018, -51.40000000000004, -128.39999999999984, -57.10000000000008, -12.299999999999999, -24.800000000000004, -52.2, -20.4, -17.399999999999988, -53.100000000000065, -31.80000000000001, -49.10000000000007, -53.900000000000034, -28.100000000000012, -40.400000000000034, -52.20000000000005, -51.600000000000044, -62.50000000000005, -21.0, -120.39999999999984, -35.000000000000036, -33.50000000000005, -54.000000000000064, -52.50000000000003, -46.80000000000003, -46.20000000000004, -22.600000000000037, -110.59999999999988, -37.199999999999996, -35.700000000000045, -142.39999999999978, -58.700000000000045, -51.600000000000065, -43.900000000000006, -22.700000000000045, -55.00000000000008, -25.7, -26.90000000000002, -38.30000000000006, -19.40000000000001, -26.60000000000002, -31.1, -34.30000000000003, -35.59999999999999, -35.0, -34.000000000000036, -16.9, -46.70000000000005, -50.20000000000008, -25.9, -74.4999999999999, -53.20000000000005, -31.900000000000063, -38.30000000000002, -44.1, -16.099999999999984, -13.899999999999993, -19.20000000000001, -51.70000000000006, -52.50000000000003, -38.90000000000005, -36.50000000000001, -29.4, -38.800000000000026, -38.39999999999999, -27.80000000000001, -9.799999999999999, -40.99999999999992, -33.00000000000005, -17.599999999999994, -38.70000000000008, -28.1, -90.19999999999989, -44.400000000000055, -50.400000000000055, -56.500000000000085, -16.299999999999997, -32.0, -19.499999999999993, -48.800000000000004, -37.20000000000005, -17.399999999999984, -45.80000000000006, -17.099999999999987], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6092504710466062, "mean_inference_ms": 0.6800518866254902, "mean_action_processing_ms": 1.198229921892142, "mean_env_wait_ms": 4.221512394774122, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 248000, "timesteps_this_iter": 0, "agent_timesteps_total": 248000, "timers": {"sample_time_ms": 21167.478, "sample_throughput": 188.969, "load_time_ms": 0.293, "load_throughput": 13670020.37, "learn_time_ms": 4310.876, "learn_throughput": 927.886}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.57763671875e-06, "cur_lr": 0.00010000000000000003, "total_loss": 0.7266138789594494, "policy_loss": 0.0020955828824631307, "vf_loss": 72.45183073679605, "vf_explained_var": 0.06925490049905675, "kl": 0.0017068495768227873, "entropy": 0.31760965464736823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 248000, "num_agent_steps_sampled": 248000, "num_steps_trained": 248000, "num_agent_steps_trained": 248000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2480, "training_iteration": 62, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-34-28", "timestamp": 1651062868, "time_this_iter_s": 20.48894190788269, "time_total_s": 1923.3447830677032, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1923.3447830677032, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 19.15, "ram_util_percent": 94.85714285714286}}
{"episode_reward_max": -9.799999999999999, "episode_reward_min": -521.6000000000012, "episode_reward_mean": -44.51900000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.80000000000003, -46.20000000000004, -22.600000000000037, -110.59999999999988, -37.199999999999996, -35.700000000000045, -142.39999999999978, -58.700000000000045, -51.600000000000065, -43.900000000000006, -22.700000000000045, -55.00000000000008, -25.7, -26.90000000000002, -38.30000000000006, -19.40000000000001, -26.60000000000002, -31.1, -34.30000000000003, -35.59999999999999, -35.0, -34.000000000000036, -16.9, -46.70000000000005, -50.20000000000008, -25.9, -74.4999999999999, -53.20000000000005, -31.900000000000063, -38.30000000000002, -44.1, -16.099999999999984, -13.899999999999993, -19.20000000000001, -51.70000000000006, -52.50000000000003, -38.90000000000005, -36.50000000000001, -29.4, -38.800000000000026, -38.39999999999999, -27.80000000000001, -9.799999999999999, -40.99999999999992, -33.00000000000005, -17.599999999999994, -38.70000000000008, -28.1, -90.19999999999989, -44.400000000000055, -50.400000000000055, -56.500000000000085, -16.299999999999997, -32.0, -19.499999999999993, -48.800000000000004, -37.20000000000005, -17.399999999999984, -45.80000000000006, -17.099999999999987, -41.00000000000002, -50.40000000000005, -37.20000000000006, -37.5, -51.50000000000003, -48.79999999999994, -51.30000000000003, -24.000000000000007, -53.40000000000009, -35.0, -17.500000000000014, -38.10000000000005, -51.600000000000065, -133.3999999999998, -521.6000000000012, -16.59999999999999, -26.300000000000004, -30.40000000000005, -51.60000000000005, -32.29999999999996, -27.1, -38.10000000000007, -49.40000000000006, -52.00000000000004, -89.2, -35.100000000000065, -56.90000000000006, -19.199999999999996, -52.400000000000034, -27.700000000000006, -28.30000000000001, -46.0, -16.09999999999999, -19.4, -14.1, -36.49999999999999, -14.799999999999997, -18.900000000000002, -22.299999999999997, -69.90000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6083697166758902, "mean_inference_ms": 0.6796323211924874, "mean_action_processing_ms": 1.1794291007078122, "mean_env_wait_ms": 4.200158583577649, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 252000, "timesteps_this_iter": 0, "agent_timesteps_total": 252000, "timers": {"sample_time_ms": 21136.879, "sample_throughput": 189.243, "load_time_ms": 0.294, "load_throughput": 13610137.097, "learn_time_ms": 4306.23, "learn_throughput": 928.887}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.288818359375e-06, "cur_lr": 0.00010000000000000003, "total_loss": 12.569618654767833, "policy_loss": -0.0092185907456423, "vf_loss": 1257.8837506981306, "vf_explained_var": 0.0037967015338200394, "kl": 0.01067705360632772, "entropy": 0.26569147758906886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 252000, "num_agent_steps_sampled": 252000, "num_steps_trained": 252000, "num_agent_steps_trained": 252000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2520, "training_iteration": 63, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-34-49", "timestamp": 1651062889, "time_this_iter_s": 21.230555772781372, "time_total_s": 1944.5753388404846, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1944.5753388404846, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 21.917241379310347, "ram_util_percent": 95.11379310344824}}
{"episode_reward_max": -9.799999999999999, "episode_reward_min": -521.6000000000012, "episode_reward_mean": -43.28100000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.39999999999999, -27.80000000000001, -9.799999999999999, -40.99999999999992, -33.00000000000005, -17.599999999999994, -38.70000000000008, -28.1, -90.19999999999989, -44.400000000000055, -50.400000000000055, -56.500000000000085, -16.299999999999997, -32.0, -19.499999999999993, -48.800000000000004, -37.20000000000005, -17.399999999999984, -45.80000000000006, -17.099999999999987, -41.00000000000002, -50.40000000000005, -37.20000000000006, -37.5, -51.50000000000003, -48.79999999999994, -51.30000000000003, -24.000000000000007, -53.40000000000009, -35.0, -17.500000000000014, -38.10000000000005, -51.600000000000065, -133.3999999999998, -521.6000000000012, -16.59999999999999, -26.300000000000004, -30.40000000000005, -51.60000000000005, -32.29999999999996, -27.1, -38.10000000000007, -49.40000000000006, -52.00000000000004, -89.2, -35.100000000000065, -56.90000000000006, -19.199999999999996, -52.400000000000034, -27.700000000000006, -28.30000000000001, -46.0, -16.09999999999999, -19.4, -14.1, -36.49999999999999, -14.799999999999997, -18.900000000000002, -22.299999999999997, -69.90000000000006, -42.100000000000065, -44.70000000000004, -67.00000000000006, -24.400000000000006, -49.000000000000064, -21.10000000000001, -27.600000000000023, -32.50000000000002, -50.60000000000006, -16.699999999999996, -69.70000000000003, -33.500000000000064, -72.30000000000005, -15.8, -21.20000000000001, -25.0, -36.9, -12.699999999999998, -44.700000000000045, -28.20000000000003, -33.10000000000001, -31.10000000000001, -44.300000000000054, -54.30000000000004, -19.600000000000005, -13.5, -32.90000000000006, -13.3, -54.800000000000054, -34.099999999999994, -34.50000000000001, -23.400000000000002, -16.3, -53.800000000000054, -53.000000000000036, -47.900000000000034, -15.999999999999996, -36.2, -46.20000000000004, -141.1999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6080535614618491, "mean_inference_ms": 0.6788645074566105, "mean_action_processing_ms": 1.1612171735764476, "mean_env_wait_ms": 4.178848995724414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 256000, "timesteps_this_iter": 0, "agent_timesteps_total": 256000, "timers": {"sample_time_ms": 21046.008, "sample_throughput": 190.06, "load_time_ms": 0.294, "load_throughput": 13604618.878, "learn_time_ms": 4284.395, "learn_throughput": 933.621}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.288818359375e-06, "cur_lr": 0.00010000000000000003, "total_loss": 1.1624414353735335, "policy_loss": -0.0006436816096225733, "vf_loss": 116.30851605528144, "vf_explained_var": 0.02099954338483913, "kl": 0.0016633457683526672, "entropy": 0.2614418150436494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 256000, "num_agent_steps_sampled": 256000, "num_steps_trained": 256000, "num_agent_steps_trained": 256000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2560, "training_iteration": 64, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-35-09", "timestamp": 1651062909, "time_this_iter_s": 20.09880781173706, "time_total_s": 1964.6741466522217, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1964.6741466522217, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 12.725, "ram_util_percent": 95.12499999999997}}
{"episode_reward_max": -10.1, "episode_reward_min": -141.1999999999998, "episode_reward_mean": -37.56500000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.1, -38.10000000000007, -49.40000000000006, -52.00000000000004, -89.2, -35.100000000000065, -56.90000000000006, -19.199999999999996, -52.400000000000034, -27.700000000000006, -28.30000000000001, -46.0, -16.09999999999999, -19.4, -14.1, -36.49999999999999, -14.799999999999997, -18.900000000000002, -22.299999999999997, -69.90000000000006, -42.100000000000065, -44.70000000000004, -67.00000000000006, -24.400000000000006, -49.000000000000064, -21.10000000000001, -27.600000000000023, -32.50000000000002, -50.60000000000006, -16.699999999999996, -69.70000000000003, -33.500000000000064, -72.30000000000005, -15.8, -21.20000000000001, -25.0, -36.9, -12.699999999999998, -44.700000000000045, -28.20000000000003, -33.10000000000001, -31.10000000000001, -44.300000000000054, -54.30000000000004, -19.600000000000005, -13.5, -32.90000000000006, -13.3, -54.800000000000054, -34.099999999999994, -34.50000000000001, -23.400000000000002, -16.3, -53.800000000000054, -53.000000000000036, -47.900000000000034, -15.999999999999996, -36.2, -46.20000000000004, -141.1999999999998, -17.699999999999996, -37.60000000000001, -56.00000000000008, -41.500000000000064, -35.60000000000002, -58.1, -50.20000000000006, -113.49999999999987, -27.400000000000006, -71.20000000000014, -19.900000000000016, -52.90000000000005, -22.5, -14.999999999999996, -21.400000000000013, -39.70000000000006, -55.90000000000008, -16.099999999999994, -15.199999999999998, -19.599999999999994, -53.30000000000004, -44.00000000000008, -32.09999999999998, -22.900000000000013, -50.700000000000024, -49.200000000000045, -35.90000000000006, -39.0, -10.1, -26.700000000000003, -13.6, -28.800000000000004, -46.50000000000006, -23.500000000000014, -12.79999999999999, -20.099999999999998, -50.000000000000036, -30.20000000000001, -38.00000000000002, -73.50000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6081315051268096, "mean_inference_ms": 0.6779209301147964, "mean_action_processing_ms": 1.1435649702745103, "mean_env_wait_ms": 4.157870886794302, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 260000, "timesteps_this_iter": 0, "agent_timesteps_total": 260000, "timers": {"sample_time_ms": 20966.576, "sample_throughput": 190.78, "load_time_ms": 0.293, "load_throughput": 13631147.221, "learn_time_ms": 4224.483, "learn_throughput": 946.861}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1444091796875e-06, "cur_lr": 0.00010000000000000003, "total_loss": 1.0603300289230881, "policy_loss": 0.0012550806826961938, "vf_loss": 105.90749694455054, "vf_explained_var": -0.08704538999065276, "kl": 0.0038052279057902527, "entropy": 0.3231446533994649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 260000, "num_agent_steps_sampled": 260000, "num_steps_trained": 260000, "num_agent_steps_trained": 260000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2600, "training_iteration": 65, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-35-30", "timestamp": 1651062930, "time_this_iter_s": 20.57159423828125, "time_total_s": 1985.245740890503, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1985.245740890503, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 13.321428571428571, "ram_util_percent": 95.18214285714285}}
{"episode_reward_max": -10.1, "episode_reward_min": -141.1999999999998, "episode_reward_mean": -40.189000000000014, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.10000000000001, -31.10000000000001, -44.300000000000054, -54.30000000000004, -19.600000000000005, -13.5, -32.90000000000006, -13.3, -54.800000000000054, -34.099999999999994, -34.50000000000001, -23.400000000000002, -16.3, -53.800000000000054, -53.000000000000036, -47.900000000000034, -15.999999999999996, -36.2, -46.20000000000004, -141.1999999999998, -17.699999999999996, -37.60000000000001, -56.00000000000008, -41.500000000000064, -35.60000000000002, -58.1, -50.20000000000006, -113.49999999999987, -27.400000000000006, -71.20000000000014, -19.900000000000016, -52.90000000000005, -22.5, -14.999999999999996, -21.400000000000013, -39.70000000000006, -55.90000000000008, -16.099999999999994, -15.199999999999998, -19.599999999999994, -53.30000000000004, -44.00000000000008, -32.09999999999998, -22.900000000000013, -50.700000000000024, -49.200000000000045, -35.90000000000006, -39.0, -10.1, -26.700000000000003, -13.6, -28.800000000000004, -46.50000000000006, -23.500000000000014, -12.79999999999999, -20.099999999999998, -50.000000000000036, -30.20000000000001, -38.00000000000002, -73.50000000000004, -53.70000000000004, -45.19999999999992, -63.40000000000006, -47.80000000000008, -19.800000000000004, -14.499999999999998, -47.100000000000044, -56.10000000000009, -31.10000000000006, -38.000000000000064, -21.20000000000001, -85.39999999999996, -15.899999999999997, -30.200000000000014, -99.49999999999993, -24.500000000000004, -45.400000000000006, -51.80000000000002, -34.6, -25.000000000000007, -14.5, -29.599999999999998, -31.100000000000023, -19.700000000000003, -91.4, -45.100000000000044, -27.500000000000007, -122.99999999999984, -63.10000000000007, -18.0, -31.60000000000005, -22.9, -82.39999999999999, -58.800000000000004, -36.80000000000005, -24.700000000000003, -38.100000000000065, -40.60000000000005, -52.50000000000006, -29.900000000000013], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6082298137353495, "mean_inference_ms": 0.6771990039469747, "mean_action_processing_ms": 1.126452268704853, "mean_env_wait_ms": 4.137104356664076, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 264000, "timesteps_this_iter": 0, "agent_timesteps_total": 264000, "timers": {"sample_time_ms": 20837.644, "sample_throughput": 191.96, "load_time_ms": 0.295, "load_throughput": 13542025.991, "learn_time_ms": 4203.187, "learn_throughput": 951.659}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.7220458984375e-07, "cur_lr": 0.00010000000000000003, "total_loss": 1.6187872334002888, "policy_loss": 0.0024550121292592057, "vf_loss": 161.63322678022487, "vf_explained_var": -0.006247431552538308, "kl": 0.003912240846980473, "entropy": 0.2674331461309746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 264000, "num_agent_steps_sampled": 264000, "num_steps_trained": 264000, "num_agent_steps_trained": 264000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2640, "training_iteration": 66, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-35-50", "timestamp": 1651062950, "time_this_iter_s": 20.452035188674927, "time_total_s": 2005.6977760791779, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2005.6977760791779, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 17.7, "ram_util_percent": 95.14444444444443}}
{"episode_reward_max": -10.1, "episode_reward_min": -153.69999999999976, "episode_reward_mean": -39.878000000000014, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-53.30000000000004, -44.00000000000008, -32.09999999999998, -22.900000000000013, -50.700000000000024, -49.200000000000045, -35.90000000000006, -39.0, -10.1, -26.700000000000003, -13.6, -28.800000000000004, -46.50000000000006, -23.500000000000014, -12.79999999999999, -20.099999999999998, -50.000000000000036, -30.20000000000001, -38.00000000000002, -73.50000000000004, -53.70000000000004, -45.19999999999992, -63.40000000000006, -47.80000000000008, -19.800000000000004, -14.499999999999998, -47.100000000000044, -56.10000000000009, -31.10000000000006, -38.000000000000064, -21.20000000000001, -85.39999999999996, -15.899999999999997, -30.200000000000014, -99.49999999999993, -24.500000000000004, -45.400000000000006, -51.80000000000002, -34.6, -25.000000000000007, -14.5, -29.599999999999998, -31.100000000000023, -19.700000000000003, -91.4, -45.100000000000044, -27.500000000000007, -122.99999999999984, -63.10000000000007, -18.0, -31.60000000000005, -22.9, -82.39999999999999, -58.800000000000004, -36.80000000000005, -24.700000000000003, -38.100000000000065, -40.60000000000005, -52.50000000000006, -29.900000000000013, -14.6, -15.799999999999999, -31.8, -21.599999999999998, -20.799999999999997, -27.900000000000013, -17.6, -52.30000000000003, -13.3, -11.999999999999998, -21.4, -38.90000000000003, -54.20000000000005, -30.30000000000001, -54.60000000000003, -78.79999999999995, -16.199999999999992, -153.69999999999976, -21.100000000000016, -15.099999999999989, -41.10000000000005, -48.90000000000007, -19.60000000000001, -52.500000000000036, -34.800000000000004, -26.000000000000018, -60.200000000000095, -53.6000000000001, -24.700000000000003, -18.800000000000004, -42.10000000000003, -36.099999999999994, -34.4, -33.90000000000003, -50.80000000000003, -23.3, -17.799999999999997, -129.2999999999998, -40.600000000000065, -54.90000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6074671024839403, "mean_inference_ms": 0.6764923445801468, "mean_action_processing_ms": 1.109850267776409, "mean_env_wait_ms": 4.117073569622113, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 268000, "timesteps_this_iter": 0, "agent_timesteps_total": 268000, "timers": {"sample_time_ms": 20680.782, "sample_throughput": 193.416, "load_time_ms": 0.244, "load_throughput": 16374405.622, "learn_time_ms": 4186.319, "learn_throughput": 955.493}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.86102294921875e-07, "cur_lr": 0.00010000000000000003, "total_loss": 1.6964850846117223, "policy_loss": 0.0033928520056188747, "vf_loss": 169.30922726867018, "vf_explained_var": -0.05051816977480406, "kl": 0.006413526326905847, "entropy": 0.3162065048772161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 268000, "num_agent_steps_sampled": 268000, "num_steps_trained": 268000, "num_agent_steps_trained": 268000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2680, "training_iteration": 67, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-36-10", "timestamp": 1651062970, "time_this_iter_s": 19.908958911895752, "time_total_s": 2025.6067349910736, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2025.6067349910736, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 17.710714285714285, "ram_util_percent": 95.09999999999998}}
{"episode_reward_max": -8.299999999999999, "episode_reward_min": -156.59999999999974, "episode_reward_mean": -42.898, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.5, -29.599999999999998, -31.100000000000023, -19.700000000000003, -91.4, -45.100000000000044, -27.500000000000007, -122.99999999999984, -63.10000000000007, -18.0, -31.60000000000005, -22.9, -82.39999999999999, -58.800000000000004, -36.80000000000005, -24.700000000000003, -38.100000000000065, -40.60000000000005, -52.50000000000006, -29.900000000000013, -14.6, -15.799999999999999, -31.8, -21.599999999999998, -20.799999999999997, -27.900000000000013, -17.6, -52.30000000000003, -13.3, -11.999999999999998, -21.4, -38.90000000000003, -54.20000000000005, -30.30000000000001, -54.60000000000003, -78.79999999999995, -16.199999999999992, -153.69999999999976, -21.100000000000016, -15.099999999999989, -41.10000000000005, -48.90000000000007, -19.60000000000001, -52.500000000000036, -34.800000000000004, -26.000000000000018, -60.200000000000095, -53.6000000000001, -24.700000000000003, -18.800000000000004, -42.10000000000003, -36.099999999999994, -34.4, -33.90000000000003, -50.80000000000003, -23.3, -17.799999999999997, -129.2999999999998, -40.600000000000065, -54.90000000000006, -8.299999999999999, -44.80000000000004, -15.699999999999998, -38.10000000000005, -48.60000000000008, -18.8, -56.90000000000007, -54.40000000000004, -25.800000000000008, -39.40000000000005, -51.000000000000114, -52.600000000000044, -156.59999999999974, -17.700000000000003, -52.10000000000003, -141.9999999999998, -44.100000000000065, -20.400000000000002, -146.3, -27.799999999999997, -61.0, -14.999999999999998, -13.5, -83.09999999999998, -53.700000000000045, -36.90000000000005, -72.49999999999999, -16.89999999999999, -17.299999999999997, -29.60000000000001, -24.300000000000004, -22.400000000000013, -117.69999999999983, -14.89999999999999, -33.60000000000002, -40.30000000000003, -50.40000000000005, -11.7, -67.00000000000006, -9.899999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6068044264495164, "mean_inference_ms": 0.6757322535347862, "mean_action_processing_ms": 1.0937444192161478, "mean_env_wait_ms": 4.097620709957194, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 272000, "timesteps_this_iter": 0, "agent_timesteps_total": 272000, "timers": {"sample_time_ms": 20610.46, "sample_throughput": 194.076, "load_time_ms": 0.242, "load_throughput": 16498393.156, "learn_time_ms": 4183.437, "learn_throughput": 956.152}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.86102294921875e-07, "cur_lr": 0.00010000000000000003, "total_loss": 2.4578906778090945, "policy_loss": 0.001169600897538726, "vf_loss": 245.67211142099032, "vf_explained_var": -0.07351585620193071, "kl": 0.003912897738997111, "entropy": 0.3146629103249119, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 272000, "num_agent_steps_sampled": 272000, "num_steps_trained": 272000, "num_agent_steps_trained": 272000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2720, "training_iteration": 68, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-36-31", "timestamp": 1651062991, "time_this_iter_s": 20.623069047927856, "time_total_s": 2046.2298040390015, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2046.2298040390015, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 13.939285714285715, "ram_util_percent": 95.10714285714285}}
{"episode_reward_max": -8.2, "episode_reward_min": -189.5999999999996, "episode_reward_mean": -44.05000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.10000000000005, -48.90000000000007, -19.60000000000001, -52.500000000000036, -34.800000000000004, -26.000000000000018, -60.200000000000095, -53.6000000000001, -24.700000000000003, -18.800000000000004, -42.10000000000003, -36.099999999999994, -34.4, -33.90000000000003, -50.80000000000003, -23.3, -17.799999999999997, -129.2999999999998, -40.600000000000065, -54.90000000000006, -8.299999999999999, -44.80000000000004, -15.699999999999998, -38.10000000000005, -48.60000000000008, -18.8, -56.90000000000007, -54.40000000000004, -25.800000000000008, -39.40000000000005, -51.000000000000114, -52.600000000000044, -156.59999999999974, -17.700000000000003, -52.10000000000003, -141.9999999999998, -44.100000000000065, -20.400000000000002, -146.3, -27.799999999999997, -61.0, -14.999999999999998, -13.5, -83.09999999999998, -53.700000000000045, -36.90000000000005, -72.49999999999999, -16.89999999999999, -17.299999999999997, -29.60000000000001, -24.300000000000004, -22.400000000000013, -117.69999999999983, -14.89999999999999, -33.60000000000002, -40.30000000000003, -50.40000000000005, -11.7, -67.00000000000006, -9.899999999999997, -33.2, -22.3, -29.400000000000002, -56.80000000000006, -31.6, -53.50000000000004, -18.9, -47.7, -50.600000000000136, -8.2, -53.000000000000036, -23.70000000000001, -54.80000000000003, -41.100000000000044, -55.10000000000009, -50.30000000000006, -21.300000000000015, -24.1, -34.099999999999994, -42.5, -37.400000000000055, -22.300000000000036, -80.10000000000001, -36.800000000000054, -189.5999999999996, -47.00000000000005, -57.70000000000005, -57.30000000000004, -52.30000000000003, -15.499999999999998, -25.300000000000008, -62.1999999999999, -46.40000000000006, -35.40000000000002, -17.099999999999998, -23.300000000000004, -14.399999999999999, -34.90000000000001, -50.49999999999991, -50.800000000000054], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6063492288050979, "mean_inference_ms": 0.6755555223885878, "mean_action_processing_ms": 1.0781336459473245, "mean_env_wait_ms": 4.079483935583052, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 276000, "timesteps_this_iter": 0, "agent_timesteps_total": 276000, "timers": {"sample_time_ms": 20641.073, "sample_throughput": 193.788, "load_time_ms": 0.241, "load_throughput": 16588111.529, "learn_time_ms": 4193.301, "learn_throughput": 953.902}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.430511474609375e-07, "cur_lr": 0.00010000000000000003, "total_loss": 1.751851646510023, "policy_loss": 0.005363175369078113, "vf_loss": 174.64885148284256, "vf_explained_var": 0.08043592783712572, "kl": 0.004439966943510112, "entropy": 0.21800923949127557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 276000, "num_agent_steps_sampled": 276000, "num_steps_trained": 276000, "num_agent_steps_trained": 276000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2760, "training_iteration": 69, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-36-52", "timestamp": 1651063012, "time_this_iter_s": 21.32448673248291, "time_total_s": 2067.5542907714844, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2067.5542907714844, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 17.858620689655176, "ram_util_percent": 95.16206896551724}}
{"episode_reward_max": -8.2, "episode_reward_min": -189.5999999999996, "episode_reward_mean": -40.21700000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-61.0, -14.999999999999998, -13.5, -83.09999999999998, -53.700000000000045, -36.90000000000005, -72.49999999999999, -16.89999999999999, -17.299999999999997, -29.60000000000001, -24.300000000000004, -22.400000000000013, -117.69999999999983, -14.89999999999999, -33.60000000000002, -40.30000000000003, -50.40000000000005, -11.7, -67.00000000000006, -9.899999999999997, -33.2, -22.3, -29.400000000000002, -56.80000000000006, -31.6, -53.50000000000004, -18.9, -47.7, -50.600000000000136, -8.2, -53.000000000000036, -23.70000000000001, -54.80000000000003, -41.100000000000044, -55.10000000000009, -50.30000000000006, -21.300000000000015, -24.1, -34.099999999999994, -42.5, -37.400000000000055, -22.300000000000036, -80.10000000000001, -36.800000000000054, -189.5999999999996, -47.00000000000005, -57.70000000000005, -57.30000000000004, -52.30000000000003, -15.499999999999998, -25.300000000000008, -62.1999999999999, -46.40000000000006, -35.40000000000002, -17.099999999999998, -23.300000000000004, -14.399999999999999, -34.90000000000001, -50.49999999999991, -50.800000000000054, -32.70000000000001, -20.700000000000006, -37.800000000000026, -75.20000000000013, -43.30000000000006, -19.7, -30.700000000000042, -27.6, -54.60000000000002, -76.7, -12.499999999999996, -27.9, -65.30000000000007, -37.60000000000007, -40.399999999999984, -55.40000000000003, -17.9, -34.70000000000002, -42.00000000000003, -64.30000000000001, -17.599999999999998, -32.7, -44.50000000000007, -26.199999999999996, -28.500000000000036, -34.5, -36.800000000000026, -38.500000000000064, -54.30000000000007, -52.900000000000034, -52.100000000000044, -26.200000000000006, -21.800000000000004, -34.0, -47.199999999999946, -46.900000000000055, -42.700000000000024, -24.400000000000016, -30.400000000000002, -12.299999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6062985225312335, "mean_inference_ms": 0.6755950499879692, "mean_action_processing_ms": 1.0629809160930008, "mean_env_wait_ms": 4.061949626720356, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 280000, "timesteps_this_iter": 0, "agent_timesteps_total": 280000, "timers": {"sample_time_ms": 20641.343, "sample_throughput": 193.786, "load_time_ms": 0.239, "load_throughput": 16768831.584, "learn_time_ms": 4201.272, "learn_throughput": 952.093}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.152557373046875e-08, "cur_lr": 0.00010000000000000003, "total_loss": 0.759042752574208, "policy_loss": 0.001910071391412007, "vf_loss": 75.71327026326169, "vf_explained_var": 0.17713341007950487, "kl": 0.0018882727956052105, "entropy": 0.20040652481939203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 280000, "num_agent_steps_sampled": 280000, "num_steps_trained": 280000, "num_agent_steps_trained": 280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2800, "training_iteration": 70, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-37-13", "timestamp": 1651063033, "time_this_iter_s": 20.759469985961914, "time_total_s": 2088.3137607574463, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2088.3137607574463, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 18.846428571428564, "ram_util_percent": 95.21785714285714}}
{"episode_reward_max": -11.299999999999999, "episode_reward_min": -189.5999999999996, "episode_reward_mean": -39.49800000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.400000000000055, -22.300000000000036, -80.10000000000001, -36.800000000000054, -189.5999999999996, -47.00000000000005, -57.70000000000005, -57.30000000000004, -52.30000000000003, -15.499999999999998, -25.300000000000008, -62.1999999999999, -46.40000000000006, -35.40000000000002, -17.099999999999998, -23.300000000000004, -14.399999999999999, -34.90000000000001, -50.49999999999991, -50.800000000000054, -32.70000000000001, -20.700000000000006, -37.800000000000026, -75.20000000000013, -43.30000000000006, -19.7, -30.700000000000042, -27.6, -54.60000000000002, -76.7, -12.499999999999996, -27.9, -65.30000000000007, -37.60000000000007, -40.399999999999984, -55.40000000000003, -17.9, -34.70000000000002, -42.00000000000003, -64.30000000000001, -17.599999999999998, -32.7, -44.50000000000007, -26.199999999999996, -28.500000000000036, -34.5, -36.800000000000026, -38.500000000000064, -54.30000000000007, -52.900000000000034, -52.100000000000044, -26.200000000000006, -21.800000000000004, -34.0, -47.199999999999946, -46.900000000000055, -42.700000000000024, -24.400000000000016, -30.400000000000002, -12.299999999999999, -28.7, -28.5, -19.0, -18.900000000000013, -14.599999999999989, -20.4, -13.79999999999999, -75.80000000000001, -32.20000000000005, -70.70000000000003, -29.40000000000002, -52.900000000000055, -12.600000000000001, -51.00000000000003, -23.4, -39.80000000000006, -19.89999999999999, -29.3, -11.299999999999999, -41.00000000000001, -17.5, -43.60000000000004, -64.20000000000007, -15.199999999999998, -19.900000000000006, -72.3000000000001, -56.499999999999915, -44.5, -44.60000000000006, -56.30000000000008, -25.2, -27.90000000000001, -37.500000000000014, -40.900000000000006, -36.80000000000005, -57.50000000000007, -17.7, -46.1, -53.30000000000003, -61.30000000000008], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.606059448589533, "mean_inference_ms": 0.6754446344693172, "mean_action_processing_ms": 1.0482527844546203, "mean_env_wait_ms": 4.04489981301878, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 284000, "timesteps_this_iter": 0, "agent_timesteps_total": 284000, "timers": {"sample_time_ms": 20638.803, "sample_throughput": 193.81, "load_time_ms": 0.239, "load_throughput": 16720366.753, "learn_time_ms": 4189.546, "learn_throughput": 954.757}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.5762786865234374e-08, "cur_lr": 0.00010000000000000003, "total_loss": 0.8619342764524082, "policy_loss": 0.000984171741912442, "vf_loss": 86.09501245457639, "vf_explained_var": -0.0014463464419047038, "kl": 0.0064333916768196196, "entropy": 0.29952468157455486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 284000, "num_agent_steps_sampled": 284000, "num_steps_trained": 284000, "num_agent_steps_trained": 284000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2840, "training_iteration": 71, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-37-34", "timestamp": 1651063054, "time_this_iter_s": 20.565366983413696, "time_total_s": 2108.87912774086, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2108.87912774086, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 9.528571428571428, "ram_util_percent": 95.23571428571427}}
{"episode_reward_max": -11.299999999999999, "episode_reward_min": -75.80000000000001, "episode_reward_mean": -35.62500000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.599999999999998, -32.7, -44.50000000000007, -26.199999999999996, -28.500000000000036, -34.5, -36.800000000000026, -38.500000000000064, -54.30000000000007, -52.900000000000034, -52.100000000000044, -26.200000000000006, -21.800000000000004, -34.0, -47.199999999999946, -46.900000000000055, -42.700000000000024, -24.400000000000016, -30.400000000000002, -12.299999999999999, -28.7, -28.5, -19.0, -18.900000000000013, -14.599999999999989, -20.4, -13.79999999999999, -75.80000000000001, -32.20000000000005, -70.70000000000003, -29.40000000000002, -52.900000000000055, -12.600000000000001, -51.00000000000003, -23.4, -39.80000000000006, -19.89999999999999, -29.3, -11.299999999999999, -41.00000000000001, -17.5, -43.60000000000004, -64.20000000000007, -15.199999999999998, -19.900000000000006, -72.3000000000001, -56.499999999999915, -44.5, -44.60000000000006, -56.30000000000008, -25.2, -27.90000000000001, -37.500000000000014, -40.900000000000006, -36.80000000000005, -57.50000000000007, -17.7, -46.1, -53.30000000000003, -61.30000000000008, -35.20000000000006, -54.000000000000064, -27.000000000000007, -48.1, -28.59999999999998, -16.6, -52.10000000000002, -21.80000000000001, -34.70000000000004, -15.4, -11.599999999999994, -25.300000000000022, -57.200000000000045, -23.9, -44.50000000000007, -14.29999999999999, -47.70000000000008, -53.60000000000006, -22.300000000000008, -38.6, -41.10000000000001, -16.399999999999988, -16.599999999999998, -52.60000000000004, -33.69999999999999, -58.20000000000004, -33.30000000000004, -21.20000000000001, -43.800000000000054, -30.800000000000036, -50.40000000000005, -16.69999999999999, -39.30000000000004, -30.39999999999996, -36.900000000000006, -26.6, -47.09999999999998, -52.10000000000002, -43.40000000000007, -22.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6059499834431026, "mean_inference_ms": 0.6748022581447889, "mean_action_processing_ms": 1.0339291651363332, "mean_env_wait_ms": 4.027729243938247, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 288000, "timesteps_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"sample_time_ms": 20632.33, "sample_throughput": 193.87, "load_time_ms": 0.362, "load_throughput": 11060928.27, "learn_time_ms": 4161.206, "learn_throughput": 961.26}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.5762786865234374e-08, "cur_lr": 0.00010000000000000003, "total_loss": 0.5796973106366212, "policy_loss": -0.00018618099131090666, "vf_loss": 57.98835051136632, "vf_explained_var": 0.03113782957036008, "kl": 0.0031862083664055997, "entropy": 0.28653502997051006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 288000, "num_agent_steps_sampled": 288000, "num_steps_trained": 288000, "num_agent_steps_trained": 288000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2880, "training_iteration": 72, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-37-54", "timestamp": 1651063074, "time_this_iter_s": 20.263020038604736, "time_total_s": 2129.1421477794647, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2129.1421477794647, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 14.057142857142859, "ram_util_percent": 95.20714285714283}}
{"episode_reward_max": -9.6, "episode_reward_min": -76.0, "episode_reward_mean": -36.770000000000024, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.5, -43.60000000000004, -64.20000000000007, -15.199999999999998, -19.900000000000006, -72.3000000000001, -56.499999999999915, -44.5, -44.60000000000006, -56.30000000000008, -25.2, -27.90000000000001, -37.500000000000014, -40.900000000000006, -36.80000000000005, -57.50000000000007, -17.7, -46.1, -53.30000000000003, -61.30000000000008, -35.20000000000006, -54.000000000000064, -27.000000000000007, -48.1, -28.59999999999998, -16.6, -52.10000000000002, -21.80000000000001, -34.70000000000004, -15.4, -11.599999999999994, -25.300000000000022, -57.200000000000045, -23.9, -44.50000000000007, -14.29999999999999, -47.70000000000008, -53.60000000000006, -22.300000000000008, -38.6, -41.10000000000001, -16.399999999999988, -16.599999999999998, -52.60000000000004, -33.69999999999999, -58.20000000000004, -33.30000000000004, -21.20000000000001, -43.800000000000054, -30.800000000000036, -50.40000000000005, -16.69999999999999, -39.30000000000004, -30.39999999999996, -36.900000000000006, -26.6, -47.09999999999998, -52.10000000000002, -43.40000000000007, -22.9, -62.40000000000009, -28.300000000000004, -50.40000000000005, -18.400000000000016, -27.20000000000005, -41.60000000000008, -13.699999999999987, -38.80000000000007, -48.30000000000007, -54.00000000000007, -56.10000000000004, -39.900000000000006, -22.300000000000026, -11.8, -9.6, -52.500000000000064, -29.000000000000007, -18.60000000000001, -19.799999999999997, -41.80000000000007, -54.80000000000006, -28.100000000000033, -51.70000000000004, -24.800000000000022, -14.899999999999999, -16.099999999999994, -48.80000000000007, -52.70000000000004, -35.80000000000006, -45.40000000000007, -76.0, -23.6, -50.80000000000005, -13.299999999999999, -53.70000000000003, -52.50000000000005, -32.5, -32.6, -35.20000000000002, -24.400000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6058252325495753, "mean_inference_ms": 0.6740907966217219, "mean_action_processing_ms": 1.0200011367631985, "mean_env_wait_ms": 4.011060433857432, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 292000, "timesteps_this_iter": 0, "agent_timesteps_total": 292000, "timers": {"sample_time_ms": 20545.126, "sample_throughput": 194.693, "load_time_ms": 0.362, "load_throughput": 11060199.09, "learn_time_ms": 4155.936, "learn_throughput": 962.479}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7881393432617187e-08, "cur_lr": 0.00010000000000000003, "total_loss": 0.7707112212865663, "policy_loss": 0.005719706467202594, "vf_loss": 76.49915338946927, "vf_explained_var": 0.03420562244230701, "kl": 0.004839442737391097, "entropy": 0.2688954733712699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 292000, "num_agent_steps_sampled": 292000, "num_steps_trained": 292000, "num_agent_steps_trained": 292000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2920, "training_iteration": 73, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-38-14", "timestamp": 1651063094, "time_this_iter_s": 20.599009037017822, "time_total_s": 2149.7411568164825, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2149.7411568164825, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 18.885714285714283, "ram_util_percent": 95.20714285714284}}
{"episode_reward_max": -9.6, "episode_reward_min": -788.1000000000009, "episode_reward_mean": -44.412000000000035, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.10000000000001, -16.399999999999988, -16.599999999999998, -52.60000000000004, -33.69999999999999, -58.20000000000004, -33.30000000000004, -21.20000000000001, -43.800000000000054, -30.800000000000036, -50.40000000000005, -16.69999999999999, -39.30000000000004, -30.39999999999996, -36.900000000000006, -26.6, -47.09999999999998, -52.10000000000002, -43.40000000000007, -22.9, -62.40000000000009, -28.300000000000004, -50.40000000000005, -18.400000000000016, -27.20000000000005, -41.60000000000008, -13.699999999999987, -38.80000000000007, -48.30000000000007, -54.00000000000007, -56.10000000000004, -39.900000000000006, -22.300000000000026, -11.8, -9.6, -52.500000000000064, -29.000000000000007, -18.60000000000001, -19.799999999999997, -41.80000000000007, -54.80000000000006, -28.100000000000033, -51.70000000000004, -24.800000000000022, -14.899999999999999, -16.099999999999994, -48.80000000000007, -52.70000000000004, -35.80000000000006, -45.40000000000007, -76.0, -23.6, -50.80000000000005, -13.299999999999999, -53.70000000000003, -52.50000000000005, -32.5, -32.6, -35.20000000000002, -24.400000000000006, -10.799999999999995, -19.2, -42.60000000000006, -31.10000000000001, -13.999999999999988, -105.89999999999989, -34.80000000000002, -40.599999999999994, -12.999999999999998, -54.200000000000045, -46.10000000000007, -83.1999999999998, -37.000000000000064, -19.999999999999993, -12.1, -40.39999999999999, -11.3, -16.999999999999996, -16.199999999999996, -50.10000000000005, -52.900000000000055, -34.8, -47.49999999999994, -50.600000000000044, -14.999999999999995, -43.500000000000036, -49.300000000000026, -45.70000000000001, -24.0, -42.000000000000064, -56.80000000000005, -788.1000000000009, -34.599999999999994, -40.40000000000008, -35.20000000000001, -13.799999999999985, -51.50000000000004, -53.30000000000003, -65.90000000000005, -31.00000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6056215988170951, "mean_inference_ms": 0.673378434753586, "mean_action_processing_ms": 1.006447542294378, "mean_env_wait_ms": 3.994481359389056, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 296000, "timesteps_this_iter": 0, "agent_timesteps_total": 296000, "timers": {"sample_time_ms": 20532.605, "sample_throughput": 194.812, "load_time_ms": 0.362, "load_throughput": 11054369.111, "learn_time_ms": 4144.621, "learn_throughput": 965.106}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.940696716308593e-09, "cur_lr": 0.00010000000000000003, "total_loss": 38.55845517554466, "policy_loss": -0.0038389895872403216, "vf_loss": 3856.229473426778, "vf_explained_var": -0.011240191741656231, "kl": 0.0069668019945766275, "entropy": 0.2769733592467282, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 296000, "num_agent_steps_sampled": 296000, "num_steps_trained": 296000, "num_agent_steps_trained": 296000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2960, "training_iteration": 74, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-38-34", "timestamp": 1651063114, "time_this_iter_s": 19.906455993652344, "time_total_s": 2169.647612810135, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2169.647612810135, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 25.88888888888889, "ram_util_percent": 95.26296296296294}}
{"episode_reward_max": -10.799999999999995, "episode_reward_min": -788.1000000000009, "episode_reward_mean": -45.035000000000025, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.80000000000006, -28.100000000000033, -51.70000000000004, -24.800000000000022, -14.899999999999999, -16.099999999999994, -48.80000000000007, -52.70000000000004, -35.80000000000006, -45.40000000000007, -76.0, -23.6, -50.80000000000005, -13.299999999999999, -53.70000000000003, -52.50000000000005, -32.5, -32.6, -35.20000000000002, -24.400000000000006, -10.799999999999995, -19.2, -42.60000000000006, -31.10000000000001, -13.999999999999988, -105.89999999999989, -34.80000000000002, -40.599999999999994, -12.999999999999998, -54.200000000000045, -46.10000000000007, -83.1999999999998, -37.000000000000064, -19.999999999999993, -12.1, -40.39999999999999, -11.3, -16.999999999999996, -16.199999999999996, -50.10000000000005, -52.900000000000055, -34.8, -47.49999999999994, -50.600000000000044, -14.999999999999995, -43.500000000000036, -49.300000000000026, -45.70000000000001, -24.0, -42.000000000000064, -56.80000000000005, -788.1000000000009, -34.599999999999994, -40.40000000000008, -35.20000000000001, -13.799999999999985, -51.50000000000004, -53.30000000000003, -65.90000000000005, -31.00000000000003, -115.8, -17.0, -51.50000000000004, -49.1, -13.2, -43.50000000000005, -18.299999999999997, -39.800000000000004, -13.299999999999985, -37.2, -54.50000000000004, -23.700000000000003, -26.70000000000001, -36.39999999999999, -56.20000000000001, -12.3, -44.0, -46.800000000000075, -50.40000000000003, -33.40000000000007, -15.199999999999983, -39.20000000000008, -37.500000000000064, -51.800000000000054, -49.10000000000006, -39.20000000000005, -25.600000000000005, -48.70000000000007, -25.500000000000004, -35.60000000000005, -52.70000000000004, -14.599999999999998, -38.300000000000054, -53.30000000000003, -21.299999999999997, -12.2, -37.00000000000005, -20.50000000000002, -11.300000000000002, -48.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6050992385839111, "mean_inference_ms": 0.6724650020866713, "mean_action_processing_ms": 0.9932477486573359, "mean_env_wait_ms": 3.977963968104623, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 300000, "timesteps_this_iter": 0, "agent_timesteps_total": 300000, "timers": {"sample_time_ms": 20434.154, "sample_throughput": 195.751, "load_time_ms": 0.361, "load_throughput": 11069685.933, "learn_time_ms": 4138.286, "learn_throughput": 966.584}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.940696716308593e-09, "cur_lr": 0.00010000000000000003, "total_loss": 1.0328911624207933, "policy_loss": -0.006386535578677731, "vf_loss": 103.92777117452314, "vf_explained_var": -0.04954473683910985, "kl": 0.00337687011159223, "entropy": 0.2861690596547178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 300000, "num_agent_steps_sampled": 300000, "num_steps_trained": 300000, "num_agent_steps_trained": 300000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3000, "training_iteration": 75, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-38-54", "timestamp": 1651063134, "time_this_iter_s": 19.637856006622314, "time_total_s": 2189.285468816757, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2189.285468816757, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 11.49259259259259, "ram_util_percent": 95.12962962962962}}
{"episode_reward_max": -11.300000000000002, "episode_reward_min": -788.1000000000009, "episode_reward_mean": -46.73400000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-52.900000000000055, -34.8, -47.49999999999994, -50.600000000000044, -14.999999999999995, -43.500000000000036, -49.300000000000026, -45.70000000000001, -24.0, -42.000000000000064, -56.80000000000005, -788.1000000000009, -34.599999999999994, -40.40000000000008, -35.20000000000001, -13.799999999999985, -51.50000000000004, -53.30000000000003, -65.90000000000005, -31.00000000000003, -115.8, -17.0, -51.50000000000004, -49.1, -13.2, -43.50000000000005, -18.299999999999997, -39.800000000000004, -13.299999999999985, -37.2, -54.50000000000004, -23.700000000000003, -26.70000000000001, -36.39999999999999, -56.20000000000001, -12.3, -44.0, -46.800000000000075, -50.40000000000003, -33.40000000000007, -15.199999999999983, -39.20000000000008, -37.500000000000064, -51.800000000000054, -49.10000000000006, -39.20000000000005, -25.600000000000005, -48.70000000000007, -25.500000000000004, -35.60000000000005, -52.70000000000004, -14.599999999999998, -38.300000000000054, -53.30000000000003, -21.299999999999997, -12.2, -37.00000000000005, -20.50000000000002, -11.300000000000002, -48.6, -34.60000000000001, -39.90000000000007, -22.000000000000053, -12.899999999999986, -29.4, -18.1, -29.40000000000004, -58.9000000000001, -13.0, -51.70000000000003, -28.700000000000006, -73.60000000000001, -46.10000000000009, -37.80000000000004, -53.300000000000026, -41.20000000000006, -16.0, -107.5, -18.700000000000003, -51.70000000000005, -13.099999999999994, -13.899999999999986, -51.300000000000054, -54.10000000000005, -53.50000000000004, -34.100000000000044, -14.099999999999982, -14.699999999999998, -53.40000000000009, -46.200000000000045, -107.4999999999999, -38.500000000000036, -39.80000000000007, -49.400000000000006, -63.1, -48.800000000000054, -35.400000000000084, -57.60000000000005, -52.200000000000045, -11.999999999999979], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6048462247663167, "mean_inference_ms": 0.6711305869628117, "mean_action_processing_ms": 0.9803911793385407, "mean_env_wait_ms": 3.96156627726552, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 304000, "timesteps_this_iter": 0, "agent_timesteps_total": 304000, "timers": {"sample_time_ms": 20370.484, "sample_throughput": 196.363, "load_time_ms": 0.359, "load_throughput": 11146170.609, "learn_time_ms": 4129.884, "learn_throughput": 968.55}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.470348358154297e-09, "cur_lr": 0.00010000000000000003, "total_loss": 1.22485468687755, "policy_loss": 0.0026288912821841497, "vf_loss": 122.2225826796665, "vf_explained_var": 0.018357874565227056, "kl": 0.0035339722355865882, "entropy": 0.2725481234570985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 304000, "num_agent_steps_sampled": 304000, "num_steps_trained": 304000, "num_agent_steps_trained": 304000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3040, "training_iteration": 76, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-39-14", "timestamp": 1651063154, "time_this_iter_s": 19.794004917144775, "time_total_s": 2209.079473733902, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2209.079473733902, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 13.084615384615384, "ram_util_percent": 95.11923076923075}}
{"episode_reward_max": -11.300000000000002, "episode_reward_min": -114.89999999999979, "episode_reward_mean": -37.289000000000016, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.199999999999983, -39.20000000000008, -37.500000000000064, -51.800000000000054, -49.10000000000006, -39.20000000000005, -25.600000000000005, -48.70000000000007, -25.500000000000004, -35.60000000000005, -52.70000000000004, -14.599999999999998, -38.300000000000054, -53.30000000000003, -21.299999999999997, -12.2, -37.00000000000005, -20.50000000000002, -11.300000000000002, -48.6, -34.60000000000001, -39.90000000000007, -22.000000000000053, -12.899999999999986, -29.4, -18.1, -29.40000000000004, -58.9000000000001, -13.0, -51.70000000000003, -28.700000000000006, -73.60000000000001, -46.10000000000009, -37.80000000000004, -53.300000000000026, -41.20000000000006, -16.0, -107.5, -18.700000000000003, -51.70000000000005, -13.099999999999994, -13.899999999999986, -51.300000000000054, -54.10000000000005, -53.50000000000004, -34.100000000000044, -14.099999999999982, -14.699999999999998, -53.40000000000009, -46.200000000000045, -107.4999999999999, -38.500000000000036, -39.80000000000007, -49.400000000000006, -63.1, -48.800000000000054, -35.400000000000084, -57.60000000000005, -52.200000000000045, -11.999999999999979, -25.600000000000005, -25.399999999999995, -15.899999999999988, -11.999999999999993, -22.8, -52.00000000000005, -114.89999999999979, -31.40000000000004, -28.20000000000004, -22.3, -26.700000000000024, -39.10000000000001, -16.499999999999986, -44.1, -24.200000000000003, -39.000000000000036, -51.70000000000004, -14.59999999999998, -78.30000000000001, -40.5, -29.20000000000001, -35.4, -34.30000000000001, -58.6, -17.799999999999997, -23.600000000000005, -31.20000000000007, -77.30000000000003, -34.30000000000005, -34.0, -22.7, -51.80000000000005, -23.1, -15.6, -16.199999999999985, -51.80000000000003, -28.100000000000044, -53.80000000000002, -14.099999999999998, -36.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6049385872302948, "mean_inference_ms": 0.6696827561122995, "mean_action_processing_ms": 0.9678729038117939, "mean_env_wait_ms": 3.945449403833251, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 308000, "timesteps_this_iter": 0, "agent_timesteps_total": 308000, "timers": {"sample_time_ms": 20369.559, "sample_throughput": 196.371, "load_time_ms": 0.369, "load_throughput": 10829599.793, "learn_time_ms": 4113.595, "learn_throughput": 972.385}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771484e-09, "cur_lr": 0.00010000000000000003, "total_loss": 1.183531233292794, "policy_loss": -0.00753062409899568, "vf_loss": 119.10618817319153, "vf_explained_var": -0.051068115234375, "kl": 0.0056378543831047045, "entropy": 0.30510172228659355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 308000, "num_agent_steps_sampled": 308000, "num_steps_trained": 308000, "num_agent_steps_trained": 308000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3080, "training_iteration": 77, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-39-34", "timestamp": 1651063174, "time_this_iter_s": 19.82601284980774, "time_total_s": 2228.9054865837097, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2228.9054865837097, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 10.54074074074074, "ram_util_percent": 95.1185185185185}}
{"episode_reward_max": -11.600000000000001, "episode_reward_min": -152.3, "episode_reward_mean": -38.72800000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.099999999999994, -13.899999999999986, -51.300000000000054, -54.10000000000005, -53.50000000000004, -34.100000000000044, -14.099999999999982, -14.699999999999998, -53.40000000000009, -46.200000000000045, -107.4999999999999, -38.500000000000036, -39.80000000000007, -49.400000000000006, -63.1, -48.800000000000054, -35.400000000000084, -57.60000000000005, -52.200000000000045, -11.999999999999979, -25.600000000000005, -25.399999999999995, -15.899999999999988, -11.999999999999993, -22.8, -52.00000000000005, -114.89999999999979, -31.40000000000004, -28.20000000000004, -22.3, -26.700000000000024, -39.10000000000001, -16.499999999999986, -44.1, -24.200000000000003, -39.000000000000036, -51.70000000000004, -14.59999999999998, -78.30000000000001, -40.5, -29.20000000000001, -35.4, -34.30000000000001, -58.6, -17.799999999999997, -23.600000000000005, -31.20000000000007, -77.30000000000003, -34.30000000000005, -34.0, -22.7, -51.80000000000005, -23.1, -15.6, -16.199999999999985, -51.80000000000003, -28.100000000000044, -53.80000000000002, -14.099999999999998, -36.4, -44.00000000000002, -32.800000000000004, -11.600000000000001, -51.10000000000005, -45.20000000000001, -54.50000000000002, -84.6, -40.400000000000055, -40.80000000000007, -46.10000000000006, -38.800000000000054, -24.30000000000001, -37.80000000000005, -14.299999999999988, -20.6, -48.2, -18.7, -39.30000000000007, -14.899999999999997, -152.3, -29.40000000000002, -30.800000000000004, -51.00000000000004, -31.000000000000004, -16.599999999999994, -56.80000000000009, -20.9, -50.80000000000004, -19.199999999999992, -48.2, -35.3, -17.29999999999999, -23.900000000000013, -28.10000000000003, -52.80000000000004, -43.100000000000044, -57.10000000000013, -52.40000000000003, -51.800000000000004, -28.800000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6827238335001041, "mean_inference_ms": 0.6686002903338876, "mean_action_processing_ms": 0.9556810947399091, "mean_env_wait_ms": 4.35067759322579, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 312000, "timesteps_this_iter": 0, "agent_timesteps_total": 312000, "timers": {"sample_time_ms": 20386.222, "sample_throughput": 196.211, "load_time_ms": 0.371, "load_throughput": 10783658.568, "learn_time_ms": 4132.083, "learn_throughput": 968.035}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.2351741790771484e-09, "cur_lr": 0.00010000000000000003, "total_loss": 1.2866462711108377, "policy_loss": 0.000958156533619409, "vf_loss": 128.56881382029545, "vf_explained_var": 0.033149252719776603, "kl": 0.00415762232264046, "entropy": 0.25253970589368574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 312000, "num_agent_steps_sampled": 312000, "num_steps_trained": 312000, "num_agent_steps_trained": 312000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3120, "training_iteration": 78, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_13-46-23", "timestamp": 1651063583, "time_this_iter_s": 409.2673079967499, "time_total_s": 2638.1727945804596, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2638.1727945804596, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 16.599999999999998, "ram_util_percent": 94.98928571428573}}
{"episode_reward_max": -11.600000000000001, "episode_reward_min": -157.49999999999972, "episode_reward_mean": -40.84800000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.20000000000001, -35.4, -34.30000000000001, -58.6, -17.799999999999997, -23.600000000000005, -31.20000000000007, -77.30000000000003, -34.30000000000005, -34.0, -22.7, -51.80000000000005, -23.1, -15.6, -16.199999999999985, -51.80000000000003, -28.100000000000044, -53.80000000000002, -14.099999999999998, -36.4, -44.00000000000002, -32.800000000000004, -11.600000000000001, -51.10000000000005, -45.20000000000001, -54.50000000000002, -84.6, -40.400000000000055, -40.80000000000007, -46.10000000000006, -38.800000000000054, -24.30000000000001, -37.80000000000005, -14.299999999999988, -20.6, -48.2, -18.7, -39.30000000000007, -14.899999999999997, -152.3, -29.40000000000002, -30.800000000000004, -51.00000000000004, -31.000000000000004, -16.599999999999994, -56.80000000000009, -20.9, -50.80000000000004, -19.199999999999992, -48.2, -35.3, -17.29999999999999, -23.900000000000013, -28.10000000000003, -52.80000000000004, -43.100000000000044, -57.10000000000013, -52.40000000000003, -51.800000000000004, -28.800000000000004, -12.5, -28.600000000000005, -59.00000000000002, -54.000000000000036, -89.9, -51.10000000000006, -27.800000000000008, -157.49999999999972, -27.800000000000008, -54.80000000000001, -59.80000000000009, -50.80000000000004, -26.7, -55.100000000000065, -22.500000000000014, -95.99999999999996, -20.00000000000001, -114.79999999999987, -40.700000000000074, -49.19999999999994, -16.19999999999999, -17.1, -44.10000000000004, -12.3, -30.399999999999967, -34.00000000000007, -14.299999999999985, -44.30000000000007, -43.60000000000001, -29.700000000000006, -15.6, -53.10000000000003, -51.200000000000045, -49.800000000000054, -50.00000000000005, -25.700000000000006, -33.0, -42.30000000000003, -32.00000000000001, -52.60000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2249249698974396, "mean_inference_ms": 0.6684563686015372, "mean_action_processing_ms": 0.9438211254805708, "mean_env_wait_ms": 5.4323055864844765, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 316000, "timesteps_this_iter": 0, "agent_timesteps_total": 316000, "timers": {"sample_time_ms": 20527.585, "sample_throughput": 194.86, "load_time_ms": 0.371, "load_throughput": 10771888.283, "learn_time_ms": 4117.283, "learn_throughput": 971.515}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.1175870895385742e-09, "cur_lr": 0.00010000000000000003, "total_loss": 1.7252309684461404, "policy_loss": 0.001007395043408358, "vf_loss": 172.4223610970282, "vf_explained_var": -0.019711152904777117, "kl": 0.0048169297871245706, "entropy": 0.24855974618625898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 316000, "num_agent_steps_sampled": 316000, "num_steps_trained": 316000, "num_agent_steps_trained": 316000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3160, "training_iteration": 79, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-01-50", "timestamp": 1651064510, "time_this_iter_s": 926.5350787639618, "time_total_s": 3564.7078733444214, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3564.7078733444214, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 33.123333333333335, "ram_util_percent": 95.19333333333334}}
{"episode_reward_max": -12.3, "episode_reward_min": -157.49999999999972, "episode_reward_mean": -41.02600000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.40000000000002, -30.800000000000004, -51.00000000000004, -31.000000000000004, -16.599999999999994, -56.80000000000009, -20.9, -50.80000000000004, -19.199999999999992, -48.2, -35.3, -17.29999999999999, -23.900000000000013, -28.10000000000003, -52.80000000000004, -43.100000000000044, -57.10000000000013, -52.40000000000003, -51.800000000000004, -28.800000000000004, -12.5, -28.600000000000005, -59.00000000000002, -54.000000000000036, -89.9, -51.10000000000006, -27.800000000000008, -157.49999999999972, -27.800000000000008, -54.80000000000001, -59.80000000000009, -50.80000000000004, -26.7, -55.100000000000065, -22.500000000000014, -95.99999999999996, -20.00000000000001, -114.79999999999987, -40.700000000000074, -49.19999999999994, -16.19999999999999, -17.1, -44.10000000000004, -12.3, -30.399999999999967, -34.00000000000007, -14.299999999999985, -44.30000000000007, -43.60000000000001, -29.700000000000006, -15.6, -53.10000000000003, -51.200000000000045, -49.800000000000054, -50.00000000000005, -25.700000000000006, -33.0, -42.30000000000003, -32.00000000000001, -52.60000000000004, -25.400000000000006, -57.199999999999974, -62.600000000000065, -24.300000000000004, -32.000000000000014, -53.20000000000003, -39.00000000000005, -47.00000000000007, -34.9, -52.80000000000004, -52.200000000000095, -52.80000000000003, -24.7, -52.20000000000004, -21.2, -35.8, -39.30000000000001, -35.5, -21.500000000000025, -53.40000000000004, -15.59999999999998, -32.00000000000004, -40.800000000000075, -15.899999999999999, -42.4, -62.40000000000009, -54.00000000000006, -20.40000000000004, -54.70000000000003, -35.69999999999998, -44.9, -14.499999999999986, -17.200000000000003, -34.600000000000016, -41.30000000000003, -131.69999999999982, -28.199999999999953, -29.400000000000006, -16.39999999999999, -18.299999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.721687870970076, "mean_inference_ms": 0.668396450181881, "mean_action_processing_ms": 0.932267439545078, "mean_env_wait_ms": 6.290329055877205, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 320000, "timesteps_this_iter": 0, "agent_timesteps_total": 320000, "timers": {"sample_time_ms": 20483.195, "sample_throughput": 195.282, "load_time_ms": 0.385, "load_throughput": 10393517.532, "learn_time_ms": 4112.225, "learn_throughput": 972.709}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.587935447692871e-10, "cur_lr": 0.00010000000000000003, "total_loss": 1.0714599862579577, "policy_loss": 0.001728227484210204, "vf_loss": 106.97317781140727, "vf_explained_var": 0.05322594988730646, "kl": 0.00334826363788388, "entropy": 0.24367587829148898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 320000, "num_agent_steps_sampled": 320000, "num_steps_trained": 320000, "num_agent_steps_trained": 320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3200, "training_iteration": 80, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-02-10", "timestamp": 1651064530, "time_this_iter_s": 20.41185688972473, "time_total_s": 3585.119730234146, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3585.119730234146, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 17.425, "ram_util_percent": 95.36785714285716}}
{"episode_reward_max": -10.1, "episode_reward_min": -131.69999999999982, "episode_reward_mean": -37.24200000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.19999999999999, -17.1, -44.10000000000004, -12.3, -30.399999999999967, -34.00000000000007, -14.299999999999985, -44.30000000000007, -43.60000000000001, -29.700000000000006, -15.6, -53.10000000000003, -51.200000000000045, -49.800000000000054, -50.00000000000005, -25.700000000000006, -33.0, -42.30000000000003, -32.00000000000001, -52.60000000000004, -25.400000000000006, -57.199999999999974, -62.600000000000065, -24.300000000000004, -32.000000000000014, -53.20000000000003, -39.00000000000005, -47.00000000000007, -34.9, -52.80000000000004, -52.200000000000095, -52.80000000000003, -24.7, -52.20000000000004, -21.2, -35.8, -39.30000000000001, -35.5, -21.500000000000025, -53.40000000000004, -15.59999999999998, -32.00000000000004, -40.800000000000075, -15.899999999999999, -42.4, -62.40000000000009, -54.00000000000006, -20.40000000000004, -54.70000000000003, -35.69999999999998, -44.9, -14.499999999999986, -17.200000000000003, -34.600000000000016, -41.30000000000003, -131.69999999999982, -28.199999999999953, -29.400000000000006, -16.39999999999999, -18.299999999999997, -40.09999999999999, -17.300000000000008, -55.200000000000045, -31.70000000000001, -29.500000000000007, -36.600000000000044, -16.3, -50.400000000000055, -12.299999999999999, -10.1, -33.40000000000002, -51.000000000000036, -34.10000000000001, -48.60000000000006, -29.300000000000015, -25.000000000000007, -36.0, -52.600000000000044, -41.200000000000074, -39.60000000000004, -50.400000000000055, -77.29999999999995, -54.40000000000008, -28.70000000000001, -52.50000000000004, -15.199999999999994, -33.40000000000004, -48.60000000000003, -31.600000000000055, -51.80000000000004, -35.70000000000006, -40.90000000000007, -32.80000000000001, -32.50000000000002, -52.60000000000003, -12.1, -33.60000000000004, -17.4, -50.60000000000004, -23.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9406537966634105, "mean_inference_ms": 0.6679385231023874, "mean_action_processing_ms": 0.9209982345833803, "mean_env_wait_ms": 6.587092700470084, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 324000, "timesteps_this_iter": 0, "agent_timesteps_total": 324000, "timers": {"sample_time_ms": 20429.237, "sample_throughput": 195.798, "load_time_ms": 0.387, "load_throughput": 10347364.006, "learn_time_ms": 4105.024, "learn_throughput": 974.416}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7939677238464354e-10, "cur_lr": 0.00010000000000000003, "total_loss": 0.6849916427656607, "policy_loss": -0.00010083437126169923, "vf_loss": 68.50924937545612, "vf_explained_var": 0.057602594424319524, "kl": 0.0015759212454568945, "entropy": 0.1830376324354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 324000, "num_agent_steps_sampled": 324000, "num_steps_trained": 324000, "num_agent_steps_trained": 324000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3240, "training_iteration": 81, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-02-30", "timestamp": 1651064550, "time_this_iter_s": 20.004306077957153, "time_total_s": 3605.1240363121033, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3605.1240363121033, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 11.785185185185187, "ram_util_percent": 95.3222222222222}}
{"episode_reward_max": -10.1, "episode_reward_min": -131.69999999999982, "episode_reward_mean": -36.33700000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.59999999999998, -32.00000000000004, -40.800000000000075, -15.899999999999999, -42.4, -62.40000000000009, -54.00000000000006, -20.40000000000004, -54.70000000000003, -35.69999999999998, -44.9, -14.499999999999986, -17.200000000000003, -34.600000000000016, -41.30000000000003, -131.69999999999982, -28.199999999999953, -29.400000000000006, -16.39999999999999, -18.299999999999997, -40.09999999999999, -17.300000000000008, -55.200000000000045, -31.70000000000001, -29.500000000000007, -36.600000000000044, -16.3, -50.400000000000055, -12.299999999999999, -10.1, -33.40000000000002, -51.000000000000036, -34.10000000000001, -48.60000000000006, -29.300000000000015, -25.000000000000007, -36.0, -52.600000000000044, -41.200000000000074, -39.60000000000004, -50.400000000000055, -77.29999999999995, -54.40000000000008, -28.70000000000001, -52.50000000000004, -15.199999999999994, -33.40000000000004, -48.60000000000003, -31.600000000000055, -51.80000000000004, -35.70000000000006, -40.90000000000007, -32.80000000000001, -32.50000000000002, -52.60000000000003, -12.1, -33.60000000000004, -17.4, -50.60000000000004, -23.099999999999998, -49.20000000000006, -42.200000000000074, -41.90000000000005, -46.60000000000006, -38.80000000000006, -32.9, -39.9, -16.799999999999997, -33.30000000000001, -17.299999999999997, -29.700000000000014, -39.3, -60.3, -11.5, -16.3, -12.39999999999999, -34.100000000000044, -13.499999999999996, -48.00000000000008, -38.40000000000002, -32.6, -25.600000000000005, -35.20000000000006, -74.00000000000003, -20.50000000000004, -53.50000000000006, -27.800000000000004, -53.200000000000045, -25.6, -16.4, -28.9, -39.3, -13.799999999999997, -79.09999999999998, -34.600000000000016, -18.800000000000015, -52.80000000000003, -34.20000000000004, -37.20000000000001, -52.30000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9241340667723994, "mean_inference_ms": 0.6674019552493293, "mean_action_processing_ms": 0.9100045936249317, "mean_env_wait_ms": 6.540473498161279, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 328000, "timesteps_this_iter": 0, "agent_timesteps_total": 328000, "timers": {"sample_time_ms": 20464.149, "sample_throughput": 195.464, "load_time_ms": 0.265, "load_throughput": 15114609.009, "learn_time_ms": 4115.744, "learn_throughput": 971.878}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3969838619232177e-10, "cur_lr": 0.00010000000000000003, "total_loss": 0.6685106693261293, "policy_loss": 0.005736338038758565, "vf_loss": 66.27743453364218, "vf_explained_var": 0.043069639385387465, "kl": 0.0030203345676374045, "entropy": 0.2179309238910034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 328000, "num_agent_steps_sampled": 328000, "num_steps_trained": 328000, "num_agent_steps_trained": 328000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3280, "training_iteration": 82, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-02-51", "timestamp": 1651064571, "time_this_iter_s": 20.758400917053223, "time_total_s": 3625.8824372291565, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3625.8824372291565, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 14.882758620689655, "ram_util_percent": 95.36551724137932}}
{"episode_reward_max": -11.5, "episode_reward_min": -79.09999999999998, "episode_reward_mean": -36.20800000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.400000000000055, -77.29999999999995, -54.40000000000008, -28.70000000000001, -52.50000000000004, -15.199999999999994, -33.40000000000004, -48.60000000000003, -31.600000000000055, -51.80000000000004, -35.70000000000006, -40.90000000000007, -32.80000000000001, -32.50000000000002, -52.60000000000003, -12.1, -33.60000000000004, -17.4, -50.60000000000004, -23.099999999999998, -49.20000000000006, -42.200000000000074, -41.90000000000005, -46.60000000000006, -38.80000000000006, -32.9, -39.9, -16.799999999999997, -33.30000000000001, -17.299999999999997, -29.700000000000014, -39.3, -60.3, -11.5, -16.3, -12.39999999999999, -34.100000000000044, -13.499999999999996, -48.00000000000008, -38.40000000000002, -32.6, -25.600000000000005, -35.20000000000006, -74.00000000000003, -20.50000000000004, -53.50000000000006, -27.800000000000004, -53.200000000000045, -25.6, -16.4, -28.9, -39.3, -13.799999999999997, -79.09999999999998, -34.600000000000016, -18.800000000000015, -52.80000000000003, -34.20000000000004, -37.20000000000001, -52.30000000000003, -37.59999999999997, -32.70000000000001, -53.60000000000004, -24.099999999999998, -29.500000000000078, -53.900000000000034, -32.60000000000001, -52.20000000000005, -13.899999999999997, -26.70000000000001, -13.2, -14.699999999999992, -56.300000000000054, -33.30000000000007, -32.5, -23.8, -19.499999999999996, -65.30000000000005, -70.6999999999999, -54.100000000000065, -43.00000000000008, -17.1, -53.700000000000045, -39.80000000000006, -52.50000000000003, -33.600000000000016, -32.300000000000026, -41.79999999999999, -20.4, -14.199999999999983, -17.999999999999993, -13.799999999999981, -53.90000000000004, -39.60000000000001, -37.100000000000065, -50.70000000000003, -29.20000000000005, -22.00000000000001, -53.10000000000006, -21.800000000000026], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9079433965103427, "mean_inference_ms": 0.6670121371988599, "mean_action_processing_ms": 0.8992806177662849, "mean_env_wait_ms": 6.49508088518616, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 332000, "timesteps_this_iter": 0, "agent_timesteps_total": 332000, "timers": {"sample_time_ms": 20453.099, "sample_throughput": 195.569, "load_time_ms": 0.331, "load_throughput": 12073413.932, "learn_time_ms": 4110.651, "learn_throughput": 973.082}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.984919309616089e-11, "cur_lr": 0.00010000000000000003, "total_loss": 0.674465629754598, "policy_loss": 0.002042413088342836, "vf_loss": 67.24232334834274, "vf_explained_var": -0.09778835215876179, "kl": 0.0030570026420896836, "entropy": 0.26433941928209154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 332000, "num_agent_steps_sampled": 332000, "num_steps_trained": 332000, "num_agent_steps_trained": 332000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3320, "training_iteration": 83, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-03-11", "timestamp": 1651064591, "time_this_iter_s": 20.33670997619629, "time_total_s": 3646.219147205353, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3646.219147205353, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 14.025, "ram_util_percent": 95.35357142857144}}
{"episode_reward_max": -11.399999999999986, "episode_reward_min": -90.89999999999995, "episode_reward_mean": -35.97900000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.6, -25.600000000000005, -35.20000000000006, -74.00000000000003, -20.50000000000004, -53.50000000000006, -27.800000000000004, -53.200000000000045, -25.6, -16.4, -28.9, -39.3, -13.799999999999997, -79.09999999999998, -34.600000000000016, -18.800000000000015, -52.80000000000003, -34.20000000000004, -37.20000000000001, -52.30000000000003, -37.59999999999997, -32.70000000000001, -53.60000000000004, -24.099999999999998, -29.500000000000078, -53.900000000000034, -32.60000000000001, -52.20000000000005, -13.899999999999997, -26.70000000000001, -13.2, -14.699999999999992, -56.300000000000054, -33.30000000000007, -32.5, -23.8, -19.499999999999996, -65.30000000000005, -70.6999999999999, -54.100000000000065, -43.00000000000008, -17.1, -53.700000000000045, -39.80000000000006, -52.50000000000003, -33.600000000000016, -32.300000000000026, -41.79999999999999, -20.4, -14.199999999999983, -17.999999999999993, -13.799999999999981, -53.90000000000004, -39.60000000000001, -37.100000000000065, -50.70000000000003, -29.20000000000005, -22.00000000000001, -53.10000000000006, -21.800000000000026, -28.600000000000012, -34.20000000000007, -51.40000000000006, -35.10000000000009, -35.20000000000003, -32.50000000000001, -38.10000000000001, -16.799999999999997, -13.099999999999987, -13.799999999999999, -35.600000000000016, -11.399999999999986, -28.400000000000013, -28.70000000000001, -31.900000000000002, -26.299999999999997, -14.79999999999998, -52.70000000000004, -26.800000000000004, -31.000000000000032, -14.099999999999977, -56.20000000000006, -37.30000000000006, -53.60000000000003, -33.60000000000005, -23.099999999999994, -14.199999999999978, -50.000000000000064, -52.20000000000005, -32.0, -53.10000000000003, -24.30000000000002, -51.700000000000045, -14.599999999999987, -90.89999999999995, -19.299999999999997, -79.10000000000001, -46.60000000000007, -31.700000000000006, -50.700000000000074], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8921132440917523, "mean_inference_ms": 0.6665474576519587, "mean_action_processing_ms": 0.8888118776544242, "mean_env_wait_ms": 6.450738572746418, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 336000, "timesteps_this_iter": 0, "agent_timesteps_total": 336000, "timers": {"sample_time_ms": 20465.217, "sample_throughput": 195.454, "load_time_ms": 0.332, "load_throughput": 12040488.015, "learn_time_ms": 4117.311, "learn_throughput": 971.508}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.492459654808044e-11, "cur_lr": 0.00010000000000000003, "total_loss": 0.8266091838418956, "policy_loss": -0.0030787620332933243, "vf_loss": 82.96879657622307, "vf_explained_var": 0.06903887993545943, "kl": 0.004360148108059058, "entropy": 0.2947396153403867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 336000, "num_agent_steps_sampled": 336000, "num_steps_trained": 336000, "num_agent_steps_trained": 336000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3360, "training_iteration": 84, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-03-31", "timestamp": 1651064611, "time_this_iter_s": 20.146351099014282, "time_total_s": 3666.365498304367, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3666.365498304367, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 13.644444444444444, "ram_util_percent": 95.26666666666667}}
{"episode_reward_max": -10.299999999999999, "episode_reward_min": -139.0999999999998, "episode_reward_mean": -38.43100000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.00000000000008, -17.1, -53.700000000000045, -39.80000000000006, -52.50000000000003, -33.600000000000016, -32.300000000000026, -41.79999999999999, -20.4, -14.199999999999983, -17.999999999999993, -13.799999999999981, -53.90000000000004, -39.60000000000001, -37.100000000000065, -50.70000000000003, -29.20000000000005, -22.00000000000001, -53.10000000000006, -21.800000000000026, -28.600000000000012, -34.20000000000007, -51.40000000000006, -35.10000000000009, -35.20000000000003, -32.50000000000001, -38.10000000000001, -16.799999999999997, -13.099999999999987, -13.799999999999999, -35.600000000000016, -11.399999999999986, -28.400000000000013, -28.70000000000001, -31.900000000000002, -26.299999999999997, -14.79999999999998, -52.70000000000004, -26.800000000000004, -31.000000000000032, -14.099999999999977, -56.20000000000006, -37.30000000000006, -53.60000000000003, -33.60000000000005, -23.099999999999994, -14.199999999999978, -50.000000000000064, -52.20000000000005, -32.0, -53.10000000000003, -24.30000000000002, -51.700000000000045, -14.599999999999987, -90.89999999999995, -19.299999999999997, -79.10000000000001, -46.60000000000007, -31.700000000000006, -50.700000000000074, -42.60000000000005, -14.3, -46.2, -15.299999999999988, -38.90000000000006, -32.40000000000004, -38.500000000000014, -38.400000000000006, -58.40000000000006, -67.30000000000005, -44.50000000000004, -73.09999999999998, -15.499999999999973, -116.5, -45.70000000000004, -36.5, -41.000000000000064, -35.20000000000001, -53.400000000000055, -36.800000000000004, -51.50000000000006, -53.10000000000005, -32.30000000000004, -139.0999999999998, -15.6, -39.80000000000004, -51.900000000000034, -40.80000000000007, -49.60000000000003, -10.299999999999999, -37.50000000000004, -66.6000000000001, -39.699999999999996, -35.800000000000004, -13.2, -56.60000000000007, -23.500000000000004, -52.100000000000044, -12.5, -28.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.876498026683704, "mean_inference_ms": 0.6659285285068043, "mean_action_processing_ms": 0.8785886325352468, "mean_env_wait_ms": 6.407293536863299, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 340000, "timesteps_this_iter": 0, "agent_timesteps_total": 340000, "timers": {"sample_time_ms": 20510.744, "sample_throughput": 195.02, "load_time_ms": 0.333, "load_throughput": 11997437.071, "learn_time_ms": 4119.71, "learn_throughput": 970.942}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.746229827404022e-11, "cur_lr": 0.00010000000000000003, "total_loss": 1.453781288422604, "policy_loss": 0.0009656379710362163, "vf_loss": 145.28156782170777, "vf_explained_var": 0.22210739742043198, "kl": 0.0029270897086320787, "entropy": 0.17350622362266946, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 340000, "num_agent_steps_sampled": 340000, "num_steps_trained": 340000, "num_agent_steps_trained": 340000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3400, "training_iteration": 85, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-03-51", "timestamp": 1651064631, "time_this_iter_s": 20.05153489112854, "time_total_s": 3686.4170331954956, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3686.4170331954956, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 14.342857142857143, "ram_util_percent": 95.22499999999998}}
{"episode_reward_max": -10.299999999999999, "episode_reward_min": -158.39999999999975, "episode_reward_mean": -40.72500000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.099999999999977, -56.20000000000006, -37.30000000000006, -53.60000000000003, -33.60000000000005, -23.099999999999994, -14.199999999999978, -50.000000000000064, -52.20000000000005, -32.0, -53.10000000000003, -24.30000000000002, -51.700000000000045, -14.599999999999987, -90.89999999999995, -19.299999999999997, -79.10000000000001, -46.60000000000007, -31.700000000000006, -50.700000000000074, -42.60000000000005, -14.3, -46.2, -15.299999999999988, -38.90000000000006, -32.40000000000004, -38.500000000000014, -38.400000000000006, -58.40000000000006, -67.30000000000005, -44.50000000000004, -73.09999999999998, -15.499999999999973, -116.5, -45.70000000000004, -36.5, -41.000000000000064, -35.20000000000001, -53.400000000000055, -36.800000000000004, -51.50000000000006, -53.10000000000005, -32.30000000000004, -139.0999999999998, -15.6, -39.80000000000004, -51.900000000000034, -40.80000000000007, -49.60000000000003, -10.299999999999999, -37.50000000000004, -66.6000000000001, -39.699999999999996, -35.800000000000004, -13.2, -56.60000000000007, -23.500000000000004, -52.100000000000044, -12.5, -28.799999999999997, -42.40000000000001, -62.50000000000001, -32.1, -29.50000000000002, -51.50000000000004, -13.699999999999994, -15.699999999999989, -22.300000000000008, -35.7, -17.4, -52.20000000000004, -36.60000000000001, -16.2, -14.899999999999999, -158.39999999999975, -28.4, -35.7, -37.100000000000044, -31.100000000000037, -56.80000000000009, -13.5, -47.7, -30.799999999999997, -16.2, -28.300000000000008, -54.10000000000005, -26.199999999999996, -60.90000000000001, -29.60000000000001, -86.2999999999999, -35.20000000000003, -16.69999999999999, -52.80000000000005, -23.799999999999997, -12.499999999999986, -14.899999999999999, -79.69999999999989, -15.199999999999978, -53.400000000000034, -15.399999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.861022618765287, "mean_inference_ms": 0.6653786357061563, "mean_action_processing_ms": 0.8686065346038312, "mean_env_wait_ms": 6.364959080339743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 344000, "timesteps_this_iter": 0, "agent_timesteps_total": 344000, "timers": {"sample_time_ms": 20542.414, "sample_throughput": 194.719, "load_time_ms": 0.333, "load_throughput": 12010319.994, "learn_time_ms": 4118.325, "learn_throughput": 971.269}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.73114913702011e-12, "cur_lr": 0.00010000000000000003, "total_loss": 1.4263209317951033, "policy_loss": -0.0021843297392009726, "vf_loss": 142.8505300583378, "vf_explained_var": -0.10012602735591192, "kl": 0.004996861471798878, "entropy": 0.22946989264699721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 344000, "num_agent_steps_sampled": 344000, "num_steps_trained": 344000, "num_agent_steps_trained": 344000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3440, "training_iteration": 86, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-04-12", "timestamp": 1651064652, "time_this_iter_s": 20.072659969329834, "time_total_s": 3706.4896931648254, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3706.4896931648254, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 8.181481481481482, "ram_util_percent": 95.25555555555555}}
{"episode_reward_max": -8.2, "episode_reward_min": -158.39999999999975, "episode_reward_mean": -37.22600000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.50000000000006, -53.10000000000005, -32.30000000000004, -139.0999999999998, -15.6, -39.80000000000004, -51.900000000000034, -40.80000000000007, -49.60000000000003, -10.299999999999999, -37.50000000000004, -66.6000000000001, -39.699999999999996, -35.800000000000004, -13.2, -56.60000000000007, -23.500000000000004, -52.100000000000044, -12.5, -28.799999999999997, -42.40000000000001, -62.50000000000001, -32.1, -29.50000000000002, -51.50000000000004, -13.699999999999994, -15.699999999999989, -22.300000000000008, -35.7, -17.4, -52.20000000000004, -36.60000000000001, -16.2, -14.899999999999999, -158.39999999999975, -28.4, -35.7, -37.100000000000044, -31.100000000000037, -56.80000000000009, -13.5, -47.7, -30.799999999999997, -16.2, -28.300000000000008, -54.10000000000005, -26.199999999999996, -60.90000000000001, -29.60000000000001, -86.2999999999999, -35.20000000000003, -16.69999999999999, -52.80000000000005, -23.799999999999997, -12.499999999999986, -14.899999999999999, -79.69999999999989, -15.199999999999978, -53.400000000000034, -15.399999999999999, -8.2, -51.40000000000005, -13.699999999999983, -36.40000000000004, -69.90000000000003, -29.700000000000006, -13.699999999999983, -28.600000000000005, -32.8, -44.00000000000005, -13.699999999999982, -27.200000000000003, -52.30000000000005, -38.100000000000044, -52.30000000000005, -52.50000000000004, -12.699999999999982, -13.29999999999998, -43.30000000000003, -44.50000000000006, -12.4, -12.2, -33.8, -28.700000000000014, -28.900000000000034, -11.7, -52.10000000000003, -32.000000000000014, -36.600000000000044, -37.60000000000006, -31.500000000000014, -50.70000000000007, -15.099999999999982, -67.50000000000006, -21.00000000000005, -104.09999999999992, -53.90000000000004, -17.299999999999997, -31.599999999999966, -11.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8462256264098216, "mean_inference_ms": 0.6647802326671293, "mean_action_processing_ms": 0.8588546239037814, "mean_env_wait_ms": 6.323354497323041, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 348000, "timesteps_this_iter": 0, "agent_timesteps_total": 348000, "timers": {"sample_time_ms": 20562.3, "sample_throughput": 194.531, "load_time_ms": 0.322, "load_throughput": 12440468.634, "learn_time_ms": 4130.418, "learn_throughput": 968.425}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.365574568510055e-12, "cur_lr": 0.00010000000000000003, "total_loss": 0.8494936311226939, "policy_loss": 0.0014859278375903766, "vf_loss": 84.80077192244991, "vf_explained_var": 0.0638226330280304, "kl": 0.0025886676364969487, "entropy": 0.22908708523277954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 348000, "num_agent_steps_sampled": 348000, "num_steps_trained": 348000, "num_agent_steps_trained": 348000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3480, "training_iteration": 87, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-04-32", "timestamp": 1651064672, "time_this_iter_s": 20.195116996765137, "time_total_s": 3726.6848101615906, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3726.6848101615906, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 10.646428571428572, "ram_util_percent": 95.22142857142855}}
{"episode_reward_max": -8.2, "episode_reward_min": -104.09999999999992, "episode_reward_mean": -33.649000000000015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.5, -47.7, -30.799999999999997, -16.2, -28.300000000000008, -54.10000000000005, -26.199999999999996, -60.90000000000001, -29.60000000000001, -86.2999999999999, -35.20000000000003, -16.69999999999999, -52.80000000000005, -23.799999999999997, -12.499999999999986, -14.899999999999999, -79.69999999999989, -15.199999999999978, -53.400000000000034, -15.399999999999999, -8.2, -51.40000000000005, -13.699999999999983, -36.40000000000004, -69.90000000000003, -29.700000000000006, -13.699999999999983, -28.600000000000005, -32.8, -44.00000000000005, -13.699999999999982, -27.200000000000003, -52.30000000000005, -38.100000000000044, -52.30000000000005, -52.50000000000004, -12.699999999999982, -13.29999999999998, -43.30000000000003, -44.50000000000006, -12.4, -12.2, -33.8, -28.700000000000014, -28.900000000000034, -11.7, -52.10000000000003, -32.000000000000014, -36.600000000000044, -37.60000000000006, -31.500000000000014, -50.70000000000007, -15.099999999999982, -67.50000000000006, -21.00000000000005, -104.09999999999992, -53.90000000000004, -17.299999999999997, -31.599999999999966, -11.899999999999999, -43.000000000000036, -12.300000000000002, -16.9, -50.50000000000006, -19.800000000000026, -43.300000000000026, -26.10000000000001, -13.099999999999994, -33.299999999999976, -54.00000000000003, -17.2, -31.40000000000005, -51.80000000000005, -16.5, -56.20000000000007, -28.700000000000006, -11.499999999999982, -15.1, -52.50000000000003, -25.4, -16.399999999999988, -58.20000000000007, -16.699999999999996, -20.9, -31.00000000000001, -14.19999999999998, -33.50000000000004, -31.700000000000003, -49.700000000000045, -29.1, -23.1, -13.700000000000001, -29.000000000000007, -71.59999999999998, -56.00000000000006, -18.400000000000002, -42.20000000000007, -55.30000000000009, -18.0, -35.50000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8319628699453068, "mean_inference_ms": 0.6643230774961573, "mean_action_processing_ms": 0.8493305365443939, "mean_env_wait_ms": 6.282751252691113, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 352000, "timesteps_this_iter": 0, "agent_timesteps_total": 352000, "timers": {"sample_time_ms": 20536.252, "sample_throughput": 194.778, "load_time_ms": 0.331, "load_throughput": 12098663.013, "learn_time_ms": 4128.696, "learn_throughput": 968.829}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.1827872842550277e-12, "cur_lr": 0.00010000000000000003, "total_loss": 0.6647659073051776, "policy_loss": -0.006533885274523048, "vf_loss": 67.12998073741954, "vf_explained_var": -0.09306956298889653, "kl": 0.007969255104287934, "entropy": 0.22958118160085011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 352000, "num_agent_steps_sampled": 352000, "num_steps_trained": 352000, "num_agent_steps_trained": 352000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3520, "training_iteration": 88, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-04-52", "timestamp": 1651064692, "time_this_iter_s": 20.73689603805542, "time_total_s": 3747.421706199646, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3747.421706199646, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 20.72142857142857, "ram_util_percent": 95.34285714285716}}
{"episode_reward_max": -11.499999999999982, "episode_reward_min": -117.2, "episode_reward_mean": -33.59300000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.4, -12.2, -33.8, -28.700000000000014, -28.900000000000034, -11.7, -52.10000000000003, -32.000000000000014, -36.600000000000044, -37.60000000000006, -31.500000000000014, -50.70000000000007, -15.099999999999982, -67.50000000000006, -21.00000000000005, -104.09999999999992, -53.90000000000004, -17.299999999999997, -31.599999999999966, -11.899999999999999, -43.000000000000036, -12.300000000000002, -16.9, -50.50000000000006, -19.800000000000026, -43.300000000000026, -26.10000000000001, -13.099999999999994, -33.299999999999976, -54.00000000000003, -17.2, -31.40000000000005, -51.80000000000005, -16.5, -56.20000000000007, -28.700000000000006, -11.499999999999982, -15.1, -52.50000000000003, -25.4, -16.399999999999988, -58.20000000000007, -16.699999999999996, -20.9, -31.00000000000001, -14.19999999999998, -33.50000000000004, -31.700000000000003, -49.700000000000045, -29.1, -23.1, -13.700000000000001, -29.000000000000007, -71.59999999999998, -56.00000000000006, -18.400000000000002, -42.20000000000007, -55.30000000000009, -18.0, -35.50000000000005, -51.500000000000036, -40.80000000000007, -32.1, -43.80000000000007, -70.60000000000004, -52.40000000000007, -47.59999999999992, -30.7, -51.60000000000006, -37.30000000000005, -16.49999999999998, -29.6, -16.4, -41.90000000000004, -34.6, -28.9, -38.1, -19.7, -50.200000000000045, -14.8, -12.199999999999983, -11.899999999999979, -13.999999999999998, -37.10000000000005, -117.2, -20.0, -29.30000000000001, -41.50000000000006, -37.299999999999976, -12.499999999999996, -34.900000000000006, -33.10000000000001, -35.20000000000004, -12.899999999999977, -14.7, -36.8, -36.800000000000054, -53.60000000000004, -29.700000000000006, -16.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8180309881566594, "mean_inference_ms": 0.6640425076020557, "mean_action_processing_ms": 0.8400256413361662, "mean_env_wait_ms": 6.2433254150801565, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 356000, "timesteps_this_iter": 0, "agent_timesteps_total": 356000, "timers": {"sample_time_ms": 20348.196, "sample_throughput": 196.578, "load_time_ms": 0.334, "load_throughput": 11964923.691, "learn_time_ms": 4128.365, "learn_throughput": 968.907}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.1827872842550277e-12, "cur_lr": 0.00010000000000000003, "total_loss": 0.8865230489457127, "policy_loss": -0.001315828436805356, "vf_loss": 88.78388979716968, "vf_explained_var": 0.02127449615027315, "kl": 0.0035561987704900043, "entropy": 0.2089062331264378, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 356000, "num_agent_steps_sampled": 356000, "num_steps_trained": 356000, "num_agent_steps_trained": 356000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3560, "training_iteration": 89, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-05-13", "timestamp": 1651064713, "time_this_iter_s": 20.5327250957489, "time_total_s": 3767.954431295395, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3767.954431295395, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 20.175000000000004, "ram_util_percent": 95.44642857142857}}
{"episode_reward_max": -9.499999999999998, "episode_reward_min": -122.89999999999986, "episode_reward_mean": -35.59300000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.399999999999988, -58.20000000000007, -16.699999999999996, -20.9, -31.00000000000001, -14.19999999999998, -33.50000000000004, -31.700000000000003, -49.700000000000045, -29.1, -23.1, -13.700000000000001, -29.000000000000007, -71.59999999999998, -56.00000000000006, -18.400000000000002, -42.20000000000007, -55.30000000000009, -18.0, -35.50000000000005, -51.500000000000036, -40.80000000000007, -32.1, -43.80000000000007, -70.60000000000004, -52.40000000000007, -47.59999999999992, -30.7, -51.60000000000006, -37.30000000000005, -16.49999999999998, -29.6, -16.4, -41.90000000000004, -34.6, -28.9, -38.1, -19.7, -50.200000000000045, -14.8, -12.199999999999983, -11.899999999999979, -13.999999999999998, -37.10000000000005, -117.2, -20.0, -29.30000000000001, -41.50000000000006, -37.299999999999976, -12.499999999999996, -34.900000000000006, -33.10000000000001, -35.20000000000004, -12.899999999999977, -14.7, -36.8, -36.800000000000054, -53.60000000000004, -29.700000000000006, -16.099999999999998, -27.20000000000001, -32.7, -122.89999999999986, -47.69999999999995, -42.30000000000008, -13.099999999999977, -32.2, -63.50000000000009, -48.50000000000002, -52.50000000000003, -86.10000000000001, -25.0, -18.199999999999996, -50.30000000000006, -12.399999999999975, -18.9, -16.199999999999996, -10.399999999999999, -46.200000000000074, -54.900000000000055, -31.000000000000007, -42.000000000000064, -35.90000000000001, -19.09999999999999, -37.700000000000074, -44.600000000000065, -44.20000000000005, -39.4, -11.099999999999994, -15.7, -51.60000000000006, -43.10000000000006, -60.79999999999987, -34.600000000000065, -29.5, -68.2, -26.800000000000004, -14.499999999999979, -9.499999999999998, -28.700000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.804089962822835, "mean_inference_ms": 0.6638648479187459, "mean_action_processing_ms": 0.8309284181685626, "mean_env_wait_ms": 6.205183624421047, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 360000, "timesteps_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"sample_time_ms": 20360.362, "sample_throughput": 196.46, "load_time_ms": 0.322, "load_throughput": 12406430.526, "learn_time_ms": 4135.785, "learn_throughput": 967.168}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0913936421275138e-12, "cur_lr": 0.00010000000000000003, "total_loss": 1.186265460912749, "policy_loss": 0.0012456252034352992, "vf_loss": 118.50198580013809, "vf_explained_var": -0.04791538965317511, "kl": 0.004173896883948072, "entropy": 0.20318172502742018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 360000, "num_agent_steps_sampled": 360000, "num_steps_trained": 360000, "num_agent_steps_trained": 360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3600, "training_iteration": 90, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-05-34", "timestamp": 1651064734, "time_this_iter_s": 20.61005711555481, "time_total_s": 3788.5644884109497, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3788.5644884109497, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 22.4, "ram_util_percent": 95.35357142857147}}
{"episode_reward_max": -9.499999999999998, "episode_reward_min": -122.89999999999986, "episode_reward_mean": -35.87000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.199999999999983, -11.899999999999979, -13.999999999999998, -37.10000000000005, -117.2, -20.0, -29.30000000000001, -41.50000000000006, -37.299999999999976, -12.499999999999996, -34.900000000000006, -33.10000000000001, -35.20000000000004, -12.899999999999977, -14.7, -36.8, -36.800000000000054, -53.60000000000004, -29.700000000000006, -16.099999999999998, -27.20000000000001, -32.7, -122.89999999999986, -47.69999999999995, -42.30000000000008, -13.099999999999977, -32.2, -63.50000000000009, -48.50000000000002, -52.50000000000003, -86.10000000000001, -25.0, -18.199999999999996, -50.30000000000006, -12.399999999999975, -18.9, -16.199999999999996, -10.399999999999999, -46.200000000000074, -54.900000000000055, -31.000000000000007, -42.000000000000064, -35.90000000000001, -19.09999999999999, -37.700000000000074, -44.600000000000065, -44.20000000000005, -39.4, -11.099999999999994, -15.7, -51.60000000000006, -43.10000000000006, -60.79999999999987, -34.600000000000065, -29.5, -68.2, -26.800000000000004, -14.499999999999979, -9.499999999999998, -28.700000000000003, -35.90000000000004, -37.80000000000006, -15.6, -14.799999999999994, -29.0, -50.100000000000044, -11.1, -33.50000000000004, -42.9, -38.30000000000002, -52.50000000000004, -30.000000000000043, -10.2, -20.1, -49.20000000000004, -40.900000000000006, -24.6, -53.30000000000006, -53.5, -93.29999999999981, -13.199999999999983, -40.500000000000085, -15.799999999999983, -46.500000000000036, -49.90000000000007, -41.90000000000002, -26.80000000000001, -29.1, -52.30000000000003, -53.600000000000044, -36.20000000000001, -17.499999999999996, -48.900000000000084, -67.50000000000004, -29.700000000000006, -42.900000000000055, -34.000000000000036, -12.29999999999998, -31.10000000000003, -14.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7906117864336941, "mean_inference_ms": 0.663513884832319, "mean_action_processing_ms": 0.8220309725617105, "mean_env_wait_ms": 6.167703149276502, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 364000, "timesteps_this_iter": 0, "agent_timesteps_total": 364000, "timers": {"sample_time_ms": 20391.582, "sample_throughput": 196.159, "load_time_ms": 0.319, "load_throughput": 12536214.601, "learn_time_ms": 4146.865, "learn_throughput": 964.584}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.456968210637569e-13, "cur_lr": 0.00010000000000000003, "total_loss": 0.7031757444654021, "policy_loss": -0.0030100725518579603, "vf_loss": 70.61858315416562, "vf_explained_var": 0.11898463586325286, "kl": 0.01043550189596463, "entropy": 0.1976019678537243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 364000, "num_agent_steps_sampled": 364000, "num_steps_trained": 364000, "num_agent_steps_trained": 364000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3640, "training_iteration": 91, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-05-54", "timestamp": 1651064754, "time_this_iter_s": 20.3510479927063, "time_total_s": 3808.915536403656, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3808.915536403656, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 14.632142857142858, "ram_util_percent": 95.30000000000003}}
{"episode_reward_max": -9.299999999999999, "episode_reward_min": -288.8000000000004, "episode_reward_mean": -38.386000000000024, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.000000000000007, -42.000000000000064, -35.90000000000001, -19.09999999999999, -37.700000000000074, -44.600000000000065, -44.20000000000005, -39.4, -11.099999999999994, -15.7, -51.60000000000006, -43.10000000000006, -60.79999999999987, -34.600000000000065, -29.5, -68.2, -26.800000000000004, -14.499999999999979, -9.499999999999998, -28.700000000000003, -35.90000000000004, -37.80000000000006, -15.6, -14.799999999999994, -29.0, -50.100000000000044, -11.1, -33.50000000000004, -42.9, -38.30000000000002, -52.50000000000004, -30.000000000000043, -10.2, -20.1, -49.20000000000004, -40.900000000000006, -24.6, -53.30000000000006, -53.5, -93.29999999999981, -13.199999999999983, -40.500000000000085, -15.799999999999983, -46.500000000000036, -49.90000000000007, -41.90000000000002, -26.80000000000001, -29.1, -52.30000000000003, -53.600000000000044, -36.20000000000001, -17.499999999999996, -48.900000000000084, -67.50000000000004, -29.700000000000006, -42.900000000000055, -34.000000000000036, -12.29999999999998, -31.10000000000003, -14.7, -53.200000000000045, -35.10000000000002, -110.3999999999999, -33.50000000000002, -32.30000000000001, -10.799999999999999, -41.20000000000006, -288.8000000000004, -30.500000000000014, -13.699999999999976, -52.50000000000004, -15.6, -31.500000000000064, -29.400000000000038, -82.40000000000002, -39.40000000000008, -52.30000000000004, -54.6, -19.600000000000016, -11.19999999999998, -43.80000000000005, -12.799999999999999, -14.6, -30.30000000000001, -65.80000000000004, -56.80000000000009, -14.799999999999983, -23.6, -35.70000000000003, -36.80000000000002, -50.80000000000003, -12.199999999999982, -43.50000000000005, -53.70000000000004, -9.299999999999999, -17.0, -46.20000000000008, -39.400000000000006, -32.2, -32.300000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.777163700943345, "mean_inference_ms": 0.6630302048789305, "mean_action_processing_ms": 0.8133287743018803, "mean_env_wait_ms": 6.131122407983139, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 368000, "timesteps_this_iter": 0, "agent_timesteps_total": 368000, "timers": {"sample_time_ms": 20358.672, "sample_throughput": 196.476, "load_time_ms": 0.319, "load_throughput": 12526854.327, "learn_time_ms": 4130.66, "learn_throughput": 968.368}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.456968210637569e-13, "cur_lr": 0.00010000000000000003, "total_loss": 4.016368536234543, "policy_loss": -0.00892588038758565, "vf_loss": 402.5294532345187, "vf_explained_var": 0.06301087448673863, "kl": 0.014323971123642813, "entropy": 0.21444357537053604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 368000, "num_agent_steps_sampled": 368000, "num_steps_trained": 368000, "num_agent_steps_trained": 368000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3680, "training_iteration": 92, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-06-14", "timestamp": 1651064774, "time_this_iter_s": 20.185996055603027, "time_total_s": 3829.101532459259, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3829.101532459259, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 14.321428571428571, "ram_util_percent": 95.27142857142856}}
{"episode_reward_max": -9.299999999999999, "episode_reward_min": -288.8000000000004, "episode_reward_mean": -39.116000000000014, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.199999999999983, -40.500000000000085, -15.799999999999983, -46.500000000000036, -49.90000000000007, -41.90000000000002, -26.80000000000001, -29.1, -52.30000000000003, -53.600000000000044, -36.20000000000001, -17.499999999999996, -48.900000000000084, -67.50000000000004, -29.700000000000006, -42.900000000000055, -34.000000000000036, -12.29999999999998, -31.10000000000003, -14.7, -53.200000000000045, -35.10000000000002, -110.3999999999999, -33.50000000000002, -32.30000000000001, -10.799999999999999, -41.20000000000006, -288.8000000000004, -30.500000000000014, -13.699999999999976, -52.50000000000004, -15.6, -31.500000000000064, -29.400000000000038, -82.40000000000002, -39.40000000000008, -52.30000000000004, -54.6, -19.600000000000016, -11.19999999999998, -43.80000000000005, -12.799999999999999, -14.6, -30.30000000000001, -65.80000000000004, -56.80000000000009, -14.799999999999983, -23.6, -35.70000000000003, -36.80000000000002, -50.80000000000003, -12.199999999999982, -43.50000000000005, -53.70000000000004, -9.299999999999999, -17.0, -46.20000000000008, -39.400000000000006, -32.2, -32.300000000000004, -30.10000000000001, -20.700000000000003, -19.000000000000018, -137.79999999999964, -43.70000000000006, -33.7, -51.00000000000005, -32.09999999999997, -26.199999999999996, -27.700000000000003, -52.60000000000003, -35.300000000000004, -45.20000000000007, -19.200000000000014, -14.199999999999994, -9.4, -24.60000000000001, -36.5, -44.1, -26.900000000000006, -30.300000000000026, -28.10000000000002, -39.0, -35.30000000000007, -49.00000000000006, -51.50000000000004, -48.00000000000003, -29.0, -16.799999999999997, -44.100000000000044, -52.000000000000064, -12.099999999999977, -41.10000000000006, -53.00000000000004, -30.400000000000013, -105.59999999999981, -10.6, -42.50000000000003, -11.5, -37.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7639823411941398, "mean_inference_ms": 0.6625644698621772, "mean_action_processing_ms": 0.804813918648751, "mean_env_wait_ms": 6.094987532984769, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 372000, "timesteps_this_iter": 0, "agent_timesteps_total": 372000, "timers": {"sample_time_ms": 20315.113, "sample_throughput": 196.898, "load_time_ms": 0.251, "load_throughput": 15928240.767, "learn_time_ms": 4127.292, "learn_throughput": 969.159}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.456968210637569e-13, "cur_lr": 0.00010000000000000003, "total_loss": 0.9846792223312522, "policy_loss": -0.008963483290105897, "vf_loss": 99.36427271443029, "vf_explained_var": -0.022854753207134943, "kl": 0.005065342350068418, "entropy": 0.24445883430620677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 372000, "num_agent_steps_sampled": 372000, "num_steps_trained": 372000, "num_agent_steps_trained": 372000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3720, "training_iteration": 93, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-06-34", "timestamp": 1651064794, "time_this_iter_s": 20.015756845474243, "time_total_s": 3849.1172893047333, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3849.1172893047333, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 12.203703703703704, "ram_util_percent": 95.22592592592594}}
{"episode_reward_max": -9.299999999999999, "episode_reward_min": -147.5999999999998, "episode_reward_mean": -36.30900000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.80000000000005, -12.799999999999999, -14.6, -30.30000000000001, -65.80000000000004, -56.80000000000009, -14.799999999999983, -23.6, -35.70000000000003, -36.80000000000002, -50.80000000000003, -12.199999999999982, -43.50000000000005, -53.70000000000004, -9.299999999999999, -17.0, -46.20000000000008, -39.400000000000006, -32.2, -32.300000000000004, -30.10000000000001, -20.700000000000003, -19.000000000000018, -137.79999999999964, -43.70000000000006, -33.7, -51.00000000000005, -32.09999999999997, -26.199999999999996, -27.700000000000003, -52.60000000000003, -35.300000000000004, -45.20000000000007, -19.200000000000014, -14.199999999999994, -9.4, -24.60000000000001, -36.5, -44.1, -26.900000000000006, -30.300000000000026, -28.10000000000002, -39.0, -35.30000000000007, -49.00000000000006, -51.50000000000004, -48.00000000000003, -29.0, -16.799999999999997, -44.100000000000044, -52.000000000000064, -12.099999999999977, -41.10000000000006, -53.00000000000004, -30.400000000000013, -105.59999999999981, -10.6, -42.50000000000003, -11.5, -37.7, -35.20000000000005, -41.00000000000007, -13.09999999999998, -44.4, -51.40000000000003, -21.300000000000004, -19.5, -48.700000000000045, -32.20000000000001, -18.199999999999996, -37.4, -47.59999999999999, -12.1, -45.100000000000065, -23.9, -31.200000000000006, -147.5999999999998, -14.899999999999995, -18.799999999999997, -55.20000000000003, -51.90000000000004, -38.300000000000054, -35.600000000000065, -16.499999999999993, -53.30000000000006, -15.699999999999982, -52.600000000000044, -14.699999999999976, -52.800000000000026, -35.70000000000001, -11.599999999999984, -14.2, -31.50000000000003, -18.49999999999999, -53.00000000000004, -48.00000000000007, -18.8, -51.300000000000054, -36.30000000000003, -52.600000000000044], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7515176105723966, "mean_inference_ms": 0.6618482925620619, "mean_action_processing_ms": 0.796474068797001, "mean_env_wait_ms": 6.059170061962431, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 376000, "timesteps_this_iter": 0, "agent_timesteps_total": 376000, "timers": {"sample_time_ms": 20289.274, "sample_throughput": 197.148, "load_time_ms": 0.286, "load_throughput": 14009031.396, "learn_time_ms": 4123.632, "learn_throughput": 970.019}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.456968210637569e-13, "cur_lr": 0.00010000000000000003, "total_loss": 1.1846708062585563, "policy_loss": 0.002060569930441117, "vf_loss": 118.26102679467971, "vf_explained_var": 0.11167677064095774, "kl": 0.00517207102827365, "entropy": 0.25434734895024247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 376000, "num_agent_steps_sampled": 376000, "num_steps_trained": 376000, "num_agent_steps_trained": 376000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3760, "training_iteration": 94, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-06-54", "timestamp": 1651064814, "time_this_iter_s": 19.890843868255615, "time_total_s": 3869.008133172989, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3869.008133172989, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 8.407407407407407, "ram_util_percent": 95.17777777777776}}
{"episode_reward_max": -10.6, "episode_reward_min": -147.5999999999998, "episode_reward_mean": -35.25500000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.300000000000026, -28.10000000000002, -39.0, -35.30000000000007, -49.00000000000006, -51.50000000000004, -48.00000000000003, -29.0, -16.799999999999997, -44.100000000000044, -52.000000000000064, -12.099999999999977, -41.10000000000006, -53.00000000000004, -30.400000000000013, -105.59999999999981, -10.6, -42.50000000000003, -11.5, -37.7, -35.20000000000005, -41.00000000000007, -13.09999999999998, -44.4, -51.40000000000003, -21.300000000000004, -19.5, -48.700000000000045, -32.20000000000001, -18.199999999999996, -37.4, -47.59999999999999, -12.1, -45.100000000000065, -23.9, -31.200000000000006, -147.5999999999998, -14.899999999999995, -18.799999999999997, -55.20000000000003, -51.90000000000004, -38.300000000000054, -35.600000000000065, -16.499999999999993, -53.30000000000006, -15.699999999999982, -52.600000000000044, -14.699999999999976, -52.800000000000026, -35.70000000000001, -11.599999999999984, -14.2, -31.50000000000003, -18.49999999999999, -53.00000000000004, -48.00000000000007, -18.8, -51.300000000000054, -36.30000000000003, -52.600000000000044, -18.9, -11.899999999999999, -11.899999999999999, -38.099999999999994, -65.80000000000004, -40.000000000000064, -17.599999999999994, -50.00000000000004, -19.299999999999997, -28.800000000000004, -26.700000000000003, -12.099999999999982, -55.700000000000045, -17.7, -24.800000000000004, -29.90000000000003, -22.400000000000013, -21.800000000000004, -12.89999999999998, -13.199999999999985, -18.5, -13.999999999999975, -43.00000000000004, -18.900000000000002, -35.00000000000005, -31.500000000000014, -38.40000000000002, -29.7, -52.80000000000003, -42.20000000000008, -52.20000000000005, -26.900000000000038, -12.199999999999978, -37.1, -37.09999999999998, -53.80000000000005, -99.20000000000017, -34.199999999999996, -52.70000000000003, -27.30000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7400088364546644, "mean_inference_ms": 0.6616324784772529, "mean_action_processing_ms": 0.7883295129776472, "mean_env_wait_ms": 6.025159610559367, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 380000, "timesteps_this_iter": 0, "agent_timesteps_total": 380000, "timers": {"sample_time_ms": 20505.491, "sample_throughput": 195.07, "load_time_ms": 0.295, "load_throughput": 13571603.3, "learn_time_ms": 4162.106, "learn_throughput": 961.052}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.456968210637569e-13, "cur_lr": 0.00010000000000000003, "total_loss": 0.7385862927207903, "policy_loss": -0.0015043293115913226, "vf_loss": 74.00906330026606, "vf_explained_var": -0.08369910652919482, "kl": 0.0037485035298513315, "entropy": 0.22516578442306928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 380000, "num_agent_steps_sampled": 380000, "num_steps_trained": 380000, "num_agent_steps_trained": 380000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3800, "training_iteration": 95, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-07-17", "timestamp": 1651064837, "time_this_iter_s": 22.632470846176147, "time_total_s": 3891.640604019165, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3891.640604019165, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 26.98709677419355, "ram_util_percent": 95.4967741935484}}
{"episode_reward_max": -11.599999999999984, "episode_reward_min": -144.89999999999978, "episode_reward_mean": -37.379000000000026, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.90000000000004, -38.300000000000054, -35.600000000000065, -16.499999999999993, -53.30000000000006, -15.699999999999982, -52.600000000000044, -14.699999999999976, -52.800000000000026, -35.70000000000001, -11.599999999999984, -14.2, -31.50000000000003, -18.49999999999999, -53.00000000000004, -48.00000000000007, -18.8, -51.300000000000054, -36.30000000000003, -52.600000000000044, -18.9, -11.899999999999999, -11.899999999999999, -38.099999999999994, -65.80000000000004, -40.000000000000064, -17.599999999999994, -50.00000000000004, -19.299999999999997, -28.800000000000004, -26.700000000000003, -12.099999999999982, -55.700000000000045, -17.7, -24.800000000000004, -29.90000000000003, -22.400000000000013, -21.800000000000004, -12.89999999999998, -13.199999999999985, -18.5, -13.999999999999975, -43.00000000000004, -18.900000000000002, -35.00000000000005, -31.500000000000014, -38.40000000000002, -29.7, -52.80000000000003, -42.20000000000008, -52.20000000000005, -26.900000000000038, -12.199999999999978, -37.1, -37.09999999999998, -53.80000000000005, -99.20000000000017, -34.199999999999996, -52.70000000000003, -27.30000000000002, -49.90000000000006, -15.099999999999998, -29.5, -45.60000000000005, -37.50000000000006, -30.90000000000001, -52.90000000000004, -46.400000000000055, -48.800000000000054, -48.40000000000003, -43.00000000000006, -33.0, -33.400000000000006, -15.299999999999983, -53.40000000000007, -67.6, -33.10000000000002, -35.90000000000006, -49.20000000000005, -52.700000000000045, -12.99999999999998, -35.60000000000001, -54.50000000000004, -21.099999999999998, -26.300000000000008, -32.000000000000014, -45.40000000000006, -54.90000000000006, -52.300000000000026, -28.599999999999998, -45.70000000000008, -42.00000000000008, -51.00000000000005, -18.499999999999993, -28.6, -40.200000000000045, -144.89999999999978, -69.90000000000002, -59.20000000000007, -53.50000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7284776921401874, "mean_inference_ms": 0.6620602371370787, "mean_action_processing_ms": 0.7803720875729238, "mean_env_wait_ms": 5.993061586528609, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 384000, "timesteps_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"sample_time_ms": 20675.976, "sample_throughput": 193.461, "load_time_ms": 0.306, "load_throughput": 13082669.994, "learn_time_ms": 4207.454, "learn_throughput": 950.694}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7284841053187846e-13, "cur_lr": 0.00010000000000000003, "total_loss": 1.3250131842963178, "policy_loss": 0.006101097050373272, "vf_loss": 131.89121122975504, "vf_explained_var": 0.17883724371592205, "kl": 0.0026833991662486576, "entropy": 0.153305201879352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 384000, "num_agent_steps_sampled": 384000, "num_steps_trained": 384000, "num_agent_steps_trained": 384000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3840, "training_iteration": 96, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-07-39", "timestamp": 1651064859, "time_this_iter_s": 21.843594074249268, "time_total_s": 3913.4841980934143, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3913.4841980934143, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 21.6, "ram_util_percent": 95.45000000000003}}
{"episode_reward_max": -8.1, "episode_reward_min": -165.79999999999973, "episode_reward_mean": -40.59100000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.5, -13.999999999999975, -43.00000000000004, -18.900000000000002, -35.00000000000005, -31.500000000000014, -38.40000000000002, -29.7, -52.80000000000003, -42.20000000000008, -52.20000000000005, -26.900000000000038, -12.199999999999978, -37.1, -37.09999999999998, -53.80000000000005, -99.20000000000017, -34.199999999999996, -52.70000000000003, -27.30000000000002, -49.90000000000006, -15.099999999999998, -29.5, -45.60000000000005, -37.50000000000006, -30.90000000000001, -52.90000000000004, -46.400000000000055, -48.800000000000054, -48.40000000000003, -43.00000000000006, -33.0, -33.400000000000006, -15.299999999999983, -53.40000000000007, -67.6, -33.10000000000002, -35.90000000000006, -49.20000000000005, -52.700000000000045, -12.99999999999998, -35.60000000000001, -54.50000000000004, -21.099999999999998, -26.300000000000008, -32.000000000000014, -45.40000000000006, -54.90000000000006, -52.300000000000026, -28.599999999999998, -45.70000000000008, -42.00000000000008, -51.00000000000005, -18.499999999999993, -28.6, -40.200000000000045, -144.89999999999978, -69.90000000000002, -59.20000000000007, -53.50000000000004, -83.7, -41.50000000000005, -14.799999999999985, -28.400000000000006, -46.600000000000016, -24.60000000000001, -20.10000000000001, -15.199999999999998, -8.1, -57.10000000000008, -17.29999999999998, -22.700000000000003, -57.20000000000001, -50.400000000000034, -34.80000000000007, -29.800000000000054, -37.400000000000084, -12.999999999999998, -34.00000000000005, -22.7, -45.300000000000026, -59.30000000000011, -13.099999999999982, -34.40000000000004, -165.79999999999973, -50.80000000000003, -18.2, -36.80000000000007, -30.800000000000054, -20.300000000000026, -26.40000000000004, -82.00000000000001, -28.30000000000001, -34.3, -36.60000000000001, -27.400000000000006, -44.50000000000006, -44.80000000000009, -51.80000000000003, -53.29999999999992], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7169670855243004, "mean_inference_ms": 0.6630569827284137, "mean_action_processing_ms": 0.7725954851779554, "mean_env_wait_ms": 5.962591519893665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 388000, "timesteps_this_iter": 0, "agent_timesteps_total": 388000, "timers": {"sample_time_ms": 20950.738, "sample_throughput": 190.924, "load_time_ms": 0.364, "load_throughput": 10977698.096, "learn_time_ms": 4250.014, "learn_throughput": 941.173}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3642420526593923e-13, "cur_lr": 0.00010000000000000003, "total_loss": 1.4529582495010027, "policy_loss": -0.0002677738245937132, "vf_loss": 145.3226058816397, "vf_explained_var": -0.08994588031563708, "kl": 0.004906391139060918, "entropy": 0.24421988701828384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 388000, "num_agent_steps_sampled": 388000, "num_steps_trained": 388000, "num_agent_steps_trained": 388000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3880, "training_iteration": 97, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-08-02", "timestamp": 1651064882, "time_this_iter_s": 22.8876531124115, "time_total_s": 3936.371851205826, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3936.371851205826, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 19.483870967741936, "ram_util_percent": 95.30645161290323}}
{"episode_reward_max": -8.1, "episode_reward_min": -165.79999999999973, "episode_reward_mean": -39.76300000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.99999999999998, -35.60000000000001, -54.50000000000004, -21.099999999999998, -26.300000000000008, -32.000000000000014, -45.40000000000006, -54.90000000000006, -52.300000000000026, -28.599999999999998, -45.70000000000008, -42.00000000000008, -51.00000000000005, -18.499999999999993, -28.6, -40.200000000000045, -144.89999999999978, -69.90000000000002, -59.20000000000007, -53.50000000000004, -83.7, -41.50000000000005, -14.799999999999985, -28.400000000000006, -46.600000000000016, -24.60000000000001, -20.10000000000001, -15.199999999999998, -8.1, -57.10000000000008, -17.29999999999998, -22.700000000000003, -57.20000000000001, -50.400000000000034, -34.80000000000007, -29.800000000000054, -37.400000000000084, -12.999999999999998, -34.00000000000005, -22.7, -45.300000000000026, -59.30000000000011, -13.099999999999982, -34.40000000000004, -165.79999999999973, -50.80000000000003, -18.2, -36.80000000000007, -30.800000000000054, -20.300000000000026, -26.40000000000004, -82.00000000000001, -28.30000000000001, -34.3, -36.60000000000001, -27.400000000000006, -44.50000000000006, -44.80000000000009, -51.80000000000003, -53.29999999999992, -15.499999999999982, -60.100000000000094, -52.900000000000034, -49.40000000000004, -18.4, -100.69999999999992, -52.20000000000007, -17.6, -40.40000000000006, -41.500000000000036, -31.0, -34.10000000000004, -33.00000000000004, -38.900000000000084, -13.899999999999997, -14.299999999999985, -27.100000000000016, -55.400000000000006, -27.700000000000003, -34.000000000000036, -35.200000000000045, -33.100000000000044, -38.50000000000001, -49.70000000000006, -52.80000000000003, -59.200000000000024, -18.19999999999999, -11.199999999999998, -24.400000000000002, -13.799999999999997, -51.00000000000004, -35.70000000000006, -12.099999999999987, -53.70000000000003, -49.100000000000044, -36.100000000000016, -36.40000000000001, -41.400000000000034, -44.90000000000006, -40.90000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.705651988084353, "mean_inference_ms": 0.6637762817668957, "mean_action_processing_ms": 0.7649712398689554, "mean_env_wait_ms": 5.932068458931457, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 392000, "timesteps_this_iter": 0, "agent_timesteps_total": 392000, "timers": {"sample_time_ms": 21039.275, "sample_throughput": 190.121, "load_time_ms": 0.358, "load_throughput": 11175869.971, "learn_time_ms": 4330.836, "learn_throughput": 923.609}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.821210263296962e-14, "cur_lr": 0.00010000000000000003, "total_loss": 0.8998589902024676, "policy_loss": -0.003336104714582043, "vf_loss": 90.3195112402721, "vf_explained_var": 0.13233828012661267, "kl": 0.002650263105749248, "entropy": 0.16887859983109338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 392000, "num_agent_steps_sampled": 392000, "num_steps_trained": 392000, "num_agent_steps_trained": 392000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3920, "training_iteration": 98, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-08-24", "timestamp": 1651064904, "time_this_iter_s": 22.005033016204834, "time_total_s": 3958.3768842220306, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3958.3768842220306, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 20.526666666666664, "ram_util_percent": 95.23333333333332}}
{"episode_reward_max": -11.199999999999989, "episode_reward_min": -165.79999999999973, "episode_reward_mean": -39.13300000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.300000000000026, -59.30000000000011, -13.099999999999982, -34.40000000000004, -165.79999999999973, -50.80000000000003, -18.2, -36.80000000000007, -30.800000000000054, -20.300000000000026, -26.40000000000004, -82.00000000000001, -28.30000000000001, -34.3, -36.60000000000001, -27.400000000000006, -44.50000000000006, -44.80000000000009, -51.80000000000003, -53.29999999999992, -15.499999999999982, -60.100000000000094, -52.900000000000034, -49.40000000000004, -18.4, -100.69999999999992, -52.20000000000007, -17.6, -40.40000000000006, -41.500000000000036, -31.0, -34.10000000000004, -33.00000000000004, -38.900000000000084, -13.899999999999997, -14.299999999999985, -27.100000000000016, -55.400000000000006, -27.700000000000003, -34.000000000000036, -35.200000000000045, -33.100000000000044, -38.50000000000001, -49.70000000000006, -52.80000000000003, -59.200000000000024, -18.19999999999999, -11.199999999999998, -24.400000000000002, -13.799999999999997, -51.00000000000004, -35.70000000000006, -12.099999999999987, -53.70000000000003, -49.100000000000044, -36.100000000000016, -36.40000000000001, -41.400000000000034, -44.90000000000006, -40.90000000000006, -49.50000000000005, -57.60000000000008, -32.400000000000006, -37.40000000000007, -11.2, -37.10000000000007, -86.69999999999997, -39.200000000000074, -11.799999999999997, -50.200000000000074, -51.90000000000004, -33.2, -20.799999999999997, -35.90000000000005, -53.70000000000004, -12.399999999999983, -22.700000000000003, -17.699999999999996, -28.00000000000001, -32.200000000000045, -12.099999999999994, -68.70000000000002, -51.90000000000005, -53.800000000000054, -11.199999999999989, -43.00000000000007, -23.400000000000016, -39.39999999999999, -39.70000000000002, -35.80000000000004, -161.39999999999975, -14.299999999999981, -28.800000000000004, -14.099999999999989, -29.800000000000015, -71.00000000000006, -22.300000000000004, -37.3, -20.299999999999997, -13.699999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6948248650198758, "mean_inference_ms": 0.664440544308992, "mean_action_processing_ms": 0.7575010899174095, "mean_env_wait_ms": 5.901720553733383, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 396000, "timesteps_this_iter": 0, "agent_timesteps_total": 396000, "timers": {"sample_time_ms": 21238.087, "sample_throughput": 188.341, "load_time_ms": 0.356, "load_throughput": 11234993.638, "learn_time_ms": 4374.837, "learn_throughput": 914.32}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.410605131648481e-14, "cur_lr": 0.00010000000000000003, "total_loss": 1.4733982405374928, "policy_loss": -0.0013417553647311145, "vf_loss": 147.47400170705652, "vf_explained_var": -0.013527598880952405, "kl": 0.0038280073436181136, "entropy": 0.21214499941035625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 396000, "num_agent_steps_sampled": 396000, "num_steps_trained": 396000, "num_agent_steps_trained": 396000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3960, "training_iteration": 99, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-08-46", "timestamp": 1651064926, "time_this_iter_s": 22.156810998916626, "time_total_s": 3980.5336952209473, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 3980.5336952209473, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 16.858064516129033, "ram_util_percent": 95.35161290322581}}
{"episode_reward_max": -11.199999999999989, "episode_reward_min": -161.39999999999975, "episode_reward_mean": -37.082000000000015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.200000000000045, -33.100000000000044, -38.50000000000001, -49.70000000000006, -52.80000000000003, -59.200000000000024, -18.19999999999999, -11.199999999999998, -24.400000000000002, -13.799999999999997, -51.00000000000004, -35.70000000000006, -12.099999999999987, -53.70000000000003, -49.100000000000044, -36.100000000000016, -36.40000000000001, -41.400000000000034, -44.90000000000006, -40.90000000000006, -49.50000000000005, -57.60000000000008, -32.400000000000006, -37.40000000000007, -11.2, -37.10000000000007, -86.69999999999997, -39.200000000000074, -11.799999999999997, -50.200000000000074, -51.90000000000004, -33.2, -20.799999999999997, -35.90000000000005, -53.70000000000004, -12.399999999999983, -22.700000000000003, -17.699999999999996, -28.00000000000001, -32.200000000000045, -12.099999999999994, -68.70000000000002, -51.90000000000005, -53.800000000000054, -11.199999999999989, -43.00000000000007, -23.400000000000016, -39.39999999999999, -39.70000000000002, -35.80000000000004, -161.39999999999975, -14.299999999999981, -28.800000000000004, -14.099999999999989, -29.800000000000015, -71.00000000000006, -22.300000000000004, -37.3, -20.299999999999997, -13.699999999999996, -37.90000000000006, -11.499999999999988, -58.80000000000008, -15.999999999999995, -28.20000000000001, -35.400000000000006, -36.400000000000006, -39.90000000000001, -26.900000000000034, -26.300000000000004, -45.70000000000004, -36.7, -15.299999999999997, -28.800000000000043, -26.600000000000005, -51.400000000000034, -28.300000000000004, -51.200000000000045, -15.499999999999979, -50.80000000000005, -49.00000000000006, -47.40000000000006, -60.099999999999966, -34.80000000000005, -31.20000000000001, -52.900000000000034, -13.699999999999982, -12.999999999999977, -51.60000000000003, -83.50000000000004, -12.999999999999988, -23.500000000000007, -41.00000000000007, -13.7, -27.799999999999997, -11.899999999999988, -45.000000000000014, -49.10000000000003, -70.99999999999989, -56.40000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6841425430775308, "mean_inference_ms": 0.6645149779567974, "mean_action_processing_ms": 0.7501624899327181, "mean_env_wait_ms": 5.871031789600762, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 400000, "timesteps_this_iter": 0, "agent_timesteps_total": 400000, "timers": {"sample_time_ms": 21241.004, "sample_throughput": 188.315, "load_time_ms": 0.355, "load_throughput": 11283351.94, "learn_time_ms": 4375.188, "learn_throughput": 914.246}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7053025658242404e-14, "cur_lr": 0.00010000000000000003, "total_loss": 0.8514552866727094, "policy_loss": 0.0008871840087756995, "vf_loss": 85.05681152959023, "vf_explained_var": 0.10281975570545401, "kl": 0.008199669130668058, "entropy": 0.23783827844446384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 400000, "num_agent_steps_sampled": 400000, "num_steps_trained": 400000, "num_agent_steps_trained": 400000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4000, "training_iteration": 100, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-09-06", "timestamp": 1651064946, "time_this_iter_s": 20.205424070358276, "time_total_s": 4000.7391192913055, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4000.7391192913055, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 5.459259259259259, "ram_util_percent": 95.34814814814817}}
{"episode_reward_max": -11.099999999999984, "episode_reward_min": -161.39999999999975, "episode_reward_mean": -36.878000000000014, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.099999999999994, -68.70000000000002, -51.90000000000005, -53.800000000000054, -11.199999999999989, -43.00000000000007, -23.400000000000016, -39.39999999999999, -39.70000000000002, -35.80000000000004, -161.39999999999975, -14.299999999999981, -28.800000000000004, -14.099999999999989, -29.800000000000015, -71.00000000000006, -22.300000000000004, -37.3, -20.299999999999997, -13.699999999999996, -37.90000000000006, -11.499999999999988, -58.80000000000008, -15.999999999999995, -28.20000000000001, -35.400000000000006, -36.400000000000006, -39.90000000000001, -26.900000000000034, -26.300000000000004, -45.70000000000004, -36.7, -15.299999999999997, -28.800000000000043, -26.600000000000005, -51.400000000000034, -28.300000000000004, -51.200000000000045, -15.499999999999979, -50.80000000000005, -49.00000000000006, -47.40000000000006, -60.099999999999966, -34.80000000000005, -31.20000000000001, -52.900000000000034, -13.699999999999982, -12.999999999999977, -51.60000000000003, -83.50000000000004, -12.999999999999988, -23.500000000000007, -41.00000000000007, -13.7, -27.799999999999997, -11.899999999999988, -45.000000000000014, -49.10000000000003, -70.99999999999989, -56.40000000000006, -34.40000000000002, -31.300000000000004, -49.30000000000004, -46.30000000000001, -34.7, -29.100000000000016, -13.09999999999998, -11.099999999999984, -52.20000000000005, -16.399999999999995, -43.40000000000002, -13.99999999999998, -51.80000000000004, -50.60000000000006, -53.50000000000007, -50.60000000000005, -34.40000000000005, -37.3, -51.60000000000005, -64.2, -17.399999999999977, -50.400000000000084, -19.100000000000016, -22.6, -81.80000000000001, -23.900000000000002, -22.500000000000014, -48.5000000000001, -50.50000000000004, -31.200000000000003, -25.099999999999998, -38.600000000000044, -16.5, -22.800000000000026, -27.600000000000055, -48.40000000000001, -51.00000000000004, -28.60000000000001, -30.0, -12.799999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.673522403146061, "mean_inference_ms": 0.6643426320093903, "mean_action_processing_ms": 0.7429641110806614, "mean_env_wait_ms": 5.840658696956577, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 404000, "timesteps_this_iter": 0, "agent_timesteps_total": 404000, "timers": {"sample_time_ms": 21272.552, "sample_throughput": 188.036, "load_time_ms": 0.357, "load_throughput": 11197501.168, "learn_time_ms": 4401.251, "learn_throughput": 908.833}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7053025658242404e-14, "cur_lr": 0.00010000000000000003, "total_loss": 0.6911333508952271, "policy_loss": -5.882761431156948e-05, "vf_loss": 69.11921937798941, "vf_explained_var": 0.06392879043855974, "kl": 0.0034405793157071514, "entropy": 0.21499706487301537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 404000, "num_agent_steps_sampled": 404000, "num_steps_trained": 404000, "num_agent_steps_trained": 404000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4040, "training_iteration": 101, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-09-27", "timestamp": 1651064967, "time_this_iter_s": 20.927253007888794, "time_total_s": 4021.6663722991943, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4021.6663722991943, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 15.73448275862069, "ram_util_percent": 95.31724137931037}}
{"episode_reward_max": -11.099999999999984, "episode_reward_min": -148.09999999999977, "episode_reward_mean": -36.63200000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.00000000000006, -47.40000000000006, -60.099999999999966, -34.80000000000005, -31.20000000000001, -52.900000000000034, -13.699999999999982, -12.999999999999977, -51.60000000000003, -83.50000000000004, -12.999999999999988, -23.500000000000007, -41.00000000000007, -13.7, -27.799999999999997, -11.899999999999988, -45.000000000000014, -49.10000000000003, -70.99999999999989, -56.40000000000006, -34.40000000000002, -31.300000000000004, -49.30000000000004, -46.30000000000001, -34.7, -29.100000000000016, -13.09999999999998, -11.099999999999984, -52.20000000000005, -16.399999999999995, -43.40000000000002, -13.99999999999998, -51.80000000000004, -50.60000000000006, -53.50000000000007, -50.60000000000005, -34.40000000000005, -37.3, -51.60000000000005, -64.2, -17.399999999999977, -50.400000000000084, -19.100000000000016, -22.6, -81.80000000000001, -23.900000000000002, -22.500000000000014, -48.5000000000001, -50.50000000000004, -31.200000000000003, -25.099999999999998, -38.600000000000044, -16.5, -22.800000000000026, -27.600000000000055, -48.40000000000001, -51.00000000000004, -28.60000000000001, -30.0, -12.799999999999997, -14.399999999999979, -33.10000000000001, -52.900000000000034, -32.70000000000001, -31.700000000000003, -24.60000000000001, -35.80000000000005, -53.100000000000044, -148.09999999999977, -24.000000000000004, -12.699999999999996, -30.9, -43.3, -39.70000000000006, -41.599999999999994, -18.80000000000001, -44.4, -39.6, -35.20000000000001, -42.400000000000055, -53.400000000000034, -11.499999999999986, -35.00000000000006, -28.60000000000005, -29.799999999999997, -33.00000000000001, -40.900000000000006, -40.1, -39.400000000000006, -14.999999999999977, -18.000000000000004, -23.3, -38.90000000000002, -26.800000000000008, -37.10000000000005, -46.90000000000009, -40.500000000000014, -12.799999999999997, -11.999999999999996, -53.00000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6631909382021173, "mean_inference_ms": 0.6648828042559238, "mean_action_processing_ms": 0.7359303283173041, "mean_env_wait_ms": 5.812444075248716, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 408000, "timesteps_this_iter": 0, "agent_timesteps_total": 408000, "timers": {"sample_time_ms": 21610.384, "sample_throughput": 185.096, "load_time_ms": 0.363, "load_throughput": 11031110.527, "learn_time_ms": 4422.826, "learn_throughput": 904.399}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.526512829121202e-15, "cur_lr": 0.00010000000000000003, "total_loss": 0.9895599490502268, "policy_loss": 0.0034502058380073116, "vf_loss": 98.61097631864651, "vf_explained_var": 0.1683753506470752, "kl": 0.0037030515613601447, "entropy": 0.177132184850052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 408000, "num_agent_steps_sampled": 408000, "num_steps_trained": 408000, "num_agent_steps_trained": 408000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4080, "training_iteration": 102, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-09-51", "timestamp": 1651064991, "time_this_iter_s": 23.52066421508789, "time_total_s": 4045.187036514282, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4045.187036514282, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 29.625, "ram_util_percent": 95.209375}}
{"episode_reward_max": -8.5, "episode_reward_min": -151.99999999999974, "episode_reward_mean": -35.05700000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.399999999999977, -50.400000000000084, -19.100000000000016, -22.6, -81.80000000000001, -23.900000000000002, -22.500000000000014, -48.5000000000001, -50.50000000000004, -31.200000000000003, -25.099999999999998, -38.600000000000044, -16.5, -22.800000000000026, -27.600000000000055, -48.40000000000001, -51.00000000000004, -28.60000000000001, -30.0, -12.799999999999997, -14.399999999999979, -33.10000000000001, -52.900000000000034, -32.70000000000001, -31.700000000000003, -24.60000000000001, -35.80000000000005, -53.100000000000044, -148.09999999999977, -24.000000000000004, -12.699999999999996, -30.9, -43.3, -39.70000000000006, -41.599999999999994, -18.80000000000001, -44.4, -39.6, -35.20000000000001, -42.400000000000055, -53.400000000000034, -11.499999999999986, -35.00000000000006, -28.60000000000005, -29.799999999999997, -33.00000000000001, -40.900000000000006, -40.1, -39.400000000000006, -14.999999999999977, -18.000000000000004, -23.3, -38.90000000000002, -26.800000000000008, -37.10000000000005, -46.90000000000009, -40.500000000000014, -12.799999999999997, -11.999999999999996, -53.00000000000004, -32.90000000000001, -19.8, -14.7, -22.300000000000004, -31.49999999999996, -38.099999999999994, -8.5, -72.40000000000003, -15.099999999999984, -26.000000000000046, -35.000000000000036, -13.699999999999996, -38.50000000000008, -36.200000000000045, -41.00000000000003, -47.90000000000005, -28.40000000000002, -29.000000000000014, -22.200000000000035, -39.50000000000004, -51.20000000000004, -32.30000000000006, -30.699999999999957, -27.700000000000006, -13.899999999999993, -10.599999999999978, -49.500000000000085, -60.600000000000065, -36.70000000000001, -17.299999999999976, -42.80000000000002, -151.99999999999974, -9.999999999999991, -37.6, -8.799999999999997, -33.400000000000006, -51.00000000000007, -47.10000000000007, -23.5, -52.00000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.653046648243872, "mean_inference_ms": 0.6657459113649175, "mean_action_processing_ms": 0.7290453122307303, "mean_env_wait_ms": 5.785189365524718, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 412000, "timesteps_this_iter": 0, "agent_timesteps_total": 412000, "timers": {"sample_time_ms": 21733.07, "sample_throughput": 184.051, "load_time_ms": 0.364, "load_throughput": 10991362.683, "learn_time_ms": 4456.98, "learn_throughput": 897.469}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.263256414560601e-15, "cur_lr": 0.00010000000000000003, "total_loss": 1.2302056490729052, "policy_loss": 0.005578119366840329, "vf_loss": 122.46275538372737, "vf_explained_var": -0.010546177241110033, "kl": 0.0050710519830027565, "entropy": 0.16895138772595072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 412000, "num_agent_steps_sampled": 412000, "num_steps_trained": 412000, "num_agent_steps_trained": 412000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4120, "training_iteration": 103, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-10-12", "timestamp": 1651065012, "time_this_iter_s": 21.37693190574646, "time_total_s": 4066.5639684200287, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4066.5639684200287, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 17.903448275862072, "ram_util_percent": 95.18620689655171}}
{"episode_reward_max": -8.5, "episode_reward_min": -151.99999999999974, "episode_reward_mean": -33.38900000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-53.400000000000034, -11.499999999999986, -35.00000000000006, -28.60000000000005, -29.799999999999997, -33.00000000000001, -40.900000000000006, -40.1, -39.400000000000006, -14.999999999999977, -18.000000000000004, -23.3, -38.90000000000002, -26.800000000000008, -37.10000000000005, -46.90000000000009, -40.500000000000014, -12.799999999999997, -11.999999999999996, -53.00000000000004, -32.90000000000001, -19.8, -14.7, -22.300000000000004, -31.49999999999996, -38.099999999999994, -8.5, -72.40000000000003, -15.099999999999984, -26.000000000000046, -35.000000000000036, -13.699999999999996, -38.50000000000008, -36.200000000000045, -41.00000000000003, -47.90000000000005, -28.40000000000002, -29.000000000000014, -22.200000000000035, -39.50000000000004, -51.20000000000004, -32.30000000000006, -30.699999999999957, -27.700000000000006, -13.899999999999993, -10.599999999999978, -49.500000000000085, -60.600000000000065, -36.70000000000001, -17.299999999999976, -42.80000000000002, -151.99999999999974, -9.999999999999991, -37.6, -8.799999999999997, -33.400000000000006, -51.00000000000007, -47.10000000000007, -23.5, -52.00000000000005, -26.400000000000006, -42.30000000000002, -30.100000000000012, -39.400000000000034, -42.900000000000084, -50.20000000000004, -18.9, -10.2, -15.599999999999996, -26.200000000000003, -23.300000000000004, -30.9, -41.100000000000016, -51.40000000000005, -42.80000000000006, -48.70000000000004, -40.80000000000006, -21.400000000000027, -15.499999999999977, -54.30000000000006, -37.900000000000006, -31.60000000000004, -15.299999999999994, -35.600000000000016, -20.200000000000017, -30.100000000000026, -44.00000000000008, -55.60000000000006, -45.20000000000006, -31.200000000000003, -30.8, -13.599999999999989, -13.599999999999996, -42.40000000000008, -52.90000000000005, -17.5, -50.10000000000005, -29.000000000000025, -16.599999999999994, -15.899999999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6429781858250498, "mean_inference_ms": 0.6664769400122736, "mean_action_processing_ms": 0.7222905537139284, "mean_env_wait_ms": 5.75837964820258, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 416000, "timesteps_this_iter": 0, "agent_timesteps_total": 416000, "timers": {"sample_time_ms": 21931.391, "sample_throughput": 182.387, "load_time_ms": 0.33, "load_throughput": 12131031.092, "learn_time_ms": 4517.813, "learn_throughput": 885.384}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.263256414560601e-15, "cur_lr": 0.00010000000000000003, "total_loss": 0.5685765527634411, "policy_loss": 0.0010280161995881347, "vf_loss": 56.7548550205846, "vf_explained_var": 0.06943063069415349, "kl": 0.0023225417409174806, "entropy": 0.13150576032668113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 416000, "num_agent_steps_sampled": 416000, "num_steps_trained": 416000, "num_agent_steps_trained": 416000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4160, "training_iteration": 104, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-10-34", "timestamp": 1651065034, "time_this_iter_s": 22.142312049865723, "time_total_s": 4088.7062804698944, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4088.7062804698944, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 28.04, "ram_util_percent": 95.22000000000004}}
{"episode_reward_max": -8.799999999999997, "episode_reward_min": -151.99999999999974, "episode_reward_mean": -35.84900000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.20000000000004, -32.30000000000006, -30.699999999999957, -27.700000000000006, -13.899999999999993, -10.599999999999978, -49.500000000000085, -60.600000000000065, -36.70000000000001, -17.299999999999976, -42.80000000000002, -151.99999999999974, -9.999999999999991, -37.6, -8.799999999999997, -33.400000000000006, -51.00000000000007, -47.10000000000007, -23.5, -52.00000000000005, -26.400000000000006, -42.30000000000002, -30.100000000000012, -39.400000000000034, -42.900000000000084, -50.20000000000004, -18.9, -10.2, -15.599999999999996, -26.200000000000003, -23.300000000000004, -30.9, -41.100000000000016, -51.40000000000005, -42.80000000000006, -48.70000000000004, -40.80000000000006, -21.400000000000027, -15.499999999999977, -54.30000000000006, -37.900000000000006, -31.60000000000004, -15.299999999999994, -35.600000000000016, -20.200000000000017, -30.100000000000026, -44.00000000000008, -55.60000000000006, -45.20000000000006, -31.200000000000003, -30.8, -13.599999999999989, -13.599999999999996, -42.40000000000008, -52.90000000000005, -17.5, -50.10000000000005, -29.000000000000025, -16.599999999999994, -15.899999999999995, -33.70000000000002, -15.799999999999992, -49.300000000000054, -20.90000000000001, -25.100000000000037, -125.99999999999984, -53.80000000000004, -25.400000000000013, -50.00000000000005, -18.099999999999994, -14.89999999999998, -35.1, -53.80000000000004, -54.40000000000005, -54.00000000000004, -26.999999999999982, -14.299999999999983, -17.299999999999997, -53.000000000000064, -54.400000000000084, -37.40000000000002, -43.60000000000003, -27.300000000000004, -34.50000000000005, -31.799999999999997, -13.399999999999995, -25.500000000000018, -31.4, -29.90000000000001, -10.99999999999998, -50.40000000000003, -45.4, -11.499999999999975, -28.5, -40.2, -50.30000000000004, -39.8, -10.399999999999984, -109.09999999999991, -27.000000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6332771867058233, "mean_inference_ms": 0.6671936609188924, "mean_action_processing_ms": 0.7156677046897052, "mean_env_wait_ms": 5.731990586218628, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 420000, "timesteps_this_iter": 0, "agent_timesteps_total": 420000, "timers": {"sample_time_ms": 21996.096, "sample_throughput": 181.85, "load_time_ms": 0.323, "load_throughput": 12394515.366, "learn_time_ms": 4529.015, "learn_throughput": 883.194}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.1316282072803005e-15, "cur_lr": 0.00010000000000000003, "total_loss": 1.2586542417337838, "policy_loss": 0.0033077021084365345, "vf_loss": 125.53465583247524, "vf_explained_var": 0.014983122964059153, "kl": 0.005011055136544038, "entropy": 0.1906661205915033, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 420000, "num_agent_steps_sampled": 420000, "num_steps_trained": 420000, "num_agent_steps_trained": 420000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4200, "training_iteration": 105, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-10-57", "timestamp": 1651065057, "time_this_iter_s": 22.782334089279175, "time_total_s": 4111.488614559174, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4111.488614559174, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 23.754838709677415, "ram_util_percent": 95.37419354838713}}
{"episode_reward_max": -10.399999999999984, "episode_reward_min": -128.39999999999992, "episode_reward_mean": -37.064000000000014, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.900000000000006, -31.60000000000004, -15.299999999999994, -35.600000000000016, -20.200000000000017, -30.100000000000026, -44.00000000000008, -55.60000000000006, -45.20000000000006, -31.200000000000003, -30.8, -13.599999999999989, -13.599999999999996, -42.40000000000008, -52.90000000000005, -17.5, -50.10000000000005, -29.000000000000025, -16.599999999999994, -15.899999999999995, -33.70000000000002, -15.799999999999992, -49.300000000000054, -20.90000000000001, -25.100000000000037, -125.99999999999984, -53.80000000000004, -25.400000000000013, -50.00000000000005, -18.099999999999994, -14.89999999999998, -35.1, -53.80000000000004, -54.40000000000005, -54.00000000000004, -26.999999999999982, -14.299999999999983, -17.299999999999997, -53.000000000000064, -54.400000000000084, -37.40000000000002, -43.60000000000003, -27.300000000000004, -34.50000000000005, -31.799999999999997, -13.399999999999995, -25.500000000000018, -31.4, -29.90000000000001, -10.99999999999998, -50.40000000000003, -45.4, -11.499999999999975, -28.5, -40.2, -50.30000000000004, -39.8, -10.399999999999984, -109.09999999999991, -27.000000000000007, -46.10000000000003, -41.40000000000002, -74.5, -13.799999999999974, -103.89999999999992, -54.200000000000045, -13.599999999999987, -13.59999999999998, -57.900000000000055, -11.999999999999995, -13.299999999999999, -50.400000000000055, -31.7, -10.899999999999999, -26.60000000000001, -34.70000000000005, -38.20000000000001, -50.10000000000008, -43.40000000000006, -51.700000000000045, -14.199999999999976, -86.7999999999999, -28.7, -12.799999999999985, -47.900000000000055, -32.00000000000001, -37.5, -13.599999999999982, -43.40000000000005, -32.00000000000002, -52.60000000000003, -34.00000000000004, -34.40000000000002, -15.899999999999999, -20.80000000000003, -14.899999999999993, -20.0, -81.89999999999995, -48.80000000000004, -128.39999999999992], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6239591049780504, "mean_inference_ms": 0.6678648464716224, "mean_action_processing_ms": 0.7091710810622078, "mean_env_wait_ms": 5.706051519973396, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 424000, "timesteps_this_iter": 0, "agent_timesteps_total": 424000, "timers": {"sample_time_ms": 22001.245, "sample_throughput": 181.808, "load_time_ms": 0.314, "load_throughput": 12721577.191, "learn_time_ms": 4550.941, "learn_throughput": 878.939}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.1316282072803005e-15, "cur_lr": 0.00010000000000000003, "total_loss": 1.514515607130103, "policy_loss": -0.01343169546415729, "vf_loss": 152.79473365250453, "vf_explained_var": -0.09717505183271183, "kl": 0.007833758561928845, "entropy": 0.23768509060885476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 424000, "num_agent_steps_sampled": 424000, "num_steps_trained": 424000, "num_agent_steps_trained": 424000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4240, "training_iteration": 106, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-11-19", "timestamp": 1651065079, "time_this_iter_s": 22.00542378425598, "time_total_s": 4133.49403834343, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4133.49403834343, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 17.78666666666667, "ram_util_percent": 95.36666666666669}}
{"episode_reward_max": -10.399999999999984, "episode_reward_min": -128.39999999999992, "episode_reward_mean": -34.489000000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.40000000000002, -43.60000000000003, -27.300000000000004, -34.50000000000005, -31.799999999999997, -13.399999999999995, -25.500000000000018, -31.4, -29.90000000000001, -10.99999999999998, -50.40000000000003, -45.4, -11.499999999999975, -28.5, -40.2, -50.30000000000004, -39.8, -10.399999999999984, -109.09999999999991, -27.000000000000007, -46.10000000000003, -41.40000000000002, -74.5, -13.799999999999974, -103.89999999999992, -54.200000000000045, -13.599999999999987, -13.59999999999998, -57.900000000000055, -11.999999999999995, -13.299999999999999, -50.400000000000055, -31.7, -10.899999999999999, -26.60000000000001, -34.70000000000005, -38.20000000000001, -50.10000000000008, -43.40000000000006, -51.700000000000045, -14.199999999999976, -86.7999999999999, -28.7, -12.799999999999985, -47.900000000000055, -32.00000000000001, -37.5, -13.599999999999982, -43.40000000000005, -32.00000000000002, -52.60000000000003, -34.00000000000004, -34.40000000000002, -15.899999999999999, -20.80000000000003, -14.899999999999993, -20.0, -81.89999999999995, -48.80000000000004, -128.39999999999992, -34.20000000000007, -26.900000000000006, -47.700000000000045, -16.19999999999998, -14.199999999999976, -36.099999999999994, -53.60000000000003, -29.0, -53.50000000000006, -37.8, -14.199999999999998, -14.199999999999976, -53.00000000000006, -12.699999999999985, -50.20000000000005, -52.400000000000034, -53.10000000000005, -40.30000000000001, -52.400000000000055, -49.90000000000005, -13.29999999999998, -42.700000000000074, -15.399999999999997, -14.699999999999985, -27.80000000000001, -18.899999999999995, -22.5, -15.09999999999998, -27.100000000000005, -12.899999999999988, -24.10000000000001, -23.200000000000003, -16.8, -41.40000000000008, -26.1, -16.69999999999998, -16.69999999999999, -18.500000000000007, -16.699999999999996, -15.699999999999987], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6149601536580167, "mean_inference_ms": 0.6684563053612095, "mean_action_processing_ms": 0.7027946155208907, "mean_env_wait_ms": 5.680400657504236, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 428000, "timesteps_this_iter": 0, "agent_timesteps_total": 428000, "timers": {"sample_time_ms": 21965.496, "sample_throughput": 182.104, "load_time_ms": 0.256, "load_throughput": 15634345.355, "learn_time_ms": 4514.451, "learn_throughput": 886.044}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.1316282072803005e-15, "cur_lr": 0.00010000000000000003, "total_loss": 0.47553895506907695, "policy_loss": 0.0007143335952673869, "vf_loss": 47.48246307270501, "vf_explained_var": -0.07860201872805113, "kl": 0.0052813172833620775, "entropy": 0.30087900692897457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 428000, "num_agent_steps_sampled": 428000, "num_steps_trained": 428000, "num_agent_steps_trained": 428000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4280, "training_iteration": 107, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-11-41", "timestamp": 1651065101, "time_this_iter_s": 21.948015213012695, "time_total_s": 4155.442053556442, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4155.442053556442, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 18.025806451612905, "ram_util_percent": 95.38387096774191}}
{"episode_reward_max": -10.499999999999996, "episode_reward_min": -128.39999999999992, "episode_reward_mean": -34.29300000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.199999999999976, -86.7999999999999, -28.7, -12.799999999999985, -47.900000000000055, -32.00000000000001, -37.5, -13.599999999999982, -43.40000000000005, -32.00000000000002, -52.60000000000003, -34.00000000000004, -34.40000000000002, -15.899999999999999, -20.80000000000003, -14.899999999999993, -20.0, -81.89999999999995, -48.80000000000004, -128.39999999999992, -34.20000000000007, -26.900000000000006, -47.700000000000045, -16.19999999999998, -14.199999999999976, -36.099999999999994, -53.60000000000003, -29.0, -53.50000000000006, -37.8, -14.199999999999998, -14.199999999999976, -53.00000000000006, -12.699999999999985, -50.20000000000005, -52.400000000000034, -53.10000000000005, -40.30000000000001, -52.400000000000055, -49.90000000000005, -13.29999999999998, -42.700000000000074, -15.399999999999997, -14.699999999999985, -27.80000000000001, -18.899999999999995, -22.5, -15.09999999999998, -27.100000000000005, -12.899999999999988, -24.10000000000001, -23.200000000000003, -16.8, -41.40000000000008, -26.1, -16.69999999999998, -16.69999999999999, -18.500000000000007, -16.699999999999996, -15.699999999999987, -38.5, -53.10000000000006, -27.100000000000055, -10.499999999999996, -58.10000000000009, -43.00000000000006, -43.000000000000014, -51.10000000000003, -24.800000000000004, -13.799999999999997, -14.699999999999976, -27.000000000000025, -51.00000000000005, -20.0, -23.700000000000003, -45.100000000000094, -49.50000000000004, -17.200000000000003, -41.500000000000064, -50.40000000000004, -17.9, -46.80000000000001, -78.59999999999997, -50.000000000000036, -52.600000000000044, -16.199999999999978, -112.40000000000008, -48.2, -14.599999999999982, -11.599999999999998, -14.499999999999988, -23.800000000000004, -77.7, -38.10000000000005, -11.999999999999996, -29.100000000000005, -24.000000000000007, -51.900000000000034, -24.8, -12.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6059835252158985, "mean_inference_ms": 0.6688877201129904, "mean_action_processing_ms": 0.6965277274626785, "mean_env_wait_ms": 5.654788129075493, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 432000, "timesteps_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"sample_time_ms": 21944.582, "sample_throughput": 182.277, "load_time_ms": 0.267, "load_throughput": 14985008.932, "learn_time_ms": 4396.339, "learn_throughput": 909.848}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.1316282072803005e-15, "cur_lr": 0.00010000000000000003, "total_loss": 1.2115761045832187, "policy_loss": 0.0022616367026041914, "vf_loss": 120.93145029211557, "vf_explained_var": -0.07852186336312243, "kl": 0.0029241839634756976, "entropy": 0.20717492474403273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 432000, "num_agent_steps_sampled": 432000, "num_steps_trained": 432000, "num_agent_steps_trained": 432000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4320, "training_iteration": 108, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-12-02", "timestamp": 1651065122, "time_this_iter_s": 20.980162858963013, "time_total_s": 4176.422216415405, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4176.422216415405, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 25.360714285714284, "ram_util_percent": 95.2535714285714}}
{"episode_reward_max": -10.499999999999996, "episode_reward_min": -346.8000000000012, "episode_reward_mean": -40.09700000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.29999999999998, -42.700000000000074, -15.399999999999997, -14.699999999999985, -27.80000000000001, -18.899999999999995, -22.5, -15.09999999999998, -27.100000000000005, -12.899999999999988, -24.10000000000001, -23.200000000000003, -16.8, -41.40000000000008, -26.1, -16.69999999999998, -16.69999999999999, -18.500000000000007, -16.699999999999996, -15.699999999999987, -38.5, -53.10000000000006, -27.100000000000055, -10.499999999999996, -58.10000000000009, -43.00000000000006, -43.000000000000014, -51.10000000000003, -24.800000000000004, -13.799999999999997, -14.699999999999976, -27.000000000000025, -51.00000000000005, -20.0, -23.700000000000003, -45.100000000000094, -49.50000000000004, -17.200000000000003, -41.500000000000064, -50.40000000000004, -17.9, -46.80000000000001, -78.59999999999997, -50.000000000000036, -52.600000000000044, -16.199999999999978, -112.40000000000008, -48.2, -14.599999999999982, -11.599999999999998, -14.499999999999988, -23.800000000000004, -77.7, -38.10000000000005, -11.999999999999996, -29.100000000000005, -24.000000000000007, -51.900000000000034, -24.8, -12.899999999999999, -50.900000000000034, -41.90000000000002, -17.29999999999999, -52.80000000000004, -29.00000000000001, -43.40000000000008, -64.80000000000007, -51.90000000000005, -50.10000000000004, -23.199999999999996, -97.89999999999996, -35.000000000000064, -135.3999999999998, -16.89999999999999, -43.00000000000003, -52.100000000000044, -30.900000000000013, -52.90000000000005, -14.59999999999998, -52.70000000000004, -77.09999999999998, -25.000000000000007, -52.80000000000003, -37.60000000000005, -44.10000000000008, -35.099999999999994, -36.900000000000055, -50.400000000000006, -86.89999999999993, -47.800000000000004, -34.60000000000002, -35.2, -22.200000000000017, -47.10000000000006, -11.5, -48.100000000000044, -42.00000000000008, -52.5, -346.8000000000012, -32.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5967659549020745, "mean_inference_ms": 0.6689321777464644, "mean_action_processing_ms": 0.6903611338569385, "mean_env_wait_ms": 5.629128836320296, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 436000, "timesteps_this_iter": 0, "agent_timesteps_total": 436000, "timers": {"sample_time_ms": 21672.69, "sample_throughput": 184.564, "load_time_ms": 0.265, "load_throughput": 15105083.281, "learn_time_ms": 4384.944, "learn_throughput": 912.212}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0658141036401502e-15, "cur_lr": 0.00010000000000000003, "total_loss": 6.188613194762479, "policy_loss": -0.008741656823023672, "vf_loss": 619.7354988385272, "vf_explained_var": 0.19462378800556224, "kl": 0.009348464298126443, "entropy": 0.18058313902026862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 436000, "num_agent_steps_sampled": 436000, "num_steps_trained": 436000, "num_agent_steps_trained": 436000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4360, "training_iteration": 109, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-12-22", "timestamp": 1651065142, "time_this_iter_s": 20.51258897781372, "time_total_s": 4196.934805393219, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4196.934805393219, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 16.41785714285714, "ram_util_percent": 95.22500000000001}}
{"episode_reward_max": -7.799999999999999, "episode_reward_min": -346.8000000000012, "episode_reward_mean": -43.46100000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.9, -46.80000000000001, -78.59999999999997, -50.000000000000036, -52.600000000000044, -16.199999999999978, -112.40000000000008, -48.2, -14.599999999999982, -11.599999999999998, -14.499999999999988, -23.800000000000004, -77.7, -38.10000000000005, -11.999999999999996, -29.100000000000005, -24.000000000000007, -51.900000000000034, -24.8, -12.899999999999999, -50.900000000000034, -41.90000000000002, -17.29999999999999, -52.80000000000004, -29.00000000000001, -43.40000000000008, -64.80000000000007, -51.90000000000005, -50.10000000000004, -23.199999999999996, -97.89999999999996, -35.000000000000064, -135.3999999999998, -16.89999999999999, -43.00000000000003, -52.100000000000044, -30.900000000000013, -52.90000000000005, -14.59999999999998, -52.70000000000004, -77.09999999999998, -25.000000000000007, -52.80000000000003, -37.60000000000005, -44.10000000000008, -35.099999999999994, -36.900000000000055, -50.400000000000006, -86.89999999999993, -47.800000000000004, -34.60000000000002, -35.2, -22.200000000000017, -47.10000000000006, -11.5, -48.100000000000044, -42.00000000000008, -52.5, -346.8000000000012, -32.2, -36.200000000000045, -46.000000000000064, -74.9, -51.20000000000004, -35.2, -26.0, -36.500000000000064, -47.7, -49.70000000000006, -42.60000000000001, -7.799999999999999, -60.10000000000001, -12.999999999999995, -27.700000000000006, -40.90000000000002, -29.200000000000006, -52.20000000000003, -72.50000000000004, -16.999999999999993, -15.799999999999981, -16.699999999999996, -15.899999999999999, -13.799999999999985, -51.50000000000005, -35.900000000000006, -26.50000000000004, -31.600000000000016, -38.5, -37.300000000000026, -17.399999999999984, -33.80000000000005, -54.49999999999997, -30.999999999999996, -51.90000000000006, -36.50000000000002, -10.799999999999999, -39.00000000000008, -71.20000000000003, -41.999999999999986, -27.800000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5875331768430987, "mean_inference_ms": 0.6691870125609065, "mean_action_processing_ms": 0.6843127417753354, "mean_env_wait_ms": 5.604426219400097, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 440000, "timesteps_this_iter": 0, "agent_timesteps_total": 440000, "timers": {"sample_time_ms": 21861.326, "sample_throughput": 182.972, "load_time_ms": 0.265, "load_throughput": 15109164.265, "learn_time_ms": 4492.453, "learn_throughput": 890.382}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0658141036401502e-15, "cur_lr": 0.00010000000000000003, "total_loss": 0.8376577004615057, "policy_loss": -0.0013689751005781594, "vf_loss": 83.90266917854227, "vf_explained_var": 0.00017253397613443353, "kl": 0.0018932800896610872, "entropy": 0.13860074121064397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 440000, "num_agent_steps_sampled": 440000, "num_steps_trained": 440000, "num_agent_steps_trained": 440000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4400, "training_iteration": 110, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-12-46", "timestamp": 1651065166, "time_this_iter_s": 23.279831886291504, "time_total_s": 4220.2146372795105, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4220.2146372795105, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 25.7125, "ram_util_percent": 95.109375}}
{"episode_reward_max": -7.799999999999999, "episode_reward_min": -346.8000000000012, "episode_reward_mean": -40.260000000000026, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-77.09999999999998, -25.000000000000007, -52.80000000000003, -37.60000000000005, -44.10000000000008, -35.099999999999994, -36.900000000000055, -50.400000000000006, -86.89999999999993, -47.800000000000004, -34.60000000000002, -35.2, -22.200000000000017, -47.10000000000006, -11.5, -48.100000000000044, -42.00000000000008, -52.5, -346.8000000000012, -32.2, -36.200000000000045, -46.000000000000064, -74.9, -51.20000000000004, -35.2, -26.0, -36.500000000000064, -47.7, -49.70000000000006, -42.60000000000001, -7.799999999999999, -60.10000000000001, -12.999999999999995, -27.700000000000006, -40.90000000000002, -29.200000000000006, -52.20000000000003, -72.50000000000004, -16.999999999999993, -15.799999999999981, -16.699999999999996, -15.899999999999999, -13.799999999999985, -51.50000000000005, -35.900000000000006, -26.50000000000004, -31.600000000000016, -38.5, -37.300000000000026, -17.399999999999984, -33.80000000000005, -54.49999999999997, -30.999999999999996, -51.90000000000006, -36.50000000000002, -10.799999999999999, -39.00000000000008, -71.20000000000003, -41.999999999999986, -27.800000000000004, -31.200000000000053, -51.70000000000005, -36.0, -19.499999999999993, -29.600000000000037, -18.299999999999986, -36.00000000000006, -34.20000000000002, -53.20000000000004, -12.799999999999981, -35.40000000000001, -30.900000000000063, -154.99999999999977, -12.099999999999998, -14.39999999999999, -47.30000000000004, -13.7, -52.400000000000034, -50.30000000000006, -18.5, -15.799999999999995, -31.6, -38.10000000000008, -50.900000000000034, -33.80000000000002, -19.50000000000001, -24.50000000000004, -13.499999999999984, -16.799999999999994, -10.799999999999985, -52.50000000000006, -27.50000000000002, -52.10000000000004, -39.40000000000006, -13.599999999999982, -48.800000000000004, -50.200000000000074, -37.80000000000004, -50.40000000000005, -14.199999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5788458482398473, "mean_inference_ms": 0.6707445819490576, "mean_action_processing_ms": 0.6784175589274674, "mean_env_wait_ms": 5.582434489038526, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 444000, "timesteps_this_iter": 0, "agent_timesteps_total": 444000, "timers": {"sample_time_ms": 22413.531, "sample_throughput": 178.464, "load_time_ms": 0.265, "load_throughput": 15080643.596, "learn_time_ms": 4566.848, "learn_throughput": 875.878}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.329070518200751e-16, "cur_lr": 0.00010000000000000003, "total_loss": 1.2215406890357694, "policy_loss": -0.0013377972668217075, "vf_loss": 122.28785128029443, "vf_explained_var": -0.048070576178130285, "kl": 0.0042331149519245935, "entropy": 0.2556485667684546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 444000, "num_agent_steps_sampled": 444000, "num_steps_trained": 444000, "num_agent_steps_trained": 444000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4440, "training_iteration": 111, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-13-12", "timestamp": 1651065192, "time_this_iter_s": 26.109550714492798, "time_total_s": 4246.324187994003, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4246.324187994003, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 34.34285714285714, "ram_util_percent": 94.49714285714285}}
{"episode_reward_max": -10.799999999999985, "episode_reward_min": -154.99999999999977, "episode_reward_mean": -36.09200000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.699999999999996, -15.899999999999999, -13.799999999999985, -51.50000000000005, -35.900000000000006, -26.50000000000004, -31.600000000000016, -38.5, -37.300000000000026, -17.399999999999984, -33.80000000000005, -54.49999999999997, -30.999999999999996, -51.90000000000006, -36.50000000000002, -10.799999999999999, -39.00000000000008, -71.20000000000003, -41.999999999999986, -27.800000000000004, -31.200000000000053, -51.70000000000005, -36.0, -19.499999999999993, -29.600000000000037, -18.299999999999986, -36.00000000000006, -34.20000000000002, -53.20000000000004, -12.799999999999981, -35.40000000000001, -30.900000000000063, -154.99999999999977, -12.099999999999998, -14.39999999999999, -47.30000000000004, -13.7, -52.400000000000034, -50.30000000000006, -18.5, -15.799999999999995, -31.6, -38.10000000000008, -50.900000000000034, -33.80000000000002, -19.50000000000001, -24.50000000000004, -13.499999999999984, -16.799999999999994, -10.799999999999985, -52.50000000000006, -27.50000000000002, -52.10000000000004, -39.40000000000006, -13.599999999999982, -48.800000000000004, -50.200000000000074, -37.80000000000004, -50.40000000000005, -14.199999999999996, -35.00000000000005, -38.8, -18.5, -41.7, -33.80000000000005, -52.40000000000004, -50.30000000000004, -33.6, -52.60000000000004, -37.700000000000074, -51.70000000000004, -13.599999999999985, -53.10000000000004, -49.90000000000005, -15.299999999999997, -41.20000000000006, -51.300000000000054, -15.599999999999998, -20.500000000000004, -44.0, -50.00000000000004, -110.29999999999991, -35.0, -50.00000000000005, -27.3, -51.7, -39.90000000000005, -47.100000000000044, -13.399999999999999, -38.7, -49.80000000000006, -32.00000000000003, -25.300000000000015, -35.00000000000005, -52.80000000000005, -44.70000000000007, -18.299999999999997, -14.399999999999984, -16.59999999999999, -28.400000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.570394089653031, "mean_inference_ms": 0.6723274355472313, "mean_action_processing_ms": 0.672633042166825, "mean_env_wait_ms": 5.561254457658495, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 448000, "timesteps_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"sample_time_ms": 22325.981, "sample_throughput": 179.163, "load_time_ms": 0.26, "load_throughput": 15394766.012, "learn_time_ms": 4554.71, "learn_throughput": 878.212}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.6645352591003756e-16, "cur_lr": 0.00010000000000000003, "total_loss": 0.780179170197657, "policy_loss": 0.0005300262702568884, "vf_loss": 77.96491599544402, "vf_explained_var": 0.12927743190078325, "kl": 0.0027859685271041943, "entropy": 0.17459598368294135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 448000, "num_agent_steps_sampled": 448000, "num_steps_trained": 448000, "num_agent_steps_trained": 448000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4480, "training_iteration": 112, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-13-34", "timestamp": 1651065214, "time_this_iter_s": 21.777542114257812, "time_total_s": 4268.101730108261, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4268.101730108261, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 20.06, "ram_util_percent": 94.8466666666667}}
{"episode_reward_max": -10.799999999999985, "episode_reward_min": -110.29999999999991, "episode_reward_mean": -36.77400000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.799999999999995, -31.6, -38.10000000000008, -50.900000000000034, -33.80000000000002, -19.50000000000001, -24.50000000000004, -13.499999999999984, -16.799999999999994, -10.799999999999985, -52.50000000000006, -27.50000000000002, -52.10000000000004, -39.40000000000006, -13.599999999999982, -48.800000000000004, -50.200000000000074, -37.80000000000004, -50.40000000000005, -14.199999999999996, -35.00000000000005, -38.8, -18.5, -41.7, -33.80000000000005, -52.40000000000004, -50.30000000000004, -33.6, -52.60000000000004, -37.700000000000074, -51.70000000000004, -13.599999999999985, -53.10000000000004, -49.90000000000005, -15.299999999999997, -41.20000000000006, -51.300000000000054, -15.599999999999998, -20.500000000000004, -44.0, -50.00000000000004, -110.29999999999991, -35.0, -50.00000000000005, -27.3, -51.7, -39.90000000000005, -47.100000000000044, -13.399999999999999, -38.7, -49.80000000000006, -32.00000000000003, -25.300000000000015, -35.00000000000005, -52.80000000000005, -44.70000000000007, -18.299999999999997, -14.399999999999984, -16.59999999999999, -28.400000000000002, -51.30000000000006, -35.39999999999998, -43.40000000000005, -30.6, -37.80000000000002, -40.100000000000044, -31.000000000000053, -15.099999999999978, -29.10000000000001, -24.700000000000003, -15.199999999999998, -28.6, -38.70000000000005, -30.900000000000034, -37.40000000000001, -33.7, -14.499999999999984, -41.00000000000008, -30.699999999999996, -47.7, -40.30000000000007, -52.10000000000006, -35.600000000000044, -32.20000000000002, -50.90000000000005, -32.40000000000004, -109.7, -51.700000000000045, -52.70000000000003, -39.300000000000075, -20.700000000000003, -31.80000000000002, -14.499999999999984, -39.700000000000024, -52.900000000000034, -37.700000000000045, -52.30000000000004, -35.20000000000005, -38.0, -27.700000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5619447773247106, "mean_inference_ms": 0.6730360621323294, "mean_action_processing_ms": 0.666926768729617, "mean_env_wait_ms": 5.538856132077743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 452000, "timesteps_this_iter": 0, "agent_timesteps_total": 452000, "timers": {"sample_time_ms": 22267.182, "sample_throughput": 179.637, "load_time_ms": 0.258, "load_throughput": 15502879.32, "learn_time_ms": 4540.571, "learn_throughput": 880.947}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3322676295501878e-16, "cur_lr": 0.00010000000000000003, "total_loss": 0.783149854355662, "policy_loss": -0.004965831673834273, "vf_loss": 78.81157037365821, "vf_explained_var": 0.18601602847858142, "kl": 0.0034140753829374378, "entropy": 0.11835742078481182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 452000, "num_agent_steps_sampled": 452000, "num_steps_trained": 452000, "num_agent_steps_trained": 452000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4520, "training_iteration": 113, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-13-54", "timestamp": 1651065234, "time_this_iter_s": 20.771158933639526, "time_total_s": 4288.872889041901, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4288.872889041901, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 16.739285714285717, "ram_util_percent": 94.77499999999999}}
{"episode_reward_max": -7.1, "episode_reward_min": -122.30000000000001, "episode_reward_mean": -38.198000000000015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000004, -110.29999999999991, -35.0, -50.00000000000005, -27.3, -51.7, -39.90000000000005, -47.100000000000044, -13.399999999999999, -38.7, -49.80000000000006, -32.00000000000003, -25.300000000000015, -35.00000000000005, -52.80000000000005, -44.70000000000007, -18.299999999999997, -14.399999999999984, -16.59999999999999, -28.400000000000002, -51.30000000000006, -35.39999999999998, -43.40000000000005, -30.6, -37.80000000000002, -40.100000000000044, -31.000000000000053, -15.099999999999978, -29.10000000000001, -24.700000000000003, -15.199999999999998, -28.6, -38.70000000000005, -30.900000000000034, -37.40000000000001, -33.7, -14.499999999999984, -41.00000000000008, -30.699999999999996, -47.7, -40.30000000000007, -52.10000000000006, -35.600000000000044, -32.20000000000002, -50.90000000000005, -32.40000000000004, -109.7, -51.700000000000045, -52.70000000000003, -39.300000000000075, -20.700000000000003, -31.80000000000002, -14.499999999999984, -39.700000000000024, -52.900000000000034, -37.700000000000045, -52.30000000000004, -35.20000000000005, -38.0, -27.700000000000003, -43.90000000000007, -31.20000000000001, -13.599999999999982, -122.30000000000001, -52.90000000000004, -20.199999999999996, -29.60000000000003, -36.300000000000004, -12.199999999999982, -15.39999999999998, -50.000000000000064, -54.10000000000005, -12.599999999999989, -36.10000000000004, -18.5, -34.70000000000004, -34.70000000000006, -39.20000000000007, -28.4, -11.799999999999999, -14.299999999999999, -51.50000000000005, -51.70000000000003, -41.80000000000002, -41.30000000000001, -43.90000000000001, -100.39999999999992, -18.000000000000007, -47.700000000000045, -24.60000000000004, -52.300000000000004, -51.200000000000045, -30.9, -7.1, -33.30000000000001, -50.20000000000004, -28.00000000000001, -50.80000000000006, -28.700000000000024, -69.40000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.553531690781507, "mean_inference_ms": 0.6729738173580952, "mean_action_processing_ms": 0.6612987247907465, "mean_env_wait_ms": 5.515538080007863, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 456000, "timesteps_this_iter": 0, "agent_timesteps_total": 456000, "timers": {"sample_time_ms": 22180.22, "sample_throughput": 180.341, "load_time_ms": 0.268, "load_throughput": 14930333.719, "learn_time_ms": 4497.568, "learn_throughput": 889.37}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.661338147750939e-17, "cur_lr": 0.00010000000000000003, "total_loss": 1.1978092199792305, "policy_loss": -0.005514356169489122, "vf_loss": 120.33235922167378, "vf_explained_var": 0.06258141488157293, "kl": 0.003198673819496727, "entropy": 0.17606958456297395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 456000, "num_agent_steps_sampled": 456000, "num_steps_trained": 456000, "num_agent_steps_trained": 456000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4560, "training_iteration": 114, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-14-15", "timestamp": 1651065255, "time_this_iter_s": 20.97992181777954, "time_total_s": 4309.85281085968, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4309.85281085968, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 14.924137931034485, "ram_util_percent": 94.7068965517241}}
{"episode_reward_max": -7.1, "episode_reward_min": -465.8000000000014, "episode_reward_mean": -42.28200000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.30000000000007, -52.10000000000006, -35.600000000000044, -32.20000000000002, -50.90000000000005, -32.40000000000004, -109.7, -51.700000000000045, -52.70000000000003, -39.300000000000075, -20.700000000000003, -31.80000000000002, -14.499999999999984, -39.700000000000024, -52.900000000000034, -37.700000000000045, -52.30000000000004, -35.20000000000005, -38.0, -27.700000000000003, -43.90000000000007, -31.20000000000001, -13.599999999999982, -122.30000000000001, -52.90000000000004, -20.199999999999996, -29.60000000000003, -36.300000000000004, -12.199999999999982, -15.39999999999998, -50.000000000000064, -54.10000000000005, -12.599999999999989, -36.10000000000004, -18.5, -34.70000000000004, -34.70000000000006, -39.20000000000007, -28.4, -11.799999999999999, -14.299999999999999, -51.50000000000005, -51.70000000000003, -41.80000000000002, -41.30000000000001, -43.90000000000001, -100.39999999999992, -18.000000000000007, -47.700000000000045, -24.60000000000004, -52.300000000000004, -51.200000000000045, -30.9, -7.1, -33.30000000000001, -50.20000000000004, -28.00000000000001, -50.80000000000006, -28.700000000000024, -69.40000000000002, -27.900000000000023, -53.00000000000006, -14.199999999999998, -31.400000000000016, -31.200000000000053, -29.500000000000004, -38.90000000000003, -38.50000000000006, -12.89999999999998, -52.50000000000004, -22.1, -15.499999999999986, -93.99999999999996, -13.299999999999978, -36.2, -120.19999999999978, -30.20000000000001, -11.799999999999999, -30.700000000000003, -38.500000000000014, -465.8000000000014, -34.800000000000026, -25.799999999999997, -50.900000000000034, -22.90000000000005, -18.900000000000006, -16.599999999999987, -30.700000000000006, -32.400000000000055, -36.3, -32.30000000000006, -34.70000000000004, -34.5, -27.19999999999996, -41.2, -11.699999999999989, -52.30000000000003, -31.10000000000002, -51.800000000000054, -51.600000000000044], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5452111872977077, "mean_inference_ms": 0.6726104066840304, "mean_action_processing_ms": 0.6557594791252138, "mean_env_wait_ms": 5.492236692567794, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 460000, "timesteps_this_iter": 0, "agent_timesteps_total": 460000, "timers": {"sample_time_ms": 21935.736, "sample_throughput": 182.351, "load_time_ms": 0.264, "load_throughput": 15150095.72, "learn_time_ms": 4460.265, "learn_throughput": 896.808}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.3306690738754695e-17, "cur_lr": 0.00010000000000000003, "total_loss": 9.075392649170531, "policy_loss": -0.008909817834094327, "vf_loss": 908.4302740999448, "vf_explained_var": 0.010888925675422914, "kl": 0.009672837258651684, "entropy": 0.22967987051534075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 460000, "num_agent_steps_sampled": 460000, "num_steps_trained": 460000, "num_agent_steps_trained": 460000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4600, "training_iteration": 115, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-14-36", "timestamp": 1651065276, "time_this_iter_s": 20.39715576171875, "time_total_s": 4330.249966621399, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4330.249966621399, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 18.01071428571429, "ram_util_percent": 94.61428571428569}}
{"episode_reward_max": -7.1, "episode_reward_min": -465.8000000000014, "episode_reward_mean": -41.26800000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.299999999999999, -51.50000000000005, -51.70000000000003, -41.80000000000002, -41.30000000000001, -43.90000000000001, -100.39999999999992, -18.000000000000007, -47.700000000000045, -24.60000000000004, -52.300000000000004, -51.200000000000045, -30.9, -7.1, -33.30000000000001, -50.20000000000004, -28.00000000000001, -50.80000000000006, -28.700000000000024, -69.40000000000002, -27.900000000000023, -53.00000000000006, -14.199999999999998, -31.400000000000016, -31.200000000000053, -29.500000000000004, -38.90000000000003, -38.50000000000006, -12.89999999999998, -52.50000000000004, -22.1, -15.499999999999986, -93.99999999999996, -13.299999999999978, -36.2, -120.19999999999978, -30.20000000000001, -11.799999999999999, -30.700000000000003, -38.500000000000014, -465.8000000000014, -34.800000000000026, -25.799999999999997, -50.900000000000034, -22.90000000000005, -18.900000000000006, -16.599999999999987, -30.700000000000006, -32.400000000000055, -36.3, -32.30000000000006, -34.70000000000004, -34.5, -27.19999999999996, -41.2, -11.699999999999989, -52.30000000000003, -31.10000000000002, -51.800000000000054, -51.600000000000044, -52.50000000000004, -31.100000000000016, -45.500000000000064, -51.60000000000003, -17.099999999999994, -22.20000000000001, -24.70000000000001, -26.600000000000023, -13.699999999999985, -14.699999999999998, -49.80000000000003, -15.899999999999988, -50.200000000000045, -19.7, -18.3, -47.800000000000054, -17.200000000000003, -33.70000000000006, -39.200000000000024, -15.599999999999993, -39.00000000000004, -56.300000000000075, -53.50000000000006, -30.60000000000003, -20.400000000000013, -52.20000000000007, -53.10000000000005, -50.600000000000044, -13.499999999999979, -26.10000000000001, -41.700000000000024, -30.000000000000004, -47.80000000000008, -51.700000000000045, -42.00000000000002, -33.000000000000014, -44.200000000000024, -51.80000000000005, -53.200000000000045, -45.900000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5368914447385225, "mean_inference_ms": 0.6722055051687654, "mean_action_processing_ms": 0.650313847540135, "mean_env_wait_ms": 5.469181435350294, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 464000, "timesteps_this_iter": 0, "agent_timesteps_total": 464000, "timers": {"sample_time_ms": 21787.08, "sample_throughput": 183.595, "load_time_ms": 0.293, "load_throughput": 13640013.008, "learn_time_ms": 4406.729, "learn_throughput": 907.703}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.3306690738754695e-17, "cur_lr": 0.00010000000000000003, "total_loss": 0.6162180222886344, "policy_loss": 0.001892036629179793, "vf_loss": 61.43259973628547, "vf_explained_var": 0.063222607040918, "kl": 0.004389262172096153, "entropy": 0.18742701499772968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 464000, "num_agent_steps_sampled": 464000, "num_steps_trained": 464000, "num_agent_steps_trained": 464000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4640, "training_iteration": 116, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-14-56", "timestamp": 1651065296, "time_this_iter_s": 20.35629391670227, "time_total_s": 4350.606260538101, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4350.606260538101, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 13.62142857142857, "ram_util_percent": 94.60357142857141}}
{"episode_reward_max": -10.79999999999999, "episode_reward_min": -465.8000000000014, "episode_reward_mean": -39.89200000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-465.8000000000014, -34.800000000000026, -25.799999999999997, -50.900000000000034, -22.90000000000005, -18.900000000000006, -16.599999999999987, -30.700000000000006, -32.400000000000055, -36.3, -32.30000000000006, -34.70000000000004, -34.5, -27.19999999999996, -41.2, -11.699999999999989, -52.30000000000003, -31.10000000000002, -51.800000000000054, -51.600000000000044, -52.50000000000004, -31.100000000000016, -45.500000000000064, -51.60000000000003, -17.099999999999994, -22.20000000000001, -24.70000000000001, -26.600000000000023, -13.699999999999985, -14.699999999999998, -49.80000000000003, -15.899999999999988, -50.200000000000045, -19.7, -18.3, -47.800000000000054, -17.200000000000003, -33.70000000000006, -39.200000000000024, -15.599999999999993, -39.00000000000004, -56.300000000000075, -53.50000000000006, -30.60000000000003, -20.400000000000013, -52.20000000000007, -53.10000000000005, -50.600000000000044, -13.499999999999979, -26.10000000000001, -41.700000000000024, -30.000000000000004, -47.80000000000008, -51.700000000000045, -42.00000000000002, -33.000000000000014, -44.200000000000024, -51.80000000000005, -53.200000000000045, -45.900000000000006, -52.900000000000034, -12.599999999999985, -59.7, -24.3, -17.400000000000013, -32.70000000000005, -51.700000000000045, -23.900000000000055, -32.40000000000001, -44.90000000000007, -49.79999999999993, -47.50000000000008, -84.49999999999994, -42.30000000000007, -28.000000000000007, -26.700000000000006, -18.60000000000001, -29.60000000000001, -18.099999999999987, -31.000000000000057, -51.80000000000004, -44.70000000000001, -15.099999999999978, -12.399999999999986, -50.9, -19.10000000000002, -10.79999999999999, -66.30000000000011, -35.60000000000005, -36.199999999999996, -52.40000000000004, -33.2, -17.8, -22.299999999999997, -58.20000000000008, -13.49999999999998, -26.700000000000003, -61.099999999999916, -37.10000000000006, -48.20000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5288605989614137, "mean_inference_ms": 0.6716364974159574, "mean_action_processing_ms": 0.6449573146806296, "mean_env_wait_ms": 5.446130287740038, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 468000, "timesteps_this_iter": 0, "agent_timesteps_total": 468000, "timers": {"sample_time_ms": 21558.14, "sample_throughput": 185.545, "load_time_ms": 0.315, "load_throughput": 12681191.232, "learn_time_ms": 4405.997, "learn_throughput": 907.854}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6653345369377347e-17, "cur_lr": 0.00010000000000000003, "total_loss": 0.86941543861082, "policy_loss": 7.288111373782158e-05, "vf_loss": 86.93425766319356, "vf_explained_var": 0.011172612892684116, "kl": 0.0037855455672136796, "entropy": 0.23961019603215078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 468000, "num_agent_steps_sampled": 468000, "num_steps_trained": 468000, "num_agent_steps_trained": 468000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4680, "training_iteration": 117, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-15-17", "timestamp": 1651065317, "time_this_iter_s": 20.212290048599243, "time_total_s": 4370.8185505867, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4370.8185505867, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 12.062962962962963, "ram_util_percent": 94.59999999999998}}
{"episode_reward_max": -10.6, "episode_reward_min": -162.79999999999976, "episode_reward_mean": -38.547000000000025, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.00000000000004, -56.300000000000075, -53.50000000000006, -30.60000000000003, -20.400000000000013, -52.20000000000007, -53.10000000000005, -50.600000000000044, -13.499999999999979, -26.10000000000001, -41.700000000000024, -30.000000000000004, -47.80000000000008, -51.700000000000045, -42.00000000000002, -33.000000000000014, -44.200000000000024, -51.80000000000005, -53.200000000000045, -45.900000000000006, -52.900000000000034, -12.599999999999985, -59.7, -24.3, -17.400000000000013, -32.70000000000005, -51.700000000000045, -23.900000000000055, -32.40000000000001, -44.90000000000007, -49.79999999999993, -47.50000000000008, -84.49999999999994, -42.30000000000007, -28.000000000000007, -26.700000000000006, -18.60000000000001, -29.60000000000001, -18.099999999999987, -31.000000000000057, -51.80000000000004, -44.70000000000001, -15.099999999999978, -12.399999999999986, -50.9, -19.10000000000002, -10.79999999999999, -66.30000000000011, -35.60000000000005, -36.199999999999996, -52.40000000000004, -33.2, -17.8, -22.299999999999997, -58.20000000000008, -13.49999999999998, -26.700000000000003, -61.099999999999916, -37.10000000000006, -48.20000000000001, -34.10000000000005, -51.90000000000004, -40.59999999999998, -40.30000000000006, -51.30000000000005, -41.7, -49.50000000000004, -14.799999999999981, -84.79999999999994, -30.6, -24.40000000000003, -32.20000000000004, -18.799999999999997, -51.100000000000044, -10.6, -42.00000000000005, -36.10000000000006, -12.7, -21.3, -41.20000000000002, -51.700000000000045, -29.500000000000032, -14.499999999999996, -20.700000000000003, -40.100000000000065, -14.699999999999983, -53.500000000000036, -30.400000000000013, -29.90000000000002, -46.10000000000007, -54.3999999999999, -14.199999999999983, -38.00000000000006, -46.00000000000001, -80.5, -162.79999999999976, -50.500000000000036, -14.899999999999979, -23.900000000000038, -29.800000000000033], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5207894878525388, "mean_inference_ms": 0.6711487540216887, "mean_action_processing_ms": 0.6396949646694686, "mean_env_wait_ms": 5.42378870389138, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 472000, "timesteps_this_iter": 0, "agent_timesteps_total": 472000, "timers": {"sample_time_ms": 21506.518, "sample_throughput": 185.99, "load_time_ms": 0.304, "load_throughput": 13152411.414, "learn_time_ms": 4426.516, "learn_throughput": 903.645}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.326672684688674e-18, "cur_lr": 0.00010000000000000003, "total_loss": 1.4865799683396534, "policy_loss": -0.007005603392157824, "vf_loss": 149.3585624182096, "vf_explained_var": -0.0021379882930427467, "kl": 0.01008074097551965, "entropy": 0.22888150023276446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 472000, "num_agent_steps_sampled": 472000, "num_steps_trained": 472000, "num_agent_steps_trained": 472000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4720, "training_iteration": 118, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-15-37", "timestamp": 1651065337, "time_this_iter_s": 20.675529956817627, "time_total_s": 4391.494080543518, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4391.494080543518, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 11.717241379310344, "ram_util_percent": 94.43448275862072}}
{"episode_reward_max": -10.6, "episode_reward_min": -168.6999999999997, "episode_reward_mean": -38.45300000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.80000000000004, -44.70000000000001, -15.099999999999978, -12.399999999999986, -50.9, -19.10000000000002, -10.79999999999999, -66.30000000000011, -35.60000000000005, -36.199999999999996, -52.40000000000004, -33.2, -17.8, -22.299999999999997, -58.20000000000008, -13.49999999999998, -26.700000000000003, -61.099999999999916, -37.10000000000006, -48.20000000000001, -34.10000000000005, -51.90000000000004, -40.59999999999998, -40.30000000000006, -51.30000000000005, -41.7, -49.50000000000004, -14.799999999999981, -84.79999999999994, -30.6, -24.40000000000003, -32.20000000000004, -18.799999999999997, -51.100000000000044, -10.6, -42.00000000000005, -36.10000000000006, -12.7, -21.3, -41.20000000000002, -51.700000000000045, -29.500000000000032, -14.499999999999996, -20.700000000000003, -40.100000000000065, -14.699999999999983, -53.500000000000036, -30.400000000000013, -29.90000000000002, -46.10000000000007, -54.3999999999999, -14.199999999999983, -38.00000000000006, -46.00000000000001, -80.5, -162.79999999999976, -50.500000000000036, -14.899999999999979, -23.900000000000038, -29.800000000000033, -50.50000000000005, -17.799999999999997, -14.499999999999996, -22.3, -53.20000000000006, -26.699999999999985, -44.00000000000005, -31.900000000000006, -52.000000000000036, -20.0, -50.90000000000004, -18.0, -25.699999999999996, -16.39999999999999, -51.90000000000005, -20.200000000000003, -59.100000000000165, -53.40000000000005, -22.5, -31.0, -51.400000000000055, -49.90000000000002, -33.300000000000054, -32.20000000000003, -168.6999999999997, -16.899999999999984, -52.10000000000005, -35.30000000000006, -52.70000000000003, -38.90000000000005, -35.100000000000044, -14.099999999999996, -52.10000000000003, -30.900000000000045, -36.900000000000006, -38.70000000000007, -28.100000000000044, -15.299999999999981, -38.500000000000064, -52.70000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5127476743607808, "mean_inference_ms": 0.6707885808015539, "mean_action_processing_ms": 0.6345238429594618, "mean_env_wait_ms": 5.401993385819574, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 476000, "timesteps_this_iter": 0, "agent_timesteps_total": 476000, "timers": {"sample_time_ms": 21550.275, "sample_throughput": 185.612, "load_time_ms": 0.306, "load_throughput": 13088793.884, "learn_time_ms": 4388.415, "learn_throughput": 911.491}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.326672684688674e-18, "cur_lr": 0.00010000000000000003, "total_loss": 1.2524215817469002, "policy_loss": -8.838084195890734e-05, "vf_loss": 125.25099781405541, "vf_explained_var": 0.1499752688792444, "kl": 0.004713243469923459, "entropy": 0.2014828290369722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 476000, "num_agent_steps_sampled": 476000, "num_steps_trained": 476000, "num_agent_steps_trained": 476000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4760, "training_iteration": 119, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-15-58", "timestamp": 1651065358, "time_this_iter_s": 20.362283945083618, "time_total_s": 4411.856364488602, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4411.856364488602, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 17.71851851851852, "ram_util_percent": 94.4}}
{"episode_reward_max": -10.999999999999998, "episode_reward_min": -168.6999999999997, "episode_reward_mean": -37.48500000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.700000000000045, -29.500000000000032, -14.499999999999996, -20.700000000000003, -40.100000000000065, -14.699999999999983, -53.500000000000036, -30.400000000000013, -29.90000000000002, -46.10000000000007, -54.3999999999999, -14.199999999999983, -38.00000000000006, -46.00000000000001, -80.5, -162.79999999999976, -50.500000000000036, -14.899999999999979, -23.900000000000038, -29.800000000000033, -50.50000000000005, -17.799999999999997, -14.499999999999996, -22.3, -53.20000000000006, -26.699999999999985, -44.00000000000005, -31.900000000000006, -52.000000000000036, -20.0, -50.90000000000004, -18.0, -25.699999999999996, -16.39999999999999, -51.90000000000005, -20.200000000000003, -59.100000000000165, -53.40000000000005, -22.5, -31.0, -51.400000000000055, -49.90000000000002, -33.300000000000054, -32.20000000000003, -168.6999999999997, -16.899999999999984, -52.10000000000005, -35.30000000000006, -52.70000000000003, -38.90000000000005, -35.100000000000044, -14.099999999999996, -52.10000000000003, -30.900000000000045, -36.900000000000006, -38.70000000000007, -28.100000000000044, -15.299999999999981, -38.500000000000064, -52.70000000000005, -21.6, -37.30000000000001, -51.10000000000006, -74.10000000000002, -52.70000000000005, -53.80000000000006, -42.900000000000006, -28.000000000000007, -76.20000000000014, -32.60000000000004, -34.10000000000001, -30.0, -22.300000000000026, -14.199999999999996, -15.999999999999998, -16.09999999999998, -15.599999999999998, -10.999999999999998, -35.20000000000006, -50.80000000000005, -11.099999999999998, -12.799999999999999, -18.099999999999998, -14.699999999999982, -22.700000000000003, -50.600000000000044, -50.90000000000005, -23.299999999999997, -38.40000000000002, -37.90000000000003, -43.50000000000005, -25.7, -41.90000000000005, -39.800000000000004, -52.600000000000044, -14.499999999999996, -52.70000000000003, -50.00000000000006, -15.799999999999995, -13.999999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5047019297667321, "mean_inference_ms": 0.670669742450379, "mean_action_processing_ms": 0.6294408537963574, "mean_env_wait_ms": 5.380546814087284, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 480000, "timesteps_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"sample_time_ms": 21350.617, "sample_throughput": 187.348, "load_time_ms": 0.308, "load_throughput": 13000554.824, "learn_time_ms": 6265.343, "learn_throughput": 638.433}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.163336342344337e-18, "cur_lr": 0.00010000000000000003, "total_loss": 0.6428162326703288, "policy_loss": -0.0012638307627170318, "vf_loss": 64.40800736335017, "vf_explained_var": -0.1534183184946737, "kl": 0.00565732934075816, "entropy": 0.23176219048359062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 480000, "num_steps_trained": 480000, "num_agent_steps_trained": 480000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4800, "training_iteration": 120, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-16-38", "timestamp": 1651065398, "time_this_iter_s": 40.435279846191406, "time_total_s": 4452.291644334793, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4452.291644334793, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 15.579310344827586, "ram_util_percent": 94.34482758620688}}
{"episode_reward_max": -10.399999999999997, "episode_reward_min": -168.6999999999997, "episode_reward_mean": -36.76800000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.400000000000055, -49.90000000000002, -33.300000000000054, -32.20000000000003, -168.6999999999997, -16.899999999999984, -52.10000000000005, -35.30000000000006, -52.70000000000003, -38.90000000000005, -35.100000000000044, -14.099999999999996, -52.10000000000003, -30.900000000000045, -36.900000000000006, -38.70000000000007, -28.100000000000044, -15.299999999999981, -38.500000000000064, -52.70000000000005, -21.6, -37.30000000000001, -51.10000000000006, -74.10000000000002, -52.70000000000005, -53.80000000000006, -42.900000000000006, -28.000000000000007, -76.20000000000014, -32.60000000000004, -34.10000000000001, -30.0, -22.300000000000026, -14.199999999999996, -15.999999999999998, -16.09999999999998, -15.599999999999998, -10.999999999999998, -35.20000000000006, -50.80000000000005, -11.099999999999998, -12.799999999999999, -18.099999999999998, -14.699999999999982, -22.700000000000003, -50.600000000000044, -50.90000000000005, -23.299999999999997, -38.40000000000002, -37.90000000000003, -43.50000000000005, -25.7, -41.90000000000005, -39.800000000000004, -52.600000000000044, -14.499999999999996, -52.70000000000003, -50.00000000000006, -15.799999999999995, -13.999999999999996, -50.90000000000005, -33.100000000000044, -51.400000000000055, -52.90000000000005, -45.300000000000054, -49.70000000000004, -11.499999999999995, -25.1, -19.700000000000045, -25.900000000000006, -19.499999999999993, -37.39999999999999, -52.50000000000005, -24.99999999999996, -34.300000000000054, -15.099999999999993, -49.30000000000004, -52.500000000000085, -36.50000000000006, -51.50000000000003, -18.70000000000001, -50.20000000000004, -12.299999999999986, -47.80000000000003, -27.200000000000003, -87.29999999999997, -104.3999999999999, -27.10000000000001, -10.399999999999997, -26.7, -13.099999999999998, -17.200000000000003, -32.90000000000005, -23.400000000000002, -37.70000000000007, -29.200000000000003, -42.20000000000007, -48.1, -35.80000000000006, -25.60000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4973583994683752, "mean_inference_ms": 0.6714693480471212, "mean_action_processing_ms": 0.6244681214093883, "mean_env_wait_ms": 5.360657224568438, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 484000, "timesteps_this_iter": 0, "agent_timesteps_total": 484000, "timers": {"sample_time_ms": 21167.16, "sample_throughput": 188.972, "load_time_ms": 0.307, "load_throughput": 13033884.4, "learn_time_ms": 6221.753, "learn_throughput": 642.906}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.163336342344337e-18, "cur_lr": 0.00010000000000000003, "total_loss": 0.8427863257085925, "policy_loss": -0.002014403796244052, "vf_loss": 84.48007450103759, "vf_explained_var": 0.09582066651313535, "kl": 0.008113541533073311, "entropy": 0.19133955098247976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 484000, "num_agent_steps_sampled": 484000, "num_steps_trained": 484000, "num_agent_steps_trained": 484000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4840, "training_iteration": 121, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-17-02", "timestamp": 1651065422, "time_this_iter_s": 24.39563798904419, "time_total_s": 4476.687282323837, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4476.687282323837, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 36.300000000000004, "ram_util_percent": 94.88181818181818}}
{"episode_reward_max": -10.399999999999997, "episode_reward_min": -104.3999999999999, "episode_reward_mean": -34.70200000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.099999999999998, -12.799999999999999, -18.099999999999998, -14.699999999999982, -22.700000000000003, -50.600000000000044, -50.90000000000005, -23.299999999999997, -38.40000000000002, -37.90000000000003, -43.50000000000005, -25.7, -41.90000000000005, -39.800000000000004, -52.600000000000044, -14.499999999999996, -52.70000000000003, -50.00000000000006, -15.799999999999995, -13.999999999999996, -50.90000000000005, -33.100000000000044, -51.400000000000055, -52.90000000000005, -45.300000000000054, -49.70000000000004, -11.499999999999995, -25.1, -19.700000000000045, -25.900000000000006, -19.499999999999993, -37.39999999999999, -52.50000000000005, -24.99999999999996, -34.300000000000054, -15.099999999999993, -49.30000000000004, -52.500000000000085, -36.50000000000006, -51.50000000000003, -18.70000000000001, -50.20000000000004, -12.299999999999986, -47.80000000000003, -27.200000000000003, -87.29999999999997, -104.3999999999999, -27.10000000000001, -10.399999999999997, -26.7, -13.099999999999998, -17.200000000000003, -32.90000000000005, -23.400000000000002, -37.70000000000007, -29.200000000000003, -42.20000000000007, -48.1, -35.80000000000006, -25.60000000000003, -51.10000000000004, -11.6, -50.800000000000075, -12.799999999999999, -72.60000000000004, -51.700000000000045, -13.999999999999996, -51.00000000000004, -47.900000000000055, -29.1, -50.20000000000005, -37.000000000000064, -40.60000000000001, -15.199999999999983, -31.70000000000001, -24.1, -39.80000000000007, -36.7, -14.99999999999998, -52.100000000000065, -44.30000000000002, -14.799999999999994, -53.00000000000005, -32.7, -16.099999999999984, -34.60000000000001, -45.30000000000005, -13.699999999999983, -30.60000000000001, -31.100000000000023, -37.399999999999984, -15.699999999999983, -48.90000000000006, -13.099999999999993, -23.10000000000003, -43.400000000000034, -37.4, -11.199999999999987, -52.300000000000026, -49.10000000000008], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4904227253775628, "mean_inference_ms": 0.6727704993592143, "mean_action_processing_ms": 0.619593393751897, "mean_env_wait_ms": 5.341906143583485, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 488000, "timesteps_this_iter": 0, "agent_timesteps_total": 488000, "timers": {"sample_time_ms": 21194.028, "sample_throughput": 188.732, "load_time_ms": 0.308, "load_throughput": 12982446.8, "learn_time_ms": 6251.254, "learn_throughput": 639.872}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.163336342344337e-18, "cur_lr": 0.00010000000000000003, "total_loss": 0.5825581517627573, "policy_loss": -0.004369518686566622, "vf_loss": 58.692768426095284, "vf_explained_var": 0.16511459260858516, "kl": 0.004418270451160249, "entropy": 0.22478480324529673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 488000, "num_agent_steps_sampled": 488000, "num_steps_trained": 488000, "num_agent_steps_trained": 488000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4880, "training_iteration": 122, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-17-25", "timestamp": 1651065445, "time_this_iter_s": 22.76772713661194, "time_total_s": 4499.455009460449, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4499.455009460449, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 21.24516129032258, "ram_util_percent": 94.741935483871}}
{"episode_reward_max": -9.9, "episode_reward_min": -104.3999999999999, "episode_reward_mean": -33.11400000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.70000000000001, -50.20000000000004, -12.299999999999986, -47.80000000000003, -27.200000000000003, -87.29999999999997, -104.3999999999999, -27.10000000000001, -10.399999999999997, -26.7, -13.099999999999998, -17.200000000000003, -32.90000000000005, -23.400000000000002, -37.70000000000007, -29.200000000000003, -42.20000000000007, -48.1, -35.80000000000006, -25.60000000000003, -51.10000000000004, -11.6, -50.800000000000075, -12.799999999999999, -72.60000000000004, -51.700000000000045, -13.999999999999996, -51.00000000000004, -47.900000000000055, -29.1, -50.20000000000005, -37.000000000000064, -40.60000000000001, -15.199999999999983, -31.70000000000001, -24.1, -39.80000000000007, -36.7, -14.99999999999998, -52.100000000000065, -44.30000000000002, -14.799999999999994, -53.00000000000005, -32.7, -16.099999999999984, -34.60000000000001, -45.30000000000005, -13.699999999999983, -30.60000000000001, -31.100000000000023, -37.399999999999984, -15.699999999999983, -48.90000000000006, -13.099999999999993, -23.10000000000003, -43.400000000000034, -37.4, -11.199999999999987, -52.300000000000026, -49.10000000000008, -52.80000000000005, -18.2, -49.60000000000003, -17.2, -52.000000000000036, -30.100000000000026, -32.099999999999994, -52.20000000000006, -35.0, -16.09999999999999, -28.60000000000001, -43.800000000000075, -78.09999999999991, -48.20000000000004, -24.000000000000053, -33.40000000000002, -22.700000000000003, -12.999999999999998, -27.70000000000002, -26.000000000000004, -22.3, -46.30000000000007, -30.400000000000055, -15.699999999999992, -19.799999999999997, -19.400000000000013, -19.800000000000026, -15.49999999999999, -15.69999999999999, -53.400000000000055, -39.20000000000007, -37.30000000000001, -49.10000000000004, -12.599999999999998, -27.5, -26.00000000000002, -16.299999999999997, -9.9, -22.799999999999997, -11.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4835953758478257, "mean_inference_ms": 0.6739922444693071, "mean_action_processing_ms": 0.614801156652397, "mean_env_wait_ms": 5.323671733237716, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 492000, "timesteps_this_iter": 0, "agent_timesteps_total": 492000, "timers": {"sample_time_ms": 21391.593, "sample_throughput": 186.989, "load_time_ms": 0.315, "load_throughput": 12712901.417, "learn_time_ms": 6271.198, "learn_throughput": 637.837}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.0816681711721684e-18, "cur_lr": 0.00010000000000000003, "total_loss": 0.5911514630070537, "policy_loss": -0.004636193223057254, "vf_loss": 59.57876660131639, "vf_explained_var": -0.04565583147028441, "kl": 0.007228196393324544, "entropy": 0.20175899085738966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 492000, "num_agent_steps_sampled": 492000, "num_steps_trained": 492000, "num_agent_steps_trained": 492000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4920, "training_iteration": 123, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-17-48", "timestamp": 1651065468, "time_this_iter_s": 22.647118091583252, "time_total_s": 4522.1021275520325, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4522.1021275520325, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 16.925806451612903, "ram_util_percent": 94.80967741935486}}
{"episode_reward_max": -9.9, "episode_reward_min": -83.09999999999997, "episode_reward_mean": -32.29200000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.30000000000002, -14.799999999999994, -53.00000000000005, -32.7, -16.099999999999984, -34.60000000000001, -45.30000000000005, -13.699999999999983, -30.60000000000001, -31.100000000000023, -37.399999999999984, -15.699999999999983, -48.90000000000006, -13.099999999999993, -23.10000000000003, -43.400000000000034, -37.4, -11.199999999999987, -52.300000000000026, -49.10000000000008, -52.80000000000005, -18.2, -49.60000000000003, -17.2, -52.000000000000036, -30.100000000000026, -32.099999999999994, -52.20000000000006, -35.0, -16.09999999999999, -28.60000000000001, -43.800000000000075, -78.09999999999991, -48.20000000000004, -24.000000000000053, -33.40000000000002, -22.700000000000003, -12.999999999999998, -27.70000000000002, -26.000000000000004, -22.3, -46.30000000000007, -30.400000000000055, -15.699999999999992, -19.799999999999997, -19.400000000000013, -19.800000000000026, -15.49999999999999, -15.69999999999999, -53.400000000000055, -39.20000000000007, -37.30000000000001, -49.10000000000004, -12.599999999999998, -27.5, -26.00000000000002, -16.299999999999997, -9.9, -22.799999999999997, -11.5, -23.3, -27.5, -26.900000000000006, -37.1, -36.80000000000005, -49.90000000000005, -50.2, -34.2, -22.500000000000068, -83.09999999999997, -52.400000000000034, -55.10000000000005, -14.4, -11.199999999999978, -10.999999999999984, -24.90000000000006, -18.2, -21.400000000000034, -24.90000000000001, -47.90000000000008, -42.100000000000065, -15.2, -20.299999999999997, -31.900000000000055, -26.100000000000023, -45.3000000000001, -19.600000000000005, -53.20000000000003, -36.00000000000005, -48.20000000000004, -24.700000000000003, -14.299999999999985, -53.00000000000004, -41.30000000000007, -19.099999999999994, -40.80000000000006, -55.800000000000075, -32.2, -50.800000000000054, -27.299999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4765428520599153, "mean_inference_ms": 0.674928038147036, "mean_action_processing_ms": 0.6100868020556753, "mean_env_wait_ms": 5.306180992223242, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 496000, "timesteps_this_iter": 0, "agent_timesteps_total": 496000, "timers": {"sample_time_ms": 21613.108, "sample_throughput": 185.073, "load_time_ms": 0.346, "load_throughput": 11570493.793, "learn_time_ms": 6356.473, "learn_throughput": 629.28}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.0816681711721684e-18, "cur_lr": 0.00010000000000000003, "total_loss": 0.708870164660414, "policy_loss": 0.0020267047308465485, "vf_loss": 70.68434827866093, "vf_explained_var": -0.01751352349917094, "kl": 0.002051490374480814, "entropy": 0.17637137495286723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 496000, "num_agent_steps_sampled": 496000, "num_steps_trained": 496000, "num_agent_steps_trained": 496000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 4960, "training_iteration": 124, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-18-12", "timestamp": 1651065492, "time_this_iter_s": 23.850828647613525, "time_total_s": 4545.952956199646, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4545.952956199646, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 26.35, "ram_util_percent": 95.234375}}
{"episode_reward_max": -9.9, "episode_reward_min": -83.09999999999997, "episode_reward_mean": -32.904000000000025, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.3, -46.30000000000007, -30.400000000000055, -15.699999999999992, -19.799999999999997, -19.400000000000013, -19.800000000000026, -15.49999999999999, -15.69999999999999, -53.400000000000055, -39.20000000000007, -37.30000000000001, -49.10000000000004, -12.599999999999998, -27.5, -26.00000000000002, -16.299999999999997, -9.9, -22.799999999999997, -11.5, -23.3, -27.5, -26.900000000000006, -37.1, -36.80000000000005, -49.90000000000005, -50.2, -34.2, -22.500000000000068, -83.09999999999997, -52.400000000000034, -55.10000000000005, -14.4, -11.199999999999978, -10.999999999999984, -24.90000000000006, -18.2, -21.400000000000034, -24.90000000000001, -47.90000000000008, -42.100000000000065, -15.2, -20.299999999999997, -31.900000000000055, -26.100000000000023, -45.3000000000001, -19.600000000000005, -53.20000000000003, -36.00000000000005, -48.20000000000004, -24.700000000000003, -14.299999999999985, -53.00000000000004, -41.30000000000007, -19.099999999999994, -40.80000000000006, -55.800000000000075, -32.2, -50.800000000000054, -27.299999999999997, -47.70000000000003, -52.000000000000036, -52.600000000000044, -13.29999999999998, -52.20000000000008, -25.000000000000007, -52.10000000000005, -48.600000000000044, -31.00000000000001, -30.10000000000001, -31.80000000000002, -16.299999999999997, -37.2, -16.199999999999992, -50.70000000000004, -22.200000000000006, -15.89999999999998, -11.999999999999984, -46.60000000000006, -52.40000000000005, -10.499999999999986, -36.1, -55.60000000000006, -14.4, -12.699999999999998, -20.799999999999997, -20.099999999999998, -28.400000000000006, -51.90000000000008, -46.90000000000008, -42.50000000000007, -43.200000000000074, -51.80000000000003, -51.200000000000045, -28.10000000000001, -51.30000000000004, -49.800000000000054, -16.099999999999998, -40.1, -32.40000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.469608335157418, "mean_inference_ms": 0.6759156641437355, "mean_action_processing_ms": 0.6054513718163401, "mean_env_wait_ms": 5.28903033705043, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 500000, "timesteps_this_iter": 0, "agent_timesteps_total": 500000, "timers": {"sample_time_ms": 21920.834, "sample_throughput": 182.475, "load_time_ms": 0.35, "load_throughput": 11434852.781, "learn_time_ms": 6462.236, "learn_throughput": 618.981}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0408340855860842e-18, "cur_lr": 0.00010000000000000003, "total_loss": 0.6570697923596468, "policy_loss": 0.0019876668890637735, "vf_loss": 65.50821399278539, "vf_explained_var": 0.03448526487555555, "kl": 0.002638049732842226, "entropy": 0.1850682724928183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 500000, "num_agent_steps_sampled": 500000, "num_steps_trained": 500000, "num_agent_steps_trained": 500000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5000, "training_iteration": 125, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-18-35", "timestamp": 1651065515, "time_this_iter_s": 23.669704914093018, "time_total_s": 4569.622661113739, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4569.622661113739, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 27.55625, "ram_util_percent": 95.534375}}
{"episode_reward_max": -10.499999999999986, "episode_reward_min": -86.59999999999997, "episode_reward_mean": -35.239000000000026, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-42.100000000000065, -15.2, -20.299999999999997, -31.900000000000055, -26.100000000000023, -45.3000000000001, -19.600000000000005, -53.20000000000003, -36.00000000000005, -48.20000000000004, -24.700000000000003, -14.299999999999985, -53.00000000000004, -41.30000000000007, -19.099999999999994, -40.80000000000006, -55.800000000000075, -32.2, -50.800000000000054, -27.299999999999997, -47.70000000000003, -52.000000000000036, -52.600000000000044, -13.29999999999998, -52.20000000000008, -25.000000000000007, -52.10000000000005, -48.600000000000044, -31.00000000000001, -30.10000000000001, -31.80000000000002, -16.299999999999997, -37.2, -16.199999999999992, -50.70000000000004, -22.200000000000006, -15.89999999999998, -11.999999999999984, -46.60000000000006, -52.40000000000005, -10.499999999999986, -36.1, -55.60000000000006, -14.4, -12.699999999999998, -20.799999999999997, -20.099999999999998, -28.400000000000006, -51.90000000000008, -46.90000000000008, -42.50000000000007, -43.200000000000074, -51.80000000000003, -51.200000000000045, -28.10000000000001, -51.30000000000004, -49.800000000000054, -16.099999999999998, -40.1, -32.40000000000003, -30.200000000000056, -45.100000000000065, -51.20000000000007, -27.900000000000034, -34.4, -47.500000000000085, -51.40000000000004, -34.80000000000007, -40.80000000000006, -24.200000000000028, -34.6, -51.50000000000005, -44.80000000000003, -52.10000000000003, -21.40000000000005, -32.00000000000002, -16.79999999999999, -51.90000000000005, -37.10000000000004, -36.500000000000014, -10.5, -25.200000000000003, -17.9, -27.90000000000001, -53.200000000000045, -37.30000000000006, -55.20000000000008, -34.7, -13.399999999999983, -33.40000000000002, -12.499999999999984, -86.59999999999997, -35.000000000000036, -13.399999999999986, -53.90000000000004, -52.70000000000003, -31.100000000000012, -13.199999999999982, -20.799999999999994, -22.8], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.46312565494691, "mean_inference_ms": 0.6776401508167211, "mean_action_processing_ms": 0.6009053044359894, "mean_env_wait_ms": 5.273062163712165, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 504000, "timesteps_this_iter": 0, "agent_timesteps_total": 504000, "timers": {"sample_time_ms": 22506.947, "sample_throughput": 177.723, "load_time_ms": 0.32, "load_throughput": 12493272.768, "learn_time_ms": 6525.559, "learn_throughput": 612.974}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.204170427930421e-19, "cur_lr": 0.00010000000000000003, "total_loss": 0.618746150298024, "policy_loss": -0.0004979878223390989, "vf_loss": 61.92441522946922, "vf_explained_var": 0.08535362783298697, "kl": 0.00437169448458973, "entropy": 0.17682112179926887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 504000, "num_agent_steps_sampled": 504000, "num_steps_trained": 504000, "num_agent_steps_trained": 504000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5040, "training_iteration": 126, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-19-01", "timestamp": 1651065541, "time_this_iter_s": 25.77938985824585, "time_total_s": 4595.402050971985, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4595.402050971985, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 20.105714285714285, "ram_util_percent": 95.6257142857143}}
{"episode_reward_max": -10.499999999999986, "episode_reward_min": -86.59999999999997, "episode_reward_mean": -36.62100000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.499999999999986, -36.1, -55.60000000000006, -14.4, -12.699999999999998, -20.799999999999997, -20.099999999999998, -28.400000000000006, -51.90000000000008, -46.90000000000008, -42.50000000000007, -43.200000000000074, -51.80000000000003, -51.200000000000045, -28.10000000000001, -51.30000000000004, -49.800000000000054, -16.099999999999998, -40.1, -32.40000000000003, -30.200000000000056, -45.100000000000065, -51.20000000000007, -27.900000000000034, -34.4, -47.500000000000085, -51.40000000000004, -34.80000000000007, -40.80000000000006, -24.200000000000028, -34.6, -51.50000000000005, -44.80000000000003, -52.10000000000003, -21.40000000000005, -32.00000000000002, -16.79999999999999, -51.90000000000005, -37.10000000000004, -36.500000000000014, -10.5, -25.200000000000003, -17.9, -27.90000000000001, -53.200000000000045, -37.30000000000006, -55.20000000000008, -34.7, -13.399999999999983, -33.40000000000002, -12.499999999999984, -86.59999999999997, -35.000000000000036, -13.399999999999986, -53.90000000000004, -52.70000000000003, -31.100000000000012, -13.199999999999982, -20.799999999999994, -22.8, -28.30000000000001, -15.69999999999998, -51.200000000000045, -30.79999999999995, -44.00000000000007, -26.9, -16.9, -40.10000000000006, -50.10000000000004, -49.600000000000044, -30.60000000000001, -16.4, -49.300000000000026, -15.299999999999997, -15.799999999999978, -38.600000000000065, -51.70000000000004, -21.7, -50.20000000000004, -50.50000000000006, -24.799999999999997, -51.50000000000006, -31.0, -50.10000000000005, -29.000000000000007, -53.90000000000004, -48.90000000000004, -27.299999999999958, -22.9, -29.5, -55.70000000000006, -52.000000000000014, -43.90000000000003, -34.400000000000055, -71.60000000000001, -39.30000000000002, -45.80000000000005, -51.40000000000004, -48.800000000000075, -35.80000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4567862193485768, "mean_inference_ms": 0.6794527683324734, "mean_action_processing_ms": 0.5964343129886052, "mean_env_wait_ms": 5.257276233536968, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 508000, "timesteps_this_iter": 0, "agent_timesteps_total": 508000, "timers": {"sample_time_ms": 22841.334, "sample_throughput": 175.121, "load_time_ms": 0.305, "load_throughput": 13124631.151, "learn_time_ms": 6581.355, "learn_throughput": 607.778}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.6020852139652105e-19, "cur_lr": 0.00010000000000000003, "total_loss": 0.6431569657048151, "policy_loss": -0.0010338778517419293, "vf_loss": 64.41908606457454, "vf_explained_var": 0.13957550846120362, "kl": 0.00391414048046181, "entropy": 0.1467355719146629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 508000, "num_agent_steps_sampled": 508000, "num_steps_trained": 508000, "num_agent_steps_trained": 508000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5080, "training_iteration": 127, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-19-25", "timestamp": 1651065565, "time_this_iter_s": 23.46552300453186, "time_total_s": 4618.867573976517, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4618.867573976517, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 14.731250000000001, "ram_util_percent": 95.50312500000001}}
{"episode_reward_max": -10.499999999999986, "episode_reward_min": -109.99999999999999, "episode_reward_mean": -35.95900000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.5, -25.200000000000003, -17.9, -27.90000000000001, -53.200000000000045, -37.30000000000006, -55.20000000000008, -34.7, -13.399999999999983, -33.40000000000002, -12.499999999999984, -86.59999999999997, -35.000000000000036, -13.399999999999986, -53.90000000000004, -52.70000000000003, -31.100000000000012, -13.199999999999982, -20.799999999999994, -22.8, -28.30000000000001, -15.69999999999998, -51.200000000000045, -30.79999999999995, -44.00000000000007, -26.9, -16.9, -40.10000000000006, -50.10000000000004, -49.600000000000044, -30.60000000000001, -16.4, -49.300000000000026, -15.299999999999997, -15.799999999999978, -38.600000000000065, -51.70000000000004, -21.7, -50.20000000000004, -50.50000000000006, -24.799999999999997, -51.50000000000006, -31.0, -50.10000000000005, -29.000000000000007, -53.90000000000004, -48.90000000000004, -27.299999999999958, -22.9, -29.5, -55.70000000000006, -52.000000000000014, -43.90000000000003, -34.400000000000055, -71.60000000000001, -39.30000000000002, -45.80000000000005, -51.40000000000004, -48.800000000000075, -35.80000000000001, -28.500000000000007, -31.90000000000004, -51.100000000000065, -50.60000000000005, -21.3, -15.999999999999995, -27.500000000000007, -14.5, -49.000000000000064, -30.80000000000002, -31.199999999999996, -52.70000000000005, -46.500000000000064, -109.99999999999999, -28.200000000000017, -11.299999999999986, -15.899999999999997, -47.700000000000045, -33.2, -70.80000000000001, -12.799999999999983, -15.7, -17.799999999999983, -11.699999999999978, -13.999999999999998, -10.499999999999986, -40.599999999999994, -27.60000000000003, -28.8, -36.40000000000004, -33.5, -13.599999999999975, -54.60000000000008, -51.30000000000003, -53.60000000000004, -29.20000000000003, -49.700000000000045, -32.80000000000001, -50.600000000000044, -50.40000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.450411752749403, "mean_inference_ms": 0.6809553577833484, "mean_action_processing_ms": 0.592029703184554, "mean_env_wait_ms": 5.241201486204832, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 512000, "timesteps_this_iter": 0, "agent_timesteps_total": 512000, "timers": {"sample_time_ms": 23099.66, "sample_throughput": 173.163, "load_time_ms": 0.304, "load_throughput": 13174099.725, "learn_time_ms": 6668.731, "learn_throughput": 599.814}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3010426069826053e-19, "cur_lr": 0.00010000000000000003, "total_loss": 1.154808470785057, "policy_loss": 0.004508796192565432, "vf_loss": 115.02997065000636, "vf_explained_var": -0.059031266550863944, "kl": 0.0044582720050435586, "entropy": 0.19506860411856122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 512000, "num_agent_steps_sampled": 512000, "num_steps_trained": 512000, "num_agent_steps_trained": 512000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5120, "training_iteration": 128, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-19-48", "timestamp": 1651065588, "time_this_iter_s": 23.570909023284912, "time_total_s": 4642.438482999802, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4642.438482999802, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 20.553125, "ram_util_percent": 95.546875}}
{"episode_reward_max": -10.499999999999986, "episode_reward_min": -109.99999999999999, "episode_reward_mean": -36.29400000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.799999999999997, -51.50000000000006, -31.0, -50.10000000000005, -29.000000000000007, -53.90000000000004, -48.90000000000004, -27.299999999999958, -22.9, -29.5, -55.70000000000006, -52.000000000000014, -43.90000000000003, -34.400000000000055, -71.60000000000001, -39.30000000000002, -45.80000000000005, -51.40000000000004, -48.800000000000075, -35.80000000000001, -28.500000000000007, -31.90000000000004, -51.100000000000065, -50.60000000000005, -21.3, -15.999999999999995, -27.500000000000007, -14.5, -49.000000000000064, -30.80000000000002, -31.199999999999996, -52.70000000000005, -46.500000000000064, -109.99999999999999, -28.200000000000017, -11.299999999999986, -15.899999999999997, -47.700000000000045, -33.2, -70.80000000000001, -12.799999999999983, -15.7, -17.799999999999983, -11.699999999999978, -13.999999999999998, -10.499999999999986, -40.599999999999994, -27.60000000000003, -28.8, -36.40000000000004, -33.5, -13.599999999999975, -54.60000000000008, -51.30000000000003, -53.60000000000004, -29.20000000000003, -49.700000000000045, -32.80000000000001, -50.600000000000044, -50.40000000000004, -18.099999999999987, -52.10000000000001, -14.699999999999982, -12.8, -48.40000000000008, -52.10000000000003, -58.69999999999992, -19.30000000000002, -26.10000000000001, -34.70000000000004, -50.700000000000045, -16.49999999999998, -27.10000000000003, -11.999999999999998, -43.100000000000044, -47.90000000000003, -48.30000000000003, -40.000000000000064, -16.7, -32.20000000000002, -20.1, -70.80000000000003, -34.099999999999994, -13.099999999999993, -48.30000000000005, -49.40000000000004, -37.00000000000006, -49.700000000000074, -12.4, -18.000000000000007, -32.10000000000002, -13.69999999999998, -31.90000000000001, -48.00000000000008, -47.60000000000005, -34.49999999999999, -14.5, -68.69999999999999, -48.70000000000005, -13.799999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4442231903001064, "mean_inference_ms": 0.6820504394070894, "mean_action_processing_ms": 0.5876817854944365, "mean_env_wait_ms": 5.224407477030107, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 516000, "timesteps_this_iter": 0, "agent_timesteps_total": 516000, "timers": {"sample_time_ms": 23377.099, "sample_throughput": 171.108, "load_time_ms": 0.303, "load_throughput": 13181345.066, "learn_time_ms": 6725.322, "learn_throughput": 594.767}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.505213034913026e-20, "cur_lr": 0.00010000000000000003, "total_loss": 0.7744571867511577, "policy_loss": -0.0020053082175793186, "vf_loss": 77.64625060994138, "vf_explained_var": 0.05402383413366092, "kl": 0.007980523702578903, "entropy": 0.1963235840341577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 516000, "num_agent_steps_sampled": 516000, "num_steps_trained": 516000, "num_agent_steps_trained": 516000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5160, "training_iteration": 129, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-20-11", "timestamp": 1651065611, "time_this_iter_s": 22.826457977294922, "time_total_s": 4665.264940977097, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4665.264940977097, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 24.883870967741938, "ram_util_percent": 95.51612903225806}}
{"episode_reward_max": -10.499999999999986, "episode_reward_min": -70.80000000000003, "episode_reward_mean": -34.62700000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.799999999999983, -15.7, -17.799999999999983, -11.699999999999978, -13.999999999999998, -10.499999999999986, -40.599999999999994, -27.60000000000003, -28.8, -36.40000000000004, -33.5, -13.599999999999975, -54.60000000000008, -51.30000000000003, -53.60000000000004, -29.20000000000003, -49.700000000000045, -32.80000000000001, -50.600000000000044, -50.40000000000004, -18.099999999999987, -52.10000000000001, -14.699999999999982, -12.8, -48.40000000000008, -52.10000000000003, -58.69999999999992, -19.30000000000002, -26.10000000000001, -34.70000000000004, -50.700000000000045, -16.49999999999998, -27.10000000000003, -11.999999999999998, -43.100000000000044, -47.90000000000003, -48.30000000000003, -40.000000000000064, -16.7, -32.20000000000002, -20.1, -70.80000000000003, -34.099999999999994, -13.099999999999993, -48.30000000000005, -49.40000000000004, -37.00000000000006, -49.700000000000074, -12.4, -18.000000000000007, -32.10000000000002, -13.69999999999998, -31.90000000000001, -48.00000000000008, -47.60000000000005, -34.49999999999999, -14.5, -68.69999999999999, -48.70000000000005, -13.799999999999999, -30.100000000000005, -51.20000000000004, -15.99999999999998, -36.900000000000006, -54.70000000000005, -13.499999999999973, -31.00000000000001, -57.400000000000055, -52.00000000000004, -47.80000000000008, -45.200000000000024, -54.90000000000005, -30.400000000000013, -46.90000000000003, -28.6, -15.899999999999999, -50.30000000000004, -15.499999999999998, -16.099999999999977, -13.799999999999999, -13.899999999999995, -32.30000000000003, -13.79999999999998, -40.40000000000005, -36.200000000000045, -44.20000000000007, -51.90000000000005, -26.300000000000033, -52.900000000000034, -25.9, -48.20000000000003, -35.10000000000001, -41.70000000000006, -50.50000000000002, -53.49999999999992, -49.80000000000002, -52.10000000000005, -31.50000000000003, -28.700000000000003, -12.499999999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.439052762946253, "mean_inference_ms": 0.8557109049428587, "mean_action_processing_ms": 0.5834434435188435, "mean_env_wait_ms": 5.211301721490523, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 520000, "timesteps_this_iter": 0, "agent_timesteps_total": 520000, "timers": {"sample_time_ms": 24467.921, "sample_throughput": 163.479, "load_time_ms": 0.303, "load_throughput": 13184452.652, "learn_time_ms": 4809.358, "learn_throughput": 831.712}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.505213034913026e-20, "cur_lr": 0.00010000000000000003, "total_loss": 0.6938891384885797, "policy_loss": -0.005063883283285685, "vf_loss": 69.89530359083606, "vf_explained_var": 0.041810226055883595, "kl": 0.007612488185889261, "entropy": 0.1748545395550869, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 520000, "num_agent_steps_sampled": 520000, "num_steps_trained": 520000, "num_agent_steps_trained": 520000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5200, "training_iteration": 130, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-24-25", "timestamp": 1651065865, "time_this_iter_s": 253.62537384033203, "time_total_s": 4918.890314817429, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4918.890314817429, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 45.38780487804878, "ram_util_percent": 95.64146341463415}}
{"episode_reward_max": -11.299999999999997, "episode_reward_min": -142.6999999999998, "episode_reward_mean": -37.69500000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.1, -70.80000000000003, -34.099999999999994, -13.099999999999993, -48.30000000000005, -49.40000000000004, -37.00000000000006, -49.700000000000074, -12.4, -18.000000000000007, -32.10000000000002, -13.69999999999998, -31.90000000000001, -48.00000000000008, -47.60000000000005, -34.49999999999999, -14.5, -68.69999999999999, -48.70000000000005, -13.799999999999999, -30.100000000000005, -51.20000000000004, -15.99999999999998, -36.900000000000006, -54.70000000000005, -13.499999999999973, -31.00000000000001, -57.400000000000055, -52.00000000000004, -47.80000000000008, -45.200000000000024, -54.90000000000005, -30.400000000000013, -46.90000000000003, -28.6, -15.899999999999999, -50.30000000000004, -15.499999999999998, -16.099999999999977, -13.799999999999999, -13.899999999999995, -32.30000000000003, -13.79999999999998, -40.40000000000005, -36.200000000000045, -44.20000000000007, -51.90000000000005, -26.300000000000033, -52.900000000000034, -25.9, -48.20000000000003, -35.10000000000001, -41.70000000000006, -50.50000000000002, -53.49999999999992, -49.80000000000002, -52.10000000000005, -31.50000000000003, -28.700000000000003, -12.499999999999995, -101.90000000000003, -18.4, -31.900000000000006, -16.69999999999998, -47.5, -20.199999999999996, -47.90000000000008, -51.10000000000004, -15.699999999999998, -31.700000000000028, -28.500000000000046, -45.60000000000006, -38.10000000000001, -30.30000000000001, -53.60000000000005, -52.40000000000004, -15.199999999999994, -15.499999999999991, -23.800000000000004, -13.79999999999999, -56.300000000000026, -11.299999999999997, -32.20000000000001, -142.6999999999998, -11.899999999999997, -74.10000000000001, -18.2, -82.60000000000014, -52.000000000000036, -54.00000000000004, -38.1, -35.800000000000054, -16.49999999999998, -54.00000000000008, -29.700000000000003, -36.40000000000006, -38.00000000000006, -54.300000000000075, -41.700000000000045, -33.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4340251150926417, "mean_inference_ms": 1.0281503402492431, "mean_action_processing_ms": 0.5792736951751905, "mean_env_wait_ms": 5.198767085732362, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 524000, "timesteps_this_iter": 0, "agent_timesteps_total": 524000, "timers": {"sample_time_ms": 24420.058, "sample_throughput": 163.8, "load_time_ms": 0.304, "load_throughput": 13167895.77, "learn_time_ms": 4771.45, "learn_throughput": 838.32}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.505213034913026e-20, "cur_lr": 0.00010000000000000003, "total_loss": 1.7922119815693667, "policy_loss": 0.00021118753920159033, "vf_loss": 179.20008284455986, "vf_explained_var": 0.08702555042441174, "kl": 0.0028154651906435874, "entropy": 0.18025467586953953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 524000, "num_agent_steps_sampled": 524000, "num_steps_trained": 524000, "num_agent_steps_trained": 524000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5240, "training_iteration": 131, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-24-48", "timestamp": 1651065888, "time_this_iter_s": 23.363980054855347, "time_total_s": 4942.254294872284, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4942.254294872284, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 22.65483870967742, "ram_util_percent": 95.22903225806449}}
{"episode_reward_max": -11.099999999999998, "episode_reward_min": -142.6999999999998, "episode_reward_mean": -37.03100000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.899999999999995, -32.30000000000003, -13.79999999999998, -40.40000000000005, -36.200000000000045, -44.20000000000007, -51.90000000000005, -26.300000000000033, -52.900000000000034, -25.9, -48.20000000000003, -35.10000000000001, -41.70000000000006, -50.50000000000002, -53.49999999999992, -49.80000000000002, -52.10000000000005, -31.50000000000003, -28.700000000000003, -12.499999999999995, -101.90000000000003, -18.4, -31.900000000000006, -16.69999999999998, -47.5, -20.199999999999996, -47.90000000000008, -51.10000000000004, -15.699999999999998, -31.700000000000028, -28.500000000000046, -45.60000000000006, -38.10000000000001, -30.30000000000001, -53.60000000000005, -52.40000000000004, -15.199999999999994, -15.499999999999991, -23.800000000000004, -13.79999999999999, -56.300000000000026, -11.299999999999997, -32.20000000000001, -142.6999999999998, -11.899999999999997, -74.10000000000001, -18.2, -82.60000000000014, -52.000000000000036, -54.00000000000004, -38.1, -35.800000000000054, -16.49999999999998, -54.00000000000008, -29.700000000000003, -36.40000000000006, -38.00000000000006, -54.300000000000075, -41.700000000000045, -33.9, -70.3, -15.599999999999998, -32.60000000000005, -26.10000000000001, -27.799999999999994, -20.20000000000002, -22.79999999999999, -44.600000000000094, -42.30000000000008, -49.50000000000004, -20.2, -24.200000000000014, -13.099999999999987, -38.900000000000055, -39.80000000000001, -76.8, -13.799999999999983, -26.9, -11.099999999999998, -32.100000000000016, -50.30000000000007, -29.400000000000006, -37.900000000000055, -47.800000000000026, -47.40000000000005, -14.199999999999985, -36.9, -53.20000000000004, -38.300000000000075, -19.499999999999993, -17.299999999999983, -14.999999999999993, -42.20000000000005, -43.00000000000008, -53.50000000000003, -52.80000000000005, -16.199999999999992, -16.599999999999984, -28.699999999999996, -39.30000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.428526228063706, "mean_inference_ms": 1.112672421310933, "mean_action_processing_ms": 0.5751366626666655, "mean_env_wait_ms": 5.184374839462105, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 528000, "timesteps_this_iter": 0, "agent_timesteps_total": 528000, "timers": {"sample_time_ms": 24289.977, "sample_throughput": 164.677, "load_time_ms": 0.313, "load_throughput": 12788486.927, "learn_time_ms": 4805.697, "learn_throughput": 832.345}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.252606517456513e-20, "cur_lr": 0.00010000000000000003, "total_loss": 0.7019926353127405, "policy_loss": -0.002040344559817865, "vf_loss": 70.40329962699644, "vf_explained_var": 0.03848671695237519, "kl": 0.003867838722299275, "entropy": 0.23361948113312683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 528000, "num_agent_steps_sampled": 528000, "num_steps_trained": 528000, "num_agent_steps_trained": 528000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5280, "training_iteration": 132, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-25-11", "timestamp": 1651065911, "time_this_iter_s": 22.20176601409912, "time_total_s": 4964.456060886383, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4964.456060886383, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 25.635483870967743, "ram_util_percent": 95.13225806451612}}
{"episode_reward_max": -11.099999999999998, "episode_reward_min": -146.19999999999976, "episode_reward_mean": -38.46500000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.300000000000026, -11.299999999999997, -32.20000000000001, -142.6999999999998, -11.899999999999997, -74.10000000000001, -18.2, -82.60000000000014, -52.000000000000036, -54.00000000000004, -38.1, -35.800000000000054, -16.49999999999998, -54.00000000000008, -29.700000000000003, -36.40000000000006, -38.00000000000006, -54.300000000000075, -41.700000000000045, -33.9, -70.3, -15.599999999999998, -32.60000000000005, -26.10000000000001, -27.799999999999994, -20.20000000000002, -22.79999999999999, -44.600000000000094, -42.30000000000008, -49.50000000000004, -20.2, -24.200000000000014, -13.099999999999987, -38.900000000000055, -39.80000000000001, -76.8, -13.799999999999983, -26.9, -11.099999999999998, -32.100000000000016, -50.30000000000007, -29.400000000000006, -37.900000000000055, -47.800000000000026, -47.40000000000005, -14.199999999999985, -36.9, -53.20000000000004, -38.300000000000075, -19.499999999999993, -17.299999999999983, -14.999999999999993, -42.20000000000005, -43.00000000000008, -53.50000000000003, -52.80000000000005, -16.199999999999992, -16.599999999999984, -28.699999999999996, -39.30000000000005, -51.90000000000004, -32.400000000000006, -19.700000000000006, -24.400000000000002, -39.80000000000006, -38.2, -16.99999999999999, -29.799999999999997, -53.500000000000036, -28.10000000000002, -32.5, -42.399999999999984, -50.90000000000007, -26.299999999999997, -29.800000000000004, -23.000000000000046, -51.40000000000004, -37.80000000000006, -95.09999999999985, -49.100000000000044, -36.30000000000007, -26.400000000000038, -37.10000000000006, -57.90000000000004, -34.10000000000004, -18.79999999999999, -52.90000000000005, -51.700000000000045, -29.80000000000004, -23.400000000000002, -36.500000000000014, -23.0, -29.39999999999996, -25.60000000000001, -32.50000000000001, -146.19999999999976, -23.6, -32.30000000000001, -51.20000000000004, -42.80000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4224256142203062, "mean_inference_ms": 1.110008537887378, "mean_action_processing_ms": 0.5710267537123523, "mean_env_wait_ms": 5.167812801014606, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 532000, "timesteps_this_iter": 0, "agent_timesteps_total": 532000, "timers": {"sample_time_ms": 24230.395, "sample_throughput": 165.082, "load_time_ms": 0.307, "load_throughput": 13039962.692, "learn_time_ms": 4802.17, "learn_throughput": 832.957}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.6263032587282566e-20, "cur_lr": 0.00010000000000000003, "total_loss": 1.2202930321774235, "policy_loss": -3.295653069051363e-05, "vf_loss": 122.03260160056493, "vf_explained_var": 0.09658568418154152, "kl": 0.004297001564098773, "entropy": 0.11616637343878768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 532000, "num_agent_steps_sampled": 532000, "num_steps_trained": 532000, "num_agent_steps_trained": 532000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5320, "training_iteration": 133, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-25-32", "timestamp": 1651065932, "time_this_iter_s": 21.67531394958496, "time_total_s": 4986.131374835968, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 4986.131374835968, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 14.16551724137931, "ram_util_percent": 95.08275862068965}}
{"episode_reward_max": -9.499999999999998, "episode_reward_min": -146.19999999999976, "episode_reward_mean": -35.87100000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.30000000000007, -29.400000000000006, -37.900000000000055, -47.800000000000026, -47.40000000000005, -14.199999999999985, -36.9, -53.20000000000004, -38.300000000000075, -19.499999999999993, -17.299999999999983, -14.999999999999993, -42.20000000000005, -43.00000000000008, -53.50000000000003, -52.80000000000005, -16.199999999999992, -16.599999999999984, -28.699999999999996, -39.30000000000005, -51.90000000000004, -32.400000000000006, -19.700000000000006, -24.400000000000002, -39.80000000000006, -38.2, -16.99999999999999, -29.799999999999997, -53.500000000000036, -28.10000000000002, -32.5, -42.399999999999984, -50.90000000000007, -26.299999999999997, -29.800000000000004, -23.000000000000046, -51.40000000000004, -37.80000000000006, -95.09999999999985, -49.100000000000044, -36.30000000000007, -26.400000000000038, -37.10000000000006, -57.90000000000004, -34.10000000000004, -18.79999999999999, -52.90000000000005, -51.700000000000045, -29.80000000000004, -23.400000000000002, -36.500000000000014, -23.0, -29.39999999999996, -25.60000000000001, -32.50000000000001, -146.19999999999976, -23.6, -32.30000000000001, -51.20000000000004, -42.80000000000006, -50.400000000000055, -23.899999999999974, -18.299999999999983, -32.10000000000001, -26.600000000000033, -61.00000000000011, -21.500000000000014, -51.20000000000006, -36.70000000000002, -34.999999999999986, -33.500000000000064, -17.599999999999987, -51.099999999999916, -53.60000000000004, -33.800000000000004, -15.899999999999995, -18.199999999999985, -14.199999999999989, -26.400000000000006, -34.4, -9.499999999999998, -38.40000000000001, -37.700000000000045, -31.899999999999956, -32.90000000000001, -50.400000000000055, -18.70000000000001, -42.00000000000006, -33.800000000000004, -21.00000000000005, -17.19999999999999, -27.60000000000006, -52.000000000000064, -30.00000000000004, -28.70000000000001, -40.300000000000075, -41.399999999999984, -39.80000000000002, -37.10000000000006, -17.199999999999985], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.416361142253062, "mean_inference_ms": 1.106956845987244, "mean_action_processing_ms": 0.5669651225449521, "mean_env_wait_ms": 5.150718305380744, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 536000, "timesteps_this_iter": 0, "agent_timesteps_total": 536000, "timers": {"sample_time_ms": 23995.727, "sample_throughput": 166.696, "load_time_ms": 0.275, "load_throughput": 14552186.66, "learn_time_ms": 4720.909, "learn_throughput": 847.294}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.131516293641283e-21, "cur_lr": 0.00010000000000000003, "total_loss": 0.5137614094106461, "policy_loss": -0.000505406146128011, "vf_loss": 51.42668272756761, "vf_explained_var": -0.009673571586608887, "kl": 0.005206281240031825, "entropy": 0.20837901292308683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 536000, "num_agent_steps_sampled": 536000, "num_steps_trained": 536000, "num_agent_steps_trained": 536000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5360, "training_iteration": 134, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-25-53", "timestamp": 1651065953, "time_this_iter_s": 20.729058742523193, "time_total_s": 5006.860433578491, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5006.860433578491, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 18.446428571428573, "ram_util_percent": 94.96428571428571}}
{"episode_reward_max": -8.599999999999996, "episode_reward_min": -146.19999999999976, "episode_reward_mean": -37.07800000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-36.30000000000007, -26.400000000000038, -37.10000000000006, -57.90000000000004, -34.10000000000004, -18.79999999999999, -52.90000000000005, -51.700000000000045, -29.80000000000004, -23.400000000000002, -36.500000000000014, -23.0, -29.39999999999996, -25.60000000000001, -32.50000000000001, -146.19999999999976, -23.6, -32.30000000000001, -51.20000000000004, -42.80000000000006, -50.400000000000055, -23.899999999999974, -18.299999999999983, -32.10000000000001, -26.600000000000033, -61.00000000000011, -21.500000000000014, -51.20000000000006, -36.70000000000002, -34.999999999999986, -33.500000000000064, -17.599999999999987, -51.099999999999916, -53.60000000000004, -33.800000000000004, -15.899999999999995, -18.199999999999985, -14.199999999999989, -26.400000000000006, -34.4, -9.499999999999998, -38.40000000000001, -37.700000000000045, -31.899999999999956, -32.90000000000001, -50.400000000000055, -18.70000000000001, -42.00000000000006, -33.800000000000004, -21.00000000000005, -17.19999999999999, -27.60000000000006, -52.000000000000064, -30.00000000000004, -28.70000000000001, -40.300000000000075, -41.399999999999984, -39.80000000000002, -37.10000000000006, -17.199999999999985, -8.599999999999996, -36.40000000000005, -55.500000000000085, -52.700000000000045, -41.50000000000002, -39.599999999999994, -29.800000000000008, -43.8, -24.700000000000003, -34.300000000000004, -50.700000000000095, -34.100000000000044, -11.599999999999998, -9.799999999999999, -39.90000000000001, -109.29999999999977, -16.199999999999996, -51.40000000000005, -35.4, -90.49999999999989, -39.7, -24.29999999999998, -52.10000000000005, -64.20000000000006, -35.700000000000045, -108.6999999999998, -58.2, -38.400000000000006, -35.5, -11.499999999999998, -36.60000000000005, -15.499999999999998, -29.4, -16.099999999999987, -52.300000000000054, -55.400000000000006, -34.40000000000003, -27.0, -28.90000000000004, -13.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4104671220264628, "mean_inference_ms": 1.1040220908136475, "mean_action_processing_ms": 0.5629715951841293, "mean_env_wait_ms": 5.1343763616120555, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 540000, "timesteps_this_iter": 0, "agent_timesteps_total": 540000, "timers": {"sample_time_ms": 23894.844, "sample_throughput": 167.4, "load_time_ms": 0.271, "load_throughput": 14738835.105, "learn_time_ms": 4608.644, "learn_throughput": 867.934}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.131516293641283e-21, "cur_lr": 0.00010000000000000003, "total_loss": 1.1273952087938224, "policy_loss": -0.0007271564735840725, "vf_loss": 112.81223929210375, "vf_explained_var": 0.12127248228237193, "kl": 0.004681983808662611, "entropy": 0.1715871047008262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 540000, "num_agent_steps_sampled": 540000, "num_steps_trained": 540000, "num_agent_steps_trained": 540000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5400, "training_iteration": 135, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-26-15", "timestamp": 1651065975, "time_this_iter_s": 22.360389232635498, "time_total_s": 5029.220822811127, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5029.220822811127, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 17.4258064516129, "ram_util_percent": 95.30322580645162}}
{"episode_reward_max": -8.599999999999996, "episode_reward_min": -139.1999999999998, "episode_reward_mean": -38.35300000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.499999999999998, -38.40000000000001, -37.700000000000045, -31.899999999999956, -32.90000000000001, -50.400000000000055, -18.70000000000001, -42.00000000000006, -33.800000000000004, -21.00000000000005, -17.19999999999999, -27.60000000000006, -52.000000000000064, -30.00000000000004, -28.70000000000001, -40.300000000000075, -41.399999999999984, -39.80000000000002, -37.10000000000006, -17.199999999999985, -8.599999999999996, -36.40000000000005, -55.500000000000085, -52.700000000000045, -41.50000000000002, -39.599999999999994, -29.800000000000008, -43.8, -24.700000000000003, -34.300000000000004, -50.700000000000095, -34.100000000000044, -11.599999999999998, -9.799999999999999, -39.90000000000001, -109.29999999999977, -16.199999999999996, -51.40000000000005, -35.4, -90.49999999999989, -39.7, -24.29999999999998, -52.10000000000005, -64.20000000000006, -35.700000000000045, -108.6999999999998, -58.2, -38.400000000000006, -35.5, -11.499999999999998, -36.60000000000005, -15.499999999999998, -29.4, -16.099999999999987, -52.300000000000054, -55.400000000000006, -34.40000000000003, -27.0, -28.90000000000004, -13.599999999999998, -34.999999999999986, -41.20000000000004, -36.50000000000003, -47.80000000000008, -139.1999999999998, -47.400000000000055, -51.50000000000006, -22.800000000000004, -46.70000000000003, -32.8, -13.899999999999991, -30.300000000000004, -21.799999999999997, -13.099999999999989, -49.000000000000036, -16.699999999999996, -38.90000000000006, -47.10000000000008, -35.900000000000055, -41.800000000000054, -18.3, -23.999999999999996, -43.20000000000006, -16.899999999999995, -28.700000000000006, -110.39999999999989, -12.699999999999996, -53.60000000000003, -46.200000000000045, -18.300000000000004, -49.50000000000005, -41.800000000000054, -50.00000000000008, -15.399999999999997, -52.80000000000004, -26.300000000000004, -51.30000000000004, -43.70000000000007, -33.400000000000006, -48.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.404698632901838, "mean_inference_ms": 1.1008807370873273, "mean_action_processing_ms": 0.559030932503438, "mean_env_wait_ms": 5.117843803574939, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 544000, "timesteps_this_iter": 0, "agent_timesteps_total": 544000, "timers": {"sample_time_ms": 23276.071, "sample_throughput": 171.85, "load_time_ms": 0.282, "load_throughput": 14190320.562, "learn_time_ms": 4544.079, "learn_throughput": 880.266}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.0657581468206415e-21, "cur_lr": 0.00010000000000000003, "total_loss": 1.3998436654201878, "policy_loss": -0.0036051833922023414, "vf_loss": 140.34488699513096, "vf_explained_var": 0.15624722261582652, "kl": 0.006353500643330064, "entropy": 0.18844786513576745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 544000, "num_agent_steps_sampled": 544000, "num_steps_trained": 544000, "num_agent_steps_trained": 544000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5440, "training_iteration": 136, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-26-35", "timestamp": 1651065995, "time_this_iter_s": 20.08018183708191, "time_total_s": 5049.301004648209, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5049.301004648209, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 11.533333333333333, "ram_util_percent": 95.1185185185185}}
{"episode_reward_max": -11.499999999999998, "episode_reward_min": -151.49999999999974, "episode_reward_mean": -39.28500000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.7, -24.29999999999998, -52.10000000000005, -64.20000000000006, -35.700000000000045, -108.6999999999998, -58.2, -38.400000000000006, -35.5, -11.499999999999998, -36.60000000000005, -15.499999999999998, -29.4, -16.099999999999987, -52.300000000000054, -55.400000000000006, -34.40000000000003, -27.0, -28.90000000000004, -13.599999999999998, -34.999999999999986, -41.20000000000004, -36.50000000000003, -47.80000000000008, -139.1999999999998, -47.400000000000055, -51.50000000000006, -22.800000000000004, -46.70000000000003, -32.8, -13.899999999999991, -30.300000000000004, -21.799999999999997, -13.099999999999989, -49.000000000000036, -16.699999999999996, -38.90000000000006, -47.10000000000008, -35.900000000000055, -41.800000000000054, -18.3, -23.999999999999996, -43.20000000000006, -16.899999999999995, -28.700000000000006, -110.39999999999989, -12.699999999999996, -53.60000000000003, -46.200000000000045, -18.300000000000004, -49.50000000000005, -41.800000000000054, -50.00000000000008, -15.399999999999997, -52.80000000000004, -26.300000000000004, -51.30000000000004, -43.70000000000007, -33.400000000000006, -48.5, -35.8, -32.400000000000006, -38.70000000000002, -63.20000000000006, -31.400000000000002, -35.20000000000005, -14.799999999999997, -29.500000000000004, -19.099999999999998, -15.599999999999984, -151.49999999999974, -17.699999999999996, -32.70000000000002, -52.30000000000006, -48.10000000000003, -52.500000000000036, -52.50000000000003, -25.80000000000001, -35.4, -42.10000000000006, -38.60000000000001, -40.90000000000008, -27.1, -34.00000000000001, -23.400000000000006, -49.7, -17.299999999999994, -37.8, -31.700000000000006, -37.20000000000002, -42.600000000000044, -26.600000000000005, -18.19999999999999, -33.10000000000001, -12.699999999999994, -50.100000000000016, -51.400000000000034, -24.400000000000006, -82.09999999999995, -51.40000000000008], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3989299291992925, "mean_inference_ms": 1.0975696790298286, "mean_action_processing_ms": 0.5551385701025302, "mean_env_wait_ms": 5.1010698268226, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 548000, "timesteps_this_iter": 0, "agent_timesteps_total": 548000, "timers": {"sample_time_ms": 22967.227, "sample_throughput": 174.161, "load_time_ms": 0.275, "load_throughput": 14524470.609, "learn_time_ms": 4524.501, "learn_throughput": 884.075}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.0657581468206415e-21, "cur_lr": 0.00010000000000000003, "total_loss": 1.15595270627008, "policy_loss": -0.004051251813108402, "vf_loss": 116.00039800725958, "vf_explained_var": 0.1271389715774085, "kl": 0.004512610382604217, "entropy": 0.1875108776854411, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 548000, "num_agent_steps_sampled": 548000, "num_steps_trained": 548000, "num_agent_steps_trained": 548000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5480, "training_iteration": 137, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-26-56", "timestamp": 1651066016, "time_this_iter_s": 20.846393823623657, "time_total_s": 5070.147398471832, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5070.147398471832, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 15.23793103448276, "ram_util_percent": 95.21379310344827}}
{"episode_reward_max": -8.399999999999999, "episode_reward_min": -151.49999999999974, "episode_reward_mean": -37.98900000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.3, -23.999999999999996, -43.20000000000006, -16.899999999999995, -28.700000000000006, -110.39999999999989, -12.699999999999996, -53.60000000000003, -46.200000000000045, -18.300000000000004, -49.50000000000005, -41.800000000000054, -50.00000000000008, -15.399999999999997, -52.80000000000004, -26.300000000000004, -51.30000000000004, -43.70000000000007, -33.400000000000006, -48.5, -35.8, -32.400000000000006, -38.70000000000002, -63.20000000000006, -31.400000000000002, -35.20000000000005, -14.799999999999997, -29.500000000000004, -19.099999999999998, -15.599999999999984, -151.49999999999974, -17.699999999999996, -32.70000000000002, -52.30000000000006, -48.10000000000003, -52.500000000000036, -52.50000000000003, -25.80000000000001, -35.4, -42.10000000000006, -38.60000000000001, -40.90000000000008, -27.1, -34.00000000000001, -23.400000000000006, -49.7, -17.299999999999994, -37.8, -31.700000000000006, -37.20000000000002, -42.600000000000044, -26.600000000000005, -18.19999999999999, -33.10000000000001, -12.699999999999994, -50.100000000000016, -51.400000000000034, -24.400000000000006, -82.09999999999995, -51.40000000000008, -11.699999999999998, -25.300000000000004, -51.000000000000036, -18.099999999999994, -30.10000000000001, -25.000000000000007, -40.00000000000005, -30.1, -29.800000000000008, -31.900000000000002, -52.40000000000008, -27.400000000000055, -48.00000000000008, -23.900000000000006, -24.000000000000007, -103.7999999999999, -26.900000000000027, -8.399999999999999, -16.199999999999992, -37.40000000000007, -13.899999999999999, -35.999999999999964, -30.800000000000008, -52.60000000000004, -29.499999999999996, -22.800000000000004, -52.50000000000004, -33.40000000000007, -50.700000000000045, -14.699999999999994, -51.70000000000006, -32.60000000000001, -17.399999999999984, -89.7999999999999, -26.000000000000004, -52.00000000000002, -56.900000000000034, -49.40000000000003, -53.200000000000045, -30.000000000000014], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3930747417159102, "mean_inference_ms": 1.0945309972224093, "mean_action_processing_ms": 0.551308083717971, "mean_env_wait_ms": 5.08507265861228, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 552000, "timesteps_this_iter": 0, "agent_timesteps_total": 552000, "timers": {"sample_time_ms": 22891.317, "sample_throughput": 174.739, "load_time_ms": 0.275, "load_throughput": 14533277.893, "learn_time_ms": 4457.851, "learn_throughput": 897.293}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.0328790734103207e-21, "cur_lr": 0.00010000000000000003, "total_loss": 0.9701181655341599, "policy_loss": 0.002047862664806426, "vf_loss": 96.80703270614788, "vf_explained_var": 0.05704818899913501, "kl": 0.0031025809064101906, "entropy": 0.1572831267388337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 552000, "num_agent_steps_sampled": 552000, "num_steps_trained": 552000, "num_agent_steps_trained": 552000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5520, "training_iteration": 138, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-27-19", "timestamp": 1651066039, "time_this_iter_s": 22.341517210006714, "time_total_s": 5092.488915681839, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5092.488915681839, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 17.136666666666667, "ram_util_percent": 95.21999999999998}}
{"episode_reward_max": -8.399999999999999, "episode_reward_min": -108.89999999999989, "episode_reward_mean": -36.60100000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.60000000000001, -40.90000000000008, -27.1, -34.00000000000001, -23.400000000000006, -49.7, -17.299999999999994, -37.8, -31.700000000000006, -37.20000000000002, -42.600000000000044, -26.600000000000005, -18.19999999999999, -33.10000000000001, -12.699999999999994, -50.100000000000016, -51.400000000000034, -24.400000000000006, -82.09999999999995, -51.40000000000008, -11.699999999999998, -25.300000000000004, -51.000000000000036, -18.099999999999994, -30.10000000000001, -25.000000000000007, -40.00000000000005, -30.1, -29.800000000000008, -31.900000000000002, -52.40000000000008, -27.400000000000055, -48.00000000000008, -23.900000000000006, -24.000000000000007, -103.7999999999999, -26.900000000000027, -8.399999999999999, -16.199999999999992, -37.40000000000007, -13.899999999999999, -35.999999999999964, -30.800000000000008, -52.60000000000004, -29.499999999999996, -22.800000000000004, -52.50000000000004, -33.40000000000007, -50.700000000000045, -14.699999999999994, -51.70000000000006, -32.60000000000001, -17.399999999999984, -89.7999999999999, -26.000000000000004, -52.00000000000002, -56.900000000000034, -49.40000000000003, -53.200000000000045, -30.000000000000014, -28.800000000000043, -29.700000000000003, -18.299999999999997, -14.899999999999995, -48.00000000000004, -29.000000000000007, -49.00000000000004, -38.000000000000036, -18.3, -41.70000000000005, -13.999999999999984, -34.50000000000004, -18.599999999999994, -68.59999999999997, -14.399999999999999, -13.19999999999999, -41.600000000000044, -12.199999999999992, -108.89999999999989, -48.600000000000065, -45.90000000000008, -36.100000000000016, -52.10000000000001, -43.10000000000004, -88.50000000000006, -36.70000000000006, -27.1, -16.999999999999993, -31.299999999999994, -49.300000000000004, -49.200000000000045, -28.800000000000004, -15.399999999999986, -55.20000000000009, -73.89999999999996, -32.2, -15.799999999999988, -52.60000000000003, -17.29999999999999, -14.699999999999985], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3872840727730493, "mean_inference_ms": 1.092072001505531, "mean_action_processing_ms": 0.5475533720924699, "mean_env_wait_ms": 5.070692867263458, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 556000, "timesteps_this_iter": 0, "agent_timesteps_total": 556000, "timers": {"sample_time_ms": 22879.626, "sample_throughput": 174.828, "load_time_ms": 0.282, "load_throughput": 14197525.599, "learn_time_ms": 4462.869, "learn_throughput": 896.284}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0164395367051604e-21, "cur_lr": 0.00010000000000000003, "total_loss": 1.2013057662336837, "policy_loss": -0.0021889541728762527, "vf_loss": 120.3494748761577, "vf_explained_var": -0.06885449444094012, "kl": 0.007709575656608282, "entropy": 0.23380934801553527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 556000, "num_agent_steps_sampled": 556000, "num_steps_trained": 556000, "num_agent_steps_trained": 556000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5560, "training_iteration": 139, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-27-42", "timestamp": 1651066062, "time_this_iter_s": 23.42950701713562, "time_total_s": 5115.918422698975, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5115.918422698975, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 22.125, "ram_util_percent": 95.046875}}
{"episode_reward_max": -12.199999999999992, "episode_reward_min": -108.89999999999989, "episode_reward_mean": -35.35400000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.899999999999999, -35.999999999999964, -30.800000000000008, -52.60000000000004, -29.499999999999996, -22.800000000000004, -52.50000000000004, -33.40000000000007, -50.700000000000045, -14.699999999999994, -51.70000000000006, -32.60000000000001, -17.399999999999984, -89.7999999999999, -26.000000000000004, -52.00000000000002, -56.900000000000034, -49.40000000000003, -53.200000000000045, -30.000000000000014, -28.800000000000043, -29.700000000000003, -18.299999999999997, -14.899999999999995, -48.00000000000004, -29.000000000000007, -49.00000000000004, -38.000000000000036, -18.3, -41.70000000000005, -13.999999999999984, -34.50000000000004, -18.599999999999994, -68.59999999999997, -14.399999999999999, -13.19999999999999, -41.600000000000044, -12.199999999999992, -108.89999999999989, -48.600000000000065, -45.90000000000008, -36.100000000000016, -52.10000000000001, -43.10000000000004, -88.50000000000006, -36.70000000000006, -27.1, -16.999999999999993, -31.299999999999994, -49.300000000000004, -49.200000000000045, -28.800000000000004, -15.399999999999986, -55.20000000000009, -73.89999999999996, -32.2, -15.799999999999988, -52.60000000000003, -17.29999999999999, -14.699999999999985, -33.10000000000002, -97.59999999999994, -39.19999999999999, -16.69999999999998, -50.40000000000008, -40.00000000000003, -13.999999999999995, -19.900000000000013, -70.00000000000001, -17.70000000000001, -28.40000000000002, -29.000000000000032, -12.399999999999979, -53.70000000000004, -28.999999999999964, -43.0, -32.7, -51.700000000000045, -34.70000000000007, -35.10000000000001, -22.200000000000006, -13.899999999999991, -32.000000000000014, -36.2, -32.10000000000003, -16.199999999999992, -19.4, -20.500000000000036, -16.399999999999988, -31.800000000000054, -29.000000000000007, -33.10000000000005, -12.999999999999993, -33.5, -13.89999999999998, -35.90000000000006, -21.299999999999997, -52.600000000000044, -28.30000000000004, -17.399999999999984], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3817813561867809, "mean_inference_ms": 1.0899311495079345, "mean_action_processing_ms": 0.5438633607340267, "mean_env_wait_ms": 5.0568002304950745, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 560000, "timesteps_this_iter": 0, "agent_timesteps_total": 560000, "timers": {"sample_time_ms": 22035.004, "sample_throughput": 181.529, "load_time_ms": 0.281, "load_throughput": 14224006.783, "learn_time_ms": 4440.995, "learn_throughput": 900.699}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0164395367051604e-21, "cur_lr": 0.00010000000000000003, "total_loss": 0.6270044982187971, "policy_loss": -0.001475493545313516, "vf_loss": 62.848000392093454, "vf_explained_var": -0.0001320316586443173, "kl": 0.014638056557567232, "entropy": 0.2592364635508788, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 560000, "num_agent_steps_sampled": 560000, "num_steps_trained": 560000, "num_agent_steps_trained": 560000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5600, "training_iteration": 140, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-28-05", "timestamp": 1651066085, "time_this_iter_s": 22.90247106552124, "time_total_s": 5138.820893764496, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5138.820893764496, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 18.59032258064516, "ram_util_percent": 94.80967741935487}}
{"episode_reward_max": -10.999999999999996, "episode_reward_min": -97.59999999999994, "episode_reward_mean": -36.33500000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.90000000000008, -36.100000000000016, -52.10000000000001, -43.10000000000004, -88.50000000000006, -36.70000000000006, -27.1, -16.999999999999993, -31.299999999999994, -49.300000000000004, -49.200000000000045, -28.800000000000004, -15.399999999999986, -55.20000000000009, -73.89999999999996, -32.2, -15.799999999999988, -52.60000000000003, -17.29999999999999, -14.699999999999985, -33.10000000000002, -97.59999999999994, -39.19999999999999, -16.69999999999998, -50.40000000000008, -40.00000000000003, -13.999999999999995, -19.900000000000013, -70.00000000000001, -17.70000000000001, -28.40000000000002, -29.000000000000032, -12.399999999999979, -53.70000000000004, -28.999999999999964, -43.0, -32.7, -51.700000000000045, -34.70000000000007, -35.10000000000001, -22.200000000000006, -13.899999999999991, -32.000000000000014, -36.2, -32.10000000000003, -16.199999999999992, -19.4, -20.500000000000036, -16.399999999999988, -31.800000000000054, -29.000000000000007, -33.10000000000005, -12.999999999999993, -33.5, -13.89999999999998, -35.90000000000006, -21.299999999999997, -52.600000000000044, -28.30000000000004, -17.399999999999984, -80.89999999999998, -49.8000000000001, -33.6, -53.000000000000036, -19.599999999999998, -77.99999999999997, -28.000000000000018, -22.20000000000001, -34.100000000000065, -30.000000000000007, -49.60000000000003, -50.200000000000045, -32.4, -36.400000000000055, -44.70000000000008, -34.20000000000006, -53.80000000000004, -27.400000000000013, -37.900000000000055, -27.400000000000034, -41.2, -45.20000000000009, -22.800000000000043, -10.999999999999996, -53.400000000000055, -53.100000000000065, -42.90000000000003, -52.40000000000004, -23.100000000000012, -32.900000000000006, -26.90000000000001, -49.30000000000006, -52.60000000000005, -13.099999999999994, -12.599999999999998, -47.70000000000005, -30.30000000000002, -50.70000000000005, -47.500000000000085, -52.400000000000055], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.376749036759594, "mean_inference_ms": 1.0884774162502762, "mean_action_processing_ms": 0.5402545651797054, "mean_env_wait_ms": 5.044164633699164, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 564000, "timesteps_this_iter": 0, "agent_timesteps_total": 564000, "timers": {"sample_time_ms": 22244.927, "sample_throughput": 179.816, "load_time_ms": 0.286, "load_throughput": 14003185.043, "learn_time_ms": 4530.885, "learn_throughput": 882.83}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.0164395367051604e-21, "cur_lr": 0.00010000000000000003, "total_loss": 0.787321299447688, "policy_loss": 0.009699393574508929, "vf_loss": 77.76219261128415, "vf_explained_var": 0.07231146520183933, "kl": 0.0022931148289752953, "entropy": 0.10963019123651407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 564000, "num_agent_steps_sampled": 564000, "num_steps_trained": 564000, "num_agent_steps_trained": 564000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5640, "training_iteration": 141, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-28-32", "timestamp": 1651066112, "time_this_iter_s": 26.59781289100647, "time_total_s": 5165.418706655502, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5165.418706655502, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 31.735135135135135, "ram_util_percent": 93.53243243243242}}
{"episode_reward_max": -10.999999999999996, "episode_reward_min": -122.99999999999986, "episode_reward_mean": -37.326000000000015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.200000000000006, -13.899999999999991, -32.000000000000014, -36.2, -32.10000000000003, -16.199999999999992, -19.4, -20.500000000000036, -16.399999999999988, -31.800000000000054, -29.000000000000007, -33.10000000000005, -12.999999999999993, -33.5, -13.89999999999998, -35.90000000000006, -21.299999999999997, -52.600000000000044, -28.30000000000004, -17.399999999999984, -80.89999999999998, -49.8000000000001, -33.6, -53.000000000000036, -19.599999999999998, -77.99999999999997, -28.000000000000018, -22.20000000000001, -34.100000000000065, -30.000000000000007, -49.60000000000003, -50.200000000000045, -32.4, -36.400000000000055, -44.70000000000008, -34.20000000000006, -53.80000000000004, -27.400000000000013, -37.900000000000055, -27.400000000000034, -41.2, -45.20000000000009, -22.800000000000043, -10.999999999999996, -53.400000000000055, -53.100000000000065, -42.90000000000003, -52.40000000000004, -23.100000000000012, -32.900000000000006, -26.90000000000001, -49.30000000000006, -52.60000000000005, -13.099999999999994, -12.599999999999998, -47.70000000000005, -30.30000000000002, -50.70000000000005, -47.500000000000085, -52.400000000000055, -16.69999999999999, -21.400000000000002, -33.1, -51.00000000000001, -52.50000000000004, -45.80000000000004, -20.0, -48.00000000000007, -29.50000000000007, -39.2, -41.79999999999998, -50.800000000000026, -34.400000000000006, -27.00000000000002, -52.600000000000044, -15.099999999999996, -105.5999999999999, -26.499999999999993, -32.90000000000005, -51.90000000000004, -35.20000000000002, -36.60000000000001, -16.29999999999999, -113.49999999999989, -52.40000000000004, -14.899999999999993, -27.5, -39.000000000000014, -50.10000000000005, -122.99999999999986, -51.400000000000055, -51.900000000000034, -36.10000000000002, -16.099999999999994, -52.10000000000004, -31.1, -26.0, -22.200000000000024, -13.699999999999989, -24.700000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3717144982508431, "mean_inference_ms": 1.0869073365427946, "mean_action_processing_ms": 0.5366875996737701, "mean_env_wait_ms": 5.031314907629712, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 568000, "timesteps_this_iter": 0, "agent_timesteps_total": 568000, "timers": {"sample_time_ms": 22358.844, "sample_throughput": 178.9, "load_time_ms": 0.331, "load_throughput": 12087331.412, "learn_time_ms": 4508.712, "learn_throughput": 887.171}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.082197683525802e-22, "cur_lr": 0.00010000000000000003, "total_loss": 1.4519380402135393, "policy_loss": 0.0013388131174349015, "vf_loss": 145.0599248404144, "vf_explained_var": 0.061726018433929775, "kl": 0.0040607369723810564, "entropy": 0.14912549089790592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 568000, "num_agent_steps_sampled": 568000, "num_steps_trained": 568000, "num_agent_steps_trained": 568000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5680, "training_iteration": 142, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-28-54", "timestamp": 1651066134, "time_this_iter_s": 22.188626766204834, "time_total_s": 5187.607333421707, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5187.607333421707, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 23.62666666666667, "ram_util_percent": 93.8666666666667}}
{"episode_reward_max": -10.999999999999996, "episode_reward_min": -122.99999999999986, "episode_reward_mean": -36.59300000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.2, -45.20000000000009, -22.800000000000043, -10.999999999999996, -53.400000000000055, -53.100000000000065, -42.90000000000003, -52.40000000000004, -23.100000000000012, -32.900000000000006, -26.90000000000001, -49.30000000000006, -52.60000000000005, -13.099999999999994, -12.599999999999998, -47.70000000000005, -30.30000000000002, -50.70000000000005, -47.500000000000085, -52.400000000000055, -16.69999999999999, -21.400000000000002, -33.1, -51.00000000000001, -52.50000000000004, -45.80000000000004, -20.0, -48.00000000000007, -29.50000000000007, -39.2, -41.79999999999998, -50.800000000000026, -34.400000000000006, -27.00000000000002, -52.600000000000044, -15.099999999999996, -105.5999999999999, -26.499999999999993, -32.90000000000005, -51.90000000000004, -35.20000000000002, -36.60000000000001, -16.29999999999999, -113.49999999999989, -52.40000000000004, -14.899999999999993, -27.5, -39.000000000000014, -50.10000000000005, -122.99999999999986, -51.400000000000055, -51.900000000000034, -36.10000000000002, -16.099999999999994, -52.10000000000004, -31.1, -26.0, -22.200000000000024, -13.699999999999989, -24.700000000000003, -19.80000000000003, -37.70000000000003, -54.000000000000064, -17.29999999999999, -50.70000000000004, -16.499999999999993, -28.800000000000008, -31.90000000000001, -39.400000000000006, -43.500000000000014, -32.70000000000004, -16.699999999999992, -13.79999999999999, -40.7, -28.90000000000001, -39.80000000000007, -15.499999999999995, -37.5, -56.899999999999935, -15.099999999999987, -51.10000000000005, -30.900000000000013, -52.30000000000005, -28.400000000000006, -64.70000000000006, -18.200000000000003, -14.399999999999993, -19.600000000000005, -39.90000000000001, -34.40000000000005, -15.99999999999999, -30.7, -53.50000000000005, -36.600000000000016, -20.3, -27.900000000000002, -22.800000000000026, -34.70000000000003, -18.19999999999999, -16.79999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.366484854267276, "mean_inference_ms": 1.084674887087995, "mean_action_processing_ms": 0.5331441347593185, "mean_env_wait_ms": 5.017303299714722, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 572000, "timesteps_this_iter": 0, "agent_timesteps_total": 572000, "timers": {"sample_time_ms": 22258.427, "sample_throughput": 179.707, "load_time_ms": 0.339, "load_throughput": 11815772.942, "learn_time_ms": 4487.745, "learn_throughput": 891.316}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.541098841762901e-22, "cur_lr": 0.00010000000000000003, "total_loss": 0.5298634901307323, "policy_loss": -0.0012534403252185031, "vf_loss": 53.11169426620648, "vf_explained_var": 0.012382235962857483, "kl": 0.006518534779013204, "entropy": 0.2282439544276204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 572000, "num_agent_steps_sampled": 572000, "num_steps_trained": 572000, "num_agent_steps_trained": 572000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5720, "training_iteration": 143, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-29-15", "timestamp": 1651066155, "time_this_iter_s": 20.68251919746399, "time_total_s": 5208.289852619171, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5208.289852619171, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 21.73928571428571, "ram_util_percent": 93.78928571428573}}
{"episode_reward_max": -11.799999999999995, "episode_reward_min": -122.99999999999986, "episode_reward_mean": -36.67000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.20000000000002, -36.60000000000001, -16.29999999999999, -113.49999999999989, -52.40000000000004, -14.899999999999993, -27.5, -39.000000000000014, -50.10000000000005, -122.99999999999986, -51.400000000000055, -51.900000000000034, -36.10000000000002, -16.099999999999994, -52.10000000000004, -31.1, -26.0, -22.200000000000024, -13.699999999999989, -24.700000000000003, -19.80000000000003, -37.70000000000003, -54.000000000000064, -17.29999999999999, -50.70000000000004, -16.499999999999993, -28.800000000000008, -31.90000000000001, -39.400000000000006, -43.500000000000014, -32.70000000000004, -16.699999999999992, -13.79999999999999, -40.7, -28.90000000000001, -39.80000000000007, -15.499999999999995, -37.5, -56.899999999999935, -15.099999999999987, -51.10000000000005, -30.900000000000013, -52.30000000000005, -28.400000000000006, -64.70000000000006, -18.200000000000003, -14.399999999999993, -19.600000000000005, -39.90000000000001, -34.40000000000005, -15.99999999999999, -30.7, -53.50000000000005, -36.600000000000016, -20.3, -27.900000000000002, -22.800000000000026, -34.70000000000003, -18.19999999999999, -16.79999999999999, -50.600000000000044, -46.00000000000007, -60.60000000000008, -24.300000000000004, -15.499999999999993, -38.60000000000006, -53.00000000000004, -18.8, -50.60000000000006, -44.5000000000001, -39.00000000000007, -37.00000000000008, -51.00000000000005, -52.300000000000026, -50.00000000000005, -43.90000000000003, -41.800000000000004, -41.000000000000064, -52.40000000000005, -50.90000000000007, -22.00000000000002, -16.299999999999997, -37.50000000000005, -69.39999999999998, -17.700000000000003, -35.20000000000003, -50.70000000000006, -52.50000000000003, -34.400000000000034, -41.90000000000007, -11.799999999999995, -34.50000000000004, -27.70000000000001, -29.700000000000003, -14.199999999999998, -17.39999999999999, -60.700000000000074, -35.60000000000006, -52.200000000000045, -41.40000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3611595961297218, "mean_inference_ms": 1.0817356512365532, "mean_action_processing_ms": 0.529624759520387, "mean_env_wait_ms": 5.002142388027869, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 576000, "timesteps_this_iter": 0, "agent_timesteps_total": 576000, "timers": {"sample_time_ms": 22209.822, "sample_throughput": 180.1, "load_time_ms": 0.391, "load_throughput": 10218794.007, "learn_time_ms": 4479.074, "learn_throughput": 893.042}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.541098841762901e-22, "cur_lr": 0.00010000000000000003, "total_loss": 0.7316737633779324, "policy_loss": -0.004129972562233928, "vf_loss": 73.58037488588722, "vf_explained_var": 0.1037029141379941, "kl": 0.006813104543916391, "entropy": 0.15667691447381532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 576000, "num_agent_steps_sampled": 576000, "num_steps_trained": 576000, "num_agent_steps_trained": 576000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5760, "training_iteration": 144, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-29-35", "timestamp": 1651066175, "time_this_iter_s": 20.36777400970459, "time_total_s": 5228.657626628876, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5228.657626628876, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 13.603571428571428, "ram_util_percent": 93.74642857142855}}
{"episode_reward_max": -10.199999999999998, "episode_reward_min": -80.39999999999998, "episode_reward_mean": -35.711000000000034, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.10000000000005, -30.900000000000013, -52.30000000000005, -28.400000000000006, -64.70000000000006, -18.200000000000003, -14.399999999999993, -19.600000000000005, -39.90000000000001, -34.40000000000005, -15.99999999999999, -30.7, -53.50000000000005, -36.600000000000016, -20.3, -27.900000000000002, -22.800000000000026, -34.70000000000003, -18.19999999999999, -16.79999999999999, -50.600000000000044, -46.00000000000007, -60.60000000000008, -24.300000000000004, -15.499999999999993, -38.60000000000006, -53.00000000000004, -18.8, -50.60000000000006, -44.5000000000001, -39.00000000000007, -37.00000000000008, -51.00000000000005, -52.300000000000026, -50.00000000000005, -43.90000000000003, -41.800000000000004, -41.000000000000064, -52.40000000000005, -50.90000000000007, -22.00000000000002, -16.299999999999997, -37.50000000000005, -69.39999999999998, -17.700000000000003, -35.20000000000003, -50.70000000000006, -52.50000000000003, -34.400000000000034, -41.90000000000007, -11.799999999999995, -34.50000000000004, -27.70000000000001, -29.700000000000003, -14.199999999999998, -17.39999999999999, -60.700000000000074, -35.60000000000006, -52.200000000000045, -41.40000000000006, -27.80000000000001, -51.40000000000006, -27.6, -28.100000000000037, -48.600000000000044, -31.400000000000006, -47.50000000000004, -27.40000000000007, -21.500000000000007, -43.900000000000055, -13.499999999999995, -41.800000000000026, -51.80000000000003, -54.00000000000006, -43.00000000000001, -20.800000000000004, -37.1, -52.70000000000003, -22.300000000000004, -27.000000000000004, -28.90000000000003, -13.199999999999989, -30.000000000000046, -12.299999999999997, -13.099999999999998, -11.699999999999992, -18.899999999999984, -27.50000000000001, -16.599999999999994, -50.80000000000003, -48.90000000000004, -15.399999999999977, -10.199999999999998, -80.39999999999998, -47.80000000000004, -50.300000000000026, -52.300000000000026, -36.70000000000006, -17.500000000000014, -73.40000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3558380584458307, "mean_inference_ms": 1.0788862843247533, "mean_action_processing_ms": 0.5261602331572145, "mean_env_wait_ms": 4.987357673899056, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 580000, "timesteps_this_iter": 0, "agent_timesteps_total": 580000, "timers": {"sample_time_ms": 22105.365, "sample_throughput": 180.952, "load_time_ms": 0.876, "load_throughput": 4564111.102, "learn_time_ms": 4533.407, "learn_throughput": 882.339}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.541098841762901e-22, "cur_lr": 0.00010000000000000003, "total_loss": 0.7635584757565671, "policy_loss": -0.0050789814131955305, "vf_loss": 76.86374731166389, "vf_explained_var": -0.045830235429989395, "kl": 0.0050367407478137316, "entropy": 0.19654025896026764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 580000, "num_agent_steps_sampled": 580000, "num_steps_trained": 580000, "num_agent_steps_trained": 580000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5800, "training_iteration": 145, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-29-57", "timestamp": 1651066197, "time_this_iter_s": 21.95070791244507, "time_total_s": 5250.608334541321, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5250.608334541321, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 18.44333333333333, "ram_util_percent": 93.94999999999999}}
{"episode_reward_max": -10.199999999999998, "episode_reward_min": -138.2999999999998, "episode_reward_mean": -35.16200000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.00000000000002, -16.299999999999997, -37.50000000000005, -69.39999999999998, -17.700000000000003, -35.20000000000003, -50.70000000000006, -52.50000000000003, -34.400000000000034, -41.90000000000007, -11.799999999999995, -34.50000000000004, -27.70000000000001, -29.700000000000003, -14.199999999999998, -17.39999999999999, -60.700000000000074, -35.60000000000006, -52.200000000000045, -41.40000000000006, -27.80000000000001, -51.40000000000006, -27.6, -28.100000000000037, -48.600000000000044, -31.400000000000006, -47.50000000000004, -27.40000000000007, -21.500000000000007, -43.900000000000055, -13.499999999999995, -41.800000000000026, -51.80000000000003, -54.00000000000006, -43.00000000000001, -20.800000000000004, -37.1, -52.70000000000003, -22.300000000000004, -27.000000000000004, -28.90000000000003, -13.199999999999989, -30.000000000000046, -12.299999999999997, -13.099999999999998, -11.699999999999992, -18.899999999999984, -27.50000000000001, -16.599999999999994, -50.80000000000003, -48.90000000000004, -15.399999999999977, -10.199999999999998, -80.39999999999998, -47.80000000000004, -50.300000000000026, -52.300000000000026, -36.70000000000006, -17.500000000000014, -73.40000000000003, -50.70000000000004, -50.7, -53.00000000000004, -26.500000000000007, -27.00000000000004, -51.00000000000005, -35.1, -51.8000000000001, -53.100000000000044, -138.2999999999998, -17.8, -39.50000000000007, -19.400000000000013, -18.699999999999996, -34.40000000000001, -35.100000000000016, -35.60000000000003, -69.00000000000003, -28.900000000000016, -32.60000000000004, -30.700000000000003, -43.90000000000004, -12.799999999999999, -26.900000000000045, -50.500000000000064, -13.999999999999993, -17.29999999999999, -17.30000000000001, -17.699999999999996, -28.800000000000008, -44.80000000000006, -49.30000000000004, -13.899999999999999, -29.200000000000003, -17.299999999999997, -28.700000000000006, -41.5, -10.299999999999994, -21.5, -53.70000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3506274002408167, "mean_inference_ms": 1.0769690478522016, "mean_action_processing_ms": 0.5227680534017114, "mean_env_wait_ms": 4.974268215988751, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 584000, "timesteps_this_iter": 0, "agent_timesteps_total": 584000, "timers": {"sample_time_ms": 22553.905, "sample_throughput": 177.353, "load_time_ms": 0.878, "load_throughput": 4554076.004, "learn_time_ms": 4668.281, "learn_throughput": 856.846}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.541098841762901e-22, "cur_lr": 0.00010000000000000003, "total_loss": 1.1220304074546983, "policy_loss": 0.00458149178183928, "vf_loss": 111.74489378160045, "vf_explained_var": -0.02614596627091849, "kl": 0.004312562204251481, "entropy": 0.20506308192026712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 584000, "num_agent_steps_sampled": 584000, "num_steps_trained": 584000, "num_agent_steps_trained": 584000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5840, "training_iteration": 146, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-30-22", "timestamp": 1651066222, "time_this_iter_s": 25.360920190811157, "time_total_s": 5275.969254732132, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5275.969254732132, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 27.897058823529413, "ram_util_percent": 94.0029411764706}}
{"episode_reward_max": -10.199999999999998, "episode_reward_min": -138.2999999999998, "episode_reward_mean": -34.52900000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.90000000000003, -13.199999999999989, -30.000000000000046, -12.299999999999997, -13.099999999999998, -11.699999999999992, -18.899999999999984, -27.50000000000001, -16.599999999999994, -50.80000000000003, -48.90000000000004, -15.399999999999977, -10.199999999999998, -80.39999999999998, -47.80000000000004, -50.300000000000026, -52.300000000000026, -36.70000000000006, -17.500000000000014, -73.40000000000003, -50.70000000000004, -50.7, -53.00000000000004, -26.500000000000007, -27.00000000000004, -51.00000000000005, -35.1, -51.8000000000001, -53.100000000000044, -138.2999999999998, -17.8, -39.50000000000007, -19.400000000000013, -18.699999999999996, -34.40000000000001, -35.100000000000016, -35.60000000000003, -69.00000000000003, -28.900000000000016, -32.60000000000004, -30.700000000000003, -43.90000000000004, -12.799999999999999, -26.900000000000045, -50.500000000000064, -13.999999999999993, -17.29999999999999, -17.30000000000001, -17.699999999999996, -28.800000000000008, -44.80000000000006, -49.30000000000004, -13.899999999999999, -29.200000000000003, -17.299999999999997, -28.700000000000006, -41.5, -10.299999999999994, -21.5, -53.70000000000004, -37.70000000000003, -24.700000000000003, -36.10000000000004, -34.50000000000003, -13.699999999999982, -45.70000000000006, -33.80000000000004, -40.90000000000008, -51.10000000000004, -38.200000000000045, -50.100000000000065, -52.700000000000045, -11.899999999999991, -51.90000000000005, -28.4, -17.5, -51.00000000000006, -52.90000000000007, -70.2, -28.60000000000001, -12.999999999999998, -52.10000000000003, -14.999999999999998, -19.799999999999997, -53.30000000000005, -52.40000000000003, -48.80000000000008, -25.9, -20.000000000000007, -31.700000000000003, -34.1, -30.400000000000016, -17.199999999999996, -17.799999999999997, -13.899999999999999, -38.70000000000006, -18.5, -33.399999999999984, -14.699999999999998, -36.400000000000034], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3459529620797088, "mean_inference_ms": 1.075930785230649, "mean_action_processing_ms": 0.5194491440255171, "mean_env_wait_ms": 4.962791141211389, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 588000, "timesteps_this_iter": 0, "agent_timesteps_total": 588000, "timers": {"sample_time_ms": 23144.558, "sample_throughput": 172.827, "load_time_ms": 0.88, "load_throughput": 4546301.385, "learn_time_ms": 4673.449, "learn_throughput": 855.899}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2705494208814505e-22, "cur_lr": 0.00010000000000000003, "total_loss": 0.6260586312456277, "policy_loss": -0.004484770971260244, "vf_loss": 63.054341461837936, "vf_explained_var": 0.09700515885506907, "kl": 0.005650227761130694, "entropy": 0.16440369716234585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 588000, "num_agent_steps_sampled": 588000, "num_steps_trained": 588000, "num_agent_steps_trained": 588000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5880, "training_iteration": 147, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-30-48", "timestamp": 1651066248, "time_this_iter_s": 25.429967164993286, "time_total_s": 5301.399221897125, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5301.399221897125, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 31.2, "ram_util_percent": 93.94285714285714}}
{"episode_reward_max": -10.299999999999994, "episode_reward_min": -94.79999999999986, "episode_reward_mean": -34.539000000000016, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.700000000000003, -43.90000000000004, -12.799999999999999, -26.900000000000045, -50.500000000000064, -13.999999999999993, -17.29999999999999, -17.30000000000001, -17.699999999999996, -28.800000000000008, -44.80000000000006, -49.30000000000004, -13.899999999999999, -29.200000000000003, -17.299999999999997, -28.700000000000006, -41.5, -10.299999999999994, -21.5, -53.70000000000004, -37.70000000000003, -24.700000000000003, -36.10000000000004, -34.50000000000003, -13.699999999999982, -45.70000000000006, -33.80000000000004, -40.90000000000008, -51.10000000000004, -38.200000000000045, -50.100000000000065, -52.700000000000045, -11.899999999999991, -51.90000000000005, -28.4, -17.5, -51.00000000000006, -52.90000000000007, -70.2, -28.60000000000001, -12.999999999999998, -52.10000000000003, -14.999999999999998, -19.799999999999997, -53.30000000000005, -52.40000000000003, -48.80000000000008, -25.9, -20.000000000000007, -31.700000000000003, -34.1, -30.400000000000016, -17.199999999999996, -17.799999999999997, -13.899999999999999, -38.70000000000006, -18.5, -33.399999999999984, -14.699999999999998, -36.400000000000034, -46.90000000000007, -12.499999999999993, -50.20000000000006, -17.199999999999992, -15.599999999999994, -52.80000000000003, -49.30000000000004, -31.200000000000014, -43.10000000000005, -14.999999999999984, -20.000000000000004, -36.100000000000065, -37.30000000000005, -48.20000000000005, -44.500000000000014, -52.30000000000003, -51.000000000000036, -30.80000000000006, -50.10000000000007, -29.1, -29.4, -12.899999999999993, -52.100000000000065, -20.2, -53.100000000000044, -33.70000000000003, -29.800000000000004, -37.2, -52.200000000000074, -35.80000000000008, -17.899999999999995, -50.300000000000054, -44.10000000000008, -39.600000000000065, -94.79999999999986, -16.9, -48.90000000000005, -30.100000000000044, -40.700000000000045, -52.20000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3415379801497898, "mean_inference_ms": 1.0746262990906597, "mean_action_processing_ms": 0.5161669140377385, "mean_env_wait_ms": 4.951098606364906, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 592000, "timesteps_this_iter": 0, "agent_timesteps_total": 592000, "timers": {"sample_time_ms": 23143.685, "sample_throughput": 172.833, "load_time_ms": 0.881, "load_throughput": 4539167.23, "learn_time_ms": 4678.674, "learn_throughput": 854.943}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2705494208814505e-22, "cur_lr": 0.00010000000000000003, "total_loss": 0.6858709046116439, "policy_loss": 0.00675487953728886, "vf_loss": 67.91160348564065, "vf_explained_var": 0.10883683594324256, "kl": 0.0035585876118218044, "entropy": 0.21523697322725208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 592000, "num_agent_steps_sampled": 592000, "num_steps_trained": 592000, "num_agent_steps_trained": 592000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5920, "training_iteration": 148, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-31-10", "timestamp": 1651066270, "time_this_iter_s": 22.338449239730835, "time_total_s": 5323.737671136856, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5323.737671136856, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 23.253333333333334, "ram_util_percent": 93.94333333333334}}
{"episode_reward_max": -11.899999999999984, "episode_reward_min": -94.79999999999986, "episode_reward_mean": -34.13000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.999999999999998, -52.10000000000003, -14.999999999999998, -19.799999999999997, -53.30000000000005, -52.40000000000003, -48.80000000000008, -25.9, -20.000000000000007, -31.700000000000003, -34.1, -30.400000000000016, -17.199999999999996, -17.799999999999997, -13.899999999999999, -38.70000000000006, -18.5, -33.399999999999984, -14.699999999999998, -36.400000000000034, -46.90000000000007, -12.499999999999993, -50.20000000000006, -17.199999999999992, -15.599999999999994, -52.80000000000003, -49.30000000000004, -31.200000000000014, -43.10000000000005, -14.999999999999984, -20.000000000000004, -36.100000000000065, -37.30000000000005, -48.20000000000005, -44.500000000000014, -52.30000000000003, -51.000000000000036, -30.80000000000006, -50.10000000000007, -29.1, -29.4, -12.899999999999993, -52.100000000000065, -20.2, -53.100000000000044, -33.70000000000003, -29.800000000000004, -37.2, -52.200000000000074, -35.80000000000008, -17.899999999999995, -50.300000000000054, -44.10000000000008, -39.600000000000065, -94.79999999999986, -16.9, -48.90000000000005, -30.100000000000044, -40.700000000000045, -52.20000000000006, -11.899999999999984, -37.30000000000001, -13.299999999999988, -13.799999999999997, -52.20000000000005, -16.499999999999993, -39.300000000000054, -29.600000000000005, -15.999999999999998, -18.699999999999992, -38.600000000000065, -14.699999999999985, -41.2, -24.100000000000005, -17.099999999999998, -40.60000000000002, -41.00000000000007, -33.40000000000001, -45.80000000000005, -29.899999999999963, -34.2, -49.40000000000005, -27.6, -52.50000000000003, -53.000000000000036, -35.500000000000036, -52.40000000000004, -26.79999999999998, -28.800000000000026, -52.80000000000005, -18.900000000000006, -34.80000000000001, -39.90000000000005, -22.8, -50.700000000000045, -17.199999999999996, -40.10000000000004, -18.4, -30.000000000000025, -40.00000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3370364992503414, "mean_inference_ms": 1.0730310815803514, "mean_action_processing_ms": 0.5129183486354634, "mean_env_wait_ms": 4.938993199187891, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 596000, "timesteps_this_iter": 0, "agent_timesteps_total": 596000, "timers": {"sample_time_ms": 23159.359, "sample_throughput": 172.716, "load_time_ms": 0.89, "load_throughput": 4495502.68, "learn_time_ms": 4666.442, "learn_throughput": 857.184}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.352747104407252e-23, "cur_lr": 0.00010000000000000003, "total_loss": 0.537580041210818, "policy_loss": 0.0018442597540636217, "vf_loss": 53.573579312396305, "vf_explained_var": 0.12452924655329796, "kl": 0.005051285615916578, "entropy": 0.21278256555087866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 596000, "num_agent_steps_sampled": 596000, "num_steps_trained": 596000, "num_agent_steps_trained": 596000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 5960, "training_iteration": 149, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-31-34", "timestamp": 1651066294, "time_this_iter_s": 23.348146200180054, "time_total_s": 5347.085817337036, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5347.085817337036, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 18.256249999999998, "ram_util_percent": 93.884375}}
{"episode_reward_max": -8.599999999999996, "episode_reward_min": -94.79999999999986, "episode_reward_mean": -35.38400000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.4, -12.899999999999993, -52.100000000000065, -20.2, -53.100000000000044, -33.70000000000003, -29.800000000000004, -37.2, -52.200000000000074, -35.80000000000008, -17.899999999999995, -50.300000000000054, -44.10000000000008, -39.600000000000065, -94.79999999999986, -16.9, -48.90000000000005, -30.100000000000044, -40.700000000000045, -52.20000000000006, -11.899999999999984, -37.30000000000001, -13.299999999999988, -13.799999999999997, -52.20000000000005, -16.499999999999993, -39.300000000000054, -29.600000000000005, -15.999999999999998, -18.699999999999992, -38.600000000000065, -14.699999999999985, -41.2, -24.100000000000005, -17.099999999999998, -40.60000000000002, -41.00000000000007, -33.40000000000001, -45.80000000000005, -29.899999999999963, -34.2, -49.40000000000005, -27.6, -52.50000000000003, -53.000000000000036, -35.500000000000036, -52.40000000000004, -26.79999999999998, -28.800000000000026, -52.80000000000005, -18.900000000000006, -34.80000000000001, -39.90000000000005, -22.8, -50.700000000000045, -17.199999999999996, -40.10000000000004, -18.4, -30.000000000000025, -40.00000000000005, -51.40000000000004, -15.299999999999992, -31.000000000000025, -18.599999999999998, -49.50000000000003, -45.50000000000008, -35.699999999999996, -64.50000000000003, -8.599999999999996, -24.200000000000006, -52.70000000000006, -50.300000000000054, -17.8, -52.30000000000004, -52.10000000000002, -26.700000000000006, -29.600000000000005, -28.200000000000056, -37.7, -51.00000000000004, -33.10000000000003, -36.60000000000001, -11.299999999999983, -52.000000000000064, -29.300000000000008, -31.10000000000003, -50.30000000000004, -12.79999999999999, -15.599999999999998, -20.59999999999999, -36.80000000000002, -44.000000000000064, -17.5, -49.700000000000045, -51.700000000000045, -35.20000000000005, -36.600000000000016, -42.70000000000008, -30.1, -65.99999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3324044150157477, "mean_inference_ms": 1.0711940597533478, "mean_action_processing_ms": 0.5097030392587989, "mean_env_wait_ms": 4.926389663944588, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 600000, "timesteps_this_iter": 0, "agent_timesteps_total": 600000, "timers": {"sample_time_ms": 23096.313, "sample_throughput": 173.188, "load_time_ms": 0.89, "load_throughput": 4494900.469, "learn_time_ms": 4638.48, "learn_throughput": 862.351}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.352747104407252e-23, "cur_lr": 0.00010000000000000003, "total_loss": 0.698591360946997, "policy_loss": 0.0008225752421284235, "vf_loss": 69.7768805883264, "vf_explained_var": 0.06230776092057587, "kl": 0.004270192674899816, "entropy": 0.20451273686322635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 600000, "num_agent_steps_sampled": 600000, "num_steps_trained": 600000, "num_agent_steps_trained": 600000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6000, "training_iteration": 150, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-31-56", "timestamp": 1651066316, "time_this_iter_s": 22.111633777618408, "time_total_s": 5369.1974511146545, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5369.1974511146545, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 19.66, "ram_util_percent": 93.82666666666668}}
{"episode_reward_max": -8.599999999999996, "episode_reward_min": -278.90000000000015, "episode_reward_mean": -38.44300000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.2, -49.40000000000005, -27.6, -52.50000000000003, -53.000000000000036, -35.500000000000036, -52.40000000000004, -26.79999999999998, -28.800000000000026, -52.80000000000005, -18.900000000000006, -34.80000000000001, -39.90000000000005, -22.8, -50.700000000000045, -17.199999999999996, -40.10000000000004, -18.4, -30.000000000000025, -40.00000000000005, -51.40000000000004, -15.299999999999992, -31.000000000000025, -18.599999999999998, -49.50000000000003, -45.50000000000008, -35.699999999999996, -64.50000000000003, -8.599999999999996, -24.200000000000006, -52.70000000000006, -50.300000000000054, -17.8, -52.30000000000004, -52.10000000000002, -26.700000000000006, -29.600000000000005, -28.200000000000056, -37.7, -51.00000000000004, -33.10000000000003, -36.60000000000001, -11.299999999999983, -52.000000000000064, -29.300000000000008, -31.10000000000003, -50.30000000000004, -12.79999999999999, -15.599999999999998, -20.59999999999999, -36.80000000000002, -44.000000000000064, -17.5, -49.700000000000045, -51.700000000000045, -35.20000000000005, -36.600000000000016, -42.70000000000008, -30.1, -65.99999999999999, -76.20000000000009, -29.300000000000004, -43.900000000000006, -25.0, -17.9, -46.300000000000004, -33.000000000000014, -40.30000000000001, -30.19999999999996, -52.600000000000044, -29.200000000000053, -39.500000000000014, -15.499999999999993, -11.699999999999987, -25.500000000000007, -48.5, -9.599999999999993, -20.3, -32.300000000000004, -51.40000000000005, -17.1, -52.80000000000003, -36.60000000000003, -50.20000000000005, -47.90000000000005, -55.199999999999896, -278.90000000000015, -36.50000000000005, -59.20000000000009, -33.00000000000004, -35.4, -41.60000000000004, -16.59999999999999, -12.899999999999979, -52.20000000000008, -47.80000000000004, -44.800000000000075, -36.70000000000003, -25.1, -14.099999999999989], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3278071980169945, "mean_inference_ms": 1.0691552394432, "mean_action_processing_ms": 0.5065227362155595, "mean_env_wait_ms": 4.913652328154244, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 604000, "timesteps_this_iter": 0, "agent_timesteps_total": 604000, "timers": {"sample_time_ms": 22681.568, "sample_throughput": 176.355, "load_time_ms": 0.886, "load_throughput": 4514251.581, "learn_time_ms": 4561.016, "learn_throughput": 876.998}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.176373552203626e-23, "cur_lr": 0.00010000000000000003, "total_loss": 5.110251539611127, "policy_loss": -0.01494818988546569, "vf_loss": 512.5199901047573, "vf_explained_var": -0.023853968997155466, "kl": 0.012157437838134262, "entropy": 0.2447044075807176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 604000, "num_agent_steps_sampled": 604000, "num_steps_trained": 604000, "num_agent_steps_trained": 604000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6040, "training_iteration": 151, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-32-18", "timestamp": 1651066338, "time_this_iter_s": 21.950767278671265, "time_total_s": 5391.148218393326, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5391.148218393326, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 19.610344827586207, "ram_util_percent": 93.82758620689658}}
{"episode_reward_max": -7.2, "episode_reward_min": -278.90000000000015, "episode_reward_mean": -37.95400000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.10000000000003, -36.60000000000001, -11.299999999999983, -52.000000000000064, -29.300000000000008, -31.10000000000003, -50.30000000000004, -12.79999999999999, -15.599999999999998, -20.59999999999999, -36.80000000000002, -44.000000000000064, -17.5, -49.700000000000045, -51.700000000000045, -35.20000000000005, -36.600000000000016, -42.70000000000008, -30.1, -65.99999999999999, -76.20000000000009, -29.300000000000004, -43.900000000000006, -25.0, -17.9, -46.300000000000004, -33.000000000000014, -40.30000000000001, -30.19999999999996, -52.600000000000044, -29.200000000000053, -39.500000000000014, -15.499999999999993, -11.699999999999987, -25.500000000000007, -48.5, -9.599999999999993, -20.3, -32.300000000000004, -51.40000000000005, -17.1, -52.80000000000003, -36.60000000000003, -50.20000000000005, -47.90000000000005, -55.199999999999896, -278.90000000000015, -36.50000000000005, -59.20000000000009, -33.00000000000004, -35.4, -41.60000000000004, -16.59999999999999, -12.899999999999979, -52.20000000000008, -47.80000000000004, -44.800000000000075, -36.70000000000003, -25.1, -14.099999999999989, -34.20000000000006, -39.99999999999998, -45.40000000000002, -7.2, -13.799999999999986, -23.4, -38.90000000000005, -54.3, -72.80000000000001, -50.80000000000004, -53.200000000000045, -31.900000000000013, -28.30000000000001, -22.8, -48.7, -53.300000000000054, -19.1, -54.40000000000005, -44.6, -42.20000000000005, -51.40000000000004, -26.6, -27.10000000000001, -35.6, -16.29999999999999, -74.99999999999989, -43.90000000000005, -27.900000000000006, -31.4, -31.400000000000006, -32.900000000000006, -13.899999999999984, -50.20000000000006, -22.3, -17.9, -20.899999999999995, -13.699999999999996, -21.100000000000026, -48.700000000000074, -32.099999999999994], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.323238054014915, "mean_inference_ms": 1.0669993238031676, "mean_action_processing_ms": 0.5033803480423151, "mean_env_wait_ms": 4.901082144269721, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 608000, "timesteps_this_iter": 0, "agent_timesteps_total": 608000, "timers": {"sample_time_ms": 22640.487, "sample_throughput": 176.675, "load_time_ms": 0.83, "load_throughput": 4820485.002, "learn_time_ms": 4554.774, "learn_throughput": 878.2}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.176373552203626e-23, "cur_lr": 0.00010000000000000003, "total_loss": 0.7395043304903552, "policy_loss": -0.0020396202129201704, "vf_loss": 74.15439671957364, "vf_explained_var": 0.022114617786099834, "kl": 0.003666019765265976, "entropy": 0.2150185680001854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 608000, "num_agent_steps_sampled": 608000, "num_steps_trained": 608000, "num_agent_steps_trained": 608000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6080, "training_iteration": 152, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-32-40", "timestamp": 1651066360, "time_this_iter_s": 22.509695053100586, "time_total_s": 5413.657913446426, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5413.657913446426, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 21.49032258064516, "ram_util_percent": 93.81935483870971}}
{"episode_reward_max": -7.2, "episode_reward_min": -278.90000000000015, "episode_reward_mean": -37.69800000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.1, -52.80000000000003, -36.60000000000003, -50.20000000000005, -47.90000000000005, -55.199999999999896, -278.90000000000015, -36.50000000000005, -59.20000000000009, -33.00000000000004, -35.4, -41.60000000000004, -16.59999999999999, -12.899999999999979, -52.20000000000008, -47.80000000000004, -44.800000000000075, -36.70000000000003, -25.1, -14.099999999999989, -34.20000000000006, -39.99999999999998, -45.40000000000002, -7.2, -13.799999999999986, -23.4, -38.90000000000005, -54.3, -72.80000000000001, -50.80000000000004, -53.200000000000045, -31.900000000000013, -28.30000000000001, -22.8, -48.7, -53.300000000000054, -19.1, -54.40000000000005, -44.6, -42.20000000000005, -51.40000000000004, -26.6, -27.10000000000001, -35.6, -16.29999999999999, -74.99999999999989, -43.90000000000005, -27.900000000000006, -31.4, -31.400000000000006, -32.900000000000006, -13.899999999999984, -50.20000000000006, -22.3, -17.9, -20.899999999999995, -13.699999999999996, -21.100000000000026, -48.700000000000074, -32.099999999999994, -31.000000000000043, -14.699999999999996, -38.30000000000006, -38.30000000000004, -34.7, -51.70000000000005, -32.000000000000014, -52.60000000000003, -22.399999999999995, -32.800000000000004, -37.90000000000007, -154.99999999999974, -42.60000000000007, -29.5, -17.20000000000001, -16.79999999999999, -48.90000000000005, -49.90000000000004, -7.599999999999996, -22.500000000000014, -10.799999999999994, -23.500000000000004, -17.399999999999984, -50.80000000000005, -39.30000000000002, -77.69999999999999, -20.599999999999994, -23.20000000000001, -27.700000000000003, -10.699999999999994, -10.299999999999992, -20.79999999999996, -22.599999999999998, -17.2, -14.699999999999998, -39.20000000000002, -38.1, -10.29999999999999, -51.300000000000054, -53.00000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3189306349747587, "mean_inference_ms": 1.0653616072680754, "mean_action_processing_ms": 0.5002954936892561, "mean_env_wait_ms": 4.889752153263498, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 612000, "timesteps_this_iter": 0, "agent_timesteps_total": 612000, "timers": {"sample_time_ms": 23021.433, "sample_throughput": 173.751, "load_time_ms": 0.857, "load_throughput": 4665132.497, "learn_time_ms": 4774.636, "learn_throughput": 837.76}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.588186776101813e-23, "cur_lr": 0.00010000000000000003, "total_loss": 1.2085581880210527, "policy_loss": 0.00243754384798869, "vf_loss": 120.61206805936752, "vf_explained_var": -0.07601781493874006, "kl": 0.00827642715310927, "entropy": 0.3623948806921841, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 612000, "num_agent_steps_sampled": 612000, "num_steps_trained": 612000, "num_agent_steps_trained": 612000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6120, "training_iteration": 153, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-33-07", "timestamp": 1651066387, "time_this_iter_s": 26.742287158966064, "time_total_s": 5440.4002006053925, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5440.4002006053925, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 40.169444444444444, "ram_util_percent": 93.98611111111114}}
{"episode_reward_max": -7.599999999999996, "episode_reward_min": -154.99999999999974, "episode_reward_mean": -34.35700000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.40000000000004, -26.6, -27.10000000000001, -35.6, -16.29999999999999, -74.99999999999989, -43.90000000000005, -27.900000000000006, -31.4, -31.400000000000006, -32.900000000000006, -13.899999999999984, -50.20000000000006, -22.3, -17.9, -20.899999999999995, -13.699999999999996, -21.100000000000026, -48.700000000000074, -32.099999999999994, -31.000000000000043, -14.699999999999996, -38.30000000000006, -38.30000000000004, -34.7, -51.70000000000005, -32.000000000000014, -52.60000000000003, -22.399999999999995, -32.800000000000004, -37.90000000000007, -154.99999999999974, -42.60000000000007, -29.5, -17.20000000000001, -16.79999999999999, -48.90000000000005, -49.90000000000004, -7.599999999999996, -22.500000000000014, -10.799999999999994, -23.500000000000004, -17.399999999999984, -50.80000000000005, -39.30000000000002, -77.69999999999999, -20.599999999999994, -23.20000000000001, -27.700000000000003, -10.699999999999994, -10.299999999999992, -20.79999999999996, -22.599999999999998, -17.2, -14.699999999999998, -39.20000000000002, -38.1, -10.29999999999999, -51.300000000000054, -53.00000000000004, -51.40000000000004, -52.10000000000004, -20.299999999999997, -14.799999999999994, -34.300000000000026, -23.30000000000003, -40.800000000000054, -43.90000000000003, -50.10000000000005, -38.80000000000006, -37.2, -13.299999999999994, -52.50000000000005, -65.50000000000006, -19.099999999999987, -52.90000000000005, -32.00000000000004, -53.10000000000004, -49.50000000000003, -18.199999999999996, -48.50000000000005, -11.599999999999996, -16.19999999999998, -17.200000000000003, -32.49999999999998, -19.699999999999996, -51.80000000000003, -19.89999999999999, -24.900000000000006, -71.80000000000003, -30.500000000000004, -32.50000000000001, -47.200000000000074, -52.00000000000004, -35.3, -43.30000000000007, -52.000000000000085, -11.699999999999998, -21.89999999999999, -36.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3145909455705762, "mean_inference_ms": 1.0638942295674567, "mean_action_processing_ms": 0.49725643638808514, "mean_env_wait_ms": 4.879081170214005, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 616000, "timesteps_this_iter": 0, "agent_timesteps_total": 616000, "timers": {"sample_time_ms": 23480.482, "sample_throughput": 170.354, "load_time_ms": 0.795, "load_throughput": 5030649.475, "learn_time_ms": 4873.335, "learn_throughput": 820.793}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.588186776101813e-23, "cur_lr": 0.00010000000000000003, "total_loss": 0.7012768334623987, "policy_loss": -0.0025078748082441667, "vf_loss": 70.37847255788823, "vf_explained_var": -0.012364002837929674, "kl": 0.006974737183674611, "entropy": 0.2765298504567635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 616000, "num_agent_steps_sampled": 616000, "num_steps_trained": 616000, "num_agent_steps_trained": 616000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6160, "training_iteration": 154, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-33-31", "timestamp": 1651066411, "time_this_iter_s": 23.728410959243774, "time_total_s": 5464.128611564636, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5464.128611564636, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 16.009375, "ram_util_percent": 94.0}}
{"episode_reward_max": -7.599999999999999, "episode_reward_min": -77.69999999999999, "episode_reward_mean": -34.286000000000016, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.799999999999994, -23.500000000000004, -17.399999999999984, -50.80000000000005, -39.30000000000002, -77.69999999999999, -20.599999999999994, -23.20000000000001, -27.700000000000003, -10.699999999999994, -10.299999999999992, -20.79999999999996, -22.599999999999998, -17.2, -14.699999999999998, -39.20000000000002, -38.1, -10.29999999999999, -51.300000000000054, -53.00000000000004, -51.40000000000004, -52.10000000000004, -20.299999999999997, -14.799999999999994, -34.300000000000026, -23.30000000000003, -40.800000000000054, -43.90000000000003, -50.10000000000005, -38.80000000000006, -37.2, -13.299999999999994, -52.50000000000005, -65.50000000000006, -19.099999999999987, -52.90000000000005, -32.00000000000004, -53.10000000000004, -49.50000000000003, -18.199999999999996, -48.50000000000005, -11.599999999999996, -16.19999999999998, -17.200000000000003, -32.49999999999998, -19.699999999999996, -51.80000000000003, -19.89999999999999, -24.900000000000006, -71.80000000000003, -30.500000000000004, -32.50000000000001, -47.200000000000074, -52.00000000000004, -35.3, -43.30000000000007, -52.000000000000085, -11.699999999999998, -21.89999999999999, -36.2, -11.299999999999995, -27.400000000000006, -7.599999999999999, -16.299999999999994, -53.60000000000003, -30.400000000000016, -51.50000000000005, -35.00000000000004, -51.600000000000044, -50.900000000000055, -40.20000000000003, -38.800000000000004, -14.599999999999996, -27.500000000000043, -15.399999999999993, -17.099999999999998, -49.700000000000045, -48.30000000000006, -42.1, -17.999999999999993, -34.900000000000006, -50.10000000000009, -51.30000000000005, -53.80000000000004, -58.60000000000005, -38.7, -29.000000000000053, -30.900000000000002, -51.80000000000005, -52.70000000000004, -24.500000000000004, -27.700000000000024, -34.000000000000064, -9.999999999999993, -34.00000000000004, -41.20000000000002, -21.500000000000014, -50.1, -51.400000000000034, -16.099999999999994], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3102868465195536, "mean_inference_ms": 1.0620930715645498, "mean_action_processing_ms": 0.49424577491131416, "mean_env_wait_ms": 4.867961025303572, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 620000, "timesteps_this_iter": 0, "agent_timesteps_total": 620000, "timers": {"sample_time_ms": 23617.333, "sample_throughput": 169.367, "load_time_ms": 0.31, "load_throughput": 12889686.54, "learn_time_ms": 4845.155, "learn_throughput": 825.567}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.588186776101813e-23, "cur_lr": 0.00010000000000000003, "total_loss": 0.6191952875795304, "policy_loss": -0.00026468193679246853, "vf_loss": 61.945998111847906, "vf_explained_var": 0.09320587092830289, "kl": 0.006809036976978735, "entropy": 0.20501589771192422, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 620000, "num_agent_steps_sampled": 620000, "num_steps_trained": 620000, "num_agent_steps_trained": 620000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6200, "training_iteration": 155, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-33-53", "timestamp": 1651066433, "time_this_iter_s": 22.041807889938354, "time_total_s": 5486.170419454575, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5486.170419454575, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 24.779310344827582, "ram_util_percent": 93.96206896551725}}
{"episode_reward_max": -7.599999999999999, "episode_reward_min": -122.19999999999985, "episode_reward_mean": -35.35200000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.50000000000005, -11.599999999999996, -16.19999999999998, -17.200000000000003, -32.49999999999998, -19.699999999999996, -51.80000000000003, -19.89999999999999, -24.900000000000006, -71.80000000000003, -30.500000000000004, -32.50000000000001, -47.200000000000074, -52.00000000000004, -35.3, -43.30000000000007, -52.000000000000085, -11.699999999999998, -21.89999999999999, -36.2, -11.299999999999995, -27.400000000000006, -7.599999999999999, -16.299999999999994, -53.60000000000003, -30.400000000000016, -51.50000000000005, -35.00000000000004, -51.600000000000044, -50.900000000000055, -40.20000000000003, -38.800000000000004, -14.599999999999996, -27.500000000000043, -15.399999999999993, -17.099999999999998, -49.700000000000045, -48.30000000000006, -42.1, -17.999999999999993, -34.900000000000006, -50.10000000000009, -51.30000000000005, -53.80000000000004, -58.60000000000005, -38.7, -29.000000000000053, -30.900000000000002, -51.80000000000005, -52.70000000000004, -24.500000000000004, -27.700000000000024, -34.000000000000064, -9.999999999999993, -34.00000000000004, -41.20000000000002, -21.500000000000014, -50.1, -51.400000000000034, -16.099999999999994, -35.2, -35.599999999999994, -51.50000000000004, -20.100000000000012, -21.1, -14.699999999999994, -17.19999999999999, -52.700000000000045, -46.50000000000005, -36.70000000000005, -122.19999999999985, -24.60000000000001, -49.50000000000006, -29.60000000000001, -16.299999999999986, -37.100000000000016, -49.80000000000007, -49.10000000000004, -50.90000000000008, -28.20000000000001, -70.60000000000004, -34.0, -32.400000000000055, -48.60000000000009, -14.099999999999996, -10.899999999999991, -27.00000000000003, -11.199999999999996, -14.299999999999997, -29.600000000000012, -19.6, -53.60000000000004, -38.5, -52.40000000000005, -37.50000000000006, -24.000000000000004, -53.70000000000003, -15.299999999999985, -20.999999999999996, -52.00000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3058862603758945, "mean_inference_ms": 1.0599435103410304, "mean_action_processing_ms": 0.4912615351424708, "mean_env_wait_ms": 4.856163264575005, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 624000, "timesteps_this_iter": 0, "agent_timesteps_total": 624000, "timers": {"sample_time_ms": 23332.453, "sample_throughput": 171.435, "load_time_ms": 0.306, "load_throughput": 13088793.884, "learn_time_ms": 4755.709, "learn_throughput": 841.094}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.588186776101813e-23, "cur_lr": 0.00010000000000000003, "total_loss": 1.0241314844098142, "policy_loss": 0.0028824395064504875, "vf_loss": 102.12490645993141, "vf_explained_var": 0.0076217174530029295, "kl": 0.004383017362874976, "entropy": 0.2203131925555006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 624000, "num_agent_steps_sampled": 624000, "num_steps_trained": 624000, "num_agent_steps_trained": 624000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6240, "training_iteration": 156, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-34-15", "timestamp": 1651066455, "time_this_iter_s": 21.90823197364807, "time_total_s": 5508.078651428223, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5508.078651428223, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 17.283333333333335, "ram_util_percent": 93.99666666666667}}
{"episode_reward_max": -9.999999999999993, "episode_reward_min": -122.19999999999985, "episode_reward_mean": -34.22900000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.900000000000006, -50.10000000000009, -51.30000000000005, -53.80000000000004, -58.60000000000005, -38.7, -29.000000000000053, -30.900000000000002, -51.80000000000005, -52.70000000000004, -24.500000000000004, -27.700000000000024, -34.000000000000064, -9.999999999999993, -34.00000000000004, -41.20000000000002, -21.500000000000014, -50.1, -51.400000000000034, -16.099999999999994, -35.2, -35.599999999999994, -51.50000000000004, -20.100000000000012, -21.1, -14.699999999999994, -17.19999999999999, -52.700000000000045, -46.50000000000005, -36.70000000000005, -122.19999999999985, -24.60000000000001, -49.50000000000006, -29.60000000000001, -16.299999999999986, -37.100000000000016, -49.80000000000007, -49.10000000000004, -50.90000000000008, -28.20000000000001, -70.60000000000004, -34.0, -32.400000000000055, -48.60000000000009, -14.099999999999996, -10.899999999999991, -27.00000000000003, -11.199999999999996, -14.299999999999997, -29.600000000000012, -19.6, -53.60000000000004, -38.5, -52.40000000000005, -37.50000000000006, -24.000000000000004, -53.70000000000003, -15.299999999999985, -20.999999999999996, -52.00000000000003, -24.70000000000001, -11.499999999999993, -28.700000000000006, -46.50000000000006, -49.600000000000044, -12.499999999999993, -41.20000000000006, -50.90000000000005, -14.099999999999994, -11.499999999999998, -28.50000000000003, -51.20000000000003, -53.800000000000054, -50.40000000000005, -31.500000000000007, -70.60000000000004, -17.499999999999996, -49.600000000000044, -28.800000000000008, -18.799999999999997, -14.099999999999994, -11.799999999999983, -41.300000000000004, -17.5, -51.50000000000003, -12.699999999999998, -40.100000000000044, -14.299999999999997, -18.1, -33.999999999999986, -12.499999999999991, -15.099999999999994, -48.30000000000004, -21.100000000000016, -51.600000000000044, -51.30000000000004, -13.099999999999993, -10.999999999999998, -25.6, -14.79999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3014967087270286, "mean_inference_ms": 1.0577800096180405, "mean_action_processing_ms": 0.48831177748561855, "mean_env_wait_ms": 4.84425367048703, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 628000, "timesteps_this_iter": 0, "agent_timesteps_total": 628000, "timers": {"sample_time_ms": 22917.384, "sample_throughput": 174.54, "load_time_ms": 0.304, "load_throughput": 13176169.01, "learn_time_ms": 4732.406, "learn_throughput": 845.236}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.940933880509065e-24, "cur_lr": 0.00010000000000000003, "total_loss": 0.5070586748323553, "policy_loss": -3.2300061436109644e-05, "vf_loss": 50.709098628259476, "vf_explained_var": -0.005652635135958272, "kl": 0.005546949581586833, "entropy": 0.3328138913372181, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 628000, "num_agent_steps_sampled": 628000, "num_steps_trained": 628000, "num_agent_steps_trained": 628000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6280, "training_iteration": 157, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-34-37", "timestamp": 1651066477, "time_this_iter_s": 21.962734937667847, "time_total_s": 5530.0413863658905, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5530.0413863658905, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 36.058620689655164, "ram_util_percent": 94.03103448275863}}
{"episode_reward_max": -9.899999999999997, "episode_reward_min": -77.79999999999997, "episode_reward_mean": -32.74000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.60000000000004, -34.0, -32.400000000000055, -48.60000000000009, -14.099999999999996, -10.899999999999991, -27.00000000000003, -11.199999999999996, -14.299999999999997, -29.600000000000012, -19.6, -53.60000000000004, -38.5, -52.40000000000005, -37.50000000000006, -24.000000000000004, -53.70000000000003, -15.299999999999985, -20.999999999999996, -52.00000000000003, -24.70000000000001, -11.499999999999993, -28.700000000000006, -46.50000000000006, -49.600000000000044, -12.499999999999993, -41.20000000000006, -50.90000000000005, -14.099999999999994, -11.499999999999998, -28.50000000000003, -51.20000000000003, -53.800000000000054, -50.40000000000005, -31.500000000000007, -70.60000000000004, -17.499999999999996, -49.600000000000044, -28.800000000000008, -18.799999999999997, -14.099999999999994, -11.799999999999983, -41.300000000000004, -17.5, -51.50000000000003, -12.699999999999998, -40.100000000000044, -14.299999999999997, -18.1, -33.999999999999986, -12.499999999999991, -15.099999999999994, -48.30000000000004, -21.100000000000016, -51.600000000000044, -51.30000000000004, -13.099999999999993, -10.999999999999998, -25.6, -14.79999999999999, -59.30000000000008, -42.599999999999994, -51.80000000000003, -9.999999999999996, -15.199999999999998, -48.30000000000005, -42.300000000000026, -32.20000000000004, -21.5, -52.20000000000005, -13.499999999999995, -48.50000000000006, -35.10000000000004, -27.800000000000015, -38.90000000000006, -17.800000000000015, -52.50000000000003, -9.899999999999997, -18.9, -15.399999999999986, -23.500000000000046, -14.39999999999998, -34.500000000000064, -24.30000000000002, -29.600000000000023, -28.0, -51.30000000000004, -12.699999999999998, -11.499999999999998, -55.40000000000008, -35.30000000000001, -44.30000000000002, -53.50000000000004, -32.400000000000006, -51.300000000000054, -14.699999999999982, -77.79999999999997, -26.799999999999997, -77.0, -50.00000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.297093835869132, "mean_inference_ms": 1.0559280035295477, "mean_action_processing_ms": 0.485406340076325, "mean_env_wait_ms": 4.832638675474201, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 632000, "timesteps_this_iter": 0, "agent_timesteps_total": 632000, "timers": {"sample_time_ms": 22914.446, "sample_throughput": 174.562, "load_time_ms": 0.301, "load_throughput": 13288883.96, "learn_time_ms": 4727.987, "learn_throughput": 846.026}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.940933880509065e-24, "cur_lr": 0.00010000000000000003, "total_loss": 0.8070684043323791, "policy_loss": 0.005061194330694214, "vf_loss": 80.20072294255739, "vf_explained_var": 0.04714453463913292, "kl": 0.003935143167612924, "entropy": 0.17186368043804842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 632000, "num_agent_steps_sampled": 632000, "num_steps_trained": 632000, "num_agent_steps_trained": 632000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6320, "training_iteration": 158, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-34-59", "timestamp": 1651066499, "time_this_iter_s": 22.497906923294067, "time_total_s": 5552.539293289185, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5552.539293289185, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 35.07096774193548, "ram_util_percent": 94.15483870967745}}
{"episode_reward_max": -8.899999999999997, "episode_reward_min": -113.40000000000013, "episode_reward_mean": -35.52300000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.099999999999994, -11.799999999999983, -41.300000000000004, -17.5, -51.50000000000003, -12.699999999999998, -40.100000000000044, -14.299999999999997, -18.1, -33.999999999999986, -12.499999999999991, -15.099999999999994, -48.30000000000004, -21.100000000000016, -51.600000000000044, -51.30000000000004, -13.099999999999993, -10.999999999999998, -25.6, -14.79999999999999, -59.30000000000008, -42.599999999999994, -51.80000000000003, -9.999999999999996, -15.199999999999998, -48.30000000000005, -42.300000000000026, -32.20000000000004, -21.5, -52.20000000000005, -13.499999999999995, -48.50000000000006, -35.10000000000004, -27.800000000000015, -38.90000000000006, -17.800000000000015, -52.50000000000003, -9.899999999999997, -18.9, -15.399999999999986, -23.500000000000046, -14.39999999999998, -34.500000000000064, -24.30000000000002, -29.600000000000023, -28.0, -51.30000000000004, -12.699999999999998, -11.499999999999998, -55.40000000000008, -35.30000000000001, -44.30000000000002, -53.50000000000004, -32.400000000000006, -51.300000000000054, -14.699999999999982, -77.79999999999997, -26.799999999999997, -77.0, -50.00000000000004, -25.8, -46.800000000000054, -50.60000000000005, -16.999999999999986, -25.100000000000005, -112.69999999999987, -52.40000000000004, -53.000000000000036, -14.799999999999995, -50.400000000000034, -30.200000000000024, -13.499999999999979, -53.500000000000036, -40.90000000000006, -51.30000000000003, -25.900000000000006, -13.899999999999991, -39.30000000000001, -39.20000000000007, -30.00000000000002, -52.50000000000003, -30.200000000000003, -111.99999999999987, -18.200000000000003, -23.500000000000043, -34.00000000000003, -39.20000000000001, -51.30000000000005, -31.200000000000006, -78.6, -32.4, -42.7, -37.09999999999996, -28.200000000000003, -49.700000000000045, -113.40000000000013, -19.300000000000004, -8.899999999999997, -14.299999999999997, -27.50000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.29280300905923, "mean_inference_ms": 1.054286179895894, "mean_action_processing_ms": 0.4825464147346954, "mean_env_wait_ms": 4.821516678532722, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 636000, "timesteps_this_iter": 0, "agent_timesteps_total": 636000, "timers": {"sample_time_ms": 22866.19, "sample_throughput": 174.931, "load_time_ms": 0.285, "load_throughput": 14043036.746, "learn_time_ms": 4771.026, "learn_throughput": 838.394}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.970466940254533e-24, "cur_lr": 0.00010000000000000003, "total_loss": 1.7270327870791617, "policy_loss": 0.0033530186285935745, "vf_loss": 172.36798003412062, "vf_explained_var": -0.03977392822183588, "kl": 0.0032027436327367403, "entropy": 0.15545437184077318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 636000, "num_agent_steps_sampled": 636000, "num_steps_trained": 636000, "num_agent_steps_trained": 636000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6360, "training_iteration": 159, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-35-23", "timestamp": 1651066523, "time_this_iter_s": 23.36108422279358, "time_total_s": 5575.900377511978, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5575.900377511978, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 30.067741935483873, "ram_util_percent": 94.69032258064512}}
{"episode_reward_max": -8.899999999999997, "episode_reward_min": -113.40000000000013, "episode_reward_mean": -37.17800000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.500000000000046, -14.39999999999998, -34.500000000000064, -24.30000000000002, -29.600000000000023, -28.0, -51.30000000000004, -12.699999999999998, -11.499999999999998, -55.40000000000008, -35.30000000000001, -44.30000000000002, -53.50000000000004, -32.400000000000006, -51.300000000000054, -14.699999999999982, -77.79999999999997, -26.799999999999997, -77.0, -50.00000000000004, -25.8, -46.800000000000054, -50.60000000000005, -16.999999999999986, -25.100000000000005, -112.69999999999987, -52.40000000000004, -53.000000000000036, -14.799999999999995, -50.400000000000034, -30.200000000000024, -13.499999999999979, -53.500000000000036, -40.90000000000006, -51.30000000000003, -25.900000000000006, -13.899999999999991, -39.30000000000001, -39.20000000000007, -30.00000000000002, -52.50000000000003, -30.200000000000003, -111.99999999999987, -18.200000000000003, -23.500000000000043, -34.00000000000003, -39.20000000000001, -51.30000000000005, -31.200000000000006, -78.6, -32.4, -42.7, -37.09999999999996, -28.200000000000003, -49.700000000000045, -113.40000000000013, -19.300000000000004, -8.899999999999997, -14.299999999999997, -27.50000000000004, -23.0, -27.600000000000005, -18.19999999999999, -51.400000000000055, -15.59999999999999, -10.799999999999995, -12.7, -28.20000000000001, -14.599999999999984, -26.900000000000013, -15.599999999999984, -70.30000000000014, -23.100000000000026, -81.49999999999984, -38.20000000000007, -15.399999999999993, -22.099999999999998, -18.1, -12.599999999999993, -19.099999999999994, -28.5, -26.5, -31.800000000000047, -35.60000000000002, -13.29999999999999, -42.300000000000004, -23.6, -32.700000000000024, -53.70000000000003, -50.800000000000004, -52.30000000000005, -112.19999999999986, -28.200000000000024, -63.00000000000008, -14.099999999999987, -39.50000000000007, -43.60000000000004, -12.199999999999998, -41.400000000000055, -48.70000000000008], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2886069915322502, "mean_inference_ms": 1.0525772286781652, "mean_action_processing_ms": 0.47972014071719776, "mean_env_wait_ms": 4.810518957813781, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 640000, "timesteps_this_iter": 0, "agent_timesteps_total": 640000, "timers": {"sample_time_ms": 22914.775, "sample_throughput": 174.56, "load_time_ms": 0.284, "load_throughput": 14100870.735, "learn_time_ms": 4824.283, "learn_throughput": 829.139}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9852334701272663e-24, "cur_lr": 0.00010000000000000003, "total_loss": 1.1290772488274392, "policy_loss": 0.00012201661123864113, "vf_loss": 112.89552585847916, "vf_explained_var": -0.004376091752001035, "kl": 0.0049098999582221905, "entropy": 0.22124739611591462, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 640000, "num_agent_steps_sampled": 640000, "num_steps_trained": 640000, "num_agent_steps_trained": 640000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6400, "training_iteration": 160, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-35-45", "timestamp": 1651066545, "time_this_iter_s": 22.694150924682617, "time_total_s": 5598.594528436661, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5598.594528436661, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 20.860000000000003, "ram_util_percent": 94.74000000000001}}
{"episode_reward_max": -8.899999999999997, "episode_reward_min": -154.79999999999973, "episode_reward_mean": -36.676, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-52.50000000000003, -30.200000000000003, -111.99999999999987, -18.200000000000003, -23.500000000000043, -34.00000000000003, -39.20000000000001, -51.30000000000005, -31.200000000000006, -78.6, -32.4, -42.7, -37.09999999999996, -28.200000000000003, -49.700000000000045, -113.40000000000013, -19.300000000000004, -8.899999999999997, -14.299999999999997, -27.50000000000004, -23.0, -27.600000000000005, -18.19999999999999, -51.400000000000055, -15.59999999999999, -10.799999999999995, -12.7, -28.20000000000001, -14.599999999999984, -26.900000000000013, -15.599999999999984, -70.30000000000014, -23.100000000000026, -81.49999999999984, -38.20000000000007, -15.399999999999993, -22.099999999999998, -18.1, -12.599999999999993, -19.099999999999994, -28.5, -26.5, -31.800000000000047, -35.60000000000002, -13.29999999999999, -42.300000000000004, -23.6, -32.700000000000024, -53.70000000000003, -50.800000000000004, -52.30000000000005, -112.19999999999986, -28.200000000000024, -63.00000000000008, -14.099999999999987, -39.50000000000007, -43.60000000000004, -12.199999999999998, -41.400000000000055, -48.70000000000008, -49.70000000000005, -52.700000000000045, -14.699999999999996, -24.500000000000004, -21.0, -27.50000000000001, -13.199999999999985, -24.500000000000018, -43.60000000000001, -20.100000000000023, -33.1, -81.2, -23.700000000000028, -48.400000000000055, -13.999999999999991, -28.70000000000002, -39.00000000000006, -18.40000000000001, -25.800000000000004, -29.400000000000013, -154.79999999999973, -42.40000000000005, -50.600000000000044, -30.400000000000023, -51.10000000000006, -49.1, -81.60000000000001, -31.10000000000004, -44.600000000000044, -37.6, -14.799999999999995, -28.900000000000006, -35.099999999999994, -25.800000000000036, -34.00000000000001, -19.4, -16.199999999999996, -48.50000000000006, -29.700000000000006, -25.500000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2846709210576603, "mean_inference_ms": 1.051240803659218, "mean_action_processing_ms": 0.4769410633536957, "mean_env_wait_ms": 4.800518182592339, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 644000, "timesteps_this_iter": 0, "agent_timesteps_total": 644000, "timers": {"sample_time_ms": 23272.739, "sample_throughput": 171.875, "load_time_ms": 0.285, "load_throughput": 14037161.981, "learn_time_ms": 4886.371, "learn_throughput": 818.603}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.926167350636332e-25, "cur_lr": 0.00010000000000000003, "total_loss": 1.223594767905982, "policy_loss": 0.0012454487483507842, "vf_loss": 122.23493468376898, "vf_explained_var": -0.047381174948907666, "kl": 0.00520047498749615, "entropy": 0.24301814844691624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 644000, "num_agent_steps_sampled": 644000, "num_steps_trained": 644000, "num_agent_steps_trained": 644000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6440, "training_iteration": 161, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-36-11", "timestamp": 1651066571, "time_this_iter_s": 25.623610019683838, "time_total_s": 5624.218138456345, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5624.218138456345, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 31.423529411764708, "ram_util_percent": 95.08235294117647}}
{"episode_reward_max": -11.499999999999993, "episode_reward_min": -154.79999999999973, "episode_reward_mean": -35.40400000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.5, -26.5, -31.800000000000047, -35.60000000000002, -13.29999999999999, -42.300000000000004, -23.6, -32.700000000000024, -53.70000000000003, -50.800000000000004, -52.30000000000005, -112.19999999999986, -28.200000000000024, -63.00000000000008, -14.099999999999987, -39.50000000000007, -43.60000000000004, -12.199999999999998, -41.400000000000055, -48.70000000000008, -49.70000000000005, -52.700000000000045, -14.699999999999996, -24.500000000000004, -21.0, -27.50000000000001, -13.199999999999985, -24.500000000000018, -43.60000000000001, -20.100000000000023, -33.1, -81.2, -23.700000000000028, -48.400000000000055, -13.999999999999991, -28.70000000000002, -39.00000000000006, -18.40000000000001, -25.800000000000004, -29.400000000000013, -154.79999999999973, -42.40000000000005, -50.600000000000044, -30.400000000000023, -51.10000000000006, -49.1, -81.60000000000001, -31.10000000000004, -44.600000000000044, -37.6, -14.799999999999995, -28.900000000000006, -35.099999999999994, -25.800000000000036, -34.00000000000001, -19.4, -16.199999999999996, -48.50000000000006, -29.700000000000006, -25.500000000000007, -51.100000000000065, -35.50000000000003, -44.10000000000006, -14.39999999999999, -52.70000000000005, -47.8, -15.599999999999985, -50.10000000000004, -20.90000000000001, -20.1, -42.50000000000007, -40.50000000000002, -52.7000000000001, -29.499999999999968, -50.30000000000004, -52.60000000000003, -16.399999999999995, -15.599999999999987, -53.00000000000005, -21.90000000000001, -31.500000000000004, -13.499999999999993, -17.699999999999992, -19.70000000000002, -50.70000000000003, -34.4, -16.89999999999999, -43.80000000000005, -30.700000000000014, -24.10000000000001, -22.700000000000006, -21.699999999999996, -27.10000000000006, -27.400000000000006, -13.499999999999996, -47.400000000000055, -11.499999999999993, -35.199999999999996, -27.5, -17.700000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2808591256885293, "mean_inference_ms": 1.0504320556422106, "mean_action_processing_ms": 0.47420829971298906, "mean_env_wait_ms": 4.791357293653126, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 648000, "timesteps_this_iter": 0, "agent_timesteps_total": 648000, "timers": {"sample_time_ms": 23555.128, "sample_throughput": 169.814, "load_time_ms": 0.287, "load_throughput": 13944988.779, "learn_time_ms": 4906.574, "learn_throughput": 815.233}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.926167350636332e-25, "cur_lr": 0.00010000000000000003, "total_loss": 0.556486886072283, "policy_loss": 0.0006598030657617636, "vf_loss": 55.582709248860674, "vf_explained_var": -0.09091800316687554, "kl": 0.007300023019926291, "entropy": 0.30028399687400587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 648000, "num_agent_steps_sampled": 648000, "num_steps_trained": 648000, "num_agent_steps_trained": 648000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6480, "training_iteration": 162, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-36-36", "timestamp": 1651066596, "time_this_iter_s": 24.915380001068115, "time_total_s": 5649.133518457413, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5649.133518457413, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 35.91212121212121, "ram_util_percent": 95.42727272727272}}
{"episode_reward_max": -11.299999999999995, "episode_reward_min": -154.79999999999973, "episode_reward_mean": -34.491000000000014, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-154.79999999999973, -42.40000000000005, -50.600000000000044, -30.400000000000023, -51.10000000000006, -49.1, -81.60000000000001, -31.10000000000004, -44.600000000000044, -37.6, -14.799999999999995, -28.900000000000006, -35.099999999999994, -25.800000000000036, -34.00000000000001, -19.4, -16.199999999999996, -48.50000000000006, -29.700000000000006, -25.500000000000007, -51.100000000000065, -35.50000000000003, -44.10000000000006, -14.39999999999999, -52.70000000000005, -47.8, -15.599999999999985, -50.10000000000004, -20.90000000000001, -20.1, -42.50000000000007, -40.50000000000002, -52.7000000000001, -29.499999999999968, -50.30000000000004, -52.60000000000003, -16.399999999999995, -15.599999999999987, -53.00000000000005, -21.90000000000001, -31.500000000000004, -13.499999999999993, -17.699999999999992, -19.70000000000002, -50.70000000000003, -34.4, -16.89999999999999, -43.80000000000005, -30.700000000000014, -24.10000000000001, -22.700000000000006, -21.699999999999996, -27.10000000000006, -27.400000000000006, -13.499999999999996, -47.400000000000055, -11.499999999999993, -35.199999999999996, -27.5, -17.700000000000003, -42.60000000000001, -27.000000000000007, -15.599999999999987, -32.10000000000004, -45.60000000000005, -32.6, -48.300000000000054, -33.30000000000001, -22.200000000000028, -18.199999999999996, -38.30000000000005, -11.399999999999999, -28.299999999999997, -41.100000000000016, -51.10000000000004, -59.50000000000006, -23.10000000000001, -34.1, -47.200000000000074, -59.000000000000156, -48.7, -31.200000000000003, -35.600000000000016, -25.7, -11.299999999999995, -29.000000000000053, -12.0, -40.800000000000004, -39.00000000000005, -34.90000000000005, -51.00000000000006, -14.199999999999998, -11.299999999999999, -18.7, -52.10000000000005, -15.399999999999997, -40.20000000000004, -35.800000000000054, -31.700000000000003, -46.70000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2772073400569193, "mean_inference_ms": 1.0499342052938818, "mean_action_processing_ms": 0.47151521507205174, "mean_env_wait_ms": 4.7824153366422895, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 652000, "timesteps_this_iter": 0, "agent_timesteps_total": 652000, "timers": {"sample_time_ms": 23540.15, "sample_throughput": 169.922, "load_time_ms": 0.253, "load_throughput": 15803707.611, "learn_time_ms": 4773.224, "learn_throughput": 838.008}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.926167350636332e-25, "cur_lr": 0.00010000000000000003, "total_loss": 0.5451249861599057, "policy_loss": 0.0037385520795660634, "vf_loss": 54.13864468810379, "vf_explained_var": 0.11433192997850397, "kl": 0.006046838415484938, "entropy": 0.16628958337229266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 652000, "num_agent_steps_sampled": 652000, "num_steps_trained": 652000, "num_agent_steps_trained": 652000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6520, "training_iteration": 163, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-37-01", "timestamp": 1651066621, "time_this_iter_s": 25.069369792938232, "time_total_s": 5674.202888250351, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5674.202888250351, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 33.2764705882353, "ram_util_percent": 95.39411764705883}}
{"episode_reward_max": -11.099999999999994, "episode_reward_min": -79.8, "episode_reward_mean": -32.27900000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.500000000000004, -13.499999999999993, -17.699999999999992, -19.70000000000002, -50.70000000000003, -34.4, -16.89999999999999, -43.80000000000005, -30.700000000000014, -24.10000000000001, -22.700000000000006, -21.699999999999996, -27.10000000000006, -27.400000000000006, -13.499999999999996, -47.400000000000055, -11.499999999999993, -35.199999999999996, -27.5, -17.700000000000003, -42.60000000000001, -27.000000000000007, -15.599999999999987, -32.10000000000004, -45.60000000000005, -32.6, -48.300000000000054, -33.30000000000001, -22.200000000000028, -18.199999999999996, -38.30000000000005, -11.399999999999999, -28.299999999999997, -41.100000000000016, -51.10000000000004, -59.50000000000006, -23.10000000000001, -34.1, -47.200000000000074, -59.000000000000156, -48.7, -31.200000000000003, -35.600000000000016, -25.7, -11.299999999999995, -29.000000000000053, -12.0, -40.800000000000004, -39.00000000000005, -34.90000000000005, -51.00000000000006, -14.199999999999998, -11.299999999999999, -18.7, -52.10000000000005, -15.399999999999997, -40.20000000000004, -35.800000000000054, -31.700000000000003, -46.70000000000005, -45.70000000000007, -52.500000000000085, -33.00000000000003, -11.099999999999994, -79.8, -30.50000000000005, -24.800000000000004, -17.299999999999997, -25.200000000000053, -74.9, -26.500000000000007, -30.30000000000001, -16.799999999999997, -14.399999999999997, -41.30000000000008, -25.700000000000042, -51.10000000000003, -49.80000000000005, -13.999999999999995, -41.200000000000045, -16.699999999999996, -63.59999999999994, -14.199999999999992, -15.6, -17.0, -51.90000000000005, -55.19999999999989, -37.20000000000007, -50.10000000000005, -44.50000000000006, -42.400000000000006, -26.000000000000007, -14.699999999999989, -11.2, -31.700000000000024, -16.69999999999998, -18.7, -34.600000000000016, -52.40000000000005, -37.00000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2735289909894936, "mean_inference_ms": 1.0491341611271159, "mean_action_processing_ms": 0.46884530902049176, "mean_env_wait_ms": 4.7728176244516725, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 656000, "timesteps_this_iter": 0, "agent_timesteps_total": 656000, "timers": {"sample_time_ms": 23394.307, "sample_throughput": 170.982, "load_time_ms": 0.251, "load_throughput": 15913132.884, "learn_time_ms": 4694.019, "learn_throughput": 852.148}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.926167350636332e-25, "cur_lr": 0.00010000000000000003, "total_loss": 0.8274818275023692, "policy_loss": -0.000861719460977662, "vf_loss": 82.8343565469147, "vf_explained_var": -0.055878738049537906, "kl": 0.004185899398712833, "entropy": 0.20156538949363054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 656000, "num_agent_steps_sampled": 656000, "num_steps_trained": 656000, "num_agent_steps_trained": 656000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6560, "training_iteration": 164, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-37-24", "timestamp": 1651066644, "time_this_iter_s": 22.798696041107178, "time_total_s": 5697.001584291458, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5697.001584291458, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 27.753333333333334, "ram_util_percent": 95.31000000000003}}
{"episode_reward_max": -11.099999999999994, "episode_reward_min": -79.8, "episode_reward_mean": -35.066000000000024, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.7, -31.200000000000003, -35.600000000000016, -25.7, -11.299999999999995, -29.000000000000053, -12.0, -40.800000000000004, -39.00000000000005, -34.90000000000005, -51.00000000000006, -14.199999999999998, -11.299999999999999, -18.7, -52.10000000000005, -15.399999999999997, -40.20000000000004, -35.800000000000054, -31.700000000000003, -46.70000000000005, -45.70000000000007, -52.500000000000085, -33.00000000000003, -11.099999999999994, -79.8, -30.50000000000005, -24.800000000000004, -17.299999999999997, -25.200000000000053, -74.9, -26.500000000000007, -30.30000000000001, -16.799999999999997, -14.399999999999997, -41.30000000000008, -25.700000000000042, -51.10000000000003, -49.80000000000005, -13.999999999999995, -41.200000000000045, -16.699999999999996, -63.59999999999994, -14.199999999999992, -15.6, -17.0, -51.90000000000005, -55.19999999999989, -37.20000000000007, -50.10000000000005, -44.50000000000006, -42.400000000000006, -26.000000000000007, -14.699999999999989, -11.2, -31.700000000000024, -16.69999999999998, -18.7, -34.600000000000016, -52.40000000000005, -37.00000000000001, -79.5, -32.700000000000045, -51.00000000000005, -48.099999999999945, -18.199999999999996, -16.79999999999999, -38.3, -53.00000000000009, -42.30000000000007, -53.10000000000004, -43.3, -48.70000000000004, -12.999999999999995, -51.40000000000004, -58.00000000000008, -37.90000000000002, -53.100000000000065, -51.20000000000005, -53.200000000000045, -46.80000000000005, -30.499999999999947, -44.700000000000045, -19.500000000000007, -51.900000000000055, -16.29999999999999, -33.400000000000006, -26.799999999999997, -22.799999999999997, -23.300000000000004, -23.0, -15.299999999999988, -13.799999999999997, -13.899999999999993, -59.30000000000007, -41.1, -16.69999999999999, -51.10000000000004, -51.70000000000007, -51.20000000000006, -28.099999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2697852879356628, "mean_inference_ms": 1.0479342749247311, "mean_action_processing_ms": 0.4661987365696683, "mean_env_wait_ms": 4.762989897138445, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 660000, "timesteps_this_iter": 0, "agent_timesteps_total": 660000, "timers": {"sample_time_ms": 23416.872, "sample_throughput": 170.817, "load_time_ms": 0.263, "load_throughput": 15210531.278, "learn_time_ms": 4705.754, "learn_throughput": 850.023}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.963083675318166e-25, "cur_lr": 0.00010000000000000003, "total_loss": 0.7333386837445971, "policy_loss": 0.0009658309520893199, "vf_loss": 73.23728683943389, "vf_explained_var": -0.02532446845885246, "kl": 0.004352480406070049, "entropy": 0.19464992194346362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 660000, "num_agent_steps_sampled": 660000, "num_steps_trained": 660000, "num_agent_steps_trained": 660000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6600, "training_iteration": 165, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-37-47", "timestamp": 1651066667, "time_this_iter_s": 23.179764986038208, "time_total_s": 5720.181349277496, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5720.181349277496, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 27.212903225806453, "ram_util_percent": 95.31612903225805}}
{"episode_reward_max": -11.2, "episode_reward_min": -79.5, "episode_reward_mean": -34.984000000000016, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.699999999999996, -63.59999999999994, -14.199999999999992, -15.6, -17.0, -51.90000000000005, -55.19999999999989, -37.20000000000007, -50.10000000000005, -44.50000000000006, -42.400000000000006, -26.000000000000007, -14.699999999999989, -11.2, -31.700000000000024, -16.69999999999998, -18.7, -34.600000000000016, -52.40000000000005, -37.00000000000001, -79.5, -32.700000000000045, -51.00000000000005, -48.099999999999945, -18.199999999999996, -16.79999999999999, -38.3, -53.00000000000009, -42.30000000000007, -53.10000000000004, -43.3, -48.70000000000004, -12.999999999999995, -51.40000000000004, -58.00000000000008, -37.90000000000002, -53.100000000000065, -51.20000000000005, -53.200000000000045, -46.80000000000005, -30.499999999999947, -44.700000000000045, -19.500000000000007, -51.900000000000055, -16.29999999999999, -33.400000000000006, -26.799999999999997, -22.799999999999997, -23.300000000000004, -23.0, -15.299999999999988, -13.799999999999997, -13.899999999999993, -59.30000000000007, -41.1, -16.69999999999999, -51.10000000000004, -51.70000000000007, -51.20000000000006, -28.099999999999998, -50.90000000000007, -36.100000000000016, -14.499999999999998, -42.60000000000007, -53.50000000000003, -16.79999999999999, -26.700000000000006, -67.90000000000006, -51.80000000000003, -26.900000000000038, -42.30000000000006, -16.39999999999998, -51.50000000000005, -19.599999999999994, -26.700000000000003, -15.899999999999988, -39.000000000000064, -40.30000000000006, -23.0, -15.599999999999993, -27.7, -18.199999999999996, -13.899999999999999, -21.800000000000058, -32.7, -39.200000000000045, -77.00000000000006, -53.200000000000045, -34.00000000000004, -30.8, -35.40000000000005, -20.6, -11.299999999999997, -31.0, -53.00000000000001, -28.799999999999958, -32.7, -38.7, -24.00000000000003, -21.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2659925083846124, "mean_inference_ms": 1.046483598738798, "mean_action_processing_ms": 0.46357935188757615, "mean_env_wait_ms": 4.753189372345845, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 664000, "timesteps_this_iter": 0, "agent_timesteps_total": 664000, "timers": {"sample_time_ms": 23544.114, "sample_throughput": 169.894, "load_time_ms": 0.254, "load_throughput": 15773990.222, "learn_time_ms": 4697.455, "learn_throughput": 851.525}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.481541837659083e-25, "cur_lr": 0.00010000000000000003, "total_loss": 0.6848050267806136, "policy_loss": -0.00047102426028540055, "vf_loss": 68.52760648009598, "vf_explained_var": 0.14477159521913016, "kl": 0.003955013769024434, "entropy": 0.17984842435226486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 664000, "num_agent_steps_sampled": 664000, "num_steps_trained": 664000, "num_agent_steps_trained": 664000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6640, "training_iteration": 166, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-38-10", "timestamp": 1651066690, "time_this_iter_s": 22.941997051239014, "time_total_s": 5743.123346328735, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5743.123346328735, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 25.050000000000004, "ram_util_percent": 95.30937499999999}}
{"episode_reward_max": -11.299999999999997, "episode_reward_min": -138.3999999999998, "episode_reward_mean": -35.88400000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.499999999999947, -44.700000000000045, -19.500000000000007, -51.900000000000055, -16.29999999999999, -33.400000000000006, -26.799999999999997, -22.799999999999997, -23.300000000000004, -23.0, -15.299999999999988, -13.799999999999997, -13.899999999999993, -59.30000000000007, -41.1, -16.69999999999999, -51.10000000000004, -51.70000000000007, -51.20000000000006, -28.099999999999998, -50.90000000000007, -36.100000000000016, -14.499999999999998, -42.60000000000007, -53.50000000000003, -16.79999999999999, -26.700000000000006, -67.90000000000006, -51.80000000000003, -26.900000000000038, -42.30000000000006, -16.39999999999998, -51.50000000000005, -19.599999999999994, -26.700000000000003, -15.899999999999988, -39.000000000000064, -40.30000000000006, -23.0, -15.599999999999993, -27.7, -18.199999999999996, -13.899999999999999, -21.800000000000058, -32.7, -39.200000000000045, -77.00000000000006, -53.200000000000045, -34.00000000000004, -30.8, -35.40000000000005, -20.6, -11.299999999999997, -31.0, -53.00000000000001, -28.799999999999958, -32.7, -38.7, -24.00000000000003, -21.0, -53.80000000000003, -21.300000000000047, -19.30000000000001, -37.00000000000007, -48.100000000000065, -36.4, -54.40000000000005, -53.10000000000004, -31.099999999999998, -17.999999999999993, -138.3999999999998, -28.699999999999996, -51.300000000000004, -14.499999999999982, -36.100000000000016, -52.50000000000005, -16.599999999999998, -39.10000000000003, -28.600000000000023, -53.10000000000004, -39.80000000000006, -26.900000000000034, -38.00000000000007, -45.50000000000001, -42.10000000000007, -17.19999999999999, -50.60000000000004, -14.499999999999984, -19.900000000000006, -17.39999999999999, -51.900000000000055, -52.50000000000005, -67.19999999999996, -29.400000000000006, -52.600000000000065, -103.9999999999999, -12.999999999999996, -29.1, -51.900000000000034, -36.10000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2622183164140999, "mean_inference_ms": 1.0450069771517847, "mean_action_processing_ms": 0.4609907945401746, "mean_env_wait_ms": 4.743489385119002, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 668000, "timesteps_this_iter": 0, "agent_timesteps_total": 668000, "timers": {"sample_time_ms": 23621.097, "sample_throughput": 169.34, "load_time_ms": 0.262, "load_throughput": 15245084.961, "learn_time_ms": 4754.072, "learn_throughput": 841.384}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2407709188295415e-25, "cur_lr": 0.00010000000000000003, "total_loss": 1.3736675764984823, "policy_loss": 0.0038395998458708486, "vf_loss": 136.982800053012, "vf_explained_var": -0.01811287377470283, "kl": 0.00521497938999239, "entropy": 0.21029284238885407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 668000, "num_agent_steps_sampled": 668000, "num_steps_trained": 668000, "num_agent_steps_trained": 668000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6680, "training_iteration": 167, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-38-33", "timestamp": 1651066713, "time_this_iter_s": 23.36533522605896, "time_total_s": 5766.488681554794, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5766.488681554794, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 27.84375, "ram_util_percent": 95.29375}}
{"episode_reward_max": -11.299999999999997, "episode_reward_min": -138.3999999999998, "episode_reward_mean": -36.33600000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.7, -18.199999999999996, -13.899999999999999, -21.800000000000058, -32.7, -39.200000000000045, -77.00000000000006, -53.200000000000045, -34.00000000000004, -30.8, -35.40000000000005, -20.6, -11.299999999999997, -31.0, -53.00000000000001, -28.799999999999958, -32.7, -38.7, -24.00000000000003, -21.0, -53.80000000000003, -21.300000000000047, -19.30000000000001, -37.00000000000007, -48.100000000000065, -36.4, -54.40000000000005, -53.10000000000004, -31.099999999999998, -17.999999999999993, -138.3999999999998, -28.699999999999996, -51.300000000000004, -14.499999999999982, -36.100000000000016, -52.50000000000005, -16.599999999999998, -39.10000000000003, -28.600000000000023, -53.10000000000004, -39.80000000000006, -26.900000000000034, -38.00000000000007, -45.50000000000001, -42.10000000000007, -17.19999999999999, -50.60000000000004, -14.499999999999984, -19.900000000000006, -17.39999999999999, -51.900000000000055, -52.50000000000005, -67.19999999999996, -29.400000000000006, -52.600000000000065, -103.9999999999999, -12.999999999999996, -29.1, -51.900000000000034, -36.10000000000006, -50.500000000000036, -34.40000000000001, -35.20000000000001, -33.7, -37.20000000000004, -65.80000000000004, -13.399999999999997, -28.400000000000006, -31.800000000000008, -25.700000000000003, -14.499999999999986, -51.000000000000036, -49.10000000000004, -17.69999999999999, -46.199999999999946, -14.89999999999998, -27.900000000000027, -36.200000000000045, -51.00000000000005, -50.400000000000084, -30.200000000000003, -47.60000000000004, -39.99999999999992, -49.70000000000005, -27.900000000000002, -38.900000000000006, -30.200000000000003, -41.20000000000006, -52.70000000000005, -20.900000000000052, -13.599999999999996, -11.599999999999994, -14.899999999999991, -31.800000000000026, -32.00000000000001, -29.800000000000008, -51.30000000000002, -16.4, -14.799999999999985, -47.100000000000065], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2584330604617313, "mean_inference_ms": 1.0433689343419232, "mean_action_processing_ms": 0.45842660563382237, "mean_env_wait_ms": 4.733573597128826, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 672000, "timesteps_this_iter": 0, "agent_timesteps_total": 672000, "timers": {"sample_time_ms": 23630.26, "sample_throughput": 169.274, "load_time_ms": 0.312, "load_throughput": 12830541.45, "learn_time_ms": 4761.69, "learn_throughput": 840.038}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.2407709188295415e-25, "cur_lr": 0.00010000000000000003, "total_loss": 0.5387723352960361, "policy_loss": -0.004200138738479024, "vf_loss": 54.29724854192426, "vf_explained_var": 0.11400528300193048, "kl": 0.0030668768724272794, "entropy": 0.16956943771701746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 672000, "num_agent_steps_sampled": 672000, "num_steps_trained": 672000, "num_agent_steps_trained": 672000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6720, "training_iteration": 168, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-38-56", "timestamp": 1651066736, "time_this_iter_s": 22.09984588623047, "time_total_s": 5788.588527441025, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5788.588527441025, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 18.133333333333333, "ram_util_percent": 95.21999999999997}}
{"episode_reward_max": -11.599999999999994, "episode_reward_min": -1053.800000000001, "episode_reward_mean": -46.49700000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.80000000000006, -26.900000000000034, -38.00000000000007, -45.50000000000001, -42.10000000000007, -17.19999999999999, -50.60000000000004, -14.499999999999984, -19.900000000000006, -17.39999999999999, -51.900000000000055, -52.50000000000005, -67.19999999999996, -29.400000000000006, -52.600000000000065, -103.9999999999999, -12.999999999999996, -29.1, -51.900000000000034, -36.10000000000006, -50.500000000000036, -34.40000000000001, -35.20000000000001, -33.7, -37.20000000000004, -65.80000000000004, -13.399999999999997, -28.400000000000006, -31.800000000000008, -25.700000000000003, -14.499999999999986, -51.000000000000036, -49.10000000000004, -17.69999999999999, -46.199999999999946, -14.89999999999998, -27.900000000000027, -36.200000000000045, -51.00000000000005, -50.400000000000084, -30.200000000000003, -47.60000000000004, -39.99999999999992, -49.70000000000005, -27.900000000000002, -38.900000000000006, -30.200000000000003, -41.20000000000006, -52.70000000000005, -20.900000000000052, -13.599999999999996, -11.599999999999994, -14.899999999999991, -31.800000000000026, -32.00000000000001, -29.800000000000008, -51.30000000000002, -16.4, -14.799999999999985, -47.100000000000065, -18.5, -50.40000000000005, -52.80000000000003, -19.7, -41.10000000000005, -27.100000000000037, -57.50000000000005, -32.90000000000002, -23.10000000000001, -32.7, -16.599999999999987, -11.899999999999997, -39.00000000000004, -32.200000000000024, -27.5, -30.900000000000052, -23.0, -42.20000000000005, -31.100000000000048, -44.90000000000006, -39.100000000000065, -52.60000000000005, -38.60000000000001, -52.300000000000054, -28.90000000000005, -51.50000000000004, -52.80000000000003, -1053.800000000001, -28.3, -36.400000000000055, -51.00000000000005, -40.800000000000026, -40.70000000000003, -21.20000000000003, -27.10000000000001, -34.100000000000016, -12.699999999999998, -37.00000000000008, -56.80000000000009, -81.69999999999992], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2545317812887682, "mean_inference_ms": 1.041709823288403, "mean_action_processing_ms": 0.4558865143104858, "mean_env_wait_ms": 4.723282003939537, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 676000, "timesteps_this_iter": 0, "agent_timesteps_total": 676000, "timers": {"sample_time_ms": 23520.294, "sample_throughput": 170.066, "load_time_ms": 0.464, "load_throughput": 8620056.517, "learn_time_ms": 4734.885, "learn_throughput": 844.794}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.203854594147707e-26, "cur_lr": 0.00010000000000000003, "total_loss": 53.60205130522059, "policy_loss": -0.024821947929599592, "vf_loss": 5362.687475971509, "vf_explained_var": 0.19948435162985198, "kl": 0.01891280794707428, "entropy": 0.16056468322990783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 676000, "num_agent_steps_sampled": 676000, "num_steps_trained": 676000, "num_agent_steps_trained": 676000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6760, "training_iteration": 169, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-39-18", "timestamp": 1651066758, "time_this_iter_s": 21.97482705116272, "time_total_s": 5810.5633544921875, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5810.5633544921875, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 24.141379310344824, "ram_util_percent": 95.21724137931031}}
{"episode_reward_max": -11.599999999999994, "episode_reward_min": -1053.800000000001, "episode_reward_mean": -47.11800000000004, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.200000000000003, -47.60000000000004, -39.99999999999992, -49.70000000000005, -27.900000000000002, -38.900000000000006, -30.200000000000003, -41.20000000000006, -52.70000000000005, -20.900000000000052, -13.599999999999996, -11.599999999999994, -14.899999999999991, -31.800000000000026, -32.00000000000001, -29.800000000000008, -51.30000000000002, -16.4, -14.799999999999985, -47.100000000000065, -18.5, -50.40000000000005, -52.80000000000003, -19.7, -41.10000000000005, -27.100000000000037, -57.50000000000005, -32.90000000000002, -23.10000000000001, -32.7, -16.599999999999987, -11.899999999999997, -39.00000000000004, -32.200000000000024, -27.5, -30.900000000000052, -23.0, -42.20000000000005, -31.100000000000048, -44.90000000000006, -39.100000000000065, -52.60000000000005, -38.60000000000001, -52.300000000000054, -28.90000000000005, -51.50000000000004, -52.80000000000003, -1053.800000000001, -28.3, -36.400000000000055, -51.00000000000005, -40.800000000000026, -40.70000000000003, -21.20000000000003, -27.10000000000001, -34.100000000000016, -12.699999999999998, -37.00000000000008, -56.80000000000009, -81.69999999999992, -17.9, -19.200000000000024, -52.80000000000003, -53.80000000000006, -36.40000000000006, -29.199999999999985, -40.500000000000064, -18.19999999999999, -38.80000000000004, -53.30000000000004, -14.89999999999998, -28.700000000000003, -48.50000000000001, -52.900000000000034, -14.499999999999982, -67.50000000000004, -34.90000000000004, -22.200000000000042, -55.40000000000006, -35.899999999999984, -64.10000000000005, -117.19999999999987, -53.30000000000005, -34.80000000000004, -22.299999999999997, -29.500000000000004, -29.8, -56.40000000000006, -35.10000000000001, -51.00000000000005, -51.60000000000004, -16.799999999999983, -24.400000000000006, -76.69999999999999, -18.40000000000002, -15.89999999999999, -52.60000000000004, -36.100000000000044, -39.399999999999984, -15.799999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.25070837799123, "mean_inference_ms": 1.0401093731863102, "mean_action_processing_ms": 0.4533783726447087, "mean_env_wait_ms": 4.713219686487078, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 680000, "timesteps_this_iter": 0, "agent_timesteps_total": 680000, "timers": {"sample_time_ms": 23556.807, "sample_throughput": 169.802, "load_time_ms": 0.464, "load_throughput": 8613418.215, "learn_time_ms": 4685.191, "learn_throughput": 853.754}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.203854594147707e-26, "cur_lr": 0.00010000000000000003, "total_loss": 1.1510885761880507, "policy_loss": -0.00015080207057537571, "vf_loss": 115.12394063395838, "vf_explained_var": 0.06433775860776184, "kl": 0.003257506034844441, "entropy": 0.1800865637088415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 680000, "num_agent_steps_sampled": 680000, "num_steps_trained": 680000, "num_agent_steps_trained": 680000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6800, "training_iteration": 170, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-39-40", "timestamp": 1651066780, "time_this_iter_s": 22.800589084625244, "time_total_s": 5833.363943576813, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5833.363943576813, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 25.77741935483871, "ram_util_percent": 95.5032258064516}}
{"episode_reward_max": -11.099999999999985, "episode_reward_min": -1053.800000000001, "episode_reward_mean": -47.37600000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.100000000000065, -52.60000000000005, -38.60000000000001, -52.300000000000054, -28.90000000000005, -51.50000000000004, -52.80000000000003, -1053.800000000001, -28.3, -36.400000000000055, -51.00000000000005, -40.800000000000026, -40.70000000000003, -21.20000000000003, -27.10000000000001, -34.100000000000016, -12.699999999999998, -37.00000000000008, -56.80000000000009, -81.69999999999992, -17.9, -19.200000000000024, -52.80000000000003, -53.80000000000006, -36.40000000000006, -29.199999999999985, -40.500000000000064, -18.19999999999999, -38.80000000000004, -53.30000000000004, -14.89999999999998, -28.700000000000003, -48.50000000000001, -52.900000000000034, -14.499999999999982, -67.50000000000004, -34.90000000000004, -22.200000000000042, -55.40000000000006, -35.899999999999984, -64.10000000000005, -117.19999999999987, -53.30000000000005, -34.80000000000004, -22.299999999999997, -29.500000000000004, -29.8, -56.40000000000006, -35.10000000000001, -51.00000000000005, -51.60000000000004, -16.799999999999983, -24.400000000000006, -76.69999999999999, -18.40000000000002, -15.89999999999999, -52.60000000000004, -36.100000000000044, -39.399999999999984, -15.799999999999999, -36.100000000000044, -12.999999999999982, -11.699999999999996, -22.90000000000006, -34.00000000000005, -22.9, -11.999999999999993, -46.79999999999996, -13.09999999999998, -50.70000000000005, -23.400000000000027, -30.00000000000001, -35.99999999999998, -32.900000000000006, -52.400000000000034, -36.59999999999998, -46.90000000000008, -46.30000000000009, -19.59999999999999, -13.599999999999982, -12.299999999999983, -34.3, -54.100000000000044, -51.80000000000005, -52.00000000000005, -36.30000000000006, -18.000000000000007, -37.1, -29.9, -35.40000000000006, -13.999999999999988, -32.400000000000034, -68.40000000000002, -16.099999999999977, -44.300000000000054, -53.20000000000003, -11.099999999999985, -52.60000000000004, -14.899999999999988, -54.40000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.247148960220861, "mean_inference_ms": 1.0387019396066253, "mean_action_processing_ms": 0.45090785500238256, "mean_env_wait_ms": 4.703743086983186, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 684000, "timesteps_this_iter": 0, "agent_timesteps_total": 684000, "timers": {"sample_time_ms": 23345.674, "sample_throughput": 171.338, "load_time_ms": 0.521, "load_throughput": 7682227.208, "learn_time_ms": 4622.88, "learn_throughput": 865.261}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.1019272970738537e-26, "cur_lr": 0.00010000000000000003, "total_loss": 0.5279248005740584, "policy_loss": 0.0036576889024706937, "vf_loss": 52.426712538606374, "vf_explained_var": 0.04471096069582047, "kl": 0.007327337788283948, "entropy": 0.25371068282733844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 684000, "num_agent_steps_sampled": 684000, "num_steps_trained": 684000, "num_agent_steps_trained": 684000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6840, "training_iteration": 171, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-40-04", "timestamp": 1651066804, "time_this_iter_s": 23.384982109069824, "time_total_s": 5856.748925685883, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5856.748925685883, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 20.653125000000003, "ram_util_percent": 95.45625}}
{"episode_reward_max": -9.999999999999988, "episode_reward_min": -119.59999999999987, "episode_reward_mean": -34.03800000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.10000000000005, -117.19999999999987, -53.30000000000005, -34.80000000000004, -22.299999999999997, -29.500000000000004, -29.8, -56.40000000000006, -35.10000000000001, -51.00000000000005, -51.60000000000004, -16.799999999999983, -24.400000000000006, -76.69999999999999, -18.40000000000002, -15.89999999999999, -52.60000000000004, -36.100000000000044, -39.399999999999984, -15.799999999999999, -36.100000000000044, -12.999999999999982, -11.699999999999996, -22.90000000000006, -34.00000000000005, -22.9, -11.999999999999993, -46.79999999999996, -13.09999999999998, -50.70000000000005, -23.400000000000027, -30.00000000000001, -35.99999999999998, -32.900000000000006, -52.400000000000034, -36.59999999999998, -46.90000000000008, -46.30000000000009, -19.59999999999999, -13.599999999999982, -12.299999999999983, -34.3, -54.100000000000044, -51.80000000000005, -52.00000000000005, -36.30000000000006, -18.000000000000007, -37.1, -29.9, -35.40000000000006, -13.999999999999988, -32.400000000000034, -68.40000000000002, -16.099999999999977, -44.300000000000054, -53.20000000000003, -11.099999999999985, -52.60000000000004, -14.899999999999988, -54.40000000000004, -41.70000000000005, -27.500000000000004, -53.30000000000008, -52.900000000000034, -43.2, -32.4, -32.80000000000001, -15.19999999999998, -14.499999999999991, -52.200000000000024, -16.199999999999992, -40.700000000000024, -33.40000000000004, -32.00000000000001, -11.299999999999983, -119.59999999999987, -12.99999999999998, -16.399999999999984, -38.40000000000005, -9.999999999999988, -12.699999999999985, -36.40000000000006, -21.799999999999997, -14.99999999999998, -34.7, -37.900000000000034, -41.000000000000064, -51.100000000000065, -58.9999999999999, -13.499999999999977, -10.39999999999999, -10.09999999999999, -12.899999999999979, -16.399999999999984, -23.0, -13.099999999999985, -59.00000000000006, -25.40000000000003, -36.9, -12.099999999999984], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.243673204181903, "mean_inference_ms": 1.0372927414594273, "mean_action_processing_ms": 0.44846972031858073, "mean_env_wait_ms": 4.694461249383927, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 688000, "timesteps_this_iter": 0, "agent_timesteps_total": 688000, "timers": {"sample_time_ms": 23061.575, "sample_throughput": 173.449, "load_time_ms": 0.517, "load_throughput": 7737497.579, "learn_time_ms": 4597.366, "learn_throughput": 870.063}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.1019272970738537e-26, "cur_lr": 0.00010000000000000003, "total_loss": 0.8050412596433714, "policy_loss": -0.0006431629565814811, "vf_loss": 80.56844367570774, "vf_explained_var": -0.07759759503026162, "kl": 0.005262164583044276, "entropy": 0.33261258877433275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 688000, "num_agent_steps_sampled": 688000, "num_steps_trained": 688000, "num_agent_steps_trained": 688000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6880, "training_iteration": 172, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-40-26", "timestamp": 1651066826, "time_this_iter_s": 22.44708561897278, "time_total_s": 5879.196011304855, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5879.196011304855, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 15.58, "ram_util_percent": 95.39000000000003}}
{"episode_reward_max": -9.999999999999988, "episode_reward_min": -119.59999999999987, "episode_reward_mean": -33.674000000000014, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.299999999999983, -34.3, -54.100000000000044, -51.80000000000005, -52.00000000000005, -36.30000000000006, -18.000000000000007, -37.1, -29.9, -35.40000000000006, -13.999999999999988, -32.400000000000034, -68.40000000000002, -16.099999999999977, -44.300000000000054, -53.20000000000003, -11.099999999999985, -52.60000000000004, -14.899999999999988, -54.40000000000004, -41.70000000000005, -27.500000000000004, -53.30000000000008, -52.900000000000034, -43.2, -32.4, -32.80000000000001, -15.19999999999998, -14.499999999999991, -52.200000000000024, -16.199999999999992, -40.700000000000024, -33.40000000000004, -32.00000000000001, -11.299999999999983, -119.59999999999987, -12.99999999999998, -16.399999999999984, -38.40000000000005, -9.999999999999988, -12.699999999999985, -36.40000000000006, -21.799999999999997, -14.99999999999998, -34.7, -37.900000000000034, -41.000000000000064, -51.100000000000065, -58.9999999999999, -13.499999999999977, -10.39999999999999, -10.09999999999999, -12.899999999999979, -16.399999999999984, -23.0, -13.099999999999985, -59.00000000000006, -25.40000000000003, -36.9, -12.099999999999984, -38.70000000000006, -29.39999999999999, -47.20000000000007, -38.600000000000065, -15.399999999999983, -25.100000000000016, -36.50000000000004, -10.89999999999998, -38.50000000000004, -31.90000000000002, -45.2, -10.09999999999999, -15.89999999999998, -30.4, -51.80000000000006, -12.69999999999998, -52.100000000000065, -17.4, -38.599999999999994, -22.89999999999999, -14.799999999999981, -33.0, -62.000000000000036, -24.90000000000001, -50.30000000000005, -51.90000000000005, -53.50000000000005, -34.60000000000003, -52.900000000000034, -52.90000000000005, -68.90000000000002, -69.60000000000005, -13.799999999999985, -15.499999999999982, -15.699999999999978, -13.29999999999998, -27.400000000000006, -36.20000000000006, -43.200000000000045, -62.00000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2401520018831516, "mean_inference_ms": 1.0359032744544385, "mean_action_processing_ms": 0.4460600741108183, "mean_env_wait_ms": 4.685234598917882, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 692000, "timesteps_this_iter": 0, "agent_timesteps_total": 692000, "timers": {"sample_time_ms": 22877.268, "sample_throughput": 174.846, "load_time_ms": 0.57, "load_throughput": 7020636.9, "learn_time_ms": 4535.951, "learn_throughput": 881.844}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.1019272970738537e-26, "cur_lr": 0.00010000000000000003, "total_loss": 0.7991026186624602, "policy_loss": -0.00917969293371644, "vf_loss": 80.82823296618717, "vf_explained_var": -0.08502504973001378, "kl": 0.012755102350539036, "entropy": 0.28762169255404385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 692000, "num_agent_steps_sampled": 692000, "num_steps_trained": 692000, "num_agent_steps_trained": 692000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6920, "training_iteration": 173, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-40-49", "timestamp": 1651066849, "time_this_iter_s": 22.86269211769104, "time_total_s": 5902.058703422546, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5902.058703422546, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 17.70645161290323, "ram_util_percent": 95.37419354838714}}
{"episode_reward_max": -9.399999999999986, "episode_reward_min": -69.60000000000005, "episode_reward_mean": -32.14200000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.699999999999985, -36.40000000000006, -21.799999999999997, -14.99999999999998, -34.7, -37.900000000000034, -41.000000000000064, -51.100000000000065, -58.9999999999999, -13.499999999999977, -10.39999999999999, -10.09999999999999, -12.899999999999979, -16.399999999999984, -23.0, -13.099999999999985, -59.00000000000006, -25.40000000000003, -36.9, -12.099999999999984, -38.70000000000006, -29.39999999999999, -47.20000000000007, -38.600000000000065, -15.399999999999983, -25.100000000000016, -36.50000000000004, -10.89999999999998, -38.50000000000004, -31.90000000000002, -45.2, -10.09999999999999, -15.89999999999998, -30.4, -51.80000000000006, -12.69999999999998, -52.100000000000065, -17.4, -38.599999999999994, -22.89999999999999, -14.799999999999981, -33.0, -62.000000000000036, -24.90000000000001, -50.30000000000005, -51.90000000000005, -53.50000000000005, -34.60000000000003, -52.900000000000034, -52.90000000000005, -68.90000000000002, -69.60000000000005, -13.799999999999985, -15.499999999999982, -15.699999999999978, -13.29999999999998, -27.400000000000006, -36.20000000000006, -43.200000000000045, -62.00000000000007, -45.200000000000045, -49.00000000000004, -9.59999999999999, -20.900000000000038, -14.399999999999979, -52.70000000000003, -45.80000000000004, -53.70000000000004, -50.10000000000004, -10.899999999999993, -33.69999999999997, -9.499999999999986, -29.300000000000022, -52.40000000000004, -51.40000000000004, -41.2, -17.90000000000001, -51.10000000000006, -14.799999999999986, -33.90000000000006, -9.399999999999986, -17.099999999999998, -42.19999999999999, -28.200000000000028, -46.30000000000007, -27.60000000000001, -25.100000000000023, -50.80000000000005, -24.3, -27.900000000000006, -37.70000000000002, -13.999999999999986, -11.499999999999986, -50.60000000000006, -42.70000000000004, -51.50000000000004, -10.699999999999996, -11.999999999999984, -15.699999999999982, -33.30000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.236686090069751, "mean_inference_ms": 1.0345451285688139, "mean_action_processing_ms": 0.4436809965280315, "mean_env_wait_ms": 4.6760880377396665, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 696000, "timesteps_this_iter": 0, "agent_timesteps_total": 696000, "timers": {"sample_time_ms": 22811.317, "sample_throughput": 175.352, "load_time_ms": 0.581, "load_throughput": 6890593.067, "learn_time_ms": 4560.822, "learn_throughput": 877.035}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.1019272970738537e-26, "cur_lr": 0.00010000000000000003, "total_loss": 0.5263893873400746, "policy_loss": -0.004172031875819929, "vf_loss": 53.05614328692036, "vf_explained_var": 0.06562131207476381, "kl": 0.008343781356466578, "entropy": 0.2944599243461765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 696000, "num_agent_steps_sampled": 696000, "num_steps_trained": 696000, "num_agent_steps_trained": 696000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 6960, "training_iteration": 174, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-41-12", "timestamp": 1651066872, "time_this_iter_s": 23.028853178024292, "time_total_s": 5925.087556600571, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5925.087556600571, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 21.106451612903225, "ram_util_percent": 95.51935483870969}}
{"episode_reward_max": -9.399999999999986, "episode_reward_min": -126.19999999999983, "episode_reward_mean": -35.045000000000016, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.799999999999981, -33.0, -62.000000000000036, -24.90000000000001, -50.30000000000005, -51.90000000000005, -53.50000000000005, -34.60000000000003, -52.900000000000034, -52.90000000000005, -68.90000000000002, -69.60000000000005, -13.799999999999985, -15.499999999999982, -15.699999999999978, -13.29999999999998, -27.400000000000006, -36.20000000000006, -43.200000000000045, -62.00000000000007, -45.200000000000045, -49.00000000000004, -9.59999999999999, -20.900000000000038, -14.399999999999979, -52.70000000000003, -45.80000000000004, -53.70000000000004, -50.10000000000004, -10.899999999999993, -33.69999999999997, -9.499999999999986, -29.300000000000022, -52.40000000000004, -51.40000000000004, -41.2, -17.90000000000001, -51.10000000000006, -14.799999999999986, -33.90000000000006, -9.399999999999986, -17.099999999999998, -42.19999999999999, -28.200000000000028, -46.30000000000007, -27.60000000000001, -25.100000000000023, -50.80000000000005, -24.3, -27.900000000000006, -37.70000000000002, -13.999999999999986, -11.499999999999986, -50.60000000000006, -42.70000000000004, -51.50000000000004, -10.699999999999996, -11.999999999999984, -15.699999999999982, -33.30000000000006, -19.10000000000003, -29.699999999999996, -40.30000000000007, -29.000000000000004, -10.399999999999983, -14.299999999999978, -29.600000000000023, -78.20000000000012, -32.60000000000001, -45.000000000000064, -43.00000000000004, -23.40000000000004, -49.20000000000008, -12.59999999999998, -27.00000000000001, -34.20000000000003, -126.19999999999983, -52.70000000000004, -34.600000000000044, -33.50000000000003, -10.199999999999983, -47.800000000000075, -87.79999999999998, -11.59999999999998, -26.700000000000017, -39.000000000000064, -10.999999999999984, -30.70000000000001, -52.40000000000005, -37.500000000000064, -29.000000000000004, -24.400000000000034, -39.40000000000006, -25.60000000000001, -37.50000000000007, -36.70000000000001, -32.000000000000014, -50.00000000000006, -25.400000000000006, -22.700000000000045], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2333985317074783, "mean_inference_ms": 1.0331483957873597, "mean_action_processing_ms": 0.4413277738089373, "mean_env_wait_ms": 4.6669329815519935, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 700000, "timesteps_this_iter": 0, "agent_timesteps_total": 700000, "timers": {"sample_time_ms": 22783.886, "sample_throughput": 175.563, "load_time_ms": 0.583, "load_throughput": 6866059.341, "learn_time_ms": 4621.543, "learn_throughput": 865.512}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.1019272970738537e-26, "cur_lr": 0.00010000000000000003, "total_loss": 1.0497893421510134, "policy_loss": 0.003217504091400613, "vf_loss": 104.65718638512396, "vf_explained_var": 0.07548979648979762, "kl": 0.004522117723884378, "entropy": 0.1786731767988894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 700000, "num_agent_steps_sampled": 700000, "num_steps_trained": 700000, "num_agent_steps_trained": 700000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7000, "training_iteration": 175, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-41-36", "timestamp": 1651066896, "time_this_iter_s": 23.255215883255005, "time_total_s": 5948.342772483826, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5948.342772483826, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 25.709375, "ram_util_percent": 95.425}}
{"episode_reward_max": -9.399999999999986, "episode_reward_min": -137.79999999999978, "episode_reward_mean": -32.893000000000015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.399999999999986, -17.099999999999998, -42.19999999999999, -28.200000000000028, -46.30000000000007, -27.60000000000001, -25.100000000000023, -50.80000000000005, -24.3, -27.900000000000006, -37.70000000000002, -13.999999999999986, -11.499999999999986, -50.60000000000006, -42.70000000000004, -51.50000000000004, -10.699999999999996, -11.999999999999984, -15.699999999999982, -33.30000000000006, -19.10000000000003, -29.699999999999996, -40.30000000000007, -29.000000000000004, -10.399999999999983, -14.299999999999978, -29.600000000000023, -78.20000000000012, -32.60000000000001, -45.000000000000064, -43.00000000000004, -23.40000000000004, -49.20000000000008, -12.59999999999998, -27.00000000000001, -34.20000000000003, -126.19999999999983, -52.70000000000004, -34.600000000000044, -33.50000000000003, -10.199999999999983, -47.800000000000075, -87.79999999999998, -11.59999999999998, -26.700000000000017, -39.000000000000064, -10.999999999999984, -30.70000000000001, -52.40000000000005, -37.500000000000064, -29.000000000000004, -24.400000000000034, -39.40000000000006, -25.60000000000001, -37.50000000000007, -36.70000000000001, -32.000000000000014, -50.00000000000006, -25.400000000000006, -22.700000000000045, -13.099999999999977, -29.900000000000006, -35.80000000000006, -67.2999999999999, -14.699999999999978, -20.6, -13.19999999999998, -14.599999999999975, -41.70000000000008, -36.39999999999998, -51.20000000000005, -39.2, -22.300000000000043, -34.300000000000004, -137.79999999999978, -52.50000000000006, -11.699999999999974, -13.199999999999982, -20.099999999999998, -13.699999999999976, -30.10000000000001, -20.100000000000023, -11.19999999999998, -29.799999999999976, -40.90000000000003, -14.499999999999986, -12.599999999999982, -12.099999999999978, -31.30000000000001, -13.399999999999974, -51.200000000000024, -12.799999999999981, -30.200000000000028, -45.50000000000007, -49.60000000000003, -24.59999999999999, -42.40000000000006, -51.20000000000006, -29.0, -32.90000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.230177311211157, "mean_inference_ms": 1.0319515033227646, "mean_action_processing_ms": 0.4390079512638618, "mean_env_wait_ms": 4.658247164502545, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 704000, "timesteps_this_iter": 0, "agent_timesteps_total": 704000, "timers": {"sample_time_ms": 22937.878, "sample_throughput": 174.384, "load_time_ms": 0.584, "load_throughput": 6849520.699, "learn_time_ms": 4622.425, "learn_throughput": 865.347}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5509636485369268e-26, "cur_lr": 0.00010000000000000003, "total_loss": 1.104519540716904, "policy_loss": -0.00423586718958392, "vf_loss": 110.87554328672347, "vf_explained_var": -0.03416351746487361, "kl": 0.01087604302820095, "entropy": 0.30825869728340416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 704000, "num_agent_steps_sampled": 704000, "num_steps_trained": 704000, "num_agent_steps_trained": 704000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7040, "training_iteration": 176, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-41-59", "timestamp": 1651066919, "time_this_iter_s": 23.925710201263428, "time_total_s": 5972.268482685089, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5972.268482685089, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 27.812121212121212, "ram_util_percent": 95.29696969696968}}
{"episode_reward_max": -10.199999999999983, "episode_reward_min": -137.79999999999978, "episode_reward_mean": -32.762000000000015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.199999999999983, -47.800000000000075, -87.79999999999998, -11.59999999999998, -26.700000000000017, -39.000000000000064, -10.999999999999984, -30.70000000000001, -52.40000000000005, -37.500000000000064, -29.000000000000004, -24.400000000000034, -39.40000000000006, -25.60000000000001, -37.50000000000007, -36.70000000000001, -32.000000000000014, -50.00000000000006, -25.400000000000006, -22.700000000000045, -13.099999999999977, -29.900000000000006, -35.80000000000006, -67.2999999999999, -14.699999999999978, -20.6, -13.19999999999998, -14.599999999999975, -41.70000000000008, -36.39999999999998, -51.20000000000005, -39.2, -22.300000000000043, -34.300000000000004, -137.79999999999978, -52.50000000000006, -11.699999999999974, -13.199999999999982, -20.099999999999998, -13.699999999999976, -30.10000000000001, -20.100000000000023, -11.19999999999998, -29.799999999999976, -40.90000000000003, -14.499999999999986, -12.599999999999982, -12.099999999999978, -31.30000000000001, -13.399999999999974, -51.200000000000024, -12.799999999999981, -30.200000000000028, -45.50000000000007, -49.60000000000003, -24.59999999999999, -42.40000000000006, -51.20000000000006, -29.0, -32.90000000000002, -51.80000000000005, -13.099999999999984, -49.000000000000064, -12.799999999999985, -41.30000000000002, -13.299999999999985, -30.100000000000005, -11.09999999999998, -31.200000000000003, -40.000000000000114, -40.80000000000002, -41.70000000000007, -51.30000000000005, -10.89999999999998, -35.200000000000024, -10.299999999999983, -37.300000000000075, -49.10000000000006, -86.90000000000008, -31.000000000000036, -10.59999999999998, -11.499999999999982, -32.899999999999956, -43.400000000000055, -35.20000000000004, -51.70000000000004, -10.99999999999998, -35.40000000000004, -15.099999999999973, -32.10000000000001, -35.70000000000005, -44.100000000000044, -14.499999999999975, -51.40000000000005, -52.40000000000005, -54.100000000000044, -13.499999999999975, -25.700000000000003, -40.200000000000045, -31.400000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2269430509609878, "mean_inference_ms": 1.030834100770609, "mean_action_processing_ms": 0.4367170959669832, "mean_env_wait_ms": 4.64979615700624, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 708000, "timesteps_this_iter": 0, "agent_timesteps_total": 708000, "timers": {"sample_time_ms": 22951.906, "sample_throughput": 174.277, "load_time_ms": 0.579, "load_throughput": 6908468.602, "learn_time_ms": 4647.756, "learn_throughput": 860.63}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5509636485369268e-26, "cur_lr": 0.00010000000000000003, "total_loss": 0.6667059286187093, "policy_loss": -0.0023153519618415064, "vf_loss": 66.90213046330278, "vf_explained_var": 0.08003591254193296, "kl": 0.007998350339579687, "entropy": 0.2604263690202647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 708000, "num_agent_steps_sampled": 708000, "num_steps_trained": 708000, "num_agent_steps_trained": 708000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7080, "training_iteration": 177, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-42-23", "timestamp": 1651066943, "time_this_iter_s": 23.76659893989563, "time_total_s": 5996.035081624985, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 5996.035081624985, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 27.896874999999998, "ram_util_percent": 94.89375}}
{"episode_reward_max": -9.499999999999986, "episode_reward_min": -86.90000000000008, "episode_reward_mean": -32.609000000000016, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.10000000000001, -20.100000000000023, -11.19999999999998, -29.799999999999976, -40.90000000000003, -14.499999999999986, -12.599999999999982, -12.099999999999978, -31.30000000000001, -13.399999999999974, -51.200000000000024, -12.799999999999981, -30.200000000000028, -45.50000000000007, -49.60000000000003, -24.59999999999999, -42.40000000000006, -51.20000000000006, -29.0, -32.90000000000002, -51.80000000000005, -13.099999999999984, -49.000000000000064, -12.799999999999985, -41.30000000000002, -13.299999999999985, -30.100000000000005, -11.09999999999998, -31.200000000000003, -40.000000000000114, -40.80000000000002, -41.70000000000007, -51.30000000000005, -10.89999999999998, -35.200000000000024, -10.299999999999983, -37.300000000000075, -49.10000000000006, -86.90000000000008, -31.000000000000036, -10.59999999999998, -11.499999999999982, -32.899999999999956, -43.400000000000055, -35.20000000000004, -51.70000000000004, -10.99999999999998, -35.40000000000004, -15.099999999999973, -32.10000000000001, -35.70000000000005, -44.100000000000044, -14.499999999999975, -51.40000000000005, -52.40000000000005, -54.100000000000044, -13.499999999999975, -25.700000000000003, -40.200000000000045, -31.400000000000002, -24.1, -36.400000000000055, -36.300000000000054, -37.70000000000005, -10.799999999999978, -40.70000000000005, -40.00000000000005, -34.500000000000014, -39.10000000000006, -31.700000000000006, -35.500000000000064, -9.499999999999986, -58.40000000000006, -10.299999999999981, -12.599999999999978, -42.900000000000034, -54.200000000000045, -31.300000000000004, -50.10000000000003, -52.60000000000006, -14.599999999999975, -48.40000000000004, -12.899999999999979, -62.50000000000006, -43.000000000000064, -49.60000000000003, -10.799999999999983, -52.600000000000044, -33.1, -36.00000000000006, -56.80000000000009, -12.899999999999979, -52.40000000000004, -45.70000000000008, -13.499999999999977, -19.1, -12.399999999999975, -10.499999999999979, -42.00000000000007, -27.90000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2238577135798068, "mean_inference_ms": 1.0300141722224532, "mean_action_processing_ms": 0.43446158055621764, "mean_env_wait_ms": 4.642034571157476, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 712000, "timesteps_this_iter": 0, "agent_timesteps_total": 712000, "timers": {"sample_time_ms": 23274.404, "sample_throughput": 171.863, "load_time_ms": 0.528, "load_throughput": 7569921.04, "learn_time_ms": 4658.622, "learn_throughput": 858.623}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5509636485369268e-26, "cur_lr": 0.00010000000000000003, "total_loss": 0.565246276942993, "policy_loss": 0.0009523614399856137, "vf_loss": 56.42939285873085, "vf_explained_var": 0.08560506445105358, "kl": 0.006650048435158892, "entropy": 0.237106549687263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 712000, "num_agent_steps_sampled": 712000, "num_steps_trained": 712000, "num_agent_steps_trained": 712000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7120, "training_iteration": 178, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-42-48", "timestamp": 1651066968, "time_this_iter_s": 25.175253868103027, "time_total_s": 6021.210335493088, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6021.210335493088, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 25.647058823529413, "ram_util_percent": 94.04411764705883}}
{"episode_reward_max": -9.499999999999986, "episode_reward_min": -117.19999999999986, "episode_reward_mean": -34.60200000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.59999999999998, -11.499999999999982, -32.899999999999956, -43.400000000000055, -35.20000000000004, -51.70000000000004, -10.99999999999998, -35.40000000000004, -15.099999999999973, -32.10000000000001, -35.70000000000005, -44.100000000000044, -14.499999999999975, -51.40000000000005, -52.40000000000005, -54.100000000000044, -13.499999999999975, -25.700000000000003, -40.200000000000045, -31.400000000000002, -24.1, -36.400000000000055, -36.300000000000054, -37.70000000000005, -10.799999999999978, -40.70000000000005, -40.00000000000005, -34.500000000000014, -39.10000000000006, -31.700000000000006, -35.500000000000064, -9.499999999999986, -58.40000000000006, -10.299999999999981, -12.599999999999978, -42.900000000000034, -54.200000000000045, -31.300000000000004, -50.10000000000003, -52.60000000000006, -14.599999999999975, -48.40000000000004, -12.899999999999979, -62.50000000000006, -43.000000000000064, -49.60000000000003, -10.799999999999983, -52.600000000000044, -33.1, -36.00000000000006, -56.80000000000009, -12.899999999999979, -52.40000000000004, -45.70000000000008, -13.499999999999977, -19.1, -12.399999999999975, -10.499999999999979, -42.00000000000007, -27.90000000000003, -37.30000000000005, -42.700000000000045, -16.099999999999973, -27.000000000000046, -14.699999999999978, -18.0, -35.30000000000003, -38.6, -50.700000000000045, -54.50000000000004, -49.60000000000001, -27.800000000000008, -117.19999999999986, -31.6, -53.90000000000005, -40.8, -13.999999999999982, -13.599999999999982, -53.80000000000004, -40.90000000000004, -47.70000000000002, -51.10000000000005, -53.50000000000004, -36.89999999999997, -11.699999999999982, -27.80000000000007, -52.300000000000026, -27.300000000000033, -38.9, -28.700000000000028, -26.199999999999996, -12.599999999999977, -31.500000000000007, -52.700000000000045, -43.40000000000006, -26.000000000000004, -54.30000000000007, -49.300000000000004, -10.599999999999985, -12.29999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2208770095735972, "mean_inference_ms": 1.0292402741456639, "mean_action_processing_ms": 0.4322310841995045, "mean_env_wait_ms": 4.634582722925169, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 716000, "timesteps_this_iter": 0, "agent_timesteps_total": 716000, "timers": {"sample_time_ms": 23516.358, "sample_throughput": 170.094, "load_time_ms": 0.376, "load_throughput": 10629928.404, "learn_time_ms": 4686.868, "learn_throughput": 853.448}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5509636485369268e-26, "cur_lr": 0.00010000000000000003, "total_loss": 0.8485411614269739, "policy_loss": -0.004168393961103853, "vf_loss": 85.2709580390684, "vf_explained_var": 0.02579353964456948, "kl": 0.004052468090941618, "entropy": 0.18268340332183225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 716000, "num_agent_steps_sampled": 716000, "num_steps_trained": 716000, "num_agent_steps_trained": 716000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7160, "training_iteration": 179, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-43-13", "timestamp": 1651066993, "time_this_iter_s": 24.548842906951904, "time_total_s": 6045.75917840004, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6045.75917840004, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 31.527272727272724, "ram_util_percent": 94.04242424242425}}
{"episode_reward_max": -8.699999999999987, "episode_reward_min": -144.99999999999977, "episode_reward_mean": -38.36600000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.599999999999975, -48.40000000000004, -12.899999999999979, -62.50000000000006, -43.000000000000064, -49.60000000000003, -10.799999999999983, -52.600000000000044, -33.1, -36.00000000000006, -56.80000000000009, -12.899999999999979, -52.40000000000004, -45.70000000000008, -13.499999999999977, -19.1, -12.399999999999975, -10.499999999999979, -42.00000000000007, -27.90000000000003, -37.30000000000005, -42.700000000000045, -16.099999999999973, -27.000000000000046, -14.699999999999978, -18.0, -35.30000000000003, -38.6, -50.700000000000045, -54.50000000000004, -49.60000000000001, -27.800000000000008, -117.19999999999986, -31.6, -53.90000000000005, -40.8, -13.999999999999982, -13.599999999999982, -53.80000000000004, -40.90000000000004, -47.70000000000002, -51.10000000000005, -53.50000000000004, -36.89999999999997, -11.699999999999982, -27.80000000000007, -52.300000000000026, -27.300000000000033, -38.9, -28.700000000000028, -26.199999999999996, -12.599999999999977, -31.500000000000007, -52.700000000000045, -43.40000000000006, -26.000000000000004, -54.30000000000007, -49.300000000000004, -10.599999999999985, -12.29999999999998, -43.60000000000004, -44.19999999999996, -52.80000000000007, -27.500000000000057, -29.20000000000001, -15.799999999999978, -48.80000000000003, -52.200000000000045, -45.00000000000002, -42.100000000000065, -48.00000000000006, -11.599999999999985, -49.10000000000006, -52.200000000000045, -51.80000000000005, -41.900000000000084, -31.700000000000003, -46.300000000000075, -34.100000000000044, -51.80000000000005, -17.499999999999993, -51.60000000000006, -26.29999999999996, -32.0, -48.400000000000006, -52.20000000000003, -51.300000000000054, -44.100000000000094, -44.50000000000002, -144.99999999999977, -22.5, -52.40000000000012, -47.500000000000064, -40.80000000000006, -8.699999999999987, -57.3000000000001, -41.70000000000005, -20.800000000000004, -51.40000000000005, -31.300000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2180030310212113, "mean_inference_ms": 1.0284122505757944, "mean_action_processing_ms": 0.4300219440339347, "mean_env_wait_ms": 4.627096018038558, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 720000, "timesteps_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"sample_time_ms": 23646.262, "sample_throughput": 169.16, "load_time_ms": 0.51, "load_throughput": 7841652.723, "learn_time_ms": 4717.339, "learn_throughput": 847.936}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.754818242684634e-27, "cur_lr": 0.00010000000000000003, "total_loss": 1.151413789539728, "policy_loss": -0.00024160155625913734, "vf_loss": 115.16554176166494, "vf_explained_var": 0.2128967494733872, "kl": 0.0053270677977945375, "entropy": 0.1259252925776446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 720000, "num_agent_steps_sampled": 720000, "num_steps_trained": 720000, "num_agent_steps_trained": 720000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7200, "training_iteration": 180, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-43-37", "timestamp": 1651067017, "time_this_iter_s": 24.17245602607727, "time_total_s": 6069.931634426117, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6069.931634426117, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 31.306060606060605, "ram_util_percent": 94.05151515151515}}
{"episode_reward_max": -8.699999999999987, "episode_reward_min": -144.99999999999977, "episode_reward_mean": -38.43200000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-47.70000000000002, -51.10000000000005, -53.50000000000004, -36.89999999999997, -11.699999999999982, -27.80000000000007, -52.300000000000026, -27.300000000000033, -38.9, -28.700000000000028, -26.199999999999996, -12.599999999999977, -31.500000000000007, -52.700000000000045, -43.40000000000006, -26.000000000000004, -54.30000000000007, -49.300000000000004, -10.599999999999985, -12.29999999999998, -43.60000000000004, -44.19999999999996, -52.80000000000007, -27.500000000000057, -29.20000000000001, -15.799999999999978, -48.80000000000003, -52.200000000000045, -45.00000000000002, -42.100000000000065, -48.00000000000006, -11.599999999999985, -49.10000000000006, -52.200000000000045, -51.80000000000005, -41.900000000000084, -31.700000000000003, -46.300000000000075, -34.100000000000044, -51.80000000000005, -17.499999999999993, -51.60000000000006, -26.29999999999996, -32.0, -48.400000000000006, -52.20000000000003, -51.300000000000054, -44.100000000000094, -44.50000000000002, -144.99999999999977, -22.5, -52.40000000000012, -47.500000000000064, -40.80000000000006, -8.699999999999987, -57.3000000000001, -41.70000000000005, -20.800000000000004, -51.40000000000005, -31.300000000000004, -37.600000000000016, -39.000000000000064, -31.400000000000016, -52.80000000000003, -14.699999999999978, -12.799999999999978, -12.799999999999983, -38.60000000000006, -10.799999999999985, -38.70000000000006, -34.00000000000002, -39.500000000000085, -33.400000000000006, -30.50000000000001, -33.80000000000003, -34.600000000000016, -51.60000000000006, -39.600000000000065, -29.000000000000007, -13.99999999999998, -51.80000000000005, -43.70000000000007, -11.499999999999979, -31.09999999999996, -53.200000000000024, -53.100000000000044, -50.10000000000006, -18.099999999999998, -10.29999999999999, -27.0, -30.300000000000054, -45.90000000000006, -77.89999999999996, -40.00000000000008, -12.89999999999998, -50.60000000000006, -109.59999999999982, -52.399999999999956, -30.100000000000012, -12.599999999999985], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2150487964432897, "mean_inference_ms": 1.0275271322470108, "mean_action_processing_ms": 0.4278332026859012, "mean_env_wait_ms": 4.619384328123739, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 724000, "timesteps_this_iter": 0, "agent_timesteps_total": 724000, "timers": {"sample_time_ms": 23707.054, "sample_throughput": 168.726, "load_time_ms": 0.452, "load_throughput": 8852944.963, "learn_time_ms": 4738.808, "learn_throughput": 844.094}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.754818242684634e-27, "cur_lr": 0.00010000000000000003, "total_loss": 0.7993870873171937, "policy_loss": -0.0027008306421589866, "vf_loss": 80.20879430770874, "vf_explained_var": 0.08616788835935696, "kl": 0.007002943735097216, "entropy": 0.2015226914179361, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 724000, "num_agent_steps_sampled": 724000, "num_steps_trained": 724000, "num_agent_steps_trained": 724000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7240, "training_iteration": 181, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-44-01", "timestamp": 1651067041, "time_this_iter_s": 23.855473041534424, "time_total_s": 6093.787107467651, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6093.787107467651, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 27.528125, "ram_util_percent": 94.05937499999999}}
{"episode_reward_max": -8.699999999999987, "episode_reward_min": -144.99999999999977, "episode_reward_mean": -37.98600000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.499999999999993, -51.60000000000006, -26.29999999999996, -32.0, -48.400000000000006, -52.20000000000003, -51.300000000000054, -44.100000000000094, -44.50000000000002, -144.99999999999977, -22.5, -52.40000000000012, -47.500000000000064, -40.80000000000006, -8.699999999999987, -57.3000000000001, -41.70000000000005, -20.800000000000004, -51.40000000000005, -31.300000000000004, -37.600000000000016, -39.000000000000064, -31.400000000000016, -52.80000000000003, -14.699999999999978, -12.799999999999978, -12.799999999999983, -38.60000000000006, -10.799999999999985, -38.70000000000006, -34.00000000000002, -39.500000000000085, -33.400000000000006, -30.50000000000001, -33.80000000000003, -34.600000000000016, -51.60000000000006, -39.600000000000065, -29.000000000000007, -13.99999999999998, -51.80000000000005, -43.70000000000007, -11.499999999999979, -31.09999999999996, -53.200000000000024, -53.100000000000044, -50.10000000000006, -18.099999999999998, -10.29999999999999, -27.0, -30.300000000000054, -45.90000000000006, -77.89999999999996, -40.00000000000008, -12.89999999999998, -50.60000000000006, -109.59999999999982, -52.399999999999956, -30.100000000000012, -12.599999999999985, -23.200000000000003, -9.499999999999986, -60.50000000000004, -24.299999999999997, -11.099999999999993, -50.700000000000045, -50.00000000000004, -13.699999999999978, -46.800000000000075, -32.9, -52.60000000000005, -131.2999999999998, -30.8, -11.499999999999979, -52.10000000000005, -61.700000000000045, -28.500000000000004, -28.400000000000006, -12.699999999999978, -52.20000000000004, -45.400000000000006, -36.1, -29.60000000000003, -12.199999999999976, -13.99999999999998, -34.00000000000001, -44.70000000000006, -9.799999999999986, -15.099999999999977, -42.900000000000006, -31.700000000000003, -53.900000000000034, -41.50000000000005, -52.90000000000003, -39.600000000000065, -26.400000000000066, -56.900000000000084, -49.30000000000004, -12.299999999999976, -37.100000000000016], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.21203180386323, "mean_inference_ms": 1.026575503607643, "mean_action_processing_ms": 0.42566656833205785, "mean_env_wait_ms": 4.61161925590774, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 728000, "timesteps_this_iter": 0, "agent_timesteps_total": 728000, "timers": {"sample_time_ms": 23822.447, "sample_throughput": 167.909, "load_time_ms": 0.518, "load_throughput": 7722894.495, "learn_time_ms": 4846.995, "learn_throughput": 825.254}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.754818242684634e-27, "cur_lr": 0.00010000000000000003, "total_loss": 0.9571159293018883, "policy_loss": 0.00019851301306037493, "vf_loss": 95.69174334823444, "vf_explained_var": 0.14600145002847076, "kl": 0.005119254073648069, "entropy": 0.2088890551429202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 728000, "num_agent_steps_sampled": 728000, "num_steps_trained": 728000, "num_agent_steps_trained": 728000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7280, "training_iteration": 182, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-44-26", "timestamp": 1651067066, "time_this_iter_s": 24.479167938232422, "time_total_s": 6118.266275405884, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6118.266275405884, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 26.98787878787879, "ram_util_percent": 94.2030303030303}}
{"episode_reward_max": -9.499999999999986, "episode_reward_min": -166.49999999999974, "episode_reward_mean": -39.56300000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.80000000000005, -43.70000000000007, -11.499999999999979, -31.09999999999996, -53.200000000000024, -53.100000000000044, -50.10000000000006, -18.099999999999998, -10.29999999999999, -27.0, -30.300000000000054, -45.90000000000006, -77.89999999999996, -40.00000000000008, -12.89999999999998, -50.60000000000006, -109.59999999999982, -52.399999999999956, -30.100000000000012, -12.599999999999985, -23.200000000000003, -9.499999999999986, -60.50000000000004, -24.299999999999997, -11.099999999999993, -50.700000000000045, -50.00000000000004, -13.699999999999978, -46.800000000000075, -32.9, -52.60000000000005, -131.2999999999998, -30.8, -11.499999999999979, -52.10000000000005, -61.700000000000045, -28.500000000000004, -28.400000000000006, -12.699999999999978, -52.20000000000004, -45.400000000000006, -36.1, -29.60000000000003, -12.199999999999976, -13.99999999999998, -34.00000000000001, -44.70000000000006, -9.799999999999986, -15.099999999999977, -42.900000000000006, -31.700000000000003, -53.900000000000034, -41.50000000000005, -52.90000000000003, -39.600000000000065, -26.400000000000066, -56.900000000000084, -49.30000000000004, -12.299999999999976, -37.100000000000016, -41.80000000000004, -166.49999999999974, -43.50000000000007, -35.9, -127.80000000000005, -12.99999999999998, -48.600000000000115, -13.899999999999975, -40.60000000000007, -38.699999999999996, -43.000000000000064, -36.6, -52.10000000000006, -12.899999999999979, -31.400000000000006, -10.79999999999998, -88.70000000000014, -35.90000000000003, -11.399999999999977, -51.800000000000054, -39.70000000000001, -10.699999999999978, -35.60000000000004, -52.900000000000034, -26.200000000000035, -36.20000000000005, -44.60000000000006, -72.7, -43.60000000000007, -14.699999999999976, -40.00000000000006, -12.099999999999982, -29.80000000000001, -51.20000000000004, -38.70000000000006, -31.90000000000005, -51.70000000000007, -10.99999999999998, -12.399999999999983, -73.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2089679446565134, "mean_inference_ms": 1.02575892501875, "mean_action_processing_ms": 0.4235244591382171, "mean_env_wait_ms": 4.604212526941307, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 732000, "timesteps_this_iter": 0, "agent_timesteps_total": 732000, "timers": {"sample_time_ms": 24079.684, "sample_throughput": 166.115, "load_time_ms": 0.469, "load_throughput": 8536720.094, "learn_time_ms": 4917.286, "learn_throughput": 813.457}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.754818242684634e-27, "cur_lr": 0.00010000000000000003, "total_loss": 2.2432931082894005, "policy_loss": -0.017213949861545716, "vf_loss": 226.05071019203433, "vf_explained_var": 0.0898914623004134, "kl": 0.016946373838502563, "entropy": 0.23547786750194807, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 732000, "num_agent_steps_sampled": 732000, "num_steps_trained": 732000, "num_agent_steps_trained": 732000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7320, "training_iteration": 183, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-44-51", "timestamp": 1651067091, "time_this_iter_s": 25.041815757751465, "time_total_s": 6143.308091163635, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6143.308091163635, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 19.48235294117647, "ram_util_percent": 94.7}}
{"episode_reward_max": -9.799999999999986, "episode_reward_min": -166.49999999999974, "episode_reward_mean": -38.03800000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.400000000000006, -36.1, -29.60000000000003, -12.199999999999976, -13.99999999999998, -34.00000000000001, -44.70000000000006, -9.799999999999986, -15.099999999999977, -42.900000000000006, -31.700000000000003, -53.900000000000034, -41.50000000000005, -52.90000000000003, -39.600000000000065, -26.400000000000066, -56.900000000000084, -49.30000000000004, -12.299999999999976, -37.100000000000016, -41.80000000000004, -166.49999999999974, -43.50000000000007, -35.9, -127.80000000000005, -12.99999999999998, -48.600000000000115, -13.899999999999975, -40.60000000000007, -38.699999999999996, -43.000000000000064, -36.6, -52.10000000000006, -12.899999999999979, -31.400000000000006, -10.79999999999998, -88.70000000000014, -35.90000000000003, -11.399999999999977, -51.800000000000054, -39.70000000000001, -10.699999999999978, -35.60000000000004, -52.900000000000034, -26.200000000000035, -36.20000000000005, -44.60000000000006, -72.7, -43.60000000000007, -14.699999999999976, -40.00000000000006, -12.099999999999982, -29.80000000000001, -51.20000000000004, -38.70000000000006, -31.90000000000005, -51.70000000000007, -10.99999999999998, -12.399999999999983, -73.6, -28.600000000000005, -50.40000000000008, -52.50000000000003, -46.40000000000007, -14.899999999999977, -66.60000000000004, -17.999999999999986, -40.3, -49.60000000000001, -25.80000000000004, -45.20000000000006, -30.6, -11.799999999999981, -34.8, -11.499999999999982, -26.70000000000001, -12.699999999999987, -31.700000000000035, -36.500000000000064, -113.19999999999987, -40.40000000000008, -67.60000000000001, -59.70000000000009, -53.40000000000004, -51.70000000000006, -51.90000000000005, -11.799999999999983, -13.099999999999973, -32.9, -37.00000000000002, -14.29999999999998, -35.900000000000034, -52.50000000000004, -14.699999999999976, -39.000000000000014, -36.1, -13.599999999999978, -14.599999999999978, -45.800000000000054, -10.39999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2058330919615263, "mean_inference_ms": 1.0250617516907732, "mean_action_processing_ms": 0.42140633650693515, "mean_env_wait_ms": 4.5968545019203155, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 736000, "timesteps_this_iter": 0, "agent_timesteps_total": 736000, "timers": {"sample_time_ms": 24205.002, "sample_throughput": 165.255, "load_time_ms": 0.462, "load_throughput": 8655187.784, "learn_time_ms": 4939.597, "learn_throughput": 809.783}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.754818242684634e-27, "cur_lr": 0.00010000000000000003, "total_loss": 0.9839588710900536, "policy_loss": -0.0019199307537287153, "vf_loss": 98.58788229214248, "vf_explained_var": 0.09141468489041893, "kl": 0.003169040151212322, "entropy": 0.24277118803803077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 736000, "num_agent_steps_sampled": 736000, "num_steps_trained": 736000, "num_agent_steps_trained": 736000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7360, "training_iteration": 184, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-45-15", "timestamp": 1651067115, "time_this_iter_s": 23.795093059539795, "time_total_s": 6167.103184223175, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6167.103184223175, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 26.753124999999997, "ram_util_percent": 94.875}}
{"episode_reward_max": -10.39999999999998, "episode_reward_min": -113.19999999999987, "episode_reward_mean": -37.92300000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.70000000000001, -10.699999999999978, -35.60000000000004, -52.900000000000034, -26.200000000000035, -36.20000000000005, -44.60000000000006, -72.7, -43.60000000000007, -14.699999999999976, -40.00000000000006, -12.099999999999982, -29.80000000000001, -51.20000000000004, -38.70000000000006, -31.90000000000005, -51.70000000000007, -10.99999999999998, -12.399999999999983, -73.6, -28.600000000000005, -50.40000000000008, -52.50000000000003, -46.40000000000007, -14.899999999999977, -66.60000000000004, -17.999999999999986, -40.3, -49.60000000000001, -25.80000000000004, -45.20000000000006, -30.6, -11.799999999999981, -34.8, -11.499999999999982, -26.70000000000001, -12.699999999999987, -31.700000000000035, -36.500000000000064, -113.19999999999987, -40.40000000000008, -67.60000000000001, -59.70000000000009, -53.40000000000004, -51.70000000000006, -51.90000000000005, -11.799999999999983, -13.099999999999973, -32.9, -37.00000000000002, -14.29999999999998, -35.900000000000034, -52.50000000000004, -14.699999999999976, -39.000000000000014, -36.1, -13.599999999999978, -14.599999999999978, -45.800000000000054, -10.39999999999998, -49.40000000000005, -52.000000000000036, -34.30000000000008, -30.7, -11.29999999999998, -38.50000000000001, -54.99999999999992, -52.40000000000004, -30.200000000000006, -51.40000000000003, -51.40000000000004, -52.600000000000065, -39.70000000000006, -48.900000000000084, -11.89999999999998, -29.300000000000033, -53.50000000000005, -98.99999999999984, -83.79999999999993, -26.000000000000007, -37.600000000000065, -51.50000000000004, -11.699999999999982, -24.799999999999997, -12.599999999999978, -48.900000000000034, -55.000000000000064, -37.600000000000065, -36.100000000000044, -51.6, -63.80000000000006, -12.599999999999984, -31.200000000000003, -36.30000000000001, -14.69999999999998, -32.1, -50.30000000000001, -47.3, -14.89999999999998, -46.90000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2027746451159234, "mean_inference_ms": 1.0246815972789485, "mean_action_processing_ms": 0.41931416587670367, "mean_env_wait_ms": 4.589871542016073, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 740000, "timesteps_this_iter": 0, "agent_timesteps_total": 740000, "timers": {"sample_time_ms": 24473.22, "sample_throughput": 163.444, "load_time_ms": 0.451, "load_throughput": 8877773.309, "learn_time_ms": 4970.254, "learn_throughput": 804.788}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.877409121342317e-27, "cur_lr": 0.00010000000000000003, "total_loss": 0.9313228009078371, "policy_loss": -0.005382319323478207, "vf_loss": 93.6705140759868, "vf_explained_var": 0.17580073155382628, "kl": 0.004508063889763545, "entropy": 0.15772322708708283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 740000, "num_agent_steps_sampled": 740000, "num_steps_trained": 740000, "num_agent_steps_trained": 740000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7400, "training_iteration": 185, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-45-41", "timestamp": 1651067141, "time_this_iter_s": 26.027065753936768, "time_total_s": 6193.130249977112, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6193.130249977112, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 25.508823529411764, "ram_util_percent": 95.04411764705881}}
{"episode_reward_max": -10.39999999999998, "episode_reward_min": -98.99999999999984, "episode_reward_mean": -36.78700000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.40000000000008, -67.60000000000001, -59.70000000000009, -53.40000000000004, -51.70000000000006, -51.90000000000005, -11.799999999999983, -13.099999999999973, -32.9, -37.00000000000002, -14.29999999999998, -35.900000000000034, -52.50000000000004, -14.699999999999976, -39.000000000000014, -36.1, -13.599999999999978, -14.599999999999978, -45.800000000000054, -10.39999999999998, -49.40000000000005, -52.000000000000036, -34.30000000000008, -30.7, -11.29999999999998, -38.50000000000001, -54.99999999999992, -52.40000000000004, -30.200000000000006, -51.40000000000003, -51.40000000000004, -52.600000000000065, -39.70000000000006, -48.900000000000084, -11.89999999999998, -29.300000000000033, -53.50000000000005, -98.99999999999984, -83.79999999999993, -26.000000000000007, -37.600000000000065, -51.50000000000004, -11.699999999999982, -24.799999999999997, -12.599999999999978, -48.900000000000034, -55.000000000000064, -37.600000000000065, -36.100000000000044, -51.6, -63.80000000000006, -12.599999999999984, -31.200000000000003, -36.30000000000001, -14.69999999999998, -32.1, -50.30000000000001, -47.3, -14.89999999999998, -46.90000000000006, -52.000000000000036, -11.799999999999983, -49.89999999999994, -31.50000000000004, -16.09999999999998, -42.400000000000055, -45.59999999999994, -50.50000000000005, -13.999999999999982, -37.000000000000085, -31.0, -53.29999999999991, -41.200000000000045, -42.60000000000009, -31.1, -31.300000000000004, -52.80000000000004, -30.300000000000004, -14.499999999999982, -14.899999999999977, -22.6, -51.700000000000045, -12.099999999999982, -43.20000000000001, -12.099999999999987, -50.900000000000084, -22.300000000000026, -14.099999999999982, -48.50000000000004, -51.40000000000004, -10.89999999999998, -17.099999999999998, -49.0, -14.099999999999975, -18.300000000000004, -83.29999999999994, -11.199999999999983, -53.800000000000054, -50.700000000000045, -32.400000000000034], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2000640390074853, "mean_inference_ms": 1.0245814916493325, "mean_action_processing_ms": 0.4172560330470399, "mean_env_wait_ms": 4.583849227755135, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 744000, "timesteps_this_iter": 0, "agent_timesteps_total": 744000, "timers": {"sample_time_ms": 24780.619, "sample_throughput": 161.416, "load_time_ms": 0.568, "load_throughput": 7040671.451, "learn_time_ms": 5000.091, "learn_throughput": 799.985}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9387045606711585e-27, "cur_lr": 0.00010000000000000003, "total_loss": 0.6546235839460766, "policy_loss": -0.0029516942248309173, "vf_loss": 65.75752938485914, "vf_explained_var": 0.01997945353549014, "kl": 0.005217428640042908, "entropy": 0.2441657575132746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 744000, "num_agent_steps_sampled": 744000, "num_steps_trained": 744000, "num_agent_steps_trained": 744000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7440, "training_iteration": 186, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-46-08", "timestamp": 1651067168, "time_this_iter_s": 26.987195253372192, "time_total_s": 6220.117445230484, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6220.117445230484, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 31.93783783783784, "ram_util_percent": 95.28918918918917}}
{"episode_reward_max": -10.89999999999998, "episode_reward_min": -141.49999999999977, "episode_reward_mean": -35.29100000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.600000000000065, -51.50000000000004, -11.699999999999982, -24.799999999999997, -12.599999999999978, -48.900000000000034, -55.000000000000064, -37.600000000000065, -36.100000000000044, -51.6, -63.80000000000006, -12.599999999999984, -31.200000000000003, -36.30000000000001, -14.69999999999998, -32.1, -50.30000000000001, -47.3, -14.89999999999998, -46.90000000000006, -52.000000000000036, -11.799999999999983, -49.89999999999994, -31.50000000000004, -16.09999999999998, -42.400000000000055, -45.59999999999994, -50.50000000000005, -13.999999999999982, -37.000000000000085, -31.0, -53.29999999999991, -41.200000000000045, -42.60000000000009, -31.1, -31.300000000000004, -52.80000000000004, -30.300000000000004, -14.499999999999982, -14.899999999999977, -22.6, -51.700000000000045, -12.099999999999982, -43.20000000000001, -12.099999999999987, -50.900000000000084, -22.300000000000026, -14.099999999999982, -48.50000000000004, -51.40000000000004, -10.89999999999998, -17.099999999999998, -49.0, -14.099999999999975, -18.300000000000004, -83.29999999999994, -11.199999999999983, -53.800000000000054, -50.700000000000045, -32.400000000000034, -56.80000000000009, -15.499999999999975, -45.2, -43.200000000000024, -20.5, -24.7, -50.300000000000054, -49.60000000000006, -15.399999999999977, -52.800000000000054, -49.80000000000007, -46.70000000000007, -53.00000000000005, -22.600000000000033, -37.00000000000005, -36.1, -11.29999999999998, -33.70000000000004, -40.40000000000009, -76.3, -50.500000000000064, -26.29999999999995, -14.099999999999973, -38.800000000000054, -10.99999999999998, -33.1, -38.70000000000006, -36.20000000000001, -27.300000000000004, -13.299999999999985, -35.80000000000006, -14.999999999999973, -14.09999999999998, -13.99999999999998, -33.00000000000001, -11.19999999999998, -141.49999999999977, -51.30000000000001, -37.40000000000002, -24.600000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1973878490984693, "mean_inference_ms": 1.0240550559740318, "mean_action_processing_ms": 0.4152118812657724, "mean_env_wait_ms": 4.577513624461186, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 748000, "timesteps_this_iter": 0, "agent_timesteps_total": 748000, "timers": {"sample_time_ms": 24781.424, "sample_throughput": 161.411, "load_time_ms": 0.566, "load_throughput": 7070640.593, "learn_time_ms": 4891.612, "learn_throughput": 817.726}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9387045606711585e-27, "cur_lr": 0.00010000000000000003, "total_loss": 1.023833948567069, "policy_loss": 0.0014610772932408958, "vf_loss": 102.23728894367012, "vf_explained_var": 0.10955299895296815, "kl": 0.01031419151978263, "entropy": 0.2182485846071554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 748000, "num_agent_steps_sampled": 748000, "num_steps_trained": 748000, "num_agent_steps_trained": 748000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7480, "training_iteration": 187, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-46-30", "timestamp": 1651067190, "time_this_iter_s": 22.38486385345459, "time_total_s": 6242.502309083939, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6242.502309083939, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 16.286666666666665, "ram_util_percent": 95.12666666666664}}
{"episode_reward_max": -10.299999999999983, "episode_reward_min": -141.49999999999977, "episode_reward_mean": -35.02800000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.6, -51.700000000000045, -12.099999999999982, -43.20000000000001, -12.099999999999987, -50.900000000000084, -22.300000000000026, -14.099999999999982, -48.50000000000004, -51.40000000000004, -10.89999999999998, -17.099999999999998, -49.0, -14.099999999999975, -18.300000000000004, -83.29999999999994, -11.199999999999983, -53.800000000000054, -50.700000000000045, -32.400000000000034, -56.80000000000009, -15.499999999999975, -45.2, -43.200000000000024, -20.5, -24.7, -50.300000000000054, -49.60000000000006, -15.399999999999977, -52.800000000000054, -49.80000000000007, -46.70000000000007, -53.00000000000005, -22.600000000000033, -37.00000000000005, -36.1, -11.29999999999998, -33.70000000000004, -40.40000000000009, -76.3, -50.500000000000064, -26.29999999999995, -14.099999999999973, -38.800000000000054, -10.99999999999998, -33.1, -38.70000000000006, -36.20000000000001, -27.300000000000004, -13.299999999999985, -35.80000000000006, -14.999999999999973, -14.09999999999998, -13.99999999999998, -33.00000000000001, -11.19999999999998, -141.49999999999977, -51.30000000000001, -37.40000000000002, -24.600000000000005, -33.40000000000005, -51.80000000000005, -12.09999999999998, -53.100000000000065, -27.900000000000013, -51.70000000000004, -46.99999999999999, -29.700000000000006, -12.799999999999983, -47.10000000000007, -48.00000000000005, -15.299999999999985, -51.700000000000045, -21.40000000000006, -19.00000000000002, -53.30000000000004, -10.299999999999983, -39.30000000000004, -41.800000000000004, -51.50000000000004, -22.000000000000043, -11.599999999999985, -11.399999999999979, -14.699999999999985, -50.10000000000005, -51.400000000000055, -55.50000000000004, -52.100000000000044, -11.799999999999976, -52.300000000000026, -42.40000000000003, -49.90000000000007, -21.50000000000003, -64.50000000000007, -21.000000000000007, -27.400000000000006, -11.699999999999974, -30.400000000000006, -34.20000000000007, -30.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1945035619015687, "mean_inference_ms": 1.0227189948108224, "mean_action_processing_ms": 0.4131693718727072, "mean_env_wait_ms": 4.570045528197855, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 752000, "timesteps_this_iter": 0, "agent_timesteps_total": 752000, "timers": {"sample_time_ms": 24328.438, "sample_throughput": 164.417, "load_time_ms": 0.567, "load_throughput": 7052213.535, "learn_time_ms": 4909.786, "learn_throughput": 814.7}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9387045606711585e-27, "cur_lr": 0.00010000000000000003, "total_loss": 0.6099616445240474, "policy_loss": -0.005000557041456622, "vf_loss": 61.49622158337665, "vf_explained_var": 0.14214858579379255, "kl": 0.006310851330676575, "entropy": 0.23689059989266498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 752000, "num_agent_steps_sampled": 752000, "num_steps_trained": 752000, "num_agent_steps_trained": 752000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7520, "training_iteration": 188, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-46-52", "timestamp": 1651067212, "time_this_iter_s": 21.916696786880493, "time_total_s": 6264.419005870819, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6264.419005870819, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 19.546666666666667, "ram_util_percent": 95.08000000000001}}
{"episode_reward_max": -9.499999999999986, "episode_reward_min": -141.49999999999977, "episode_reward_mean": -33.58100000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.500000000000064, -26.29999999999995, -14.099999999999973, -38.800000000000054, -10.99999999999998, -33.1, -38.70000000000006, -36.20000000000001, -27.300000000000004, -13.299999999999985, -35.80000000000006, -14.999999999999973, -14.09999999999998, -13.99999999999998, -33.00000000000001, -11.19999999999998, -141.49999999999977, -51.30000000000001, -37.40000000000002, -24.600000000000005, -33.40000000000005, -51.80000000000005, -12.09999999999998, -53.100000000000065, -27.900000000000013, -51.70000000000004, -46.99999999999999, -29.700000000000006, -12.799999999999983, -47.10000000000007, -48.00000000000005, -15.299999999999985, -51.700000000000045, -21.40000000000006, -19.00000000000002, -53.30000000000004, -10.299999999999983, -39.30000000000004, -41.800000000000004, -51.50000000000004, -22.000000000000043, -11.599999999999985, -11.399999999999979, -14.699999999999985, -50.10000000000005, -51.400000000000055, -55.50000000000004, -52.100000000000044, -11.799999999999976, -52.300000000000026, -42.40000000000003, -49.90000000000007, -21.50000000000003, -64.50000000000007, -21.000000000000007, -27.400000000000006, -11.699999999999974, -30.400000000000006, -34.20000000000007, -30.9, -37.90000000000003, -15.29999999999998, -23.90000000000001, -52.00000000000003, -9.499999999999986, -51.20000000000003, -51.200000000000045, -14.199999999999982, -11.599999999999982, -50.50000000000007, -103.29999999999993, -13.799999999999978, -31.100000000000033, -53.50000000000004, -13.29999999999998, -34.20000000000002, -31.300000000000068, -30.90000000000004, -51.30000000000004, -12.49999999999999, -37.00000000000007, -41.90000000000008, -48.500000000000036, -26.000000000000007, -39.200000000000045, -47.50000000000004, -49.400000000000034, -12.799999999999985, -13.399999999999986, -11.29999999999999, -42.80000000000004, -29.80000000000002, -33.6, -29.0, -40.30000000000002, -12.599999999999985, -31.40000000000004, -16.699999999999992, -36.60000000000001, -13.599999999999982], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1918271588275664, "mean_inference_ms": 1.02165283653636, "mean_action_processing_ms": 0.41115862814465487, "mean_env_wait_ms": 4.563023640346961, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 756000, "timesteps_this_iter": 0, "agent_timesteps_total": 756000, "timers": {"sample_time_ms": 24566.836, "sample_throughput": 162.821, "load_time_ms": 0.584, "load_throughput": 6844211.643, "learn_time_ms": 4965.178, "learn_throughput": 805.611}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9387045606711585e-27, "cur_lr": 0.00010000000000000003, "total_loss": 0.7209760634784377, "policy_loss": -0.004835318187151545, "vf_loss": 72.58114005058043, "vf_explained_var": 0.12720259793343083, "kl": 0.006717300559369408, "entropy": 0.1893378149505244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 756000, "num_agent_steps_sampled": 756000, "num_steps_trained": 756000, "num_agent_steps_trained": 756000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7560, "training_iteration": 189, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-47-19", "timestamp": 1651067239, "time_this_iter_s": 27.303972005844116, "time_total_s": 6291.722977876663, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6291.722977876663, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 24.994594594594595, "ram_util_percent": 95.26756756756755}}
{"episode_reward_max": -9.499999999999986, "episode_reward_min": -122.19999999999986, "episode_reward_mean": -35.490000000000016, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.000000000000043, -11.599999999999985, -11.399999999999979, -14.699999999999985, -50.10000000000005, -51.400000000000055, -55.50000000000004, -52.100000000000044, -11.799999999999976, -52.300000000000026, -42.40000000000003, -49.90000000000007, -21.50000000000003, -64.50000000000007, -21.000000000000007, -27.400000000000006, -11.699999999999974, -30.400000000000006, -34.20000000000007, -30.9, -37.90000000000003, -15.29999999999998, -23.90000000000001, -52.00000000000003, -9.499999999999986, -51.20000000000003, -51.200000000000045, -14.199999999999982, -11.599999999999982, -50.50000000000007, -103.29999999999993, -13.799999999999978, -31.100000000000033, -53.50000000000004, -13.29999999999998, -34.20000000000002, -31.300000000000068, -30.90000000000004, -51.30000000000004, -12.49999999999999, -37.00000000000007, -41.90000000000008, -48.500000000000036, -26.000000000000007, -39.200000000000045, -47.50000000000004, -49.400000000000034, -12.799999999999985, -13.399999999999986, -11.29999999999999, -42.80000000000004, -29.80000000000002, -33.6, -29.0, -40.30000000000002, -12.599999999999985, -31.40000000000004, -16.699999999999992, -36.60000000000001, -13.599999999999982, -62.1000000000001, -36.40000000000001, -51.10000000000005, -52.10000000000004, -35.20000000000002, -13.999999999999984, -15.299999999999976, -15.699999999999978, -51.700000000000045, -53.400000000000034, -17.599999999999994, -13.999999999999982, -14.899999999999984, -12.599999999999975, -26.200000000000035, -40.40000000000002, -14.099999999999975, -49.60000000000004, -52.500000000000064, -32.10000000000005, -52.70000000000003, -30.500000000000032, -122.19999999999986, -28.100000000000016, -10.399999999999983, -51.30000000000007, -81.70000000000003, -33.2, -22.900000000000013, -27.300000000000008, -52.300000000000026, -13.799999999999985, -58.60000000000001, -29.0, -49.90000000000005, -62.00000000000009, -26.700000000000003, -51.00000000000005, -10.799999999999985, -100.89999999999992], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1892578898739772, "mean_inference_ms": 1.0208526798745263, "mean_action_processing_ms": 0.4091768038453133, "mean_env_wait_ms": 4.556368861780161, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 760000, "timesteps_this_iter": 0, "agent_timesteps_total": 760000, "timers": {"sample_time_ms": 24573.446, "sample_throughput": 162.777, "load_time_ms": 0.45, "load_throughput": 8894245.878, "learn_time_ms": 4962.576, "learn_throughput": 806.033}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9387045606711585e-27, "cur_lr": 0.00010000000000000003, "total_loss": 1.3635630478088554, "policy_loss": -0.004862492721557857, "vf_loss": 136.84255693702286, "vf_explained_var": -0.019046094276571786, "kl": 0.005237596400038935, "entropy": 0.19485996371305359, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 760000, "num_agent_steps_sampled": 760000, "num_steps_trained": 760000, "num_agent_steps_trained": 760000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7600, "training_iteration": 190, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-47-43", "timestamp": 1651067263, "time_this_iter_s": 23.6447331905365, "time_total_s": 6315.3677110672, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6315.3677110672, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 30.84375, "ram_util_percent": 95.125}}
{"episode_reward_max": -10.19999999999998, "episode_reward_min": -122.19999999999986, "episode_reward_mean": -34.536000000000016, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.00000000000007, -41.90000000000008, -48.500000000000036, -26.000000000000007, -39.200000000000045, -47.50000000000004, -49.400000000000034, -12.799999999999985, -13.399999999999986, -11.29999999999999, -42.80000000000004, -29.80000000000002, -33.6, -29.0, -40.30000000000002, -12.599999999999985, -31.40000000000004, -16.699999999999992, -36.60000000000001, -13.599999999999982, -62.1000000000001, -36.40000000000001, -51.10000000000005, -52.10000000000004, -35.20000000000002, -13.999999999999984, -15.299999999999976, -15.699999999999978, -51.700000000000045, -53.400000000000034, -17.599999999999994, -13.999999999999982, -14.899999999999984, -12.599999999999975, -26.200000000000035, -40.40000000000002, -14.099999999999975, -49.60000000000004, -52.500000000000064, -32.10000000000005, -52.70000000000003, -30.500000000000032, -122.19999999999986, -28.100000000000016, -10.399999999999983, -51.30000000000007, -81.70000000000003, -33.2, -22.900000000000013, -27.300000000000008, -52.300000000000026, -13.799999999999985, -58.60000000000001, -29.0, -49.90000000000005, -62.00000000000009, -26.700000000000003, -51.00000000000005, -10.799999999999985, -100.89999999999992, -47.90000000000005, -19.299999999999997, -12.199999999999982, -43.600000000000065, -37.89999999999997, -39.800000000000004, -20.499999999999996, -16.19999999999998, -30.10000000000001, -34.5, -32.099999999999994, -15.699999999999974, -32.400000000000006, -11.999999999999977, -20.4, -51.200000000000045, -24.8, -12.799999999999976, -33.10000000000006, -42.80000000000002, -52.60000000000003, -52.30000000000004, -41.400000000000034, -36.20000000000001, -50.400000000000055, -40.20000000000001, -50.400000000000055, -10.19999999999998, -50.10000000000005, -45.500000000000085, -28.00000000000002, -31.700000000000003, -35.10000000000003, -36.300000000000054, -37.199999999999996, -15.199999999999976, -14.799999999999999, -30.2, -14.999999999999998, -11.799999999999981], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1867100092311116, "mean_inference_ms": 1.0200221290308522, "mean_action_processing_ms": 0.4072177636293357, "mean_env_wait_ms": 4.549485438904908, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 764000, "timesteps_this_iter": 0, "agent_timesteps_total": 764000, "timers": {"sample_time_ms": 24526.596, "sample_throughput": 163.088, "load_time_ms": 0.45, "load_throughput": 8881062.94, "learn_time_ms": 4954.912, "learn_throughput": 807.28}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.9387045606711585e-27, "cur_lr": 0.00010000000000000003, "total_loss": 0.48816567946585915, "policy_loss": -9.48434595459251e-05, "vf_loss": 48.826053381478914, "vf_explained_var": 0.03427085927737657, "kl": 0.0032596594800366665, "entropy": 0.11536723506481697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 764000, "num_agent_steps_sampled": 764000, "num_steps_trained": 764000, "num_agent_steps_trained": 764000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7640, "training_iteration": 191, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-48-06", "timestamp": 1651067286, "time_this_iter_s": 23.38064694404602, "time_total_s": 6338.748358011246, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6338.748358011246, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 29.578125, "ram_util_percent": 95.046875}}
{"episode_reward_max": -7.399999999999993, "episode_reward_min": -185.49999999999966, "episode_reward_mean": -38.30300000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-52.70000000000003, -30.500000000000032, -122.19999999999986, -28.100000000000016, -10.399999999999983, -51.30000000000007, -81.70000000000003, -33.2, -22.900000000000013, -27.300000000000008, -52.300000000000026, -13.799999999999985, -58.60000000000001, -29.0, -49.90000000000005, -62.00000000000009, -26.700000000000003, -51.00000000000005, -10.799999999999985, -100.89999999999992, -47.90000000000005, -19.299999999999997, -12.199999999999982, -43.600000000000065, -37.89999999999997, -39.800000000000004, -20.499999999999996, -16.19999999999998, -30.10000000000001, -34.5, -32.099999999999994, -15.699999999999974, -32.400000000000006, -11.999999999999977, -20.4, -51.200000000000045, -24.8, -12.799999999999976, -33.10000000000006, -42.80000000000002, -52.60000000000003, -52.30000000000004, -41.400000000000034, -36.20000000000001, -50.400000000000055, -40.20000000000001, -50.400000000000055, -10.19999999999998, -50.10000000000005, -45.500000000000085, -28.00000000000002, -31.700000000000003, -35.10000000000003, -36.300000000000054, -37.199999999999996, -15.199999999999976, -14.799999999999999, -30.2, -14.999999999999998, -11.799999999999981, -18.199999999999992, -29.50000000000002, -51.30000000000004, -27.2, -7.399999999999993, -49.10000000000005, -35.1, -61.60000000000008, -53.00000000000004, -40.60000000000009, -8.599999999999989, -49.50000000000004, -39.89999999999998, -37.400000000000006, -38.30000000000004, -50.200000000000074, -50.40000000000004, -38.10000000000004, -14.299999999999978, -49.00000000000006, -49.400000000000055, -51.80000000000005, -38.20000000000006, -52.900000000000034, -53.10000000000004, -47.40000000000005, -37.90000000000004, -50.90000000000005, -30.9, -16.299999999999997, -36.50000000000004, -46.90000000000006, -10.799999999999981, -53.300000000000054, -50.60000000000004, -185.49999999999966, -11.39999999999998, -53.10000000000005, -12.599999999999975, -12.89999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1841245483039415, "mean_inference_ms": 1.0192300037933568, "mean_action_processing_ms": 0.40527807487680034, "mean_env_wait_ms": 4.542500442698871, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 768000, "timesteps_this_iter": 0, "agent_timesteps_total": 768000, "timers": {"sample_time_ms": 24622.588, "sample_throughput": 162.452, "load_time_ms": 0.389, "load_throughput": 10282677.127, "learn_time_ms": 4868.363, "learn_throughput": 821.631}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.693522803355793e-28, "cur_lr": 0.00010000000000000003, "total_loss": 1.4064668924818116, "policy_loss": -0.0024074377572183966, "vf_loss": 140.88743654169062, "vf_explained_var": 0.1324111475739428, "kl": 0.005192988733173155, "entropy": 0.10360766839766775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 768000, "num_agent_steps_sampled": 768000, "num_steps_trained": 768000, "num_agent_steps_trained": 768000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7680, "training_iteration": 192, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-48-31", "timestamp": 1651067311, "time_this_iter_s": 24.642740964889526, "time_total_s": 6363.391098976135, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6363.391098976135, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 23.366666666666667, "ram_util_percent": 95.24242424242425}}
{"episode_reward_max": -7.399999999999993, "episode_reward_min": -185.49999999999966, "episode_reward_mean": -36.98800000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-52.60000000000003, -52.30000000000004, -41.400000000000034, -36.20000000000001, -50.400000000000055, -40.20000000000001, -50.400000000000055, -10.19999999999998, -50.10000000000005, -45.500000000000085, -28.00000000000002, -31.700000000000003, -35.10000000000003, -36.300000000000054, -37.199999999999996, -15.199999999999976, -14.799999999999999, -30.2, -14.999999999999998, -11.799999999999981, -18.199999999999992, -29.50000000000002, -51.30000000000004, -27.2, -7.399999999999993, -49.10000000000005, -35.1, -61.60000000000008, -53.00000000000004, -40.60000000000009, -8.599999999999989, -49.50000000000004, -39.89999999999998, -37.400000000000006, -38.30000000000004, -50.200000000000074, -50.40000000000004, -38.10000000000004, -14.299999999999978, -49.00000000000006, -49.400000000000055, -51.80000000000005, -38.20000000000006, -52.900000000000034, -53.10000000000004, -47.40000000000005, -37.90000000000004, -50.90000000000005, -30.9, -16.299999999999997, -36.50000000000004, -46.90000000000006, -10.799999999999981, -53.300000000000054, -50.60000000000004, -185.49999999999966, -11.39999999999998, -53.10000000000005, -12.599999999999975, -12.89999999999998, -12.799999999999985, -42.50000000000007, -49.70000000000007, -42.60000000000006, -12.799999999999978, -83.39999999999982, -50.200000000000045, -40.700000000000045, -10.09999999999998, -35.90000000000008, -48.600000000000044, -11.599999999999978, -11.49999999999998, -17.5, -52.30000000000004, -40.30000000000007, -29.500000000000004, -46.90000000000005, -48.50000000000005, -31.100000000000016, -17.600000000000005, -11.099999999999982, -49.60000000000003, -26.9, -31.200000000000045, -35.90000000000001, -53.20000000000003, -21.100000000000023, -38.50000000000006, -11.399999999999979, -36.40000000000006, -31.4, -54.200000000000095, -13.799999999999985, -12.399999999999977, -52.600000000000044, -54.10000000000004, -30.5, -12.299999999999983, -50.40000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1816261803970056, "mean_inference_ms": 1.0184834548249513, "mean_action_processing_ms": 0.40335516137692545, "mean_env_wait_ms": 4.535507892705141, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 772000, "timesteps_this_iter": 0, "agent_timesteps_total": 772000, "timers": {"sample_time_ms": 24434.353, "sample_throughput": 163.704, "load_time_ms": 0.385, "load_throughput": 10387725.837, "learn_time_ms": 4841.452, "learn_throughput": 826.198}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 9.693522803355793e-28, "cur_lr": 0.00010000000000000003, "total_loss": 0.6497187099609805, "policy_loss": 0.004239632384050437, "vf_loss": 64.5479093172217, "vf_explained_var": 0.14976546796419288, "kl": 0.004261446535849936, "entropy": 0.14309241782863855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 772000, "num_agent_steps_sampled": 772000, "num_steps_trained": 772000, "num_agent_steps_trained": 772000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7720, "training_iteration": 193, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-48-55", "timestamp": 1651067335, "time_this_iter_s": 23.76902198791504, "time_total_s": 6387.16012096405, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6387.16012096405, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 24.0875, "ram_util_percent": 95.40312500000002}}
{"episode_reward_max": -10.09999999999998, "episode_reward_min": -185.49999999999966, "episode_reward_mean": -36.84000000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.400000000000055, -51.80000000000005, -38.20000000000006, -52.900000000000034, -53.10000000000004, -47.40000000000005, -37.90000000000004, -50.90000000000005, -30.9, -16.299999999999997, -36.50000000000004, -46.90000000000006, -10.799999999999981, -53.300000000000054, -50.60000000000004, -185.49999999999966, -11.39999999999998, -53.10000000000005, -12.599999999999975, -12.89999999999998, -12.799999999999985, -42.50000000000007, -49.70000000000007, -42.60000000000006, -12.799999999999978, -83.39999999999982, -50.200000000000045, -40.700000000000045, -10.09999999999998, -35.90000000000008, -48.600000000000044, -11.599999999999978, -11.49999999999998, -17.5, -52.30000000000004, -40.30000000000007, -29.500000000000004, -46.90000000000005, -48.50000000000005, -31.100000000000016, -17.600000000000005, -11.099999999999982, -49.60000000000003, -26.9, -31.200000000000045, -35.90000000000001, -53.20000000000003, -21.100000000000023, -38.50000000000006, -11.399999999999979, -36.40000000000006, -31.4, -54.200000000000095, -13.799999999999985, -12.399999999999977, -52.600000000000044, -54.10000000000004, -30.5, -12.299999999999983, -50.40000000000004, -38.20000000000005, -11.299999999999986, -33.199999999999996, -37.700000000000074, -31.800000000000054, -38.900000000000055, -13.999999999999977, -13.99999999999998, -152.29999999999976, -31.1, -51.10000000000006, -44.90000000000001, -31.0, -39.400000000000055, -38.70000000000007, -12.499999999999975, -14.499999999999977, -62.30000000000008, -15.399999999999972, -32.20000000000003, -59.200000000000045, -38.5, -25.5, -43.00000000000007, -13.699999999999974, -51.10000000000005, -29.200000000000006, -63.500000000000064, -14.099999999999975, -30.500000000000043, -42.40000000000008, -28.099999999999998, -10.99999999999998, -12.199999999999983, -42.700000000000024, -23.300000000000033, -10.699999999999982, -10.599999999999978, -98.79999999999986, -25.900000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1792327919519214, "mean_inference_ms": 1.017729004092259, "mean_action_processing_ms": 0.401450492722722, "mean_env_wait_ms": 4.52864883244937, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 776000, "timesteps_this_iter": 0, "agent_timesteps_total": 776000, "timers": {"sample_time_ms": 24469.663, "sample_throughput": 163.468, "load_time_ms": 0.384, "load_throughput": 10409639.511, "learn_time_ms": 4806.854, "learn_throughput": 832.145}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.846761401677896e-28, "cur_lr": 0.00010000000000000003, "total_loss": 1.1985548654831546, "policy_loss": 0.0014007057954547226, "vf_loss": 119.71541866589618, "vf_explained_var": 0.07166391950781627, "kl": 0.0036828055480585035, "entropy": 0.21174354194475697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 776000, "num_agent_steps_sampled": 776000, "num_steps_trained": 776000, "num_agent_steps_trained": 776000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7760, "training_iteration": 194, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-49-19", "timestamp": 1651067359, "time_this_iter_s": 24.061052083969116, "time_total_s": 6411.221173048019, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6411.221173048019, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 28.303125, "ram_util_percent": 95.4375}}
{"episode_reward_max": -10.599999999999978, "episode_reward_min": -152.29999999999976, "episode_reward_mean": -34.47300000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.600000000000005, -11.099999999999982, -49.60000000000003, -26.9, -31.200000000000045, -35.90000000000001, -53.20000000000003, -21.100000000000023, -38.50000000000006, -11.399999999999979, -36.40000000000006, -31.4, -54.200000000000095, -13.799999999999985, -12.399999999999977, -52.600000000000044, -54.10000000000004, -30.5, -12.299999999999983, -50.40000000000004, -38.20000000000005, -11.299999999999986, -33.199999999999996, -37.700000000000074, -31.800000000000054, -38.900000000000055, -13.999999999999977, -13.99999999999998, -152.29999999999976, -31.1, -51.10000000000006, -44.90000000000001, -31.0, -39.400000000000055, -38.70000000000007, -12.499999999999975, -14.499999999999977, -62.30000000000008, -15.399999999999972, -32.20000000000003, -59.200000000000045, -38.5, -25.5, -43.00000000000007, -13.699999999999974, -51.10000000000005, -29.200000000000006, -63.500000000000064, -14.099999999999975, -30.500000000000043, -42.40000000000008, -28.099999999999998, -10.99999999999998, -12.199999999999983, -42.700000000000024, -23.300000000000033, -10.699999999999982, -10.599999999999978, -98.79999999999986, -25.900000000000006, -39.80000000000001, -63.40000000000004, -11.499999999999979, -57.5000000000001, -12.099999999999973, -11.499999999999975, -29.400000000000006, -28.6, -31.900000000000045, -27.6, -20.0, -11.799999999999981, -37.599999999999994, -53.00000000000009, -51.100000000000044, -65.80000000000007, -34.70000000000003, -31.400000000000006, -88.89999999999998, -43.30000000000006, -31.50000000000005, -22.200000000000003, -15.299999999999972, -39.30000000000011, -50.60000000000004, -42.70000000000009, -23.600000000000048, -31.40000000000001, -49.00000000000006, -38.9, -37.80000000000002, -31.200000000000056, -10.999999999999982, -13.899999999999975, -37.0, -26.200000000000003, -33.600000000000016, -31.30000000000004, -35.60000000000006, -31.200000000000017], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.176703458783206, "mean_inference_ms": 1.017043042041467, "mean_action_processing_ms": 0.3995689107630458, "mean_env_wait_ms": 4.522111255146168, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 780000, "timesteps_this_iter": 0, "agent_timesteps_total": 780000, "timers": {"sample_time_ms": 24347.109, "sample_throughput": 164.291, "load_time_ms": 0.386, "load_throughput": 10374878.486, "learn_time_ms": 4760.071, "learn_throughput": 840.324}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.423380700838948e-28, "cur_lr": 0.00010000000000000003, "total_loss": 0.6299094042966082, "policy_loss": 0.0022138489370224297, "vf_loss": 62.769556314201765, "vf_explained_var": 0.056228324482517855, "kl": 0.005582437506731433, "entropy": 0.14497174995711012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 780000, "num_agent_steps_sampled": 780000, "num_steps_trained": 780000, "num_agent_steps_trained": 780000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7800, "training_iteration": 195, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-49-44", "timestamp": 1651067384, "time_this_iter_s": 24.68053698539734, "time_total_s": 6435.901710033417, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6435.901710033417, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 21.545454545454547, "ram_util_percent": 95.45454545454547}}
{"episode_reward_max": -9.599999999999985, "episode_reward_min": -182.49999999999966, "episode_reward_mean": -34.24, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-59.200000000000045, -38.5, -25.5, -43.00000000000007, -13.699999999999974, -51.10000000000005, -29.200000000000006, -63.500000000000064, -14.099999999999975, -30.500000000000043, -42.40000000000008, -28.099999999999998, -10.99999999999998, -12.199999999999983, -42.700000000000024, -23.300000000000033, -10.699999999999982, -10.599999999999978, -98.79999999999986, -25.900000000000006, -39.80000000000001, -63.40000000000004, -11.499999999999979, -57.5000000000001, -12.099999999999973, -11.499999999999975, -29.400000000000006, -28.6, -31.900000000000045, -27.6, -20.0, -11.799999999999981, -37.599999999999994, -53.00000000000009, -51.100000000000044, -65.80000000000007, -34.70000000000003, -31.400000000000006, -88.89999999999998, -43.30000000000006, -31.50000000000005, -22.200000000000003, -15.299999999999972, -39.30000000000011, -50.60000000000004, -42.70000000000009, -23.600000000000048, -31.40000000000001, -49.00000000000006, -38.9, -37.80000000000002, -31.200000000000056, -10.999999999999982, -13.899999999999975, -37.0, -26.200000000000003, -33.600000000000016, -31.30000000000004, -35.60000000000006, -31.200000000000017, -14.199999999999996, -30.799999999999997, -48.80000000000004, -37.1, -49.40000000000005, -26.900000000000016, -52.50000000000003, -26.800000000000033, -9.599999999999985, -12.799999999999985, -27.500000000000032, -51.30000000000006, -14.69999999999998, -48.400000000000055, -51.60000000000006, -13.199999999999994, -48.80000000000006, -22.300000000000058, -14.799999999999969, -51.60000000000003, -17.799999999999997, -24.000000000000018, -11.499999999999975, -33.7, -12.399999999999988, -19.800000000000004, -12.699999999999982, -12.599999999999989, -52.10000000000004, -35.6, -55.30000000000003, -14.399999999999974, -29.000000000000007, -27.700000000000003, -33.40000000000001, -54.30000000000006, -30.200000000000024, -40.000000000000064, -182.49999999999966, -13.699999999999974], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1745482628028057, "mean_inference_ms": 1.0166452344380859, "mean_action_processing_ms": 0.39771509799372395, "mean_env_wait_ms": 4.5161588269126165, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 784000, "timesteps_this_iter": 0, "agent_timesteps_total": 784000, "timers": {"sample_time_ms": 24228.999, "sample_throughput": 165.091, "load_time_ms": 0.268, "load_throughput": 14898513.454, "learn_time_ms": 4787.585, "learn_throughput": 835.494}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.423380700838948e-28, "cur_lr": 0.00010000000000000003, "total_loss": 1.3038846828539166, "policy_loss": -0.00808304016308118, "vf_loss": 131.1967741884211, "vf_explained_var": 0.009702890919100853, "kl": 0.0056730477648162985, "entropy": 0.1862147113248225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 784000, "num_agent_steps_sampled": 784000, "num_steps_trained": 784000, "num_agent_steps_trained": 784000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7840, "training_iteration": 196, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-50-10", "timestamp": 1651067410, "time_this_iter_s": 26.5486581325531, "time_total_s": 6462.45036816597, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6462.45036816597, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 38.92499999999999, "ram_util_percent": 95.50555555555553}}
{"episode_reward_max": -9.599999999999985, "episode_reward_min": -795.8000000000012, "episode_reward_mean": -41.304000000000016, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.50000000000005, -22.200000000000003, -15.299999999999972, -39.30000000000011, -50.60000000000004, -42.70000000000009, -23.600000000000048, -31.40000000000001, -49.00000000000006, -38.9, -37.80000000000002, -31.200000000000056, -10.999999999999982, -13.899999999999975, -37.0, -26.200000000000003, -33.600000000000016, -31.30000000000004, -35.60000000000006, -31.200000000000017, -14.199999999999996, -30.799999999999997, -48.80000000000004, -37.1, -49.40000000000005, -26.900000000000016, -52.50000000000003, -26.800000000000033, -9.599999999999985, -12.799999999999985, -27.500000000000032, -51.30000000000006, -14.69999999999998, -48.400000000000055, -51.60000000000006, -13.199999999999994, -48.80000000000006, -22.300000000000058, -14.799999999999969, -51.60000000000003, -17.799999999999997, -24.000000000000018, -11.499999999999975, -33.7, -12.399999999999988, -19.800000000000004, -12.699999999999982, -12.599999999999989, -52.10000000000004, -35.6, -55.30000000000003, -14.399999999999974, -29.000000000000007, -27.700000000000003, -33.40000000000001, -54.30000000000006, -30.200000000000024, -40.000000000000064, -182.49999999999966, -13.699999999999974, -13.49999999999999, -12.799999999999986, -14.499999999999975, -13.6, -58.4000000000001, -40.70000000000002, -795.8000000000012, -54.00000000000009, -26.200000000000014, -15.199999999999983, -23.60000000000001, -11.299999999999985, -27.700000000000006, -11.199999999999978, -28.500000000000053, -44.90000000000005, -51.50000000000005, -40.400000000000006, -11.19999999999999, -42.900000000000006, -35.40000000000002, -83.09999999999985, -52.10000000000002, -148.59999999999977, -53.10000000000008, -24.700000000000063, -52.50000000000004, -51.50000000000003, -32.599999999999966, -37.90000000000008, -11.99999999999998, -30.900000000000013, -15.19999999999999, -11.699999999999978, -52.200000000000045, -12.799999999999981, -11.999999999999977, -49.20000000000004, -12.399999999999983, -13.499999999999986], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1724139336963142, "mean_inference_ms": 1.0163825691831079, "mean_action_processing_ms": 0.39588296877335194, "mean_env_wait_ms": 4.5103746902167225, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 788000, "timesteps_this_iter": 0, "agent_timesteps_total": 788000, "timers": {"sample_time_ms": 24447.231, "sample_throughput": 163.618, "load_time_ms": 0.266, "load_throughput": 15021233.772, "learn_time_ms": 4837.157, "learn_throughput": 826.932}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.423380700838948e-28, "cur_lr": 0.00010000000000000003, "total_loss": 30.684012743283905, "policy_loss": -0.026664451406567646, "vf_loss": 3071.0678045067734, "vf_explained_var": -0.11392572778527454, "kl": 0.01511454610159561, "entropy": 0.25182849366796173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 788000, "num_agent_steps_sampled": 788000, "num_steps_trained": 788000, "num_agent_steps_trained": 788000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7880, "training_iteration": 197, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-50-35", "timestamp": 1651067435, "time_this_iter_s": 24.741892099380493, "time_total_s": 6487.19226026535, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6487.19226026535, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 30.991176470588236, "ram_util_percent": 95.39411764705883}}
{"episode_reward_max": -11.199999999999978, "episode_reward_min": -795.8000000000012, "episode_reward_mean": -46.910000000000025, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.799999999999997, -24.000000000000018, -11.499999999999975, -33.7, -12.399999999999988, -19.800000000000004, -12.699999999999982, -12.599999999999989, -52.10000000000004, -35.6, -55.30000000000003, -14.399999999999974, -29.000000000000007, -27.700000000000003, -33.40000000000001, -54.30000000000006, -30.200000000000024, -40.000000000000064, -182.49999999999966, -13.699999999999974, -13.49999999999999, -12.799999999999986, -14.499999999999975, -13.6, -58.4000000000001, -40.70000000000002, -795.8000000000012, -54.00000000000009, -26.200000000000014, -15.199999999999983, -23.60000000000001, -11.299999999999985, -27.700000000000006, -11.199999999999978, -28.500000000000053, -44.90000000000005, -51.50000000000005, -40.400000000000006, -11.19999999999999, -42.900000000000006, -35.40000000000002, -83.09999999999985, -52.10000000000002, -148.59999999999977, -53.10000000000008, -24.700000000000063, -52.50000000000004, -51.50000000000003, -32.599999999999966, -37.90000000000008, -11.99999999999998, -30.900000000000013, -15.19999999999999, -11.699999999999978, -52.200000000000045, -12.799999999999981, -11.999999999999977, -49.20000000000004, -12.399999999999983, -13.499999999999986, -38.4, -42.300000000000075, -46.00000000000004, -12.899999999999977, -37.1, -11.299999999999981, -51.40000000000007, -147.4, -32.40000000000001, -11.899999999999975, -31.200000000000003, -270.90000000000003, -53.60000000000003, -41.90000000000006, -34.3, -31.699999999999996, -13.599999999999989, -40.100000000000065, -39.90000000000005, -37.4, -23.300000000000004, -27.700000000000006, -51.80000000000005, -17.7, -12.399999999999986, -33.20000000000002, -49.80000000000005, -50.90000000000008, -160.19999999999973, -26.1, -11.89999999999998, -47.20000000000006, -52.40000000000004, -51.40000000000004, -51.30000000000004, -51.100000000000044, -14.6, -43.00000000000004, -12.199999999999976, -33.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1702108236607314, "mean_inference_ms": 1.0158932603452655, "mean_action_processing_ms": 0.3940627930951861, "mean_env_wait_ms": 4.504065825844611, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 792000, "timesteps_this_iter": 0, "agent_timesteps_total": 792000, "timers": {"sample_time_ms": 24663.809, "sample_throughput": 162.181, "load_time_ms": 0.266, "load_throughput": 15046830.493, "learn_time_ms": 4802.568, "learn_throughput": 832.888}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.423380700838948e-28, "cur_lr": 0.00010000000000000003, "total_loss": 5.143581358816034, "policy_loss": -0.01498440250238624, "vf_loss": 515.856585186784, "vf_explained_var": 0.052909678669386014, "kl": 0.01300891792196766, "entropy": 0.19382388761006697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 792000, "num_agent_steps_sampled": 792000, "num_steps_trained": 792000, "num_agent_steps_trained": 792000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7920, "training_iteration": 198, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-50-58", "timestamp": 1651067458, "time_this_iter_s": 23.240018129348755, "time_total_s": 6510.432278394699, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6510.432278394699, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 17.83870967741936, "ram_util_percent": 95.48064516129033}}
{"episode_reward_max": -9.699999999999982, "episode_reward_min": -270.90000000000003, "episode_reward_mean": -41.82900000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.40000000000002, -83.09999999999985, -52.10000000000002, -148.59999999999977, -53.10000000000008, -24.700000000000063, -52.50000000000004, -51.50000000000003, -32.599999999999966, -37.90000000000008, -11.99999999999998, -30.900000000000013, -15.19999999999999, -11.699999999999978, -52.200000000000045, -12.799999999999981, -11.999999999999977, -49.20000000000004, -12.399999999999983, -13.499999999999986, -38.4, -42.300000000000075, -46.00000000000004, -12.899999999999977, -37.1, -11.299999999999981, -51.40000000000007, -147.4, -32.40000000000001, -11.899999999999975, -31.200000000000003, -270.90000000000003, -53.60000000000003, -41.90000000000006, -34.3, -31.699999999999996, -13.599999999999989, -40.100000000000065, -39.90000000000005, -37.4, -23.300000000000004, -27.700000000000006, -51.80000000000005, -17.7, -12.399999999999986, -33.20000000000002, -49.80000000000005, -50.90000000000008, -160.19999999999973, -26.1, -11.89999999999998, -47.20000000000006, -52.40000000000004, -51.40000000000004, -51.30000000000004, -51.100000000000044, -14.6, -43.00000000000004, -12.199999999999976, -33.1, -39.100000000000065, -37.90000000000006, -15.89999999999998, -10.99999999999999, -46.900000000000034, -13.799999999999985, -42.70000000000007, -14.699999999999992, -11.699999999999978, -47.20000000000007, -31.00000000000001, -15.19999999999999, -12.799999999999985, -14.89999999999998, -49.50000000000005, -157.59999999999974, -48.80000000000005, -12.29999999999999, -35.69999999999999, -120.0, -69.70000000000003, -39.20000000000001, -38.300000000000026, -61.50000000000007, -37.10000000000005, -53.10000000000003, -52.50000000000004, -14.599999999999973, -53.40000000000003, -33.8, -10.599999999999985, -20.0, -51.80000000000005, -47.000000000000064, -48.500000000000036, -9.699999999999982, -30.60000000000003, -34.600000000000065, -13.399999999999988, -44.40000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.167758370576198, "mean_inference_ms": 1.015173565648316, "mean_action_processing_ms": 0.39225424008743187, "mean_env_wait_ms": 4.497428208399557, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 796000, "timesteps_this_iter": 0, "agent_timesteps_total": 796000, "timers": {"sample_time_ms": 24352.103, "sample_throughput": 164.257, "load_time_ms": 0.251, "load_throughput": 15922194.173, "learn_time_ms": 4695.93, "learn_throughput": 851.801}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.423380700838948e-28, "cur_lr": 0.00010000000000000003, "total_loss": 1.3959211524200414, "policy_loss": -0.007163991072084955, "vf_loss": 140.30851707868678, "vf_explained_var": -0.16393323694505998, "kl": 0.004477473638656721, "entropy": 0.21800848810022236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 796000, "num_agent_steps_sampled": 796000, "num_steps_trained": 796000, "num_agent_steps_trained": 796000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 7960, "training_iteration": 199, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-51-22", "timestamp": 1651067482, "time_this_iter_s": 23.470417022705078, "time_total_s": 6533.902695417404, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6533.902695417404, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 21.8125, "ram_util_percent": 95.453125}}
{"episode_reward_max": -9.699999999999982, "episode_reward_min": -160.19999999999973, "episode_reward_mean": -37.869000000000014, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.300000000000004, -27.700000000000006, -51.80000000000005, -17.7, -12.399999999999986, -33.20000000000002, -49.80000000000005, -50.90000000000008, -160.19999999999973, -26.1, -11.89999999999998, -47.20000000000006, -52.40000000000004, -51.40000000000004, -51.30000000000004, -51.100000000000044, -14.6, -43.00000000000004, -12.199999999999976, -33.1, -39.100000000000065, -37.90000000000006, -15.89999999999998, -10.99999999999999, -46.900000000000034, -13.799999999999985, -42.70000000000007, -14.699999999999992, -11.699999999999978, -47.20000000000007, -31.00000000000001, -15.19999999999999, -12.799999999999985, -14.89999999999998, -49.50000000000005, -157.59999999999974, -48.80000000000005, -12.29999999999999, -35.69999999999999, -120.0, -69.70000000000003, -39.20000000000001, -38.300000000000026, -61.50000000000007, -37.10000000000005, -53.10000000000003, -52.50000000000004, -14.599999999999973, -53.40000000000003, -33.8, -10.599999999999985, -20.0, -51.80000000000005, -47.000000000000064, -48.500000000000036, -9.699999999999982, -30.60000000000003, -34.600000000000065, -13.399999999999988, -44.40000000000007, -49.30000000000007, -46.00000000000008, -33.000000000000014, -38.40000000000002, -37.3, -50.70000000000003, -40.90000000000007, -39.800000000000004, -15.099999999999977, -35.0, -32.2, -51.50000000000004, -51.50000000000005, -48.70000000000003, -12.999999999999979, -11.199999999999976, -10.599999999999978, -41.80000000000006, -69.6, -30.00000000000001, -34.70000000000007, -28.800000000000004, -11.699999999999982, -52.70000000000012, -50.90000000000004, -77.29999999999997, -48.20000000000005, -23.20000000000004, -12.399999999999986, -29.700000000000006, -40.60000000000004, -38.00000000000008, -19.70000000000001, -13.599999999999971, -11.499999999999996, -35.80000000000005, -12.299999999999983, -50.20000000000005, -51.20000000000004, -35.00000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1652513259297195, "mean_inference_ms": 1.0144808900296096, "mean_action_processing_ms": 0.3904638636554642, "mean_env_wait_ms": 4.4910589504266785, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 800000, "timesteps_this_iter": 0, "agent_timesteps_total": 800000, "timers": {"sample_time_ms": 24333.148, "sample_throughput": 164.385, "load_time_ms": 0.258, "load_throughput": 15495719.959, "learn_time_ms": 4766.249, "learn_throughput": 839.234}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.211690350419474e-28, "cur_lr": 0.00010000000000000003, "total_loss": 0.719585530796609, "policy_loss": -0.0020030592352912953, "vf_loss": 72.15886004560737, "vf_explained_var": -0.052545136982394804, "kl": 0.00344182992930093, "entropy": 0.13238829517416575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 800000, "num_agent_steps_sampled": 800000, "num_steps_trained": 800000, "num_agent_steps_trained": 800000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8000, "training_iteration": 200, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-51-47", "timestamp": 1651067507, "time_this_iter_s": 25.217200994491577, "time_total_s": 6559.119896411896, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6559.119896411896, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 26.285714285714285, "ram_util_percent": 94.65714285714286}}
{"episode_reward_max": -9.699999999999982, "episode_reward_min": -86.89999999999996, "episode_reward_mean": -37.67300000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-69.70000000000003, -39.20000000000001, -38.300000000000026, -61.50000000000007, -37.10000000000005, -53.10000000000003, -52.50000000000004, -14.599999999999973, -53.40000000000003, -33.8, -10.599999999999985, -20.0, -51.80000000000005, -47.000000000000064, -48.500000000000036, -9.699999999999982, -30.60000000000003, -34.600000000000065, -13.399999999999988, -44.40000000000007, -49.30000000000007, -46.00000000000008, -33.000000000000014, -38.40000000000002, -37.3, -50.70000000000003, -40.90000000000007, -39.800000000000004, -15.099999999999977, -35.0, -32.2, -51.50000000000004, -51.50000000000005, -48.70000000000003, -12.999999999999979, -11.199999999999976, -10.599999999999978, -41.80000000000006, -69.6, -30.00000000000001, -34.70000000000007, -28.800000000000004, -11.699999999999982, -52.70000000000012, -50.90000000000004, -77.29999999999997, -48.20000000000005, -23.20000000000004, -12.399999999999986, -29.700000000000006, -40.60000000000004, -38.00000000000008, -19.70000000000001, -13.599999999999971, -11.499999999999996, -35.80000000000005, -12.299999999999983, -50.20000000000005, -51.20000000000004, -35.00000000000005, -36.80000000000006, -38.60000000000005, -11.999999999999977, -10.799999999999978, -39.50000000000007, -35.700000000000024, -46.70000000000003, -39.500000000000014, -49.80000000000003, -11.099999999999978, -53.00000000000007, -41.90000000000007, -41.1, -47.400000000000006, -49.900000000000055, -49.70000000000006, -10.399999999999979, -36.70000000000003, -26.500000000000004, -46.90000000000004, -50.90000000000004, -40.70000000000005, -86.89999999999996, -61.70000000000007, -40.80000000000006, -52.70000000000004, -26.700000000000006, -52.29999999999994, -12.799999999999974, -51.900000000000055, -49.00000000000005, -37.30000000000007, -49.90000000000005, -41.300000000000026, -51.800000000000054, -50.10000000000005, -12.799999999999976, -40.40000000000006, -12.299999999999976, -34.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1629657652314151, "mean_inference_ms": 1.0140248608359055, "mean_action_processing_ms": 0.38870008598159117, "mean_env_wait_ms": 4.485325784694711, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 804000, "timesteps_this_iter": 0, "agent_timesteps_total": 804000, "timers": {"sample_time_ms": 24617.343, "sample_throughput": 162.487, "load_time_ms": 0.256, "load_throughput": 15647468.756, "learn_time_ms": 4804.907, "learn_throughput": 832.482}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.05845175209737e-29, "cur_lr": 0.00010000000000000003, "total_loss": 0.719519440500286, "policy_loss": -0.0030147044774225, "vf_loss": 72.25341594860117, "vf_explained_var": 0.16365860630107182, "kl": 0.004157517550301121, "entropy": 0.10983564740488737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 804000, "num_agent_steps_sampled": 804000, "num_steps_trained": 804000, "num_agent_steps_trained": 804000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8040, "training_iteration": 201, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-52-13", "timestamp": 1651067533, "time_this_iter_s": 25.9017493724823, "time_total_s": 6585.021645784378, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6585.021645784378, "timesteps_since_restore": 0, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 31.548571428571424, "ram_util_percent": 94.09142857142855}}
{"episode_reward_max": -9.799999999999997, "episode_reward_min": -113.0999999999999, "episode_reward_mean": -37.32400000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.70000000000007, -28.800000000000004, -11.699999999999982, -52.70000000000012, -50.90000000000004, -77.29999999999997, -48.20000000000005, -23.20000000000004, -12.399999999999986, -29.700000000000006, -40.60000000000004, -38.00000000000008, -19.70000000000001, -13.599999999999971, -11.499999999999996, -35.80000000000005, -12.299999999999983, -50.20000000000005, -51.20000000000004, -35.00000000000005, -36.80000000000006, -38.60000000000005, -11.999999999999977, -10.799999999999978, -39.50000000000007, -35.700000000000024, -46.70000000000003, -39.500000000000014, -49.80000000000003, -11.099999999999978, -53.00000000000007, -41.90000000000007, -41.1, -47.400000000000006, -49.900000000000055, -49.70000000000006, -10.399999999999979, -36.70000000000003, -26.500000000000004, -46.90000000000004, -50.90000000000004, -40.70000000000005, -86.89999999999996, -61.70000000000007, -40.80000000000006, -52.70000000000004, -26.700000000000006, -52.29999999999994, -12.799999999999974, -51.900000000000055, -49.00000000000005, -37.30000000000007, -49.90000000000005, -41.300000000000026, -51.800000000000054, -50.10000000000005, -12.799999999999976, -40.40000000000006, -12.299999999999976, -34.1, -26.900000000000006, -25.9, -42.40000000000007, -56.80000000000009, -42.4, -13.499999999999996, -52.80000000000004, -52.80000000000003, -48.50000000000004, -49.800000000000054, -15.899999999999993, -14.59999999999997, -15.799999999999978, -52.80000000000009, -35.100000000000065, -51.20000000000004, -43.200000000000024, -113.0999999999999, -11.399999999999979, -52.60000000000005, -49.30000000000006, -9.799999999999997, -48.300000000000054, -16.099999999999994, -44.900000000000006, -43.900000000000034, -11.599999999999982, -14.499999999999991, -28.400000000000034, -44.60000000000003, -37.60000000000003, -19.800000000000022, -51.400000000000034, -40.900000000000006, -15.399999999999997, -21.400000000000034, -30.700000000000056, -36.10000000000001, -49.60000000000006, -42.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1606562889989953, "mean_inference_ms": 1.0133396968697885, "mean_action_processing_ms": 0.38694740442259645, "mean_env_wait_ms": 4.47934997032441, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 808000, "timesteps_this_iter": 0, "agent_timesteps_total": 808000, "timers": {"sample_time_ms": 24479.954, "sample_throughput": 163.399, "load_time_ms": 0.255, "load_throughput": 15689905.546, "learn_time_ms": 4832.846, "learn_throughput": 827.67}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.029225876048685e-29, "cur_lr": 0.00010000000000000003, "total_loss": 0.8931587179386687, "policy_loss": -0.003911477742936983, "vf_loss": 89.70702137280536, "vf_explained_var": 0.047679191571409985, "kl": 0.006671696720117291, "entropy": 0.13589722050212433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 808000, "num_agent_steps_sampled": 808000, "num_steps_trained": 808000, "num_agent_steps_trained": 808000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8080, "training_iteration": 202, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-52-36", "timestamp": 1651067556, "time_this_iter_s": 23.16292381286621, "time_total_s": 6608.184569597244, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6608.184569597244, "timesteps_since_restore": 0, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 27.131249999999998, "ram_util_percent": 94.13125}}
{"episode_reward_max": -9.799999999999997, "episode_reward_min": -158.6999999999997, "episode_reward_mean": -38.71500000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.90000000000004, -40.70000000000005, -86.89999999999996, -61.70000000000007, -40.80000000000006, -52.70000000000004, -26.700000000000006, -52.29999999999994, -12.799999999999974, -51.900000000000055, -49.00000000000005, -37.30000000000007, -49.90000000000005, -41.300000000000026, -51.800000000000054, -50.10000000000005, -12.799999999999976, -40.40000000000006, -12.299999999999976, -34.1, -26.900000000000006, -25.9, -42.40000000000007, -56.80000000000009, -42.4, -13.499999999999996, -52.80000000000004, -52.80000000000003, -48.50000000000004, -49.800000000000054, -15.899999999999993, -14.59999999999997, -15.799999999999978, -52.80000000000009, -35.100000000000065, -51.20000000000004, -43.200000000000024, -113.0999999999999, -11.399999999999979, -52.60000000000005, -49.30000000000006, -9.799999999999997, -48.300000000000054, -16.099999999999994, -44.900000000000006, -43.900000000000034, -11.599999999999982, -14.499999999999991, -28.400000000000034, -44.60000000000003, -37.60000000000003, -19.800000000000022, -51.400000000000034, -40.900000000000006, -15.399999999999997, -21.400000000000034, -30.700000000000056, -36.10000000000001, -49.60000000000006, -42.7, -20.500000000000043, -51.6, -45.100000000000065, -41.100000000000044, -44.30000000000005, -40.600000000000065, -14.599999999999971, -10.899999999999986, -23.900000000000006, -49.000000000000036, -29.000000000000007, -33.70000000000002, -73.00000000000003, -38.60000000000006, -25.900000000000006, -49.90000000000006, -39.0, -52.30000000000005, -158.6999999999997, -39.60000000000004, -12.799999999999978, -50.30000000000003, -37.500000000000014, -52.200000000000045, -11.399999999999977, -13.399999999999999, -38.800000000000054, -51.40000000000004, -23.50000000000004, -36.20000000000007, -42.400000000000006, -23.500000000000007, -15.799999999999976, -50.40000000000006, -37.30000000000002, -15.299999999999997, -46.90000000000004, -51.600000000000044, -22.500000000000032, -26.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1582865095327715, "mean_inference_ms": 1.0123986324783083, "mean_action_processing_ms": 0.38520384482719877, "mean_env_wait_ms": 4.472936965556276, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 812000, "timesteps_this_iter": 0, "agent_timesteps_total": 812000, "timers": {"sample_time_ms": 24483.174, "sample_throughput": 163.378, "load_time_ms": 0.263, "load_throughput": 15210531.278, "learn_time_ms": 4793.333, "learn_throughput": 834.492}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.029225876048685e-29, "cur_lr": 0.00010000000000000003, "total_loss": 1.176661864373212, "policy_loss": -0.0022764604698906664, "vf_loss": 117.893835548688, "vf_explained_var": 0.12969006492245583, "kl": 0.0030006955029039297, "entropy": 0.08949988636698934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 812000, "num_agent_steps_sampled": 812000, "num_steps_trained": 812000, "num_agent_steps_trained": 812000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8120, "training_iteration": 203, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-52-59", "timestamp": 1651067579, "time_this_iter_s": 23.136193990707397, "time_total_s": 6631.320763587952, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6631.320763587952, "timesteps_since_restore": 0, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 25.70322580645162, "ram_util_percent": 94.09032258064515}}
{"episode_reward_max": -9.799999999999997, "episode_reward_min": -158.6999999999997, "episode_reward_mean": -36.801000000000016, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.30000000000006, -9.799999999999997, -48.300000000000054, -16.099999999999994, -44.900000000000006, -43.900000000000034, -11.599999999999982, -14.499999999999991, -28.400000000000034, -44.60000000000003, -37.60000000000003, -19.800000000000022, -51.400000000000034, -40.900000000000006, -15.399999999999997, -21.400000000000034, -30.700000000000056, -36.10000000000001, -49.60000000000006, -42.7, -20.500000000000043, -51.6, -45.100000000000065, -41.100000000000044, -44.30000000000005, -40.600000000000065, -14.599999999999971, -10.899999999999986, -23.900000000000006, -49.000000000000036, -29.000000000000007, -33.70000000000002, -73.00000000000003, -38.60000000000006, -25.900000000000006, -49.90000000000006, -39.0, -52.30000000000005, -158.6999999999997, -39.60000000000004, -12.799999999999978, -50.30000000000003, -37.500000000000014, -52.200000000000045, -11.399999999999977, -13.399999999999999, -38.800000000000054, -51.40000000000004, -23.50000000000004, -36.20000000000007, -42.400000000000006, -23.500000000000007, -15.799999999999976, -50.40000000000006, -37.30000000000002, -15.299999999999997, -46.90000000000004, -51.600000000000044, -22.500000000000032, -26.1, -11.499999999999995, -28.600000000000016, -23.600000000000026, -37.20000000000002, -61.30000000000003, -44.70000000000006, -14.599999999999998, -13.899999999999975, -49.899999999999935, -46.19999999999996, -36.19999999999997, -14.399999999999977, -49.80000000000005, -52.800000000000054, -109.39999999999989, -12.699999999999996, -11.6, -42.7, -34.30000000000006, -17.799999999999997, -12.999999999999979, -49.80000000000006, -28.199999999999996, -49.00000000000004, -11.399999999999979, -146.09999999999977, -51.000000000000036, -11.39999999999998, -52.30000000000005, -16.599999999999987, -67.00000000000006, -49.80000000000003, -29.700000000000028, -10.39999999999998, -49.70000000000004, -36.700000000000045, -11.799999999999978, -36.6, -38.2, -10.599999999999982], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1557786735018454, "mean_inference_ms": 1.0113668946074095, "mean_action_processing_ms": 0.3834728708828943, "mean_env_wait_ms": 4.466412821015767, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 816000, "timesteps_this_iter": 0, "agent_timesteps_total": 816000, "timers": {"sample_time_ms": 24348.39, "sample_throughput": 164.282, "load_time_ms": 0.26, "load_throughput": 15408905.217, "learn_time_ms": 4805.881, "learn_throughput": 832.314}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.5146129380243426e-29, "cur_lr": 0.00010000000000000003, "total_loss": 1.3731880781230748, "policy_loss": -0.002184383621219025, "vf_loss": 137.53724895907988, "vf_explained_var": 0.07503035504330871, "kl": 0.003459745621029238, "entropy": 0.13748822036569797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 816000, "num_agent_steps_sampled": 816000, "num_steps_trained": 816000, "num_agent_steps_trained": 816000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8160, "training_iteration": 204, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-53-22", "timestamp": 1651067602, "time_this_iter_s": 23.2474308013916, "time_total_s": 6654.568194389343, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6654.568194389343, "timesteps_since_restore": 0, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 19.45161290322581, "ram_util_percent": 94.06129032258062}}
{"episode_reward_max": -10.39999999999998, "episode_reward_min": -146.09999999999977, "episode_reward_mean": -35.09300000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.799999999999978, -50.30000000000003, -37.500000000000014, -52.200000000000045, -11.399999999999977, -13.399999999999999, -38.800000000000054, -51.40000000000004, -23.50000000000004, -36.20000000000007, -42.400000000000006, -23.500000000000007, -15.799999999999976, -50.40000000000006, -37.30000000000002, -15.299999999999997, -46.90000000000004, -51.600000000000044, -22.500000000000032, -26.1, -11.499999999999995, -28.600000000000016, -23.600000000000026, -37.20000000000002, -61.30000000000003, -44.70000000000006, -14.599999999999998, -13.899999999999975, -49.899999999999935, -46.19999999999996, -36.19999999999997, -14.399999999999977, -49.80000000000005, -52.800000000000054, -109.39999999999989, -12.699999999999996, -11.6, -42.7, -34.30000000000006, -17.799999999999997, -12.999999999999979, -49.80000000000006, -28.199999999999996, -49.00000000000004, -11.399999999999979, -146.09999999999977, -51.000000000000036, -11.39999999999998, -52.30000000000005, -16.599999999999987, -67.00000000000006, -49.80000000000003, -29.700000000000028, -10.39999999999998, -49.70000000000004, -36.700000000000045, -11.799999999999978, -36.6, -38.2, -10.599999999999982, -12.699999999999994, -52.80000000000009, -55.30000000000009, -24.900000000000006, -50.20000000000006, -40.40000000000006, -43.90000000000007, -12.399999999999979, -45.50000000000008, -42.20000000000006, -11.29999999999998, -34.30000000000004, -34.0, -66.80000000000013, -53.80000000000008, -12.19999999999998, -29.400000000000034, -37.50000000000003, -52.00000000000003, -13.2, -20.599999999999994, -29.300000000000008, -12.699999999999976, -24.300000000000004, -50.500000000000064, -51.40000000000005, -26.300000000000004, -45.60000000000005, -26.20000000000003, -49.60000000000009, -50.90000000000004, -36.50000000000006, -14.499999999999972, -13.699999999999994, -12.399999999999979, -12.399999999999979, -52.20000000000005, -51.000000000000036, -49.200000000000074, -13.399999999999975], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1532447858471733, "mean_inference_ms": 1.0103772100576827, "mean_action_processing_ms": 0.3817592598419358, "mean_env_wait_ms": 4.459911258915371, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 820000, "timesteps_this_iter": 0, "agent_timesteps_total": 820000, "timers": {"sample_time_ms": 24219.527, "sample_throughput": 165.156, "load_time_ms": 0.261, "load_throughput": 15348290.184, "learn_time_ms": 4750.363, "learn_throughput": 842.041}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 7.573064690121713e-30, "cur_lr": 0.00010000000000000003, "total_loss": 0.6291143145573685, "policy_loss": -0.004572744465242791, "vf_loss": 63.36870700569563, "vf_explained_var": 0.003000964400588825, "kl": 0.00484196581961307, "entropy": 0.10491947532351059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 820000, "num_agent_steps_sampled": 820000, "num_steps_trained": 820000, "num_agent_steps_trained": 820000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 8200, "training_iteration": 205, "trial_id": "e2333_00000", "experiment_id": "4fecf9522ef74e478d06ff5615c32b11", "date": "2022-04-27_14-53-45", "timestamp": 1651067625, "time_this_iter_s": 22.699100017547607, "time_total_s": 6677.267294406891, "pid": 83150, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 6677.267294406891, "timesteps_since_restore": 0, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 17.406451612903226, "ram_util_percent": 94.07419354838707}}
