{"episode_reward_max": -10.79999999999999, "episode_reward_min": -339.3999999999997, "episode_reward_mean": -118.225, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-212.5, -206.9, -125.89999999999996, -118.0, -105.09999999999977, -161.70000000000002, -339.3999999999997, -82.7, -58.80000000000004, -10.79999999999999, -124.4, -73.7, -131.2, -111.4, -119.6, -223.89999999999998, -65.10000000000008, -144.1999999999999, -103.60000000000005, -36.70000000000003, -55.6, -123.19999999999979, -104.8, -81.80000000000003, -10.899999999999993, -129.7, -55.300000000000004, -115.79999999999981, -129.2, -17.799999999999994, -90.50000000000014, -162.3, -164.89999999999998, -31.20000000000005, -120.79999999999993, -210.7000000000005, -19.600000000000016, -323.8000000000008, -122.10000000000001, -103.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5421242812847203, "mean_inference_ms": 0.7574618443701453, "mean_action_processing_ms": 0.030732458753902837, "mean_env_wait_ms": 2.9987859833213695, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 4000, "timesteps_this_iter": 0, "agent_timesteps_total": 4000, "timers": {"sample_time_ms": 17365.824, "sample_throughput": 230.337, "load_time_ms": 0.248, "load_throughput": 16116441.883, "learn_time_ms": 4206.077, "learn_throughput": 951.005}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 32.89343829078059, "policy_loss": -0.0050960240144562975, "vf_loss": 3289.5380844936576, "vf_explained_var": 0.00265490290939167, "kl": 0.015770232976327278, "entropy": 1.3708849263447587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 4000, "num_agent_steps_sampled": 4000, "num_steps_trained": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 40, "training_iteration": 1, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-15-56", "timestamp": 1651050956, "time_this_iter_s": 21.547571897506714, "time_total_s": 21.547571897506714, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 21.547571897506714, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 13.806666666666667, "ram_util_percent": 92.50333333333334}}
{"episode_reward_max": -10.79999999999999, "episode_reward_min": -449.9000000000003, "episode_reward_mean": -114.07624999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-212.5, -206.9, -125.89999999999996, -118.0, -105.09999999999977, -161.70000000000002, -339.3999999999997, -82.7, -58.80000000000004, -10.79999999999999, -124.4, -73.7, -131.2, -111.4, -119.6, -223.89999999999998, -65.10000000000008, -144.1999999999999, -103.60000000000005, -36.70000000000003, -55.6, -123.19999999999979, -104.8, -81.80000000000003, -10.899999999999993, -129.7, -55.300000000000004, -115.79999999999981, -129.2, -17.799999999999994, -90.50000000000014, -162.3, -164.89999999999998, -31.20000000000005, -120.79999999999993, -210.7000000000005, -19.600000000000016, -323.8000000000008, -122.10000000000001, -103.4, -112.19999999999999, -112.6, -103.69999999999997, -216.49999999999977, -126.19999999999985, -178.79999999999956, -150.49999999999983, -169.19999999999982, -119.3, -107.39999999999974, -112.9, -116.79999999999973, -18.699999999999992, -129.2, -11.499999999999993, -121.00000000000003, -117.09999999999994, -83.2, -23.400000000000016, -66.8, -61.9, -203.29999999999973, -27.800000000000047, -41.8, -90.59999999999987, -104.5, -449.9000000000003, -71.39999999999999, -46.1, -93.19999999999999, -140.6, -19.69999999999999, -95.6, -160.49999999999991, -78.60000000000011, -92.10000000000001, -126.9999999999998, -117.5, -94.0, -84.00000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564702027375112, "mean_inference_ms": 0.7734653305604556, "mean_action_processing_ms": 0.03143452714084787, "mean_env_wait_ms": 3.048168901889314, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 8000, "timesteps_this_iter": 0, "agent_timesteps_total": 8000, "timers": {"sample_time_ms": 20113.397, "sample_throughput": 198.872, "load_time_ms": 0.249, "load_throughput": 16054752.153, "learn_time_ms": 4418.765, "learn_throughput": 905.23}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 28.745644077716737, "policy_loss": 0.0013938665420057312, "vf_loss": 2874.1763756454634, "vf_explained_var": 0.0002517920668407153, "kl": 0.012435347915755924, "entropy": 1.348899386262381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 8000, "num_agent_steps_sampled": 8000, "num_steps_trained": 8000, "num_agent_steps_trained": 8000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 80, "training_iteration": 2, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-16-19", "timestamp": 1651050979, "time_this_iter_s": 23.257405996322632, "time_total_s": 44.804977893829346, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 44.804977893829346, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 15.36875, "ram_util_percent": 92.55937499999999}}
{"episode_reward_max": -10.899999999999993, "episode_reward_min": -449.9000000000003, "episode_reward_mean": -104.93699999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-55.6, -123.19999999999979, -104.8, -81.80000000000003, -10.899999999999993, -129.7, -55.300000000000004, -115.79999999999981, -129.2, -17.799999999999994, -90.50000000000014, -162.3, -164.89999999999998, -31.20000000000005, -120.79999999999993, -210.7000000000005, -19.600000000000016, -323.8000000000008, -122.10000000000001, -103.4, -112.19999999999999, -112.6, -103.69999999999997, -216.49999999999977, -126.19999999999985, -178.79999999999956, -150.49999999999983, -169.19999999999982, -119.3, -107.39999999999974, -112.9, -116.79999999999973, -18.699999999999992, -129.2, -11.499999999999993, -121.00000000000003, -117.09999999999994, -83.2, -23.400000000000016, -66.8, -61.9, -203.29999999999973, -27.800000000000047, -41.8, -90.59999999999987, -104.5, -449.9000000000003, -71.39999999999999, -46.1, -93.19999999999999, -140.6, -19.69999999999999, -95.6, -160.49999999999991, -78.60000000000011, -92.10000000000001, -126.9999999999998, -117.5, -94.0, -84.00000000000001, -108.69999999999987, -21.400000000000013, -181.69999999999953, -96.5, -18.499999999999993, -88.6, -92.10000000000001, -92.59999999999995, -199.60000000000005, -135.39999999999995, -153.59999999999957, -119.30000000000004, -80.0, -157.90000000000015, -104.69999999999995, -80.89999999999999, -16.299999999999986, -109.7, -21.500000000000004, -127.6000000000001, -151.4, -69.7, -141.9999999999998, -106.5, -149.2, -15.999999999999982, -115.3, -89.4, -113.5, -69.00000000000006, -103.19999999999999, -113.40000000000003, -161.4, -110.2, -99.6, -13.199999999999976, -12.399999999999995, -104.30000000000001, -83.89999999999996, -92.9999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5656928686946805, "mean_inference_ms": 0.7700227941229713, "mean_action_processing_ms": 0.03155371219910388, "mean_env_wait_ms": 3.0493319875365743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 12000, "timesteps_this_iter": 0, "agent_timesteps_total": 12000, "timers": {"sample_time_ms": 20540.834, "sample_throughput": 194.734, "load_time_ms": 0.243, "load_throughput": 16480565.815, "learn_time_ms": 4544.699, "learn_throughput": 880.146}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 10.161858286524332, "policy_loss": 0.0019280337027564485, "vf_loss": 1015.7321541570848, "vf_explained_var": 0.0017465465812272923, "kl": 0.013044684443801618, "entropy": 1.3070547146181906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 12000, "num_agent_steps_sampled": 12000, "num_steps_trained": 12000, "num_agent_steps_trained": 12000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 120, "training_iteration": 3, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-16-41", "timestamp": 1651051001, "time_this_iter_s": 21.53999376296997, "time_total_s": 66.34497165679932, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 66.34497165679932, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 16.713333333333335, "ram_util_percent": 92.51}}
{"episode_reward_max": -9.799999999999995, "episode_reward_min": -747.3999999999994, "episode_reward_mean": -108.54899999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-61.9, -203.29999999999973, -27.800000000000047, -41.8, -90.59999999999987, -104.5, -449.9000000000003, -71.39999999999999, -46.1, -93.19999999999999, -140.6, -19.69999999999999, -95.6, -160.49999999999991, -78.60000000000011, -92.10000000000001, -126.9999999999998, -117.5, -94.0, -84.00000000000001, -108.69999999999987, -21.400000000000013, -181.69999999999953, -96.5, -18.499999999999993, -88.6, -92.10000000000001, -92.59999999999995, -199.60000000000005, -135.39999999999995, -153.59999999999957, -119.30000000000004, -80.0, -157.90000000000015, -104.69999999999995, -80.89999999999999, -16.299999999999986, -109.7, -21.500000000000004, -127.6000000000001, -151.4, -69.7, -141.9999999999998, -106.5, -149.2, -15.999999999999982, -115.3, -89.4, -113.5, -69.00000000000006, -103.19999999999999, -113.40000000000003, -161.4, -110.2, -99.6, -13.199999999999976, -12.399999999999995, -104.30000000000001, -83.89999999999996, -92.9999999999999, -84.39999999999999, -167.79999999999967, -103.9, -422.89999999999975, -77.5, -84.1000000000002, -24.300000000000015, -178.6000000000002, -224.79999999999993, -75.49999999999996, -72.40000000000002, -148.9, -119.50000000000011, -118.19999999999993, -83.60000000000001, -88.79999999999994, -93.6, -9.799999999999995, -69.2, -76.1, -104.3, -105.1, -92.1, -87.0, -132.80000000000004, -107.5, -747.3999999999994, -21.599999999999994, -22.100000000000023, -93.60000000000015, -73.60000000000002, -78.40000000000002, -74.10000000000001, -113.39999999999985, -61.1, -128.1, -73.09999999999992, -115.19999999999979, -18.1, -159.09999999999982], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5709222285922096, "mean_inference_ms": 0.760636806562141, "mean_action_processing_ms": 0.03145622146823417, "mean_env_wait_ms": 3.047100813798424, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 16000, "timesteps_this_iter": 0, "agent_timesteps_total": 16000, "timers": {"sample_time_ms": 21026.987, "sample_throughput": 190.232, "load_time_ms": 0.247, "load_throughput": 16163021.195, "learn_time_ms": 4439.344, "learn_throughput": 901.034}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 51.261322666624544, "policy_loss": -0.0019679089106859698, "vf_loss": 5126.116919732863, "vf_explained_var": -0.012877260420912055, "kl": 0.01060955318886123, "entropy": 1.2690021103428255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 16000, "num_agent_steps_sampled": 16000, "num_steps_trained": 16000, "num_agent_steps_trained": 16000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 160, "training_iteration": 4, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-17-03", "timestamp": 1651051023, "time_this_iter_s": 21.794877290725708, "time_total_s": 88.13984894752502, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 88.13984894752502, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.400000000000002, "ram_util_percent": 92.63448275862068}}
{"episode_reward_max": -9.799999999999995, "episode_reward_min": -747.3999999999994, "episode_reward_mean": -101.81299999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151.4, -69.7, -141.9999999999998, -106.5, -149.2, -15.999999999999982, -115.3, -89.4, -113.5, -69.00000000000006, -103.19999999999999, -113.40000000000003, -161.4, -110.2, -99.6, -13.199999999999976, -12.399999999999995, -104.30000000000001, -83.89999999999996, -92.9999999999999, -84.39999999999999, -167.79999999999967, -103.9, -422.89999999999975, -77.5, -84.1000000000002, -24.300000000000015, -178.6000000000002, -224.79999999999993, -75.49999999999996, -72.40000000000002, -148.9, -119.50000000000011, -118.19999999999993, -83.60000000000001, -88.79999999999994, -93.6, -9.799999999999995, -69.2, -76.1, -104.3, -105.1, -92.1, -87.0, -132.80000000000004, -107.5, -747.3999999999994, -21.599999999999994, -22.100000000000023, -93.60000000000015, -73.60000000000002, -78.40000000000002, -74.10000000000001, -113.39999999999985, -61.1, -128.1, -73.09999999999992, -115.19999999999979, -18.1, -159.09999999999982, -90.70000000000002, -145.89999999999984, -99.8, -71.90000000000002, -156.0, -84.2, -98.30000000000011, -62.5, -105.09999999999992, -46.50000000000007, -124.89999999999978, -37.70000000000001, -92.20000000000003, -72.1, -23.40000000000002, -55.1, -95.7, -80.1, -90.8, -46.1, -110.2, -23.200000000000003, -160.5, -65.8, -78.5, -67.5, -116.09999999999975, -116.59999999999982, -67.60000000000007, -85.00000000000006, -84.6, -53.3, -105.7999999999998, -91.39999999999982, -84.1, -119.3, -162.9, -54.4, -59.10000000000009, -148.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5722440564679284, "mean_inference_ms": 0.7543706651755144, "mean_action_processing_ms": 0.03131105867723066, "mean_env_wait_ms": 3.0370380577253986, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 20000, "timesteps_this_iter": 0, "agent_timesteps_total": 20000, "timers": {"sample_time_ms": 21197.732, "sample_throughput": 188.699, "load_time_ms": 0.285, "load_throughput": 14037161.981, "learn_time_ms": 4481.415, "learn_throughput": 892.575}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.6766355452998996, "policy_loss": 0.0021758146884460604, "vf_loss": 567.2810676328597, "vf_explained_var": -0.002467950826050133, "kl": 0.008245776460611937, "entropy": 1.275678221000138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 20000, "num_agent_steps_sampled": 20000, "num_steps_trained": 20000, "num_agent_steps_trained": 20000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 200, "training_iteration": 5, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-17-25", "timestamp": 1651051045, "time_this_iter_s": 22.3899929523468, "time_total_s": 110.52984189987183, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 110.52984189987183, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.693548387096772, "ram_util_percent": 92.60645161290324}}
{"episode_reward_max": -13.899999999999984, "episode_reward_min": -747.3999999999994, "episode_reward_mean": -93.92299999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-104.3, -105.1, -92.1, -87.0, -132.80000000000004, -107.5, -747.3999999999994, -21.599999999999994, -22.100000000000023, -93.60000000000015, -73.60000000000002, -78.40000000000002, -74.10000000000001, -113.39999999999985, -61.1, -128.1, -73.09999999999992, -115.19999999999979, -18.1, -159.09999999999982, -90.70000000000002, -145.89999999999984, -99.8, -71.90000000000002, -156.0, -84.2, -98.30000000000011, -62.5, -105.09999999999992, -46.50000000000007, -124.89999999999978, -37.70000000000001, -92.20000000000003, -72.1, -23.40000000000002, -55.1, -95.7, -80.1, -90.8, -46.1, -110.2, -23.200000000000003, -160.5, -65.8, -78.5, -67.5, -116.09999999999975, -116.59999999999982, -67.60000000000007, -85.00000000000006, -84.6, -53.3, -105.7999999999998, -91.39999999999982, -84.1, -119.3, -162.9, -54.4, -59.10000000000009, -148.2, -92.59999999999998, -13.899999999999984, -74.80000000000001, -60.9, -15.599999999999993, -22.500000000000007, -22.50000000000002, -194.79999999999959, -69.39999999999999, -68.10000000000002, -106.69999999999999, -74.2, -70.20000000000007, -131.4, -96.7, -139.8, -89.99999999999991, -97.7999999999999, -123.7, -142.89999999999992, -107.7999999999998, -150.29999999999959, -64.40000000000003, -136.4999999999998, -92.2, -82.80000000000001, -30.300000000000054, -93.4999999999999, -105.2999999999998, -78.4, -90.7, -37.70000000000003, -54.80000000000001, -118.70000000000005, -70.8, -77.80000000000001, -106.19999999999982, -86.9, -123.89999999999999, -34.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5748180901343559, "mean_inference_ms": 0.7577346317331808, "mean_action_processing_ms": 0.031362332499864046, "mean_env_wait_ms": 3.0424219027917996, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 24000, "timesteps_this_iter": 0, "agent_timesteps_total": 24000, "timers": {"sample_time_ms": 21452.217, "sample_throughput": 186.461, "load_time_ms": 0.279, "load_throughput": 14347676.169, "learn_time_ms": 4425.81, "learn_throughput": 903.789}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.688958147264296, "policy_loss": 0.0016493479831404584, "vf_loss": 568.4297153595955, "vf_explained_var": 0.05217445922154252, "kl": 0.015058752078629107, "entropy": 1.291542016306231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 24000, "num_agent_steps_sampled": 24000, "num_steps_trained": 24000, "num_agent_steps_trained": 24000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 240, "training_iteration": 6, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-17-47", "timestamp": 1651051067, "time_this_iter_s": 22.205240726470947, "time_total_s": 132.73508262634277, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 132.73508262634277, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 10.196666666666667, "ram_util_percent": 92.48333333333333}}
{"episode_reward_max": -13.49999999999999, "episode_reward_min": -264.59999999999997, "episode_reward_mean": -95.44499999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-110.2, -23.200000000000003, -160.5, -65.8, -78.5, -67.5, -116.09999999999975, -116.59999999999982, -67.60000000000007, -85.00000000000006, -84.6, -53.3, -105.7999999999998, -91.39999999999982, -84.1, -119.3, -162.9, -54.4, -59.10000000000009, -148.2, -92.59999999999998, -13.899999999999984, -74.80000000000001, -60.9, -15.599999999999993, -22.500000000000007, -22.50000000000002, -194.79999999999959, -69.39999999999999, -68.10000000000002, -106.69999999999999, -74.2, -70.20000000000007, -131.4, -96.7, -139.8, -89.99999999999991, -97.7999999999999, -123.7, -142.89999999999992, -107.7999999999998, -150.29999999999959, -64.40000000000003, -136.4999999999998, -92.2, -82.80000000000001, -30.300000000000054, -93.4999999999999, -105.2999999999998, -78.4, -90.7, -37.70000000000003, -54.80000000000001, -118.70000000000005, -70.8, -77.80000000000001, -106.19999999999982, -86.9, -123.89999999999999, -34.0, -164.1999999999997, -81.2, -116.9, -68.7, -77.7, -72.9, -98.5, -117.69999999999969, -16.999999999999996, -88.19999999999978, -106.49999999999991, -102.4, -102.79999999999988, -145.79999999999967, -73.90000000000002, -264.59999999999997, -88.4, -146.29999999999995, -109.89999999999974, -29.799999999999997, -13.49999999999999, -130.8, -50.599999999999994, -136.1999999999999, -14.299999999999997, -78.29999999999991, -69.10000000000001, -112.79999999999976, -260.6000000000004, -55.50000000000001, -84.49999999999993, -259.60000000000014, -78.6, -93.3, -176.2, -121.6, -152.0000000000002, -85.89999999999995, -177.09999999999982, -14.999999999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5790727908570347, "mean_inference_ms": 0.7562888338605237, "mean_action_processing_ms": 0.031256402977389366, "mean_env_wait_ms": 3.0360708377172556, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 28000, "timesteps_this_iter": 0, "agent_timesteps_total": 28000, "timers": {"sample_time_ms": 21389.9, "sample_throughput": 187.004, "load_time_ms": 0.272, "load_throughput": 14691082.312, "learn_time_ms": 4373.102, "learn_throughput": 914.683}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 14.32120454324189, "policy_loss": 0.004493685951957139, "vf_loss": 1431.4792812962685, "vf_explained_var": 0.033411389717491725, "kl": 0.009592080496214303, "entropy": 1.2586706425554008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 28000, "num_agent_steps_sampled": 28000, "num_steps_trained": 28000, "num_agent_steps_trained": 28000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 280, "training_iteration": 7, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-18-08", "timestamp": 1651051088, "time_this_iter_s": 20.890278100967407, "time_total_s": 153.62536072731018, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 153.62536072731018, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.682758620689658, "ram_util_percent": 92.52413793103447}}
{"episode_reward_max": -11.399999999999991, "episode_reward_min": -264.59999999999997, "episode_reward_mean": -92.03699999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-107.7999999999998, -150.29999999999959, -64.40000000000003, -136.4999999999998, -92.2, -82.80000000000001, -30.300000000000054, -93.4999999999999, -105.2999999999998, -78.4, -90.7, -37.70000000000003, -54.80000000000001, -118.70000000000005, -70.8, -77.80000000000001, -106.19999999999982, -86.9, -123.89999999999999, -34.0, -164.1999999999997, -81.2, -116.9, -68.7, -77.7, -72.9, -98.5, -117.69999999999969, -16.999999999999996, -88.19999999999978, -106.49999999999991, -102.4, -102.79999999999988, -145.79999999999967, -73.90000000000002, -264.59999999999997, -88.4, -146.29999999999995, -109.89999999999974, -29.799999999999997, -13.49999999999999, -130.8, -50.599999999999994, -136.1999999999999, -14.299999999999997, -78.29999999999991, -69.10000000000001, -112.79999999999976, -260.6000000000004, -55.50000000000001, -84.49999999999993, -259.60000000000014, -78.6, -93.3, -176.2, -121.6, -152.0000000000002, -85.89999999999995, -177.09999999999982, -14.999999999999995, -92.2, -71.3, -58.9, -11.399999999999991, -61.50000000000007, -196.20000000000041, -111.69999999999992, -57.10000000000005, -102.79999999999997, -75.5, -74.8, -65.69999999999997, -131.5, -75.00000000000003, -67.5, -20.300000000000022, -54.60000000000003, -161.9, -99.09999999999992, -41.50000000000007, -24.400000000000027, -122.89999999999982, -133.19999999999987, -72.10000000000001, -79.4, -12.799999999999992, -83.80000000000001, -103.5999999999999, -133.79999999999973, -114.79999999999984, -78.80000000000001, -82.19999999999993, -15.299999999999992, -17.60000000000001, -112.69999999999992, -75.50000000000003, -212.70000000000022, -21.000000000000032, -23.80000000000003, -70.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5820263024207238, "mean_inference_ms": 0.7541982096025381, "mean_action_processing_ms": 0.031168332711359627, "mean_env_wait_ms": 3.0301636441099014, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 32000, "timesteps_this_iter": 0, "agent_timesteps_total": 32000, "timers": {"sample_time_ms": 21457.738, "sample_throughput": 186.413, "load_time_ms": 0.27, "load_throughput": 14829049.608, "learn_time_ms": 4391.219, "learn_throughput": 910.909}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 5.9984157141818795, "policy_loss": -0.0027734634696796375, "vf_loss": 599.8594148369245, "vf_explained_var": -0.05108911600164188, "kl": 0.012975800408214586, "entropy": 1.2332789054480933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 32000, "num_agent_steps_sampled": 32000, "num_steps_trained": 32000, "num_agent_steps_trained": 32000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 320, "training_iteration": 8, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-18-31", "timestamp": 1651051111, "time_this_iter_s": 22.37736225128174, "time_total_s": 176.00272297859192, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 176.00272297859192, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 23.296774193548387, "ram_util_percent": 92.60967741935481}}
{"episode_reward_max": -11.399999999999991, "episode_reward_min": -410.5000000000002, "episode_reward_mean": -86.66599999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.49999999999999, -130.8, -50.599999999999994, -136.1999999999999, -14.299999999999997, -78.29999999999991, -69.10000000000001, -112.79999999999976, -260.6000000000004, -55.50000000000001, -84.49999999999993, -259.60000000000014, -78.6, -93.3, -176.2, -121.6, -152.0000000000002, -85.89999999999995, -177.09999999999982, -14.999999999999995, -92.2, -71.3, -58.9, -11.399999999999991, -61.50000000000007, -196.20000000000041, -111.69999999999992, -57.10000000000005, -102.79999999999997, -75.5, -74.8, -65.69999999999997, -131.5, -75.00000000000003, -67.5, -20.300000000000022, -54.60000000000003, -161.9, -99.09999999999992, -41.50000000000007, -24.400000000000027, -122.89999999999982, -133.19999999999987, -72.10000000000001, -79.4, -12.799999999999992, -83.80000000000001, -103.5999999999999, -133.79999999999973, -114.79999999999984, -78.80000000000001, -82.19999999999993, -15.299999999999992, -17.60000000000001, -112.69999999999992, -75.50000000000003, -212.70000000000022, -21.000000000000032, -23.80000000000003, -70.9, -108.99999999999989, -101.1999999999998, -13.299999999999986, -40.900000000000006, -95.50000000000001, -36.6, -14.799999999999986, -124.79999999999974, -112.19999999999996, -60.40000000000005, -80.0, -107.7, -89.80000000000001, -14.199999999999992, -71.20000000000013, -106.80000000000001, -66.90000000000006, -88.49999999999987, -18.499999999999993, -61.40000000000008, -13.099999999999993, -117.6999999999997, -11.499999999999998, -102.50000000000001, -117.8, -106.20000000000002, -71.09999999999995, -63.6, -86.1, -410.5000000000002, -121.3, -46.30000000000004, -11.999999999999995, -93.69999999999999, -71.10000000000014, -66.20000000000006, -96.8, -24.900000000000034, -116.0, -117.2], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5835772157858135, "mean_inference_ms": 0.7520730435348001, "mean_action_processing_ms": 0.031106296113477944, "mean_env_wait_ms": 3.023893783777447, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 36000, "timesteps_this_iter": 0, "agent_timesteps_total": 36000, "timers": {"sample_time_ms": 21491.137, "sample_throughput": 186.123, "load_time_ms": 0.277, "load_throughput": 14423053.205, "learn_time_ms": 4366.825, "learn_throughput": 915.997}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 13.727634374172457, "policy_loss": 0.0019288789160469527, "vf_loss": 1372.4228413571593, "vf_explained_var": 0.06973173823407901, "kl": 0.007386514996576871, "entropy": 1.2350785855324038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 36000, "num_agent_steps_sampled": 36000, "num_steps_trained": 36000, "num_agent_steps_trained": 36000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 360, "training_iteration": 9, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-18-52", "timestamp": 1651051132, "time_this_iter_s": 21.39134693145752, "time_total_s": 197.39406991004944, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 197.39406991004944, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 19.282758620689656, "ram_util_percent": 92.56551724137931}}
{"episode_reward_max": -11.499999999999998, "episode_reward_min": -410.5000000000002, "episode_reward_mean": -75.82499999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.400000000000027, -122.89999999999982, -133.19999999999987, -72.10000000000001, -79.4, -12.799999999999992, -83.80000000000001, -103.5999999999999, -133.79999999999973, -114.79999999999984, -78.80000000000001, -82.19999999999993, -15.299999999999992, -17.60000000000001, -112.69999999999992, -75.50000000000003, -212.70000000000022, -21.000000000000032, -23.80000000000003, -70.9, -108.99999999999989, -101.1999999999998, -13.299999999999986, -40.900000000000006, -95.50000000000001, -36.6, -14.799999999999986, -124.79999999999974, -112.19999999999996, -60.40000000000005, -80.0, -107.7, -89.80000000000001, -14.199999999999992, -71.20000000000013, -106.80000000000001, -66.90000000000006, -88.49999999999987, -18.499999999999993, -61.40000000000008, -13.099999999999993, -117.6999999999997, -11.499999999999998, -102.50000000000001, -117.8, -106.20000000000002, -71.09999999999995, -63.6, -86.1, -410.5000000000002, -121.3, -46.30000000000004, -11.999999999999995, -93.69999999999999, -71.10000000000014, -66.20000000000006, -96.8, -24.900000000000034, -116.0, -117.2, -16.79999999999999, -18.299999999999997, -63.30000000000001, -53.10000000000001, -50.400000000000006, -79.2, -41.5, -58.000000000000014, -84.00000000000003, -37.2, -23.500000000000025, -71.5, -123.59999999999974, -109.8, -38.10000000000002, -70.90000000000003, -58.100000000000065, -64.2, -65.90000000000005, -133.39999999999986, -119.29999999999993, -59.600000000000044, -91.5, -77.5, -18.000000000000004, -73.5, -87.09999999999992, -55.900000000000006, -142.1, -16.499999999999993, -44.099999999999994, -102.3, -79.4, -133.6, -107.9, -94.8, -15.89999999999998, -49.5, -68.50000000000003, -14.099999999999985], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5874380124390186, "mean_inference_ms": 0.7490215699871982, "mean_action_processing_ms": 0.031021700560703733, "mean_env_wait_ms": 3.019569743712767, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 40000, "timesteps_this_iter": 0, "agent_timesteps_total": 40000, "timers": {"sample_time_ms": 21506.863, "sample_throughput": 185.987, "load_time_ms": 0.295, "load_throughput": 13558441.894, "learn_time_ms": 4372.86, "learn_throughput": 914.733}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.8389362836396823, "policy_loss": -0.0016592464051760172, "vf_loss": 383.8674923230243, "vf_explained_var": -0.006396843476962018, "kl": 0.009603406914093459, "entropy": 1.1821192092792963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 40000, "num_agent_steps_sampled": 40000, "num_steps_trained": 40000, "num_agent_steps_trained": 40000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 400, "training_iteration": 10, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-19-14", "timestamp": 1651051154, "time_this_iter_s": 21.889431715011597, "time_total_s": 219.28350162506104, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 219.28350162506104, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 31.262068965517237, "ram_util_percent": 92.63793103448273}}
{"episode_reward_max": -11.499999999999998, "episode_reward_min": -410.5000000000002, "episode_reward_mean": -77.823, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.099999999999993, -117.6999999999997, -11.499999999999998, -102.50000000000001, -117.8, -106.20000000000002, -71.09999999999995, -63.6, -86.1, -410.5000000000002, -121.3, -46.30000000000004, -11.999999999999995, -93.69999999999999, -71.10000000000014, -66.20000000000006, -96.8, -24.900000000000034, -116.0, -117.2, -16.79999999999999, -18.299999999999997, -63.30000000000001, -53.10000000000001, -50.400000000000006, -79.2, -41.5, -58.000000000000014, -84.00000000000003, -37.2, -23.500000000000025, -71.5, -123.59999999999974, -109.8, -38.10000000000002, -70.90000000000003, -58.100000000000065, -64.2, -65.90000000000005, -133.39999999999986, -119.29999999999993, -59.600000000000044, -91.5, -77.5, -18.000000000000004, -73.5, -87.09999999999992, -55.900000000000006, -142.1, -16.499999999999993, -44.099999999999994, -102.3, -79.4, -133.6, -107.9, -94.8, -15.89999999999998, -49.5, -68.50000000000003, -14.099999999999985, -19.9, -81.80000000000001, -55.2, -38.400000000000006, -65.9, -56.10000000000002, -59.2, -87.8, -70.30000000000001, -87.6, -109.29999999999995, -66.1, -151.6, -79.9, -78.6, -44.20000000000001, -58.7, -99.7, -87.29999999999988, -92.9, -25.299999999999997, -84.5, -120.69999999999996, -71.1, -66.60000000000002, -100.1, -158.9, -99.2, -96.1, -104.0, -85.5, -90.7, -15.799999999999997, -58.20000000000009, -95.8, -129.1, -106.4, -14.399999999999995, -141.2, -50.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5914151732641537, "mean_inference_ms": 0.7456737085908935, "mean_action_processing_ms": 0.030944835862971684, "mean_env_wait_ms": 3.0205315842288165, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 44000, "timesteps_this_iter": 0, "agent_timesteps_total": 44000, "timers": {"sample_time_ms": 22026.816, "sample_throughput": 181.597, "load_time_ms": 0.3, "load_throughput": 13334299.793, "learn_time_ms": 4474.22, "learn_throughput": 894.011}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.955360319217046, "policy_loss": -0.0032090867098460915, "vf_loss": 395.6480512229345, "vf_explained_var": 0.17698741632123147, "kl": 0.010444794015220896, "entropy": 1.1217455986366478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 44000, "num_agent_steps_sampled": 44000, "num_steps_trained": 44000, "num_agent_steps_trained": 44000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 440, "training_iteration": 11, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-19-37", "timestamp": 1651051177, "time_this_iter_s": 23.297518968582153, "time_total_s": 242.5810205936432, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 242.5810205936432, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.715624999999996, "ram_util_percent": 92.73125}}
{"episode_reward_max": -13.49999999999999, "episode_reward_min": -158.9, "episode_reward_mean": -72.17600000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-119.29999999999993, -59.600000000000044, -91.5, -77.5, -18.000000000000004, -73.5, -87.09999999999992, -55.900000000000006, -142.1, -16.499999999999993, -44.099999999999994, -102.3, -79.4, -133.6, -107.9, -94.8, -15.89999999999998, -49.5, -68.50000000000003, -14.099999999999985, -19.9, -81.80000000000001, -55.2, -38.400000000000006, -65.9, -56.10000000000002, -59.2, -87.8, -70.30000000000001, -87.6, -109.29999999999995, -66.1, -151.6, -79.9, -78.6, -44.20000000000001, -58.7, -99.7, -87.29999999999988, -92.9, -25.299999999999997, -84.5, -120.69999999999996, -71.1, -66.60000000000002, -100.1, -158.9, -99.2, -96.1, -104.0, -85.5, -90.7, -15.799999999999997, -58.20000000000009, -95.8, -129.1, -106.4, -14.399999999999995, -141.2, -50.7, -58.599999999999994, -54.6, -109.50000000000001, -56.699999999999996, -69.60000000000007, -70.80000000000004, -146.89999999999972, -88.89999999999992, -90.10000000000001, -40.300000000000004, -61.6, -35.2, -61.80000000000007, -74.29999999999994, -144.8, -82.50000000000006, -48.70000000000001, -85.20000000000002, -41.500000000000064, -15.899999999999984, -88.2, -15.19999999999999, -18.199999999999996, -115.79999999999998, -86.4, -76.7, -40.900000000000006, -63.30000000000007, -48.9, -59.40000000000007, -13.49999999999999, -15.499999999999984, -72.80000000000001, -113.00000000000003, -35.2, -15.299999999999983, -80.60000000000001, -54.599999999999994, -35.699999999999996, -75.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5957756144485173, "mean_inference_ms": 0.7479220225141694, "mean_action_processing_ms": 0.03102519504267427, "mean_env_wait_ms": 3.03087471009305, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 48000, "timesteps_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"sample_time_ms": 22180.13, "sample_throughput": 180.342, "load_time_ms": 0.3, "load_throughput": 13334299.793, "learn_time_ms": 4411.553, "learn_throughput": 906.71}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 2.7331740936284423, "policy_loss": 0.0012843697922684813, "vf_loss": 273.0305215568953, "vf_explained_var": -0.04371418997805605, "kl": 0.00792271791580568, "entropy": 1.0414438985368257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 48000, "num_agent_steps_sampled": 48000, "num_steps_trained": 48000, "num_agent_steps_trained": 48000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 480, "training_iteration": 12, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-20-00", "timestamp": 1651051200, "time_this_iter_s": 23.14783215522766, "time_total_s": 265.72885274887085, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 265.72885274887085, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 19.42258064516129, "ram_util_percent": 92.96129032258065}}
{"episode_reward_max": -9.999999999999988, "episode_reward_min": -158.9, "episode_reward_mean": -64.047, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.299999999999997, -84.5, -120.69999999999996, -71.1, -66.60000000000002, -100.1, -158.9, -99.2, -96.1, -104.0, -85.5, -90.7, -15.799999999999997, -58.20000000000009, -95.8, -129.1, -106.4, -14.399999999999995, -141.2, -50.7, -58.599999999999994, -54.6, -109.50000000000001, -56.699999999999996, -69.60000000000007, -70.80000000000004, -146.89999999999972, -88.89999999999992, -90.10000000000001, -40.300000000000004, -61.6, -35.2, -61.80000000000007, -74.29999999999994, -144.8, -82.50000000000006, -48.70000000000001, -85.20000000000002, -41.500000000000064, -15.899999999999984, -88.2, -15.19999999999999, -18.199999999999996, -115.79999999999998, -86.4, -76.7, -40.900000000000006, -63.30000000000007, -48.9, -59.40000000000007, -13.49999999999999, -15.499999999999984, -72.80000000000001, -113.00000000000003, -35.2, -15.299999999999983, -80.60000000000001, -54.599999999999994, -35.699999999999996, -75.0, -46.20000000000009, -100.79999999999981, -82.69999999999992, -74.6, -98.79999999999987, -42.699999999999996, -39.6, -48.49999999999999, -133.8, -13.699999999999983, -27.900000000000063, -86.2, -146.5, -29.100000000000044, -44.40000000000007, -60.60000000000009, -47.00000000000002, -51.300000000000004, -16.999999999999993, -11.79999999999999, -49.80000000000007, -12.899999999999988, -28.7, -64.1, -13.79999999999999, -51.8, -26.299999999999997, -23.700000000000024, -35.8, -82.40000000000002, -13.499999999999995, -64.10000000000007, -47.20000000000001, -113.39999999999998, -48.2, -137.29999999999964, -9.999999999999988, -48.000000000000014, -11.199999999999983, -43.300000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5978945334628658, "mean_inference_ms": 0.7478732540133097, "mean_action_processing_ms": 0.03103029938777567, "mean_env_wait_ms": 3.034209160132252, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 52000, "timesteps_this_iter": 0, "agent_timesteps_total": 52000, "timers": {"sample_time_ms": 22088.603, "sample_throughput": 181.089, "load_time_ms": 0.316, "load_throughput": 12670656.295, "learn_time_ms": 4348.845, "learn_throughput": 919.784}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 2.5626166773739683, "policy_loss": -0.0008550953240163865, "vf_loss": 256.2008815437235, "vf_explained_var": 0.028266518090360907, "kl": 0.007315050679484054, "entropy": 0.9765564185316845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 52000, "num_agent_steps_sampled": 52000, "num_steps_trained": 52000, "num_agent_steps_trained": 52000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 520, "training_iteration": 13, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-20-21", "timestamp": 1651051221, "time_this_iter_s": 20.62691378593445, "time_total_s": 286.3557665348053, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 286.3557665348053, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.232142857142858, "ram_util_percent": 92.94285714285716}}
{"episode_reward_max": -9.999999999999988, "episode_reward_min": -146.5, "episode_reward_mean": -54.687000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88.2, -15.19999999999999, -18.199999999999996, -115.79999999999998, -86.4, -76.7, -40.900000000000006, -63.30000000000007, -48.9, -59.40000000000007, -13.49999999999999, -15.499999999999984, -72.80000000000001, -113.00000000000003, -35.2, -15.299999999999983, -80.60000000000001, -54.599999999999994, -35.699999999999996, -75.0, -46.20000000000009, -100.79999999999981, -82.69999999999992, -74.6, -98.79999999999987, -42.699999999999996, -39.6, -48.49999999999999, -133.8, -13.699999999999983, -27.900000000000063, -86.2, -146.5, -29.100000000000044, -44.40000000000007, -60.60000000000009, -47.00000000000002, -51.300000000000004, -16.999999999999993, -11.79999999999999, -49.80000000000007, -12.899999999999988, -28.7, -64.1, -13.79999999999999, -51.8, -26.299999999999997, -23.700000000000024, -35.8, -82.40000000000002, -13.499999999999995, -64.10000000000007, -47.20000000000001, -113.39999999999998, -48.2, -137.29999999999964, -9.999999999999988, -48.000000000000014, -11.199999999999983, -43.300000000000004, -15.099999999999996, -12.499999999999986, -73.80000000000017, -72.7, -76.3, -46.6, -35.90000000000004, -51.1, -54.00000000000002, -49.5, -77.7999999999999, -24.60000000000003, -14.999999999999995, -72.3, -67.20000000000002, -100.79999999999983, -70.99999999999997, -46.599999999999994, -14.699999999999985, -47.100000000000065, -56.90000000000007, -71.90000000000005, -35.900000000000055, -21.299999999999997, -37.50000000000007, -61.9000000000001, -69.4, -38.00000000000002, -57.40000000000008, -132.69999999999982, -39.0, -21.200000000000024, -100.99999999999999, -54.30000000000007, -56.2, -104.29999999999984, -49.80000000000001, -53.000000000000085, -87.29999999999997, -42.20000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5980246627591509, "mean_inference_ms": 0.7432915691921397, "mean_action_processing_ms": 0.030906834067777354, "mean_env_wait_ms": 3.0275706713633666, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 56000, "timesteps_this_iter": 0, "agent_timesteps_total": 56000, "timers": {"sample_time_ms": 21912.282, "sample_throughput": 182.546, "load_time_ms": 0.322, "load_throughput": 12434936.259, "learn_time_ms": 4339.925, "learn_throughput": 921.675}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 2.1940028268002694, "policy_loss": 0.0009477331803771117, "vf_loss": 219.1699830660256, "vf_explained_var": 0.10058288298627381, "kl": 0.00677649089283798, "entropy": 0.8784999989053255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 56000, "num_agent_steps_sampled": 56000, "num_steps_trained": 56000, "num_agent_steps_trained": 56000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 560, "training_iteration": 14, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-20-42", "timestamp": 1651051242, "time_this_iter_s": 20.568150997161865, "time_total_s": 306.92391753196716, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 306.92391753196716, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 14.489285714285714, "ram_util_percent": 92.90357142857145}}
{"episode_reward_max": -9.999999999999988, "episode_reward_min": -138.79999999999984, "episode_reward_mean": -59.38899999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.80000000000007, -12.899999999999988, -28.7, -64.1, -13.79999999999999, -51.8, -26.299999999999997, -23.700000000000024, -35.8, -82.40000000000002, -13.499999999999995, -64.10000000000007, -47.20000000000001, -113.39999999999998, -48.2, -137.29999999999964, -9.999999999999988, -48.000000000000014, -11.199999999999983, -43.300000000000004, -15.099999999999996, -12.499999999999986, -73.80000000000017, -72.7, -76.3, -46.6, -35.90000000000004, -51.1, -54.00000000000002, -49.5, -77.7999999999999, -24.60000000000003, -14.999999999999995, -72.3, -67.20000000000002, -100.79999999999983, -70.99999999999997, -46.599999999999994, -14.699999999999985, -47.100000000000065, -56.90000000000007, -71.90000000000005, -35.900000000000055, -21.299999999999997, -37.50000000000007, -61.9000000000001, -69.4, -38.00000000000002, -57.40000000000008, -132.69999999999982, -39.0, -21.200000000000024, -100.99999999999999, -54.30000000000007, -56.2, -104.29999999999984, -49.80000000000001, -53.000000000000085, -87.29999999999997, -42.20000000000006, -135.79999999999967, -85.70000000000002, -138.79999999999984, -55.40000000000008, -65.20000000000006, -64.30000000000003, -97.7, -57.200000000000074, -15.799999999999985, -32.9, -56.8, -57.40000000000005, -68.6, -38.50000000000001, -85.6, -97.5, -120.2, -13.099999999999993, -62.60000000000008, -127.1, -54.800000000000004, -39.60000000000001, -76.4, -89.19999999999993, -59.4, -61.90000000000001, -70.3, -45.1, -47.6, -54.0, -65.20000000000014, -75.19999999999999, -82.39999999999993, -15.099999999999978, -71.5, -15.199999999999985, -61.9, -132.0, -120.09999999999985, -84.5], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.597441754805359, "mean_inference_ms": 0.7352584299850853, "mean_action_processing_ms": 0.030688019113725592, "mean_env_wait_ms": 3.0144021774923466, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 60000, "timesteps_this_iter": 0, "agent_timesteps_total": 60000, "timers": {"sample_time_ms": 21745.646, "sample_throughput": 183.945, "load_time_ms": 0.302, "load_throughput": 13240640.833, "learn_time_ms": 4273.563, "learn_throughput": 935.987}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.00010000000000000003, "total_loss": 3.218044006536084, "policy_loss": 0.004775174135362268, "vf_loss": 321.2432187316238, "vf_explained_var": -0.015004081559437577, "kl": 0.004183611129435962, "entropy": 0.8695779135791204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 60000, "num_agent_steps_sampled": 60000, "num_steps_trained": 60000, "num_agent_steps_trained": 60000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 600, "training_iteration": 15, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-21-02", "timestamp": 1651051262, "time_this_iter_s": 20.147613048553467, "time_total_s": 327.07153058052063, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 327.07153058052063, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 13.771428571428574, "ram_util_percent": 92.90000000000002}}
{"episode_reward_max": -10.799999999999999, "episode_reward_min": -749.2, "episode_reward_mean": -70.71300000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.90000000000007, -71.90000000000005, -35.900000000000055, -21.299999999999997, -37.50000000000007, -61.9000000000001, -69.4, -38.00000000000002, -57.40000000000008, -132.69999999999982, -39.0, -21.200000000000024, -100.99999999999999, -54.30000000000007, -56.2, -104.29999999999984, -49.80000000000001, -53.000000000000085, -87.29999999999997, -42.20000000000006, -135.79999999999967, -85.70000000000002, -138.79999999999984, -55.40000000000008, -65.20000000000006, -64.30000000000003, -97.7, -57.200000000000074, -15.799999999999985, -32.9, -56.8, -57.40000000000005, -68.6, -38.50000000000001, -85.6, -97.5, -120.2, -13.099999999999993, -62.60000000000008, -127.1, -54.800000000000004, -39.60000000000001, -76.4, -89.19999999999993, -59.4, -61.90000000000001, -70.3, -45.1, -47.6, -54.0, -65.20000000000014, -75.19999999999999, -82.39999999999993, -15.099999999999978, -71.5, -15.199999999999985, -61.9, -132.0, -120.09999999999985, -84.5, -83.9, -152.39999999999975, -44.900000000000055, -121.30000000000001, -11.39999999999999, -52.50000000000003, -61.30000000000015, -197.10000000000008, -53.60000000000001, -51.600000000000044, -36.20000000000004, -134.0, -80.39999999999999, -14.099999999999996, -749.2, -12.299999999999995, -10.799999999999999, -39.500000000000014, -50.60000000000005, -84.79999999999994, -51.70000000000001, -51.7, -54.7, -23.9, -99.10000000000001, -73.30000000000001, -33.89999999999999, -51.500000000000064, -73.6, -59.90000000000008, -28.499999999999996, -125.4, -45.10000000000001, -49.10000000000007, -13.699999999999978, -22.20000000000004, -37.00000000000006, -51.10000000000008, -39.40000000000006, -55.80000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5967653892633205, "mean_inference_ms": 0.7271718946986521, "mean_action_processing_ms": 0.030470961422336965, "mean_env_wait_ms": 3.0013213884126206, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 64000, "timesteps_this_iter": 0, "agent_timesteps_total": 64000, "timers": {"sample_time_ms": 21477.65, "sample_throughput": 186.24, "load_time_ms": 0.302, "load_throughput": 13257381.272, "learn_time_ms": 4256.772, "learn_throughput": 939.679}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 38.26716598150551, "policy_loss": -0.00401072041582196, "vf_loss": 3827.0449448329146, "vf_explained_var": -0.1736017213072828, "kl": 0.00729257911035596, "entropy": 0.8472808840454266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 64000, "num_agent_steps_sampled": 64000, "num_steps_trained": 64000, "num_agent_steps_trained": 64000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 640, "training_iteration": 16, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-21-22", "timestamp": 1651051282, "time_this_iter_s": 20.01986002922058, "time_total_s": 347.0913906097412, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 347.0913906097412, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 12.19259259259259, "ram_util_percent": 92.90000000000002}}
{"episode_reward_max": -10.799999999999999, "episode_reward_min": -749.2, "episode_reward_mean": -66.59300000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.800000000000004, -39.60000000000001, -76.4, -89.19999999999993, -59.4, -61.90000000000001, -70.3, -45.1, -47.6, -54.0, -65.20000000000014, -75.19999999999999, -82.39999999999993, -15.099999999999978, -71.5, -15.199999999999985, -61.9, -132.0, -120.09999999999985, -84.5, -83.9, -152.39999999999975, -44.900000000000055, -121.30000000000001, -11.39999999999999, -52.50000000000003, -61.30000000000015, -197.10000000000008, -53.60000000000001, -51.600000000000044, -36.20000000000004, -134.0, -80.39999999999999, -14.099999999999996, -749.2, -12.299999999999995, -10.799999999999999, -39.500000000000014, -50.60000000000005, -84.79999999999994, -51.70000000000001, -51.7, -54.7, -23.9, -99.10000000000001, -73.30000000000001, -33.89999999999999, -51.500000000000064, -73.6, -59.90000000000008, -28.499999999999996, -125.4, -45.10000000000001, -49.10000000000007, -13.699999999999978, -22.20000000000004, -37.00000000000006, -51.10000000000008, -39.40000000000006, -55.80000000000003, -15.899999999999988, -31.9, -69.90000000000009, -30.10000000000003, -80.89999999999998, -141.3, -64.6, -45.100000000000094, -94.59999999999984, -78.90000000000003, -32.4, -73.7, -113.29999999999981, -78.6, -35.400000000000006, -14.899999999999988, -72.7, -18.900000000000013, -61.6000000000001, -41.90000000000007, -95.80000000000001, -47.70000000000001, -88.0, -77.4, -53.60000000000006, -46.50000000000003, -28.500000000000007, -54.70000000000006, -83.69999999999999, -47.40000000000004, -14.299999999999986, -48.100000000000065, -34.8, -19.399999999999995, -68.20000000000006, -64.20000000000007, -44.2, -47.3, -61.70000000000004, -33.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5962337021526875, "mean_inference_ms": 0.7188773869127902, "mean_action_processing_ms": 0.030250739771800008, "mean_env_wait_ms": 2.9887811165346285, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 68000, "timesteps_this_iter": 0, "agent_timesteps_total": 68000, "timers": {"sample_time_ms": 21375.82, "sample_throughput": 187.127, "load_time_ms": 0.332, "load_throughput": 12062996.836, "learn_time_ms": 4249.093, "learn_throughput": 941.377}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 2.1987287532898687, "policy_loss": 0.003363888983124046, "vf_loss": 219.48519395397557, "vf_explained_var": -0.07225891133790376, "kl": 0.005129755249214469, "entropy": 0.8751065850898784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 68000, "num_agent_steps_sampled": 68000, "num_steps_trained": 68000, "num_agent_steps_trained": 68000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 680, "training_iteration": 17, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-21-42", "timestamp": 1651051302, "time_this_iter_s": 19.980900764465332, "time_total_s": 367.07229137420654, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 367.07229137420654, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 8.049999999999999, "ram_util_percent": 92.90000000000002}}
{"episode_reward_max": -10.999999999999991, "episode_reward_min": -143.0999999999997, "episode_reward_mean": -54.09600000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.70000000000001, -51.7, -54.7, -23.9, -99.10000000000001, -73.30000000000001, -33.89999999999999, -51.500000000000064, -73.6, -59.90000000000008, -28.499999999999996, -125.4, -45.10000000000001, -49.10000000000007, -13.699999999999978, -22.20000000000004, -37.00000000000006, -51.10000000000008, -39.40000000000006, -55.80000000000003, -15.899999999999988, -31.9, -69.90000000000009, -30.10000000000003, -80.89999999999998, -141.3, -64.6, -45.100000000000094, -94.59999999999984, -78.90000000000003, -32.4, -73.7, -113.29999999999981, -78.6, -35.400000000000006, -14.899999999999988, -72.7, -18.900000000000013, -61.6000000000001, -41.90000000000007, -95.80000000000001, -47.70000000000001, -88.0, -77.4, -53.60000000000006, -46.50000000000003, -28.500000000000007, -54.70000000000006, -83.69999999999999, -47.40000000000004, -14.299999999999986, -48.100000000000065, -34.8, -19.399999999999995, -68.20000000000006, -64.20000000000007, -44.2, -47.3, -61.70000000000004, -33.3, -68.90000000000012, -16.299999999999994, -61.20000000000008, -74.8, -50.7, -15.699999999999994, -60.500000000000085, -15.899999999999979, -143.0999999999997, -57.400000000000006, -67.60000000000005, -72.5, -51.00000000000004, -13.899999999999988, -13.299999999999992, -55.90000000000004, -56.700000000000074, -67.80000000000007, -127.6, -68.2, -14.89999999999998, -10.999999999999991, -58.1000000000001, -37.199999999999996, -64.70000000000002, -14.999999999999993, -51.90000000000005, -59.2, -72.00000000000003, -34.10000000000001, -34.80000000000007, -51.60000000000002, -93.60000000000004, -61.000000000000014, -67.19999999999999, -13.999999999999986, -89.0, -49.6, -34.199999999999996, -41.50000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5930936234296125, "mean_inference_ms": 0.7120589906586257, "mean_action_processing_ms": 0.03004812780495772, "mean_env_wait_ms": 2.9794728652252345, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 72000, "timesteps_this_iter": 0, "agent_timesteps_total": 72000, "timers": {"sample_time_ms": 21186.265, "sample_throughput": 188.802, "load_time_ms": 0.332, "load_throughput": 12062996.836, "learn_time_ms": 4209.316, "learn_throughput": 950.273}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 2.121838671818215, "policy_loss": -0.002986103756934084, "vf_loss": 212.3808106289115, "vf_explained_var": 0.09585992097854615, "kl": 0.010167171748131405, "entropy": 0.834135518920037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 72000, "num_agent_steps_sampled": 72000, "num_steps_trained": 72000, "num_agent_steps_trained": 72000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 720, "training_iteration": 18, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-22-02", "timestamp": 1651051322, "time_this_iter_s": 20.159180879592896, "time_total_s": 387.23147225379944, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 387.23147225379944, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 5.571428571428571, "ram_util_percent": 92.88571428571433}}
{"episode_reward_max": -10.5, "episode_reward_min": -152.2, "episode_reward_mean": -53.299000000000014, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-95.80000000000001, -47.70000000000001, -88.0, -77.4, -53.60000000000006, -46.50000000000003, -28.500000000000007, -54.70000000000006, -83.69999999999999, -47.40000000000004, -14.299999999999986, -48.100000000000065, -34.8, -19.399999999999995, -68.20000000000006, -64.20000000000007, -44.2, -47.3, -61.70000000000004, -33.3, -68.90000000000012, -16.299999999999994, -61.20000000000008, -74.8, -50.7, -15.699999999999994, -60.500000000000085, -15.899999999999979, -143.0999999999997, -57.400000000000006, -67.60000000000005, -72.5, -51.00000000000004, -13.899999999999988, -13.299999999999992, -55.90000000000004, -56.700000000000074, -67.80000000000007, -127.6, -68.2, -14.89999999999998, -10.999999999999991, -58.1000000000001, -37.199999999999996, -64.70000000000002, -14.999999999999993, -51.90000000000005, -59.2, -72.00000000000003, -34.10000000000001, -34.80000000000007, -51.60000000000002, -93.60000000000004, -61.000000000000014, -67.19999999999999, -13.999999999999986, -89.0, -49.6, -34.199999999999996, -41.50000000000002, -37.599999999999994, -45.6, -38.700000000000024, -81.3, -51.100000000000016, -22.799999999999997, -131.8, -67.1, -35.2, -45.60000000000001, -74.49999999999999, -35.80000000000005, -49.90000000000006, -41.900000000000055, -45.40000000000008, -73.6, -35.800000000000004, -53.70000000000003, -96.10000000000001, -90.1, -61.200000000000045, -14.199999999999989, -16.79999999999999, -70.30000000000007, -48.000000000000085, -60.0, -39.70000000000004, -152.2, -61.5, -60.20000000000011, -70.80000000000008, -32.9, -15.099999999999993, -41.3, -10.5, -45.3, -43.3, -44.90000000000007, -90.3999999999999, -25.299999999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1980094057383126, "mean_inference_ms": 0.710191091503394, "mean_action_processing_ms": 0.029906493133651842, "mean_env_wait_ms": 2.9736367269935537, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 76000, "timesteps_this_iter": 0, "agent_timesteps_total": 76000, "timers": {"sample_time_ms": 21175.635, "sample_throughput": 188.896, "load_time_ms": 0.324, "load_throughput": 12357086.249, "learn_time_ms": 4219.987, "learn_throughput": 947.87}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 2.1764784833756825, "policy_loss": 0.0015579587309270777, "vf_loss": 217.4510958640806, "vf_explained_var": 0.06903916674275552, "kl": 0.0040960442417914255, "entropy": 0.7345169067382813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 76000, "num_agent_steps_sampled": 76000, "num_steps_trained": 76000, "num_agent_steps_trained": 76000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 760, "training_iteration": 19, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-27-29", "timestamp": 1651051649, "time_this_iter_s": 327.03579115867615, "time_total_s": 714.2672634124756, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 714.2672634124756, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.279310344827586, "ram_util_percent": 92.86206896551724}}
{"episode_reward_max": -10.5, "episode_reward_min": -152.2, "episode_reward_mean": -49.53300000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.89999999999998, -10.999999999999991, -58.1000000000001, -37.199999999999996, -64.70000000000002, -14.999999999999993, -51.90000000000005, -59.2, -72.00000000000003, -34.10000000000001, -34.80000000000007, -51.60000000000002, -93.60000000000004, -61.000000000000014, -67.19999999999999, -13.999999999999986, -89.0, -49.6, -34.199999999999996, -41.50000000000002, -37.599999999999994, -45.6, -38.700000000000024, -81.3, -51.100000000000016, -22.799999999999997, -131.8, -67.1, -35.2, -45.60000000000001, -74.49999999999999, -35.80000000000005, -49.90000000000006, -41.900000000000055, -45.40000000000008, -73.6, -35.800000000000004, -53.70000000000003, -96.10000000000001, -90.1, -61.200000000000045, -14.199999999999989, -16.79999999999999, -70.30000000000007, -48.000000000000085, -60.0, -39.70000000000004, -152.2, -61.5, -60.20000000000011, -70.80000000000008, -32.9, -15.099999999999993, -41.3, -10.5, -45.3, -43.3, -44.90000000000007, -90.3999999999999, -25.299999999999997, -48.10000000000007, -31.400000000000013, -25.5, -54.9, -50.00000000000001, -54.10000000000002, -108.59999999999981, -14.999999999999996, -82.4, -60.4, -16.79999999999999, -20.000000000000007, -62.50000000000008, -52.10000000000004, -18.599999999999987, -40.20000000000006, -61.20000000000007, -73.1, -88.60000000000008, -95.80000000000001, -14.999999999999993, -17.400000000000002, -28.900000000000006, -16.499999999999986, -19.099999999999994, -31.9, -45.9, -49.50000000000004, -56.60000000000007, -41.400000000000006, -46.800000000000004, -61.00000000000001, -72.5, -54.80000000000009, -51.20000000000007, -53.60000000000001, -15.099999999999975, -17.69999999999999, -33.3, -53.70000000000009], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7238985288754516, "mean_inference_ms": 0.7079212251306168, "mean_action_processing_ms": 0.02975719028813631, "mean_env_wait_ms": 2.9663663308867365, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 80000, "timesteps_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"sample_time_ms": 21002.716, "sample_throughput": 190.452, "load_time_ms": 0.313, "load_throughput": 12779719.683, "learn_time_ms": 4166.589, "learn_throughput": 960.018}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 1.528569298081841, "policy_loss": -0.008075247745039642, "vf_loss": 153.6113708865258, "vf_explained_var": -0.0015031760097831807, "kl": 0.010617365177765275, "entropy": 0.7211389145543499, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 80000, "num_agent_steps_sampled": 80000, "num_steps_trained": 80000, "num_agent_steps_trained": 80000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 800, "training_iteration": 20, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-27-49", "timestamp": 1651051669, "time_this_iter_s": 19.516113758087158, "time_total_s": 733.7833771705627, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 733.7833771705627, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 14.146153846153847, "ram_util_percent": 92.83846153846154}}
{"episode_reward_max": -10.5, "episode_reward_min": -174.09999999999974, "episode_reward_mean": -50.97599999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-61.200000000000045, -14.199999999999989, -16.79999999999999, -70.30000000000007, -48.000000000000085, -60.0, -39.70000000000004, -152.2, -61.5, -60.20000000000011, -70.80000000000008, -32.9, -15.099999999999993, -41.3, -10.5, -45.3, -43.3, -44.90000000000007, -90.3999999999999, -25.299999999999997, -48.10000000000007, -31.400000000000013, -25.5, -54.9, -50.00000000000001, -54.10000000000002, -108.59999999999981, -14.999999999999996, -82.4, -60.4, -16.79999999999999, -20.000000000000007, -62.50000000000008, -52.10000000000004, -18.599999999999987, -40.20000000000006, -61.20000000000007, -73.1, -88.60000000000008, -95.80000000000001, -14.999999999999993, -17.400000000000002, -28.900000000000006, -16.499999999999986, -19.099999999999994, -31.9, -45.9, -49.50000000000004, -56.60000000000007, -41.400000000000006, -46.800000000000004, -61.00000000000001, -72.5, -54.80000000000009, -51.20000000000007, -53.60000000000001, -15.099999999999975, -17.69999999999999, -33.3, -53.70000000000009, -136.2, -12.399999999999995, -99.4, -139.3, -51.000000000000064, -33.4, -40.800000000000004, -12.999999999999995, -62.20000000000008, -63.6, -14.799999999999981, -42.1, -51.900000000000006, -44.8, -47.400000000000006, -14.299999999999978, -62.700000000000045, -125.39999999999965, -36.40000000000003, -68.40000000000009, -12.699999999999985, -50.70000000000008, -52.3, -49.800000000000026, -54.2, -34.5, -31.299999999999997, -91.10000000000004, -14.199999999999994, -32.70000000000002, -22.500000000000036, -50.200000000000024, -157.09999999999974, -54.90000000000002, -40.100000000000016, -53.4000000000001, -174.09999999999974, -38.4, -15.399999999999993, -63.40000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.372973643063006, "mean_inference_ms": 0.7042193312315415, "mean_action_processing_ms": 0.0296032239317608, "mean_env_wait_ms": 2.9582700524280647, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 84000, "timesteps_this_iter": 0, "agent_timesteps_total": 84000, "timers": {"sample_time_ms": 20730.116, "sample_throughput": 192.956, "load_time_ms": 0.31, "load_throughput": 12914491.571, "learn_time_ms": 4078.178, "learn_throughput": 980.83}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 3.6196489869586883, "policy_loss": 0.0029599578350141486, "vf_loss": 361.6344864999094, "vf_explained_var": -0.024358647805388257, "kl": 0.0068851950223977115, "entropy": 0.6971773389206137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 84000, "num_agent_steps_sampled": 84000, "num_steps_trained": 84000, "num_agent_steps_trained": 84000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 840, "training_iteration": 21, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-28-09", "timestamp": 1651051689, "time_this_iter_s": 20.263099908828735, "time_total_s": 754.0464770793915, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 754.0464770793915, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 4.989285714285715, "ram_util_percent": 92.82857142857145}}
{"episode_reward_max": -11.199999999999998, "episode_reward_min": -174.09999999999974, "episode_reward_mean": -50.28099999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.999999999999993, -17.400000000000002, -28.900000000000006, -16.499999999999986, -19.099999999999994, -31.9, -45.9, -49.50000000000004, -56.60000000000007, -41.400000000000006, -46.800000000000004, -61.00000000000001, -72.5, -54.80000000000009, -51.20000000000007, -53.60000000000001, -15.099999999999975, -17.69999999999999, -33.3, -53.70000000000009, -136.2, -12.399999999999995, -99.4, -139.3, -51.000000000000064, -33.4, -40.800000000000004, -12.999999999999995, -62.20000000000008, -63.6, -14.799999999999981, -42.1, -51.900000000000006, -44.8, -47.400000000000006, -14.299999999999978, -62.700000000000045, -125.39999999999965, -36.40000000000003, -68.40000000000009, -12.699999999999985, -50.70000000000008, -52.3, -49.800000000000026, -54.2, -34.5, -31.299999999999997, -91.10000000000004, -14.199999999999994, -32.70000000000002, -22.500000000000036, -50.200000000000024, -157.09999999999974, -54.90000000000002, -40.100000000000016, -53.4000000000001, -174.09999999999974, -38.4, -15.399999999999993, -63.40000000000007, -32.00000000000005, -71.6, -81.5, -20.40000000000001, -55.00000000000004, -86.09999999999988, -51.00000000000007, -36.999999999999986, -59.60000000000001, -21.600000000000016, -19.900000000000027, -52.80000000000005, -79.10000000000002, -11.199999999999998, -15.699999999999994, -77.70000000000002, -41.0, -133.09999999999982, -30.100000000000005, -15.299999999999983, -32.39999999999999, -123.7, -63.9, -43.60000000000006, -38.400000000000034, -51.5, -51.10000000000004, -54.500000000000014, -51.40000000000003, -52.70000000000005, -38.30000000000001, -36.90000000000005, -13.899999999999984, -45.099999999999994, -31.600000000000044, -60.800000000000004, -66.7, -32.500000000000014, -73.49999999999999, -39.50000000000008], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.192581772009572, "mean_inference_ms": 0.7005459400606138, "mean_action_processing_ms": 0.029485635954853092, "mean_env_wait_ms": 2.9522518494432473, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 88000, "timesteps_this_iter": 0, "agent_timesteps_total": 88000, "timers": {"sample_time_ms": 20404.673, "sample_throughput": 196.034, "load_time_ms": 0.31, "load_throughput": 12905550.769, "learn_time_ms": 4116.784, "learn_throughput": 971.632}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 1.9302254066031466, "policy_loss": -0.0023746539548199666, "vf_loss": 193.24193788754042, "vf_explained_var": -0.020574005060298467, "kl": 0.0036144487193969493, "entropy": 0.678883481987061, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 88000, "num_agent_steps_sampled": 88000, "num_steps_trained": 88000, "num_agent_steps_trained": 88000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 880, "training_iteration": 22, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-28-30", "timestamp": 1651051710, "time_this_iter_s": 21.176724195480347, "time_total_s": 775.2232012748718, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 775.2232012748718, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 11.625, "ram_util_percent": 92.91428571428571}}
{"episode_reward_max": -10.29999999999999, "episode_reward_min": -174.09999999999974, "episode_reward_mean": -51.96500000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.699999999999985, -50.70000000000008, -52.3, -49.800000000000026, -54.2, -34.5, -31.299999999999997, -91.10000000000004, -14.199999999999994, -32.70000000000002, -22.500000000000036, -50.200000000000024, -157.09999999999974, -54.90000000000002, -40.100000000000016, -53.4000000000001, -174.09999999999974, -38.4, -15.399999999999993, -63.40000000000007, -32.00000000000005, -71.6, -81.5, -20.40000000000001, -55.00000000000004, -86.09999999999988, -51.00000000000007, -36.999999999999986, -59.60000000000001, -21.600000000000016, -19.900000000000027, -52.80000000000005, -79.10000000000002, -11.199999999999998, -15.699999999999994, -77.70000000000002, -41.0, -133.09999999999982, -30.100000000000005, -15.299999999999983, -32.39999999999999, -123.7, -63.9, -43.60000000000006, -38.400000000000034, -51.5, -51.10000000000004, -54.500000000000014, -51.40000000000003, -52.70000000000005, -38.30000000000001, -36.90000000000005, -13.899999999999984, -45.099999999999994, -31.600000000000044, -60.800000000000004, -66.7, -32.500000000000014, -73.49999999999999, -39.50000000000008, -38.10000000000002, -22.40000000000002, -21.900000000000006, -18.999999999999993, -75.69999999999997, -26.900000000000006, -155.2, -68.70000000000003, -64.9, -14.199999999999983, -74.20000000000003, -34.9, -32.300000000000054, -53.500000000000064, -51.300000000000075, -27.80000000000003, -90.39999999999984, -29.1, -55.50000000000004, -75.0, -59.50000000000005, -50.80000000000002, -13.099999999999994, -76.2, -30.0, -59.90000000000004, -61.20000000000008, -25.100000000000012, -31.100000000000033, -99.0, -56.70000000000009, -143.3, -26.80000000000006, -10.29999999999999, -88.09999999999997, -43.900000000000055, -114.5, -23.200000000000017, -25.0, -41.10000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.030564097690031, "mean_inference_ms": 0.7002699643575702, "mean_action_processing_ms": 0.029475239015817337, "mean_env_wait_ms": 2.950601682222323, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 92000, "timesteps_this_iter": 0, "agent_timesteps_total": 92000, "timers": {"sample_time_ms": 20580.361, "sample_throughput": 194.36, "load_time_ms": 0.334, "load_throughput": 11993148.903, "learn_time_ms": 4101.689, "learn_throughput": 975.208}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 2.454306518360822, "policy_loss": -0.002334066276108065, "vf_loss": 245.63895075398108, "vf_explained_var": -0.0825147141692459, "kl": 0.010044872059481786, "entropy": 0.6280342476662769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 92000, "num_agent_steps_sampled": 92000, "num_steps_trained": 92000, "num_agent_steps_trained": 92000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 920, "training_iteration": 23, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-28-52", "timestamp": 1651051732, "time_this_iter_s": 21.849357843399048, "time_total_s": 797.0725591182709, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 797.0725591182709, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 19.323333333333334, "ram_util_percent": 93.05000000000001}}
{"episode_reward_max": -10.29999999999999, "episode_reward_min": -155.2, "episode_reward_mean": -50.90900000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.39999999999999, -123.7, -63.9, -43.60000000000006, -38.400000000000034, -51.5, -51.10000000000004, -54.500000000000014, -51.40000000000003, -52.70000000000005, -38.30000000000001, -36.90000000000005, -13.899999999999984, -45.099999999999994, -31.600000000000044, -60.800000000000004, -66.7, -32.500000000000014, -73.49999999999999, -39.50000000000008, -38.10000000000002, -22.40000000000002, -21.900000000000006, -18.999999999999993, -75.69999999999997, -26.900000000000006, -155.2, -68.70000000000003, -64.9, -14.199999999999983, -74.20000000000003, -34.9, -32.300000000000054, -53.500000000000064, -51.300000000000075, -27.80000000000003, -90.39999999999984, -29.1, -55.50000000000004, -75.0, -59.50000000000005, -50.80000000000002, -13.099999999999994, -76.2, -30.0, -59.90000000000004, -61.20000000000008, -25.100000000000012, -31.100000000000033, -99.0, -56.70000000000009, -143.3, -26.80000000000006, -10.29999999999999, -88.09999999999997, -43.900000000000055, -114.5, -23.200000000000017, -25.0, -41.10000000000005, -13.499999999999982, -13.499999999999979, -131.09999999999997, -30.9, -47.00000000000001, -47.20000000000008, -25.599999999999994, -35.900000000000006, -53.200000000000095, -50.40000000000004, -10.799999999999995, -70.1, -138.5, -42.800000000000075, -44.70000000000001, -11.599999999999994, -52.20000000000006, -56.40000000000002, -59.5, -37.8, -35.6, -43.70000000000007, -26.800000000000008, -85.2, -43.40000000000001, -87.69999999999989, -11.09999999999999, -67.7, -17.799999999999997, -11.999999999999988, -24.4, -84.89999999999998, -31.20000000000005, -59.099999999999994, -46.5, -47.199999999999996, -32.20000000000001, -63.20000000000001, -149.1, -37.60000000000008], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8829888211985906, "mean_inference_ms": 0.6997831648826033, "mean_action_processing_ms": 0.029476231423497364, "mean_env_wait_ms": 2.949067431864433, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 96000, "timesteps_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"sample_time_ms": 20544.245, "sample_throughput": 194.702, "load_time_ms": 0.491, "load_throughput": 8150610.183, "learn_time_ms": 4163.147, "learn_throughput": 960.812}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 2.395462317107826, "policy_loss": -0.00258764752489765, "vf_loss": 239.78793191807245, "vf_explained_var": 0.060208152378759074, "kl": 0.006827640263485956, "entropy": 0.5766775114882376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 96000, "num_agent_steps_sampled": 96000, "num_steps_trained": 96000, "num_agent_steps_trained": 96000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 960, "training_iteration": 24, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-29-13", "timestamp": 1651051753, "time_this_iter_s": 20.984740734100342, "time_total_s": 818.0572998523712, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 818.0572998523712, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 13.60344827586207, "ram_util_percent": 92.96206896551725}}
{"episode_reward_max": -10.29999999999998, "episode_reward_min": -149.4, "episode_reward_mean": -50.01700000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-59.50000000000005, -50.80000000000002, -13.099999999999994, -76.2, -30.0, -59.90000000000004, -61.20000000000008, -25.100000000000012, -31.100000000000033, -99.0, -56.70000000000009, -143.3, -26.80000000000006, -10.29999999999999, -88.09999999999997, -43.900000000000055, -114.5, -23.200000000000017, -25.0, -41.10000000000005, -13.499999999999982, -13.499999999999979, -131.09999999999997, -30.9, -47.00000000000001, -47.20000000000008, -25.599999999999994, -35.900000000000006, -53.200000000000095, -50.40000000000004, -10.799999999999995, -70.1, -138.5, -42.800000000000075, -44.70000000000001, -11.599999999999994, -52.20000000000006, -56.40000000000002, -59.5, -37.8, -35.6, -43.70000000000007, -26.800000000000008, -85.2, -43.40000000000001, -87.69999999999989, -11.09999999999999, -67.7, -17.799999999999997, -11.999999999999988, -24.4, -84.89999999999998, -31.20000000000005, -59.099999999999994, -46.5, -47.199999999999996, -32.20000000000001, -63.20000000000001, -149.1, -37.60000000000008, -41.20000000000007, -65.30000000000005, -35.89999999999999, -65.40000000000003, -12.799999999999997, -45.60000000000003, -34.5, -27.70000000000001, -39.00000000000006, -34.2, -31.800000000000004, -77.09999999999997, -43.80000000000003, -37.20000000000007, -53.400000000000034, -148.59999999999974, -51.300000000000004, -12.199999999999976, -63.5000000000001, -12.599999999999975, -56.200000000000074, -10.29999999999998, -119.0, -54.50000000000001, -62.40000000000003, -28.2, -101.80000000000001, -26.0, -55.900000000000034, -76.40000000000003, -43.60000000000008, -11.399999999999974, -50.4, -31.900000000000027, -35.20000000000005, -37.30000000000009, -149.4, -23.1, -12.499999999999996, -25.20000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7472049009964543, "mean_inference_ms": 0.7020672752208594, "mean_action_processing_ms": 0.029545135395156404, "mean_env_wait_ms": 2.953401274255127, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 100000, "timesteps_this_iter": 0, "agent_timesteps_total": 100000, "timers": {"sample_time_ms": 20932.464, "sample_throughput": 191.091, "load_time_ms": 0.502, "load_throughput": 7972067.474, "learn_time_ms": 4279.615, "learn_throughput": 934.663}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.00010000000000000003, "total_loss": 2.5868879246996137, "policy_loss": 0.006555267258156692, "vf_loss": 258.02100229058215, "vf_explained_var": -0.02773459425536535, "kl": 0.004907202571645123, "entropy": 0.5628537185089563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 100000, "num_agent_steps_sampled": 100000, "num_steps_trained": 100000, "num_agent_steps_trained": 100000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1000, "training_iteration": 25, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-29-38", "timestamp": 1651051778, "time_this_iter_s": 24.492758989334106, "time_total_s": 842.5500588417053, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 842.5500588417053, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 31.545454545454547, "ram_util_percent": 92.92727272727272}}
{"episode_reward_max": -10.29999999999998, "episode_reward_min": -149.4, "episode_reward_mean": -47.00100000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.6, -43.70000000000007, -26.800000000000008, -85.2, -43.40000000000001, -87.69999999999989, -11.09999999999999, -67.7, -17.799999999999997, -11.999999999999988, -24.4, -84.89999999999998, -31.20000000000005, -59.099999999999994, -46.5, -47.199999999999996, -32.20000000000001, -63.20000000000001, -149.1, -37.60000000000008, -41.20000000000007, -65.30000000000005, -35.89999999999999, -65.40000000000003, -12.799999999999997, -45.60000000000003, -34.5, -27.70000000000001, -39.00000000000006, -34.2, -31.800000000000004, -77.09999999999997, -43.80000000000003, -37.20000000000007, -53.400000000000034, -148.59999999999974, -51.300000000000004, -12.199999999999976, -63.5000000000001, -12.599999999999975, -56.200000000000074, -10.29999999999998, -119.0, -54.50000000000001, -62.40000000000003, -28.2, -101.80000000000001, -26.0, -55.900000000000034, -76.40000000000003, -43.60000000000008, -11.399999999999974, -50.4, -31.900000000000027, -35.20000000000005, -37.30000000000009, -149.4, -23.1, -12.499999999999996, -25.20000000000001, -42.80000000000006, -53.30000000000005, -42.20000000000005, -59.60000000000007, -12.499999999999984, -12.899999999999991, -54.500000000000064, -15.299999999999985, -61.30000000000001, -34.80000000000003, -27.700000000000003, -56.60000000000008, -48.60000000000009, -45.40000000000006, -48.90000000000004, -11.699999999999994, -82.29999999999991, -48.60000000000001, -78.79999999999995, -131.19999999999982, -48.1, -104.5, -28.599999999999977, -37.00000000000004, -15.09999999999999, -21.000000000000007, -57.60000000000006, -26.899999999999995, -38.4, -13.39999999999998, -14.399999999999984, -32.90000000000007, -21.200000000000024, -41.20000000000004, -14.39999999999999, -52.40000000000003, -105.20000000000012, -53.6, -34.400000000000055, -20.600000000000023], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6215979294805307, "mean_inference_ms": 0.7045310212630538, "mean_action_processing_ms": 0.029615390053219372, "mean_env_wait_ms": 2.958685768397995, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 104000, "timesteps_this_iter": 0, "agent_timesteps_total": 104000, "timers": {"sample_time_ms": 21171.95, "sample_throughput": 188.929, "load_time_ms": 0.511, "load_throughput": 7835060.944, "learn_time_ms": 4295.138, "learn_throughput": 931.286}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 1.8064001532011134, "policy_loss": -0.0032145189902474803, "vf_loss": 180.95129423038935, "vf_explained_var": 0.0015022943096776162, "kl": 0.00814249667758212, "entropy": 0.6124779410900608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 104000, "num_agent_steps_sampled": 104000, "num_steps_trained": 104000, "num_agent_steps_trained": 104000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1040, "training_iteration": 26, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-29-59", "timestamp": 1651051799, "time_this_iter_s": 21.401169776916504, "time_total_s": 863.9512286186218, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 863.9512286186218, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 26.682758620689658, "ram_util_percent": 93.20344827586207}}
{"episode_reward_max": -9.299999999999994, "episode_reward_min": -153.3, "episode_reward_mean": -45.77900000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.200000000000074, -10.29999999999998, -119.0, -54.50000000000001, -62.40000000000003, -28.2, -101.80000000000001, -26.0, -55.900000000000034, -76.40000000000003, -43.60000000000008, -11.399999999999974, -50.4, -31.900000000000027, -35.20000000000005, -37.30000000000009, -149.4, -23.1, -12.499999999999996, -25.20000000000001, -42.80000000000006, -53.30000000000005, -42.20000000000005, -59.60000000000007, -12.499999999999984, -12.899999999999991, -54.500000000000064, -15.299999999999985, -61.30000000000001, -34.80000000000003, -27.700000000000003, -56.60000000000008, -48.60000000000009, -45.40000000000006, -48.90000000000004, -11.699999999999994, -82.29999999999991, -48.60000000000001, -78.79999999999995, -131.19999999999982, -48.1, -104.5, -28.599999999999977, -37.00000000000004, -15.09999999999999, -21.000000000000007, -57.60000000000006, -26.899999999999995, -38.4, -13.39999999999998, -14.399999999999984, -32.90000000000007, -21.200000000000024, -41.20000000000004, -14.39999999999999, -52.40000000000003, -105.20000000000012, -53.6, -34.400000000000055, -20.600000000000023, -63.4, -17.799999999999997, -13.499999999999982, -56.0, -9.299999999999994, -43.6, -13.099999999999998, -64.00000000000009, -15.499999999999996, -40.80000000000004, -34.80000000000006, -30.20000000000006, -44.600000000000065, -45.30000000000006, -69.70000000000006, -30.6, -108.7, -42.50000000000006, -23.400000000000084, -39.50000000000005, -44.30000000000001, -41.2, -46.7, -45.30000000000001, -30.50000000000004, -153.3, -56.60000000000009, -20.00000000000001, -57.900000000000006, -38.70000000000006, -35.000000000000014, -73.20000000000002, -44.1, -79.39999999999995, -51.80000000000005, -15.299999999999985, -54.000000000000036, -42.800000000000004, -68.60000000000001, -12.29999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5064055539808, "mean_inference_ms": 0.7073420113087687, "mean_action_processing_ms": 0.029707310300390997, "mean_env_wait_ms": 2.9667507577277865, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 108000, "timesteps_this_iter": 0, "agent_timesteps_total": 108000, "timers": {"sample_time_ms": 21491.141, "sample_throughput": 186.123, "load_time_ms": 0.485, "load_throughput": 8250007.868, "learn_time_ms": 4446.246, "learn_throughput": 899.635}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 1.7067101139605285, "policy_loss": 0.00016218702238734051, "vf_loss": 170.64796388482534, "vf_explained_var": 0.07962508913009397, "kl": 0.0054652673083450684, "entropy": 0.5067176299069518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 108000, "num_agent_steps_sampled": 108000, "num_steps_trained": 108000, "num_agent_steps_trained": 108000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1080, "training_iteration": 27, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-30-24", "timestamp": 1651051824, "time_this_iter_s": 24.504281997680664, "time_total_s": 888.4555106163025, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 888.4555106163025, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 17.97878787878788, "ram_util_percent": 93.56666666666666}}
{"episode_reward_max": -9.299999999999994, "episode_reward_min": -153.3, "episode_reward_mean": -44.031000000000006, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.1, -104.5, -28.599999999999977, -37.00000000000004, -15.09999999999999, -21.000000000000007, -57.60000000000006, -26.899999999999995, -38.4, -13.39999999999998, -14.399999999999984, -32.90000000000007, -21.200000000000024, -41.20000000000004, -14.39999999999999, -52.40000000000003, -105.20000000000012, -53.6, -34.400000000000055, -20.600000000000023, -63.4, -17.799999999999997, -13.499999999999982, -56.0, -9.299999999999994, -43.6, -13.099999999999998, -64.00000000000009, -15.499999999999996, -40.80000000000004, -34.80000000000006, -30.20000000000006, -44.600000000000065, -45.30000000000006, -69.70000000000006, -30.6, -108.7, -42.50000000000006, -23.400000000000084, -39.50000000000005, -44.30000000000001, -41.2, -46.7, -45.30000000000001, -30.50000000000004, -153.3, -56.60000000000009, -20.00000000000001, -57.900000000000006, -38.70000000000006, -35.000000000000014, -73.20000000000002, -44.1, -79.39999999999995, -51.80000000000005, -15.299999999999985, -54.000000000000036, -42.800000000000004, -68.60000000000001, -12.29999999999998, -40.7, -51.10000000000004, -66.60000000000002, -82.1, -41.10000000000004, -134.1, -40.90000000000005, -40.5, -51.30000000000005, -38.90000000000004, -32.70000000000002, -38.500000000000064, -15.699999999999996, -21.699999999999996, -31.80000000000001, -39.500000000000036, -32.30000000000001, -106.39999999999986, -25.300000000000004, -57.30000000000001, -16.29999999999998, -46.4, -31.5, -131.09999999999982, -30.9, -13.29999999999998, -60.900000000000055, -31.400000000000006, -47.2, -34.39999999999997, -70.2, -39.10000000000004, -66.6, -32.4, -43.199999999999996, -38.00000000000006, -11.999999999999982, -15.199999999999996, -42.80000000000006, -13.499999999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.4007415784599915, "mean_inference_ms": 0.7104608235113224, "mean_action_processing_ms": 0.029802766941699258, "mean_env_wait_ms": 2.974275476317374, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 112000, "timesteps_this_iter": 0, "agent_timesteps_total": 112000, "timers": {"sample_time_ms": 21915.474, "sample_throughput": 182.519, "load_time_ms": 0.484, "load_throughput": 8258536.057, "learn_time_ms": 4446.479, "learn_throughput": 899.588}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.00010000000000000003, "total_loss": 1.7125336290948012, "policy_loss": 0.0024212582517535454, "vf_loss": 171.00554934675975, "vf_explained_var": 0.013333544295321229, "kl": 0.004552715039144485, "entropy": 0.46706040716299446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 112000, "num_agent_steps_sampled": 112000, "num_steps_trained": 112000, "num_agent_steps_trained": 112000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1120, "training_iteration": 28, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-30-46", "timestamp": 1651051846, "time_this_iter_s": 22.891267776489258, "time_total_s": 911.3467783927917, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 911.3467783927917, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 22.164516129032254, "ram_util_percent": 93.83548387096779}}
{"episode_reward_max": -11.099999999999984, "episode_reward_min": -153.3, "episode_reward_mean": -46.40800000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-44.30000000000001, -41.2, -46.7, -45.30000000000001, -30.50000000000004, -153.3, -56.60000000000009, -20.00000000000001, -57.900000000000006, -38.70000000000006, -35.000000000000014, -73.20000000000002, -44.1, -79.39999999999995, -51.80000000000005, -15.299999999999985, -54.000000000000036, -42.800000000000004, -68.60000000000001, -12.29999999999998, -40.7, -51.10000000000004, -66.60000000000002, -82.1, -41.10000000000004, -134.1, -40.90000000000005, -40.5, -51.30000000000005, -38.90000000000004, -32.70000000000002, -38.500000000000064, -15.699999999999996, -21.699999999999996, -31.80000000000001, -39.500000000000036, -32.30000000000001, -106.39999999999986, -25.300000000000004, -57.30000000000001, -16.29999999999998, -46.4, -31.5, -131.09999999999982, -30.9, -13.29999999999998, -60.900000000000055, -31.400000000000006, -47.2, -34.39999999999997, -70.2, -39.10000000000004, -66.6, -32.4, -43.199999999999996, -38.00000000000006, -11.999999999999982, -15.199999999999996, -42.80000000000006, -13.499999999999995, -39.50000000000006, -52.500000000000014, -127.39999999999984, -37.60000000000006, -39.4, -22.700000000000003, -11.099999999999984, -38.0, -28.900000000000023, -32.5, -52.00000000000004, -51.90000000000001, -41.600000000000044, -91.50000000000004, -43.200000000000074, -44.20000000000005, -31.000000000000004, -54.10000000000004, -12.599999999999998, -60.40000000000009, -60.900000000000084, -54.300000000000054, -42.40000000000001, -49.5, -12.499999999999977, -12.09999999999998, -98.69999999999983, -37.70000000000006, -27.700000000000006, -27.000000000000036, -33.500000000000036, -96.99999999999983, -52.20000000000002, -56.400000000000055, -40.0, -18.299999999999997, -13.299999999999997, -51.50000000000002, -84.79999999999987, -43.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3037091012699182, "mean_inference_ms": 0.7141447308076516, "mean_action_processing_ms": 0.0299108785693876, "mean_env_wait_ms": 2.9821899836997123, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 116000, "timesteps_this_iter": 0, "agent_timesteps_total": 116000, "timers": {"sample_time_ms": 22055.355, "sample_throughput": 181.362, "load_time_ms": 0.501, "load_throughput": 7985347.93, "learn_time_ms": 4518.552, "learn_throughput": 885.239}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 1.711641016874903, "policy_loss": 9.963598042245834e-05, "vf_loss": 171.1508613114716, "vf_explained_var": -0.04081950136410293, "kl": 0.005249979255920651, "entropy": 0.47745728595282444, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 116000, "num_agent_steps_sampled": 116000, "num_steps_trained": 116000, "num_agent_steps_trained": 116000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1160, "training_iteration": 29, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-31-10", "timestamp": 1651051870, "time_this_iter_s": 23.907466888427734, "time_total_s": 935.2542452812195, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 935.2542452812195, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 24.02121212121212, "ram_util_percent": 93.72121212121213}}
{"episode_reward_max": -8.1, "episode_reward_min": -778.1000000000003, "episode_reward_mean": -51.10300000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.29999999999998, -46.4, -31.5, -131.09999999999982, -30.9, -13.29999999999998, -60.900000000000055, -31.400000000000006, -47.2, -34.39999999999997, -70.2, -39.10000000000004, -66.6, -32.4, -43.199999999999996, -38.00000000000006, -11.999999999999982, -15.199999999999996, -42.80000000000006, -13.499999999999995, -39.50000000000006, -52.500000000000014, -127.39999999999984, -37.60000000000006, -39.4, -22.700000000000003, -11.099999999999984, -38.0, -28.900000000000023, -32.5, -52.00000000000004, -51.90000000000001, -41.600000000000044, -91.50000000000004, -43.200000000000074, -44.20000000000005, -31.000000000000004, -54.10000000000004, -12.599999999999998, -60.40000000000009, -60.900000000000084, -54.300000000000054, -42.40000000000001, -49.5, -12.499999999999977, -12.09999999999998, -98.69999999999983, -37.70000000000006, -27.700000000000006, -27.000000000000036, -33.500000000000036, -96.99999999999983, -52.20000000000002, -56.400000000000055, -40.0, -18.299999999999997, -13.299999999999997, -51.50000000000002, -84.79999999999987, -43.0, -86.1, -19.89999999999999, -8.1, -49.50000000000007, -72.70000000000003, -14.3, -12.09999999999998, -106.30000000000007, -75.0, -61.60000000000009, -54.60000000000007, -19.400000000000034, -22.799999999999994, -35.39999999999999, -42.199999999999996, -27.50000000000001, -73.4, -84.79999999999993, -16.29999999999998, -47.0, -61.20000000000008, -21.09999999999998, -17.2, -30.400000000000013, -14.499999999999998, -22.500000000000043, -30.80000000000004, -67.00000000000004, -49.3, -97.3, -18.3, -56.90000000000007, -15.4, -50.40000000000002, -44.5, -50.5, -79.69999999999992, -778.1000000000003, -11.599999999999973, -23.30000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.2126610571061076, "mean_inference_ms": 0.718056616212086, "mean_action_processing_ms": 0.030024947478049634, "mean_env_wait_ms": 2.990125325307349, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 120000, "timesteps_this_iter": 0, "agent_timesteps_total": 120000, "timers": {"sample_time_ms": 22466.86, "sample_throughput": 178.04, "load_time_ms": 0.493, "load_throughput": 8107285.203, "learn_time_ms": 4559.51, "learn_throughput": 877.287}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.00010000000000000003, "total_loss": 34.73546323359653, "policy_loss": -0.014038186433715044, "vf_loss": 3474.934896873146, "vf_explained_var": -0.09739050640854784, "kl": 0.024417014766023357, "entropy": 0.6675458842067308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 120000, "num_steps_trained": 120000, "num_agent_steps_trained": 120000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1200, "training_iteration": 30, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-31-34", "timestamp": 1651051894, "time_this_iter_s": 23.314600944519043, "time_total_s": 958.5688462257385, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 958.5688462257385, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.770967741935483, "ram_util_percent": 93.5774193548387}}
{"episode_reward_max": -8.1, "episode_reward_min": -778.1000000000003, "episode_reward_mean": -51.58, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-60.900000000000084, -54.300000000000054, -42.40000000000001, -49.5, -12.499999999999977, -12.09999999999998, -98.69999999999983, -37.70000000000006, -27.700000000000006, -27.000000000000036, -33.500000000000036, -96.99999999999983, -52.20000000000002, -56.400000000000055, -40.0, -18.299999999999997, -13.299999999999997, -51.50000000000002, -84.79999999999987, -43.0, -86.1, -19.89999999999999, -8.1, -49.50000000000007, -72.70000000000003, -14.3, -12.09999999999998, -106.30000000000007, -75.0, -61.60000000000009, -54.60000000000007, -19.400000000000034, -22.799999999999994, -35.39999999999999, -42.199999999999996, -27.50000000000001, -73.4, -84.79999999999993, -16.29999999999998, -47.0, -61.20000000000008, -21.09999999999998, -17.2, -30.400000000000013, -14.499999999999998, -22.500000000000043, -30.80000000000004, -67.00000000000004, -49.3, -97.3, -18.3, -56.90000000000007, -15.4, -50.40000000000002, -44.5, -50.5, -79.69999999999992, -778.1000000000003, -11.599999999999973, -23.30000000000007, -33.90000000000004, -17.999999999999996, -65.6, -56.10000000000006, -42.80000000000001, -14.099999999999977, -39.900000000000055, -37.9, -76.59999999999997, -64.80000000000007, -65.39999999999999, -49.000000000000064, -36.50000000000005, -47.500000000000036, -50.90000000000008, -99.3, -110.3, -11.49999999999998, -10.399999999999979, -60.500000000000014, -11.09999999999998, -36.70000000000007, -27.000000000000007, -20.0, -40.4, -46.50000000000001, -28.00000000000001, -62.199999999999996, -13.799999999999978, -37.8000000000001, -11.699999999999985, -39.3, -50.20000000000006, -29.4, -9.900000000000002, -142.29999999999998, -40.20000000000005, -30.400000000000045, -55.900000000000105, -52.40000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1271000056901017, "mean_inference_ms": 0.7221726251306617, "mean_action_processing_ms": 0.030133586256139447, "mean_env_wait_ms": 2.9970006766738946, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 124000, "timesteps_this_iter": 0, "agent_timesteps_total": 124000, "timers": {"sample_time_ms": 22778.736, "sample_throughput": 175.602, "load_time_ms": 0.492, "load_throughput": 8135591.116, "learn_time_ms": 4560.616, "learn_throughput": 877.074}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 1.422277650436867, "policy_loss": 0.00903151029750945, "vf_loss": 141.3188029422555, "vf_explained_var": 0.04538010679265504, "kl": 0.00620136147501569, "entropy": 0.5383931550928341, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 124000, "num_agent_steps_sampled": 124000, "num_steps_trained": 124000, "num_agent_steps_trained": 124000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1240, "training_iteration": 31, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-31-57", "timestamp": 1651051917, "time_this_iter_s": 22.983267068862915, "time_total_s": 981.5521132946014, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 981.5521132946014, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 19.296875, "ram_util_percent": 93.725}}
{"episode_reward_max": -9.599999999999994, "episode_reward_min": -778.1000000000003, "episode_reward_mean": -51.57300000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-61.20000000000008, -21.09999999999998, -17.2, -30.400000000000013, -14.499999999999998, -22.500000000000043, -30.80000000000004, -67.00000000000004, -49.3, -97.3, -18.3, -56.90000000000007, -15.4, -50.40000000000002, -44.5, -50.5, -79.69999999999992, -778.1000000000003, -11.599999999999973, -23.30000000000007, -33.90000000000004, -17.999999999999996, -65.6, -56.10000000000006, -42.80000000000001, -14.099999999999977, -39.900000000000055, -37.9, -76.59999999999997, -64.80000000000007, -65.39999999999999, -49.000000000000064, -36.50000000000005, -47.500000000000036, -50.90000000000008, -99.3, -110.3, -11.49999999999998, -10.399999999999979, -60.500000000000014, -11.09999999999998, -36.70000000000007, -27.000000000000007, -20.0, -40.4, -46.50000000000001, -28.00000000000001, -62.199999999999996, -13.799999999999978, -37.8000000000001, -11.699999999999985, -39.3, -50.20000000000006, -29.4, -9.900000000000002, -142.29999999999998, -40.20000000000005, -30.400000000000045, -55.900000000000105, -52.40000000000007, -61.70000000000003, -128.0999999999999, -76.30000000000003, -30.799999999999997, -38.60000000000007, -91.59999999999997, -55.00000000000007, -52.100000000000065, -40.400000000000055, -22.900000000000063, -10.599999999999978, -12.09999999999998, -41.500000000000085, -9.599999999999994, -37.60000000000001, -32.700000000000045, -43.8, -14.799999999999992, -12.499999999999993, -141.8, -11.499999999999975, -34.099999999999994, -41.00000000000005, -133.3, -12.399999999999977, -34.300000000000004, -57.5, -57.5, -48.60000000000001, -35.99999999999999, -62.70000000000004, -71.60000000000001, -71.80000000000003, -34.7, -39.1, -63.80000000000009, -12.599999999999987, -24.20000000000006, -19.39999999999999, -20.499999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.046396046154811, "mean_inference_ms": 0.7267826799826795, "mean_action_processing_ms": 0.030246867995212895, "mean_env_wait_ms": 3.00369103213737, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 128000, "timesteps_this_iter": 0, "agent_timesteps_total": 128000, "timers": {"sample_time_ms": 23010.971, "sample_throughput": 173.83, "load_time_ms": 0.493, "load_throughput": 8116305.936, "learn_time_ms": 4564.686, "learn_throughput": 876.292}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 2.240096694375238, "policy_loss": 0.00018443220585424413, "vf_loss": 223.985877654373, "vf_explained_var": -0.08547199291567649, "kl": 0.0057091194663663825, "entropy": 0.570646138056632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 128000, "num_agent_steps_sampled": 128000, "num_steps_trained": 128000, "num_agent_steps_trained": 128000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1280, "training_iteration": 32, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-32-20", "timestamp": 1651051940, "time_this_iter_s": 23.525166034698486, "time_total_s": 1005.0772793292999, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1005.0772793292999, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 18.0125, "ram_util_percent": 94.04375}}
{"episode_reward_max": -9.599999999999994, "episode_reward_min": -142.29999999999998, "episode_reward_mean": -43.899000000000015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.09999999999998, -36.70000000000007, -27.000000000000007, -20.0, -40.4, -46.50000000000001, -28.00000000000001, -62.199999999999996, -13.799999999999978, -37.8000000000001, -11.699999999999985, -39.3, -50.20000000000006, -29.4, -9.900000000000002, -142.29999999999998, -40.20000000000005, -30.400000000000045, -55.900000000000105, -52.40000000000007, -61.70000000000003, -128.0999999999999, -76.30000000000003, -30.799999999999997, -38.60000000000007, -91.59999999999997, -55.00000000000007, -52.100000000000065, -40.400000000000055, -22.900000000000063, -10.599999999999978, -12.09999999999998, -41.500000000000085, -9.599999999999994, -37.60000000000001, -32.700000000000045, -43.8, -14.799999999999992, -12.499999999999993, -141.8, -11.499999999999975, -34.099999999999994, -41.00000000000005, -133.3, -12.399999999999977, -34.300000000000004, -57.5, -57.5, -48.60000000000001, -35.99999999999999, -62.70000000000004, -71.60000000000001, -71.80000000000003, -34.7, -39.1, -63.80000000000009, -12.599999999999987, -24.20000000000006, -19.39999999999999, -20.499999999999996, -22.699999999999996, -39.00000000000001, -38.20000000000005, -91.99999999999997, -100.50000000000003, -64.80000000000003, -12.999999999999996, -19.80000000000001, -45.0, -9.9, -38.800000000000075, -19.500000000000032, -31.29999999999995, -48.80000000000003, -41.0, -108.99999999999977, -26.000000000000007, -12.599999999999978, -53.80000000000007, -39.700000000000045, -13.699999999999974, -11.69999999999998, -46.40000000000008, -27.900000000000013, -11.699999999999982, -45.3, -43.300000000000075, -14.799999999999974, -34.500000000000036, -59.099999999999994, -32.40000000000004, -39.10000000000007, -50.30000000000006, -92.2, -41.40000000000007, -90.60000000000002, -41.00000000000001, -42.8, -106.29999999999987, -53.700000000000045], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.971607398669245, "mean_inference_ms": 0.7311445384807365, "mean_action_processing_ms": 0.030356706828867534, "mean_env_wait_ms": 3.0099945489998294, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 132000, "timesteps_this_iter": 0, "agent_timesteps_total": 132000, "timers": {"sample_time_ms": 23146.671, "sample_throughput": 172.811, "load_time_ms": 0.456, "load_throughput": 8778826.854, "learn_time_ms": 4669.972, "learn_throughput": 856.536}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 1.444040365621788, "policy_loss": -0.005692646656465787, "vf_loss": 144.96843572021814, "vf_explained_var": 0.05015840530395508, "kl": 0.005192507797707233, "entropy": 0.47322863936424253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 132000, "num_agent_steps_sampled": 132000, "num_steps_trained": 132000, "num_agent_steps_trained": 132000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1320, "training_iteration": 33, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-32-44", "timestamp": 1651051964, "time_this_iter_s": 24.212751865386963, "time_total_s": 1029.290031194687, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1029.290031194687, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 22.972727272727273, "ram_util_percent": 94.03333333333335}}
{"episode_reward_max": -9.9, "episode_reward_min": -152.2, "episode_reward_mean": -44.91300000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.499999999999975, -34.099999999999994, -41.00000000000005, -133.3, -12.399999999999977, -34.300000000000004, -57.5, -57.5, -48.60000000000001, -35.99999999999999, -62.70000000000004, -71.60000000000001, -71.80000000000003, -34.7, -39.1, -63.80000000000009, -12.599999999999987, -24.20000000000006, -19.39999999999999, -20.499999999999996, -22.699999999999996, -39.00000000000001, -38.20000000000005, -91.99999999999997, -100.50000000000003, -64.80000000000003, -12.999999999999996, -19.80000000000001, -45.0, -9.9, -38.800000000000075, -19.500000000000032, -31.29999999999995, -48.80000000000003, -41.0, -108.99999999999977, -26.000000000000007, -12.599999999999978, -53.80000000000007, -39.700000000000045, -13.699999999999974, -11.69999999999998, -46.40000000000008, -27.900000000000013, -11.699999999999982, -45.3, -43.300000000000075, -14.799999999999974, -34.500000000000036, -59.099999999999994, -32.40000000000004, -39.10000000000007, -50.30000000000006, -92.2, -41.40000000000007, -90.60000000000002, -41.00000000000001, -42.8, -106.29999999999987, -53.700000000000045, -18.70000000000001, -14.4, -12.2, -30.600000000000062, -40.800000000000004, -152.2, -18.8, -105.79999999999984, -28.400000000000027, -46.00000000000001, -18.200000000000003, -31.999999999999993, -10.499999999999979, -43.20000000000006, -36.20000000000005, -54.500000000000085, -71.80000000000004, -94.79999999999994, -51.20000000000005, -14.700000000000001, -26.699999999999964, -20.800000000000026, -10.599999999999978, -10.999999999999979, -29.500000000000007, -48.00000000000002, -51.200000000000024, -127.39999999999993, -96.4, -28.299999999999997, -12.699999999999978, -34.7, -40.800000000000004, -77.3, -30.0, -11.59999999999998, -63.500000000000085, -44.80000000000006, -34.50000000000001, -146.3], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9007118453077725, "mean_inference_ms": 0.7329699807306744, "mean_action_processing_ms": 0.03040689188066094, "mean_env_wait_ms": 3.014630656217312, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 136000, "timesteps_this_iter": 0, "agent_timesteps_total": 136000, "timers": {"sample_time_ms": 23360.654, "sample_throughput": 171.228, "load_time_ms": 0.292, "load_throughput": 13721449.252, "learn_time_ms": 4623.738, "learn_throughput": 865.101}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 2.4831388619678316, "policy_loss": -0.0007004226547896221, "vf_loss": 248.37842401278917, "vf_explained_var": -0.18130484204138478, "kl": 0.005878469629839699, "entropy": 0.5169416708330954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 136000, "num_agent_steps_sampled": 136000, "num_steps_trained": 136000, "num_agent_steps_trained": 136000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1360, "training_iteration": 34, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-33-06", "timestamp": 1651051986, "time_this_iter_s": 21.593384981155396, "time_total_s": 1050.8834161758423, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1050.8834161758423, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 20.944827586206895, "ram_util_percent": 94.1103448275862}}
{"episode_reward_max": -10.499999999999979, "episode_reward_min": -152.2, "episode_reward_mean": -44.98300000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.699999999999974, -11.69999999999998, -46.40000000000008, -27.900000000000013, -11.699999999999982, -45.3, -43.300000000000075, -14.799999999999974, -34.500000000000036, -59.099999999999994, -32.40000000000004, -39.10000000000007, -50.30000000000006, -92.2, -41.40000000000007, -90.60000000000002, -41.00000000000001, -42.8, -106.29999999999987, -53.700000000000045, -18.70000000000001, -14.4, -12.2, -30.600000000000062, -40.800000000000004, -152.2, -18.8, -105.79999999999984, -28.400000000000027, -46.00000000000001, -18.200000000000003, -31.999999999999993, -10.499999999999979, -43.20000000000006, -36.20000000000005, -54.500000000000085, -71.80000000000004, -94.79999999999994, -51.20000000000005, -14.700000000000001, -26.699999999999964, -20.800000000000026, -10.599999999999978, -10.999999999999979, -29.500000000000007, -48.00000000000002, -51.200000000000024, -127.39999999999993, -96.4, -28.299999999999997, -12.699999999999978, -34.7, -40.800000000000004, -77.3, -30.0, -11.59999999999998, -63.500000000000085, -44.80000000000006, -34.50000000000001, -146.3, -39.4, -53.0000000000001, -72.80000000000001, -12.399999999999991, -48.40000000000007, -19.099999999999994, -58.500000000000085, -24.80000000000005, -49.70000000000009, -34.500000000000064, -59.20000000000007, -14.499999999999975, -33.699999999999996, -57.30000000000003, -68.20000000000002, -60.0, -72.0, -52.000000000000064, -30.900000000000023, -49.800000000000004, -22.500000000000018, -53.800000000000075, -58.8, -34.20000000000003, -34.900000000000006, -40.199999999999996, -12.099999999999975, -10.799999999999997, -131.09999999999982, -51.70000000000004, -30.6, -30.800000000000004, -92.59999999999997, -38.89999999999999, -40.10000000000002, -52.90000000000004, -49.7, -11.299999999999992, -33.800000000000004, -18.0], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8335579038987238, "mean_inference_ms": 0.732301455580947, "mean_action_processing_ms": 0.03039062847334206, "mean_env_wait_ms": 3.0157006242455524, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 140000, "timesteps_this_iter": 0, "agent_timesteps_total": 140000, "timers": {"sample_time_ms": 23072.407, "sample_throughput": 173.367, "load_time_ms": 0.285, "load_throughput": 14053623.723, "learn_time_ms": 4536.114, "learn_throughput": 881.812}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 1.4072249206083436, "policy_loss": -0.0036661235134928458, "vf_loss": 141.08167374928792, "vf_explained_var": 0.122395678681712, "kl": 0.00792876519091501, "entropy": 0.4558021357783707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 140000, "num_agent_steps_sampled": 140000, "num_steps_trained": 140000, "num_agent_steps_trained": 140000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1400, "training_iteration": 35, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-33-27", "timestamp": 1651052007, "time_this_iter_s": 21.285539150238037, "time_total_s": 1072.1689553260803, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1072.1689553260803, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 12.341379310344829, "ram_util_percent": 94.03448275862068}}
{"episode_reward_max": -10.599999999999978, "episode_reward_min": -158.49999999999974, "episode_reward_mean": -49.34599999999998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.699999999999964, -20.800000000000026, -10.599999999999978, -10.999999999999979, -29.500000000000007, -48.00000000000002, -51.200000000000024, -127.39999999999993, -96.4, -28.299999999999997, -12.699999999999978, -34.7, -40.800000000000004, -77.3, -30.0, -11.59999999999998, -63.500000000000085, -44.80000000000006, -34.50000000000001, -146.3, -39.4, -53.0000000000001, -72.80000000000001, -12.399999999999991, -48.40000000000007, -19.099999999999994, -58.500000000000085, -24.80000000000005, -49.70000000000009, -34.500000000000064, -59.20000000000007, -14.499999999999975, -33.699999999999996, -57.30000000000003, -68.20000000000002, -60.0, -72.0, -52.000000000000064, -30.900000000000023, -49.800000000000004, -22.500000000000018, -53.800000000000075, -58.8, -34.20000000000003, -34.900000000000006, -40.199999999999996, -12.099999999999975, -10.799999999999997, -131.09999999999982, -51.70000000000004, -30.6, -30.800000000000004, -92.59999999999997, -38.89999999999999, -40.10000000000002, -52.90000000000004, -49.7, -11.299999999999992, -33.800000000000004, -18.0, -27.9, -40.900000000000034, -92.4, -42.000000000000064, -32.9, -10.599999999999982, -35.300000000000054, -87.90000000000002, -62.199999999999996, -40.00000000000007, -50.899999999999935, -28.0, -60.5, -20.1, -69.1, -11.19999999999998, -32.80000000000004, -41.00000000000003, -47.800000000000004, -21.6, -141.29999999999978, -62.90000000000007, -46.4, -158.49999999999974, -78.20000000000002, -37.300000000000075, -66.1, -43.700000000000074, -98.19999999999987, -15.299999999999988, -140.49999999999994, -41.5, -36.4, -32.00000000000005, -37.90000000000001, -39.900000000000006, -73.4, -82.4, -114.5, -28.000000000000032], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7695761576685696, "mean_inference_ms": 0.7311227597814244, "mean_action_processing_ms": 0.030350933099357543, "mean_env_wait_ms": 3.014647035947145, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 144000, "timesteps_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"sample_time_ms": 22973.019, "sample_throughput": 174.117, "load_time_ms": 0.276, "load_throughput": 14496859.933, "learn_time_ms": 4545.414, "learn_throughput": 880.008}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 3.0132152243201893, "policy_loss": -0.0010626826665654618, "vf_loss": 301.4198750321583, "vf_explained_var": 0.16210090171906255, "kl": 0.008453613148791074, "entropy": 0.4724224290059459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 144000, "num_agent_steps_sampled": 144000, "num_steps_trained": 144000, "num_agent_steps_trained": 144000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1440, "training_iteration": 36, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-33-49", "timestamp": 1651052029, "time_this_iter_s": 21.382040977478027, "time_total_s": 1093.5509963035583, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1093.5509963035583, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 16.355172413793102, "ram_util_percent": 94.10344827586206}}
{"episode_reward_max": -10.3, "episode_reward_min": -164.3, "episode_reward_mean": -50.62700000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.500000000000018, -53.800000000000075, -58.8, -34.20000000000003, -34.900000000000006, -40.199999999999996, -12.099999999999975, -10.799999999999997, -131.09999999999982, -51.70000000000004, -30.6, -30.800000000000004, -92.59999999999997, -38.89999999999999, -40.10000000000002, -52.90000000000004, -49.7, -11.299999999999992, -33.800000000000004, -18.0, -27.9, -40.900000000000034, -92.4, -42.000000000000064, -32.9, -10.599999999999982, -35.300000000000054, -87.90000000000002, -62.199999999999996, -40.00000000000007, -50.899999999999935, -28.0, -60.5, -20.1, -69.1, -11.19999999999998, -32.80000000000004, -41.00000000000003, -47.800000000000004, -21.6, -141.29999999999978, -62.90000000000007, -46.4, -158.49999999999974, -78.20000000000002, -37.300000000000075, -66.1, -43.700000000000074, -98.19999999999987, -15.299999999999988, -140.49999999999994, -41.5, -36.4, -32.00000000000005, -37.90000000000001, -39.900000000000006, -73.4, -82.4, -114.5, -28.000000000000032, -45.000000000000085, -92.6, -17.4, -57.300000000000004, -75.6999999999999, -82.6, -60.3, -17.799999999999997, -16.999999999999993, -10.3, -54.6, -44.80000000000007, -55.40000000000001, -52.80000000000005, -13.399999999999975, -164.3, -29.90000000000001, -43.9, -22.1, -100.89999999999992, -64.30000000000001, -41.90000000000003, -93.10000000000002, -65.6, -25.8, -56.80000000000008, -41.50000000000007, -22.9, -12.499999999999975, -60.30000000000006, -12.599999999999975, -53.300000000000075, -91.3, -87.59999999999998, -37.199999999999996, -31.100000000000012, -44.400000000000006, -11.69999999999998, -53.8, -18.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7096912512113134, "mean_inference_ms": 0.7300800333133699, "mean_action_processing_ms": 0.030318826280706843, "mean_env_wait_ms": 3.013070878338942, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 148000, "timesteps_this_iter": 0, "agent_timesteps_total": 148000, "timers": {"sample_time_ms": 22802.678, "sample_throughput": 175.418, "load_time_ms": 0.338, "load_throughput": 11834108.768, "learn_time_ms": 4439.432, "learn_throughput": 901.016}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 1.9386949026739344, "policy_loss": 0.0011085265876239626, "vf_loss": 193.75348465006837, "vf_explained_var": 0.13900837167616814, "kl": 0.005501456757597956, "entropy": 0.5327663095087134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 148000, "num_agent_steps_sampled": 148000, "num_steps_trained": 148000, "num_agent_steps_trained": 148000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1480, "training_iteration": 37, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-34-10", "timestamp": 1651052050, "time_this_iter_s": 21.671764135360718, "time_total_s": 1115.222760438919, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1115.222760438919, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 13.686206896551726, "ram_util_percent": 94.2931034482759}}
{"episode_reward_max": -10.3, "episode_reward_min": -164.3, "episode_reward_mean": -49.562000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-141.29999999999978, -62.90000000000007, -46.4, -158.49999999999974, -78.20000000000002, -37.300000000000075, -66.1, -43.700000000000074, -98.19999999999987, -15.299999999999988, -140.49999999999994, -41.5, -36.4, -32.00000000000005, -37.90000000000001, -39.900000000000006, -73.4, -82.4, -114.5, -28.000000000000032, -45.000000000000085, -92.6, -17.4, -57.300000000000004, -75.6999999999999, -82.6, -60.3, -17.799999999999997, -16.999999999999993, -10.3, -54.6, -44.80000000000007, -55.40000000000001, -52.80000000000005, -13.399999999999975, -164.3, -29.90000000000001, -43.9, -22.1, -100.89999999999992, -64.30000000000001, -41.90000000000003, -93.10000000000002, -65.6, -25.8, -56.80000000000008, -41.50000000000007, -22.9, -12.499999999999975, -60.30000000000006, -12.599999999999975, -53.300000000000075, -91.3, -87.59999999999998, -37.199999999999996, -31.100000000000012, -44.400000000000006, -11.69999999999998, -53.8, -18.6, -56.10000000000009, -11.599999999999996, -35.50000000000006, -51.9000000000001, -36.60000000000005, -48.40000000000008, -26.0, -48.60000000000007, -12.799999999999978, -31.100000000000026, -18.700000000000006, -11.29999999999998, -33.900000000000055, -10.699999999999982, -11.599999999999998, -60.50000000000006, -61.30000000000002, -54.10000000000004, -85.5, -56.10000000000001, -61.50000000000007, -37.00000000000004, -64.1, -64.89999999999992, -53.800000000000075, -16.999999999999993, -12.499999999999979, -10.899999999999995, -41.10000000000001, -27.80000000000001, -128.4, -72.0, -69.60000000000002, -11.69999999999998, -11.799999999999995, -16.0, -23.8, -35.20000000000003, -39.40000000000002, -36.60000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.652912415824277, "mean_inference_ms": 0.7284479457371325, "mean_action_processing_ms": 0.03027503328550357, "mean_env_wait_ms": 3.010518552646906, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 152000, "timesteps_this_iter": 0, "agent_timesteps_total": 152000, "timers": {"sample_time_ms": 22461.914, "sample_throughput": 178.079, "load_time_ms": 0.338, "load_throughput": 11828268.472, "learn_time_ms": 4430.937, "learn_throughput": 902.744}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 1.3683414349738028, "policy_loss": -0.0015093693654904122, "vf_loss": 136.97819075122956, "vf_explained_var": -0.06803307462764042, "kl": 0.007352518784002962, "entropy": 0.4647213519420675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 152000, "num_agent_steps_sampled": 152000, "num_steps_trained": 152000, "num_agent_steps_trained": 152000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1520, "training_iteration": 38, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-34-31", "timestamp": 1651052071, "time_this_iter_s": 20.414185047149658, "time_total_s": 1135.6369454860687, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1135.6369454860687, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 11.971428571428572, "ram_util_percent": 94.21071428571427}}
{"episode_reward_max": -9.499999999999995, "episode_reward_min": -167.4000000000001, "episode_reward_mean": -45.40200000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.30000000000001, -41.90000000000003, -93.10000000000002, -65.6, -25.8, -56.80000000000008, -41.50000000000007, -22.9, -12.499999999999975, -60.30000000000006, -12.599999999999975, -53.300000000000075, -91.3, -87.59999999999998, -37.199999999999996, -31.100000000000012, -44.400000000000006, -11.69999999999998, -53.8, -18.6, -56.10000000000009, -11.599999999999996, -35.50000000000006, -51.9000000000001, -36.60000000000005, -48.40000000000008, -26.0, -48.60000000000007, -12.799999999999978, -31.100000000000026, -18.700000000000006, -11.29999999999998, -33.900000000000055, -10.699999999999982, -11.599999999999998, -60.50000000000006, -61.30000000000002, -54.10000000000004, -85.5, -56.10000000000001, -61.50000000000007, -37.00000000000004, -64.1, -64.89999999999992, -53.800000000000075, -16.999999999999993, -12.499999999999979, -10.899999999999995, -41.10000000000001, -27.80000000000001, -128.4, -72.0, -69.60000000000002, -11.69999999999998, -11.799999999999995, -16.0, -23.8, -35.20000000000003, -39.40000000000002, -36.60000000000001, -9.499999999999995, -45.900000000000006, -51.30000000000003, -11.399999999999993, -13.399999999999986, -12.199999999999976, -128.4, -28.000000000000007, -58.400000000000006, -30.49999999999996, -56.09999999999997, -63.10000000000008, -47.80000000000001, -68.70000000000006, -24.9, -167.4000000000001, -79.0, -87.39999999999988, -15.399999999999979, -55.000000000000014, -67.0, -59.20000000000003, -67.2, -60.10000000000006, -64.10000000000007, -62.80000000000005, -51.100000000000065, -30.900000000000006, -36.70000000000002, -55.50000000000011, -54.50000000000003, -58.20000000000008, -63.10000000000009, -31.300000000000043, -34.0, -31.7, -9.699999999999982, -46.00000000000006, -40.900000000000006, -38.70000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.598648135902287, "mean_inference_ms": 0.7270861499601584, "mean_action_processing_ms": 0.03023817081774896, "mean_env_wait_ms": 3.0087334754332486, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 156000, "timesteps_this_iter": 0, "agent_timesteps_total": 156000, "timers": {"sample_time_ms": 22298.228, "sample_throughput": 179.386, "load_time_ms": 0.319, "load_throughput": 12543712.897, "learn_time_ms": 4338.759, "learn_throughput": 921.923}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 2.142289454007261, "policy_loss": -0.003793860325008951, "vf_loss": 214.59893838820918, "vf_explained_var": 0.19969018614420328, "kl": 0.010024827228407035, "entropy": 0.43898190739013815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 156000, "num_agent_steps_sampled": 156000, "num_steps_trained": 156000, "num_agent_steps_trained": 156000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1560, "training_iteration": 39, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-34-52", "timestamp": 1651052092, "time_this_iter_s": 21.434274911880493, "time_total_s": 1157.0712203979492, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1157.0712203979492, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 21.620000000000005, "ram_util_percent": 94.29666666666662}}
{"episode_reward_max": -9.499999999999995, "episode_reward_min": -167.4000000000001, "episode_reward_mean": -45.98100000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-61.50000000000007, -37.00000000000004, -64.1, -64.89999999999992, -53.800000000000075, -16.999999999999993, -12.499999999999979, -10.899999999999995, -41.10000000000001, -27.80000000000001, -128.4, -72.0, -69.60000000000002, -11.69999999999998, -11.799999999999995, -16.0, -23.8, -35.20000000000003, -39.40000000000002, -36.60000000000001, -9.499999999999995, -45.900000000000006, -51.30000000000003, -11.399999999999993, -13.399999999999986, -12.199999999999976, -128.4, -28.000000000000007, -58.400000000000006, -30.49999999999996, -56.09999999999997, -63.10000000000008, -47.80000000000001, -68.70000000000006, -24.9, -167.4000000000001, -79.0, -87.39999999999988, -15.399999999999979, -55.000000000000014, -67.0, -59.20000000000003, -67.2, -60.10000000000006, -64.10000000000007, -62.80000000000005, -51.100000000000065, -30.900000000000006, -36.70000000000002, -55.50000000000011, -54.50000000000003, -58.20000000000008, -63.10000000000009, -31.300000000000043, -34.0, -31.7, -9.699999999999982, -46.00000000000006, -40.900000000000006, -38.70000000000004, -30.80000000000001, -45.600000000000065, -68.9, -21.400000000000066, -41.50000000000001, -27.4, -35.2, -38.000000000000064, -34.40000000000002, -53.60000000000001, -52.0, -63.00000000000009, -34.6, -77.3, -35.80000000000002, -21.00000000000005, -54.000000000000014, -39.60000000000008, -15.299999999999988, -34.100000000000044, -35.900000000000055, -12.099999999999982, -36.5, -46.50000000000006, -39.29999999999999, -36.00000000000003, -56.30000000000001, -50.30000000000002, -60.4, -53.0, -37.2, -48.700000000000074, -33.099999999999994, -32.2, -106.09999999999977, -46.00000000000007, -50.10000000000007, -56.20000000000003, -57.800000000000054, -29.300000000000065], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.547323756735332, "mean_inference_ms": 0.7262861183869979, "mean_action_processing_ms": 0.030215240052227053, "mean_env_wait_ms": 3.0071985393138214, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 160000, "timesteps_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"sample_time_ms": 22018.035, "sample_throughput": 181.669, "load_time_ms": 0.328, "load_throughput": 12190972.242, "learn_time_ms": 4345.593, "learn_throughput": 920.473}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 0.8794865850659628, "policy_loss": 0.00020110944826756753, "vf_loss": 87.92097739865703, "vf_explained_var": 0.1124740231421686, "kl": 0.008076856867057048, "entropy": 0.4484765051193135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 160000, "num_agent_steps_sampled": 160000, "num_steps_trained": 160000, "num_agent_steps_trained": 160000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1600, "training_iteration": 40, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-35-14", "timestamp": 1651052114, "time_this_iter_s": 21.507887840270996, "time_total_s": 1178.5791082382202, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1178.5791082382202, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 20.32758620689655, "ram_util_percent": 94.27241379310345}}
{"episode_reward_max": -9.699999999999982, "episode_reward_min": -262.8999999999999, "episode_reward_mean": -48.49400000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -59.20000000000003, -67.2, -60.10000000000006, -64.10000000000007, -62.80000000000005, -51.100000000000065, -30.900000000000006, -36.70000000000002, -55.50000000000011, -54.50000000000003, -58.20000000000008, -63.10000000000009, -31.300000000000043, -34.0, -31.7, -9.699999999999982, -46.00000000000006, -40.900000000000006, -38.70000000000004, -30.80000000000001, -45.600000000000065, -68.9, -21.400000000000066, -41.50000000000001, -27.4, -35.2, -38.000000000000064, -34.40000000000002, -53.60000000000001, -52.0, -63.00000000000009, -34.6, -77.3, -35.80000000000002, -21.00000000000005, -54.000000000000014, -39.60000000000008, -15.299999999999988, -34.100000000000044, -35.900000000000055, -12.099999999999982, -36.5, -46.50000000000006, -39.29999999999999, -36.00000000000003, -56.30000000000001, -50.30000000000002, -60.4, -53.0, -37.2, -48.700000000000074, -33.099999999999994, -32.2, -106.09999999999977, -46.00000000000007, -50.10000000000007, -56.20000000000003, -57.800000000000054, -29.300000000000065, -39.800000000000004, -13.699999999999989, -11.499999999999993, -12.299999999999994, -10.799999999999978, -23.5, -33.80000000000008, -262.8999999999999, -62.599999999999994, -39.700000000000074, -9.999999999999996, -138.2, -68.80000000000001, -66.0, -187.7999999999997, -36.70000000000005, -35.7, -35.600000000000016, -80.5, -19.099999999999994, -27.9, -45.40000000000007, -57.59999999999993, -52.300000000000026, -65.70000000000003, -13.299999999999974, -74.70000000000005, -34.200000000000024, -41.90000000000007, -17.099999999999998, -10.099999999999994, -55.80000000000006, -80.79999999999983, -45.90000000000006, -33.40000000000007, -56.30000000000005, -59.60000000000006, -60.8, -57.00000000000008, -61.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4992020440733027, "mean_inference_ms": 0.7272101850686612, "mean_action_processing_ms": 0.03025458648705734, "mean_env_wait_ms": 3.0095637830573305, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 164000, "timesteps_this_iter": 0, "agent_timesteps_total": 164000, "timers": {"sample_time_ms": 22101.295, "sample_throughput": 180.985, "load_time_ms": 0.336, "load_throughput": 11913944.042, "learn_time_ms": 4422.852, "learn_throughput": 904.394}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 5.974054107580694, "policy_loss": -0.005386509828429709, "vf_loss": 597.9297604468561, "vf_explained_var": -0.012429712087877335, "kl": 0.015267586232958721, "entropy": 0.5503699887183404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 164000, "num_agent_steps_sampled": 164000, "num_steps_trained": 164000, "num_agent_steps_trained": 164000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1640, "training_iteration": 41, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-35-38", "timestamp": 1651052138, "time_this_iter_s": 24.519454956054688, "time_total_s": 1203.098563194275, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1203.098563194275, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 31.245454545454542, "ram_util_percent": 94.36969696969696}}
{"episode_reward_max": -9.999999999999984, "episode_reward_min": -540.4999999999998, "episode_reward_mean": -52.65400000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.900000000000055, -12.099999999999982, -36.5, -46.50000000000006, -39.29999999999999, -36.00000000000003, -56.30000000000001, -50.30000000000002, -60.4, -53.0, -37.2, -48.700000000000074, -33.099999999999994, -32.2, -106.09999999999977, -46.00000000000007, -50.10000000000007, -56.20000000000003, -57.800000000000054, -29.300000000000065, -39.800000000000004, -13.699999999999989, -11.499999999999993, -12.299999999999994, -10.799999999999978, -23.5, -33.80000000000008, -262.8999999999999, -62.599999999999994, -39.700000000000074, -9.999999999999996, -138.2, -68.80000000000001, -66.0, -187.7999999999997, -36.70000000000005, -35.7, -35.600000000000016, -80.5, -19.099999999999994, -27.9, -45.40000000000007, -57.59999999999993, -52.300000000000026, -65.70000000000003, -13.299999999999974, -74.70000000000005, -34.200000000000024, -41.90000000000007, -17.099999999999998, -10.099999999999994, -55.80000000000006, -80.79999999999983, -45.90000000000006, -33.40000000000007, -56.30000000000005, -59.60000000000006, -60.8, -57.00000000000008, -61.4, -27.099999999999998, -56.1, -51.00000000000004, -55.90000000000008, -25.5, -52.20000000000006, -27.100000000000005, -14.299999999999981, -58.2, -80.80000000000003, -41.90000000000006, -46.500000000000014, -30.600000000000048, -11.599999999999996, -9.999999999999984, -39.80000000000005, -11.299999999999978, -62.3, -39.500000000000014, -79.29999999999998, -39.700000000000074, -59.5, -13.599999999999993, -65.20000000000007, -44.20000000000006, -57.80000000000011, -10.799999999999981, -72.8, -76.40000000000005, -59.10000000000007, -540.4999999999998, -16.099999999999994, -13.799999999999978, -81.49999999999999, -21.60000000000002, -50.100000000000044, -56.30000000000009, -12.099999999999977, -52.10000000000001, -38.00000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.454051273489837, "mean_inference_ms": 0.7301782408101352, "mean_action_processing_ms": 0.030355330521374405, "mean_env_wait_ms": 3.01591960283008, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 168000, "timesteps_this_iter": 0, "agent_timesteps_total": 168000, "timers": {"sample_time_ms": 22279.777, "sample_throughput": 179.535, "load_time_ms": 0.333, "load_throughput": 12007741.197, "learn_time_ms": 4413.013, "learn_throughput": 906.41}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 19.44018672415486, "policy_loss": 0.0011195222997376995, "vf_loss": 1943.8901131701725, "vf_explained_var": 0.11229038334661914, "kl": 0.01778723036561506, "entropy": 0.5015524982444701, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 168000, "num_agent_steps_sampled": 168000, "num_steps_trained": 168000, "num_agent_steps_trained": 168000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1680, "training_iteration": 42, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-36-03", "timestamp": 1651052163, "time_this_iter_s": 24.427220106124878, "time_total_s": 1227.5257833003998, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1227.5257833003998, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 24.694117647058825, "ram_util_percent": 94.4470588235294}}
{"episode_reward_max": -9.199999999999994, "episode_reward_min": -540.4999999999998, "episode_reward_mean": -50.652000000000015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.9, -45.40000000000007, -57.59999999999993, -52.300000000000026, -65.70000000000003, -13.299999999999974, -74.70000000000005, -34.200000000000024, -41.90000000000007, -17.099999999999998, -10.099999999999994, -55.80000000000006, -80.79999999999983, -45.90000000000006, -33.40000000000007, -56.30000000000005, -59.60000000000006, -60.8, -57.00000000000008, -61.4, -27.099999999999998, -56.1, -51.00000000000004, -55.90000000000008, -25.5, -52.20000000000006, -27.100000000000005, -14.299999999999981, -58.2, -80.80000000000003, -41.90000000000006, -46.500000000000014, -30.600000000000048, -11.599999999999996, -9.999999999999984, -39.80000000000005, -11.299999999999978, -62.3, -39.500000000000014, -79.29999999999998, -39.700000000000074, -59.5, -13.599999999999993, -65.20000000000007, -44.20000000000006, -57.80000000000011, -10.799999999999981, -72.8, -76.40000000000005, -59.10000000000007, -540.4999999999998, -16.099999999999994, -13.799999999999978, -81.49999999999999, -21.60000000000002, -50.100000000000044, -56.30000000000009, -12.099999999999977, -52.10000000000001, -38.00000000000004, -33.800000000000004, -34.400000000000055, -13.799999999999974, -48.20000000000006, -32.60000000000004, -45.20000000000006, -29.100000000000037, -150.39999999999978, -43.30000000000007, -76.09999999999997, -137.0, -51.50000000000006, -35.900000000000006, -76.89999999999992, -12.799999999999978, -64.70000000000007, -27.20000000000001, -93.29999999999995, -45.89999999999991, -50.70000000000004, -43.70000000000007, -35.60000000000007, -11.499999999999991, -61.70000000000015, -10.399999999999983, -11.699999999999989, -48.10000000000001, -46.4, -57.099999999999994, -48.00000000000008, -86.3, -18.799999999999997, -9.199999999999994, -41.00000000000002, -12.699999999999994, -41.700000000000074, -87.69999999999999, -68.40000000000016, -15.199999999999994, -53.80000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.41126104513834, "mean_inference_ms": 0.7326791755595398, "mean_action_processing_ms": 0.03044035803335597, "mean_env_wait_ms": 3.0218290813446176, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 172000, "timesteps_this_iter": 0, "agent_timesteps_total": 172000, "timers": {"sample_time_ms": 22163.805, "sample_throughput": 180.474, "load_time_ms": 0.338, "load_throughput": 11850827.153, "learn_time_ms": 4347.802, "learn_throughput": 920.005}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 1.9606142519302265, "policy_loss": 0.001990586561301062, "vf_loss": 195.8534308730915, "vf_explained_var": 0.062320301673745596, "kl": 0.009536045960844614, "entropy": 0.4323931137720744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 172000, "num_agent_steps_sampled": 172000, "num_steps_trained": 172000, "num_agent_steps_trained": 172000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1720, "training_iteration": 43, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-36-25", "timestamp": 1651052185, "time_this_iter_s": 22.51633882522583, "time_total_s": 1250.0421221256256, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1250.0421221256256, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 18.1258064516129, "ram_util_percent": 94.49354838709678}}
{"episode_reward_max": -7.599999999999995, "episode_reward_min": -651.8000000000008, "episode_reward_mean": -58.06100000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.700000000000074, -59.5, -13.599999999999993, -65.20000000000007, -44.20000000000006, -57.80000000000011, -10.799999999999981, -72.8, -76.40000000000005, -59.10000000000007, -540.4999999999998, -16.099999999999994, -13.799999999999978, -81.49999999999999, -21.60000000000002, -50.100000000000044, -56.30000000000009, -12.099999999999977, -52.10000000000001, -38.00000000000004, -33.800000000000004, -34.400000000000055, -13.799999999999974, -48.20000000000006, -32.60000000000004, -45.20000000000006, -29.100000000000037, -150.39999999999978, -43.30000000000007, -76.09999999999997, -137.0, -51.50000000000006, -35.900000000000006, -76.89999999999992, -12.799999999999978, -64.70000000000007, -27.20000000000001, -93.29999999999995, -45.89999999999991, -50.70000000000004, -43.70000000000007, -35.60000000000007, -11.499999999999991, -61.70000000000015, -10.399999999999983, -11.699999999999989, -48.10000000000001, -46.4, -57.099999999999994, -48.00000000000008, -86.3, -18.799999999999997, -9.199999999999994, -41.00000000000002, -12.699999999999994, -41.700000000000074, -87.69999999999999, -68.40000000000016, -15.199999999999994, -53.80000000000005, -34.3, -28.70000000000001, -26.0, -51.60000000000007, -43.400000000000006, -37.500000000000014, -29.10000000000001, -54.40000000000005, -12.199999999999994, -53.40000000000004, -51.30000000000006, -67.70000000000007, -58.50000000000003, -54.100000000000065, -52.20000000000004, -91.9, -126.49999999999987, -43.400000000000055, -58.30000000000009, -10.200000000000001, -21.4, -12.199999999999992, -26.700000000000006, -90.3, -15.999999999999995, -7.599999999999995, -137.79999999999978, -69.10000000000001, -45.40000000000005, -54.4, -34.1, -35.2, -55.300000000000075, -36.7, -57.400000000000006, -52.30000000000004, -52.70000000000004, -651.8000000000008, -53.400000000000055, -18.599999999999994], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.37009620079554, "mean_inference_ms": 0.7340889594577276, "mean_action_processing_ms": 0.03047638616960204, "mean_env_wait_ms": 3.024467220373466, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 176000, "timesteps_this_iter": 0, "agent_timesteps_total": 176000, "timers": {"sample_time_ms": 22144.714, "sample_throughput": 180.63, "load_time_ms": 0.339, "load_throughput": 11804134.243, "learn_time_ms": 4356.811, "learn_throughput": 918.103}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 28.401012956062633, "policy_loss": -0.004873970424836522, "vf_loss": 2840.5817127432874, "vf_explained_var": -0.06295294172020369, "kl": 0.007490145058897752, "entropy": 0.41227353140711787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 176000, "num_agent_steps_sampled": 176000, "num_steps_trained": 176000, "num_agent_steps_trained": 176000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1760, "training_iteration": 44, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-36-48", "timestamp": 1651052208, "time_this_iter_s": 22.127190113067627, "time_total_s": 1272.1693122386932, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1272.1693122386932, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 20.220000000000002, "ram_util_percent": 94.51666666666667}}
{"episode_reward_max": -7.599999999999995, "episode_reward_min": -651.8000000000008, "episode_reward_mean": -56.494000000000035, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.70000000000007, -35.60000000000007, -11.499999999999991, -61.70000000000015, -10.399999999999983, -11.699999999999989, -48.10000000000001, -46.4, -57.099999999999994, -48.00000000000008, -86.3, -18.799999999999997, -9.199999999999994, -41.00000000000002, -12.699999999999994, -41.700000000000074, -87.69999999999999, -68.40000000000016, -15.199999999999994, -53.80000000000005, -34.3, -28.70000000000001, -26.0, -51.60000000000007, -43.400000000000006, -37.500000000000014, -29.10000000000001, -54.40000000000005, -12.199999999999994, -53.40000000000004, -51.30000000000006, -67.70000000000007, -58.50000000000003, -54.100000000000065, -52.20000000000004, -91.9, -126.49999999999987, -43.400000000000055, -58.30000000000009, -10.200000000000001, -21.4, -12.199999999999992, -26.700000000000006, -90.3, -15.999999999999995, -7.599999999999995, -137.79999999999978, -69.10000000000001, -45.40000000000005, -54.4, -34.1, -35.2, -55.300000000000075, -36.7, -57.400000000000006, -52.30000000000004, -52.70000000000004, -651.8000000000008, -53.400000000000055, -18.599999999999994, -34.3, -29.800000000000047, -34.0, -80.79999999999998, -12.999999999999993, -33.0, -32.099999999999994, -15.099999999999989, -33.20000000000002, -52.70000000000004, -33.7, -31.40000000000001, -36.000000000000014, -13.699999999999973, -46.00000000000006, -46.50000000000003, -78.39999999999998, -14.499999999999972, -53.60000000000005, -113.89999999999996, -48.600000000000044, -11.499999999999975, -481.8000000000006, -51.000000000000114, -57.30000000000008, -59.000000000000085, -51.9, -112.69999999999999, -28.900000000000013, -52.900000000000006, -65.50000000000007, -46.20000000000003, -100.4, -65.3, -39.00000000000006, -56.0, -51.000000000000036, -17.499999999999996, -46.10000000000004, -59.000000000000014], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3305351516270623, "mean_inference_ms": 0.734442397500441, "mean_action_processing_ms": 0.03047475743143147, "mean_env_wait_ms": 3.0246703189115123, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 180000, "timesteps_this_iter": 0, "agent_timesteps_total": 180000, "timers": {"sample_time_ms": 22204.714, "sample_throughput": 180.142, "load_time_ms": 0.339, "load_throughput": 11784235.443, "learn_time_ms": 4367.045, "learn_throughput": 915.951}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 15.295603962771354, "policy_loss": -0.004341596507176917, "vf_loss": 1529.9863610975203, "vf_explained_var": -0.05427325258972824, "kl": 0.008794960395371821, "entropy": 0.35745276405766446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 180000, "num_agent_steps_sampled": 180000, "num_steps_trained": 180000, "num_agent_steps_trained": 180000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1800, "training_iteration": 45, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-37-10", "timestamp": 1651052230, "time_this_iter_s": 21.896053314208984, "time_total_s": 1294.0653655529022, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1294.0653655529022, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 12.523333333333333, "ram_util_percent": 94.50333333333333}}
{"episode_reward_max": -7.599999999999995, "episode_reward_min": -651.8000000000008, "episode_reward_mean": -57.92000000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.4, -12.199999999999992, -26.700000000000006, -90.3, -15.999999999999995, -7.599999999999995, -137.79999999999978, -69.10000000000001, -45.40000000000005, -54.4, -34.1, -35.2, -55.300000000000075, -36.7, -57.400000000000006, -52.30000000000004, -52.70000000000004, -651.8000000000008, -53.400000000000055, -18.599999999999994, -34.3, -29.800000000000047, -34.0, -80.79999999999998, -12.999999999999993, -33.0, -32.099999999999994, -15.099999999999989, -33.20000000000002, -52.70000000000004, -33.7, -31.40000000000001, -36.000000000000014, -13.699999999999973, -46.00000000000006, -46.50000000000003, -78.39999999999998, -14.499999999999972, -53.60000000000005, -113.89999999999996, -48.600000000000044, -11.499999999999975, -481.8000000000006, -51.000000000000114, -57.30000000000008, -59.000000000000085, -51.9, -112.69999999999999, -28.900000000000013, -52.900000000000006, -65.50000000000007, -46.20000000000003, -100.4, -65.3, -39.00000000000006, -56.0, -51.000000000000036, -17.499999999999996, -46.10000000000004, -59.000000000000014, -28.800000000000022, -53.60000000000008, -61.30000000000005, -11.699999999999992, -36.20000000000004, -53.40000000000001, -15.99999999999999, -51.60000000000005, -10.499999999999998, -19.200000000000003, -20.400000000000027, -41.60000000000003, -85.3, -16.599999999999987, -54.30000000000007, -14.19999999999998, -10.699999999999987, -53.700000000000074, -32.90000000000001, -58.7, -45.9, -150.3, -25.200000000000003, -14.399999999999988, -25.400000000000023, -242.79999999999959, -54.100000000000065, -11.399999999999993, -9.599999999999985, -102.0, -47.70000000000002, -26.30000000000002, -117.39999999999986, -42.09999999999994, -53.70000000000003, -64.30000000000007, -77.60000000000002, -42.60000000000005, -38.30000000000002, -14.499999999999982], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.292768245884479, "mean_inference_ms": 0.7359260981601449, "mean_action_processing_ms": 0.03049342840830728, "mean_env_wait_ms": 3.025493371745503, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 184000, "timesteps_this_iter": 0, "agent_timesteps_total": 184000, "timers": {"sample_time_ms": 22382.397, "sample_throughput": 178.712, "load_time_ms": 0.341, "load_throughput": 11745460.655, "learn_time_ms": 4438.781, "learn_throughput": 901.148}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 3.4346531974372043, "policy_loss": -0.0019675580334038503, "vf_loss": 343.6547810585268, "vf_explained_var": -0.15023931578923297, "kl": 0.007786407502282266, "entropy": 0.4506272885107225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 184000, "num_agent_steps_sampled": 184000, "num_steps_trained": 184000, "num_agent_steps_trained": 184000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1840, "training_iteration": 46, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-37-33", "timestamp": 1651052253, "time_this_iter_s": 23.771982669830322, "time_total_s": 1317.8373482227325, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1317.8373482227325, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 30.39677419354839, "ram_util_percent": 94.83225806451611}}
{"episode_reward_max": -9.599999999999985, "episode_reward_min": -481.8000000000006, "episode_reward_mean": -49.12900000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.600000000000044, -11.499999999999975, -481.8000000000006, -51.000000000000114, -57.30000000000008, -59.000000000000085, -51.9, -112.69999999999999, -28.900000000000013, -52.900000000000006, -65.50000000000007, -46.20000000000003, -100.4, -65.3, -39.00000000000006, -56.0, -51.000000000000036, -17.499999999999996, -46.10000000000004, -59.000000000000014, -28.800000000000022, -53.60000000000008, -61.30000000000005, -11.699999999999992, -36.20000000000004, -53.40000000000001, -15.99999999999999, -51.60000000000005, -10.499999999999998, -19.200000000000003, -20.400000000000027, -41.60000000000003, -85.3, -16.599999999999987, -54.30000000000007, -14.19999999999998, -10.699999999999987, -53.700000000000074, -32.90000000000001, -58.7, -45.9, -150.3, -25.200000000000003, -14.399999999999988, -25.400000000000023, -242.79999999999959, -54.100000000000065, -11.399999999999993, -9.599999999999985, -102.0, -47.70000000000002, -26.30000000000002, -117.39999999999986, -42.09999999999994, -53.70000000000003, -64.30000000000007, -77.60000000000002, -42.60000000000005, -38.30000000000002, -14.499999999999982, -27.7, -11.499999999999979, -55.800000000000075, -35.50000000000001, -11.299999999999976, -29.70000000000003, -55.20000000000008, -10.799999999999978, -69.10000000000001, -32.600000000000044, -12.799999999999986, -52.300000000000026, -28.700000000000006, -40.20000000000003, -53.000000000000064, -17.799999999999997, -30.60000000000001, -12.599999999999989, -12.699999999999996, -35.400000000000034, -35.399999999999984, -51.10000000000004, -63.2, -20.000000000000025, -16.19999999999999, -43.70000000000009, -26.900000000000006, -68.39999999999999, -46.599999999999994, -58.00000000000003, -41.9, -43.3, -57.10000000000008, -35.900000000000006, -51.800000000000026, -56.99999999999989, -20.700000000000006, -39.800000000000054, -51.00000000000001, -11.699999999999974], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.256764918168063, "mean_inference_ms": 0.7369081734174658, "mean_action_processing_ms": 0.030504172065744118, "mean_env_wait_ms": 3.0263894250898344, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 188000, "timesteps_this_iter": 0, "agent_timesteps_total": 188000, "timers": {"sample_time_ms": 22490.056, "sample_throughput": 177.856, "load_time_ms": 0.275, "load_throughput": 14552186.66, "learn_time_ms": 4388.324, "learn_throughput": 911.51}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 0.8487071325401625, "policy_loss": 0.0044192301510002025, "vf_loss": 84.41994958077707, "vf_explained_var": 0.044398377339045204, "kl": 0.009432217405208271, "entropy": 0.3632865779902986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 188000, "num_agent_steps_sampled": 188000, "num_steps_trained": 188000, "num_agent_steps_trained": 188000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1880, "training_iteration": 47, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-37-55", "timestamp": 1651052275, "time_this_iter_s": 21.489961862564087, "time_total_s": 1339.3273100852966, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1339.3273100852966, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 13.975862068965517, "ram_util_percent": 94.77241379310342}}
{"episode_reward_max": -9.599999999999985, "episode_reward_min": -242.79999999999959, "episode_reward_mean": -45.03200000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.9, -150.3, -25.200000000000003, -14.399999999999988, -25.400000000000023, -242.79999999999959, -54.100000000000065, -11.399999999999993, -9.599999999999985, -102.0, -47.70000000000002, -26.30000000000002, -117.39999999999986, -42.09999999999994, -53.70000000000003, -64.30000000000007, -77.60000000000002, -42.60000000000005, -38.30000000000002, -14.499999999999982, -27.7, -11.499999999999979, -55.800000000000075, -35.50000000000001, -11.299999999999976, -29.70000000000003, -55.20000000000008, -10.799999999999978, -69.10000000000001, -32.600000000000044, -12.799999999999986, -52.300000000000026, -28.700000000000006, -40.20000000000003, -53.000000000000064, -17.799999999999997, -30.60000000000001, -12.599999999999989, -12.699999999999996, -35.400000000000034, -35.399999999999984, -51.10000000000004, -63.2, -20.000000000000025, -16.19999999999999, -43.70000000000009, -26.900000000000006, -68.39999999999999, -46.599999999999994, -58.00000000000003, -41.9, -43.3, -57.10000000000008, -35.900000000000006, -51.800000000000026, -56.99999999999989, -20.700000000000006, -39.800000000000054, -51.00000000000001, -11.699999999999974, -11.299999999999976, -40.29999999999993, -48.00000000000008, -118.69999999999986, -30.80000000000002, -10.399999999999979, -34.7, -44.700000000000024, -34.800000000000054, -55.70000000000002, -50.30000000000005, -9.799999999999981, -39.50000000000006, -27.9, -26.800000000000004, -45.80000000000006, -65.50000000000011, -76.0, -52.200000000000024, -66.30000000000007, -42.50000000000002, -82.4, -45.300000000000004, -52.70000000000009, -75.69999999999999, -49.00000000000001, -32.300000000000004, -14.499999999999984, -26.200000000000003, -46.80000000000008, -36.10000000000008, -30.200000000000003, -28.500000000000007, -10.899999999999977, -77.69999999999999, -35.80000000000002, -44.6, -94.9, -55.80000000000006, -51.200000000000024], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2221134361684522, "mean_inference_ms": 0.7364563754796964, "mean_action_processing_ms": 0.030484073273690467, "mean_env_wait_ms": 3.025279147605448, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 192000, "timesteps_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"sample_time_ms": 22442.875, "sample_throughput": 178.23, "load_time_ms": 0.279, "load_throughput": 14341952.471, "learn_time_ms": 4396.712, "learn_throughput": 909.771}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 1.3650481037520152, "policy_loss": 0.005378468659385959, "vf_loss": 135.9595908257269, "vf_explained_var": 0.19855712088205482, "kl": 0.007867753398257606, "entropy": 0.2684653904329064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 192000, "num_agent_steps_sampled": 192000, "num_steps_trained": 192000, "num_agent_steps_trained": 192000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1920, "training_iteration": 48, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-38-15", "timestamp": 1651052295, "time_this_iter_s": 20.576014041900635, "time_total_s": 1359.9033241271973, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1359.9033241271973, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 14.964285714285714, "ram_util_percent": 94.6285714285714}}
{"episode_reward_max": -9.799999999999981, "episode_reward_min": -141.3999999999999, "episode_reward_mean": -45.51800000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.399999999999984, -51.10000000000004, -63.2, -20.000000000000025, -16.19999999999999, -43.70000000000009, -26.900000000000006, -68.39999999999999, -46.599999999999994, -58.00000000000003, -41.9, -43.3, -57.10000000000008, -35.900000000000006, -51.800000000000026, -56.99999999999989, -20.700000000000006, -39.800000000000054, -51.00000000000001, -11.699999999999974, -11.299999999999976, -40.29999999999993, -48.00000000000008, -118.69999999999986, -30.80000000000002, -10.399999999999979, -34.7, -44.700000000000024, -34.800000000000054, -55.70000000000002, -50.30000000000005, -9.799999999999981, -39.50000000000006, -27.9, -26.800000000000004, -45.80000000000006, -65.50000000000011, -76.0, -52.200000000000024, -66.30000000000007, -42.50000000000002, -82.4, -45.300000000000004, -52.70000000000009, -75.69999999999999, -49.00000000000001, -32.300000000000004, -14.499999999999984, -26.200000000000003, -46.80000000000008, -36.10000000000008, -30.200000000000003, -28.500000000000007, -10.899999999999977, -77.69999999999999, -35.80000000000002, -44.6, -94.9, -55.80000000000006, -51.200000000000024, -52.40000000000003, -39.500000000000036, -51.800000000000026, -27.499999999999986, -36.10000000000006, -31.3, -17.599999999999998, -141.3999999999999, -95.20000000000022, -13.29999999999999, -17.59999999999999, -56.000000000000064, -55.20000000000007, -67.90000000000003, -48.40000000000008, -13.899999999999988, -10.299999999999995, -89.99999999999996, -29.699999999999996, -63.70000000000009, -64.40000000000009, -11.899999999999993, -35.300000000000004, -78.30000000000001, -56.30000000000001, -14.799999999999981, -52.60000000000003, -62.10000000000008, -52.30000000000003, -66.40000000000006, -110.6999999999999, -46.699999999999996, -42.00000000000007, -55.90000000000006, -22.000000000000036, -66.30000000000004, -15.699999999999989, -13.59999999999999, -13.999999999999998, -49.400000000000034], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1886951800257854, "mean_inference_ms": 0.7347846062473326, "mean_action_processing_ms": 0.03044085655935582, "mean_env_wait_ms": 3.0224370839733217, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 196000, "timesteps_this_iter": 0, "agent_timesteps_total": 196000, "timers": {"sample_time_ms": 22380.999, "sample_throughput": 178.723, "load_time_ms": 0.289, "load_throughput": 13846014.69, "learn_time_ms": 4398.504, "learn_throughput": 909.4}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.009375, "cur_lr": 0.00010000000000000003, "total_loss": 1.8263150046379255, "policy_loss": 0.007405600688790762, "vf_loss": 181.88684190729612, "vf_explained_var": -0.06402190039234777, "kl": 0.004374050751488462, "entropy": 0.3546437859294876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 196000, "num_agent_steps_sampled": 196000, "num_steps_trained": 196000, "num_agent_steps_trained": 196000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 1960, "training_iteration": 49, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-38-36", "timestamp": 1651052316, "time_this_iter_s": 20.748058080673218, "time_total_s": 1380.6513822078705, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1380.6513822078705, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 13.30357142857143, "ram_util_percent": 94.51428571428572}}
{"episode_reward_max": -10.199999999999992, "episode_reward_min": -141.3999999999999, "episode_reward_mean": -43.77300000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-42.50000000000002, -82.4, -45.300000000000004, -52.70000000000009, -75.69999999999999, -49.00000000000001, -32.300000000000004, -14.499999999999984, -26.200000000000003, -46.80000000000008, -36.10000000000008, -30.200000000000003, -28.500000000000007, -10.899999999999977, -77.69999999999999, -35.80000000000002, -44.6, -94.9, -55.80000000000006, -51.200000000000024, -52.40000000000003, -39.500000000000036, -51.800000000000026, -27.499999999999986, -36.10000000000006, -31.3, -17.599999999999998, -141.3999999999999, -95.20000000000022, -13.29999999999999, -17.59999999999999, -56.000000000000064, -55.20000000000007, -67.90000000000003, -48.40000000000008, -13.899999999999988, -10.299999999999995, -89.99999999999996, -29.699999999999996, -63.70000000000009, -64.40000000000009, -11.899999999999993, -35.300000000000004, -78.30000000000001, -56.30000000000001, -14.799999999999981, -52.60000000000003, -62.10000000000008, -52.30000000000003, -66.40000000000006, -110.6999999999999, -46.699999999999996, -42.00000000000007, -55.90000000000006, -22.000000000000036, -66.30000000000004, -15.699999999999989, -13.59999999999999, -13.999999999999998, -49.400000000000034, -14.799999999999994, -27.10000000000001, -42.0, -49.00000000000005, -24.40000000000004, -52.600000000000016, -45.7, -55.40000000000006, -40.800000000000054, -10.199999999999992, -13.299999999999986, -60.100000000000094, -33.79999999999997, -53.70000000000003, -30.500000000000007, -56.100000000000065, -31.500000000000007, -11.899999999999995, -57.000000000000085, -30.40000000000003, -34.39999999999999, -34.8, -52.30000000000003, -70.40000000000006, -36.500000000000014, -44.40000000000007, -60.800000000000075, -50.60000000000003, -42.50000000000007, -16.79999999999999, -68.29999999999997, -35.60000000000005, -12.499999999999975, -26.100000000000062, -18.9, -25.80000000000002, -33.09999999999998, -50.700000000000095, -17.799999999999997, -82.1], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1562348644255636, "mean_inference_ms": 0.7327980291294725, "mean_action_processing_ms": 0.030390431055617038, "mean_env_wait_ms": 3.0187730262309582, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 200000, "timesteps_this_iter": 0, "agent_timesteps_total": 200000, "timers": {"sample_time_ms": 22285.443, "sample_throughput": 179.489, "load_time_ms": 0.277, "load_throughput": 14444439.087, "learn_time_ms": 4352.57, "learn_throughput": 918.997}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0046875, "cur_lr": 0.00010000000000000003, "total_loss": 0.8318220805657166, "policy_loss": -0.005537718893479436, "vf_loss": 83.73326989655854, "vf_explained_var": 0.13921315734104445, "kl": 0.005786211827364986, "entropy": 0.2687842870992358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 200000, "num_agent_steps_sampled": 200000, "num_steps_trained": 200000, "num_agent_steps_trained": 200000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2000, "training_iteration": 50, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-38-56", "timestamp": 1651052336, "time_this_iter_s": 20.073922872543335, "time_total_s": 1400.7253050804138, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1400.7253050804138, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 15.996296296296295, "ram_util_percent": 94.45555555555556}}
{"episode_reward_max": -6.299999999999995, "episode_reward_min": -152.3, "episode_reward_mean": -42.378000000000014, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.40000000000009, -11.899999999999993, -35.300000000000004, -78.30000000000001, -56.30000000000001, -14.799999999999981, -52.60000000000003, -62.10000000000008, -52.30000000000003, -66.40000000000006, -110.6999999999999, -46.699999999999996, -42.00000000000007, -55.90000000000006, -22.000000000000036, -66.30000000000004, -15.699999999999989, -13.59999999999999, -13.999999999999998, -49.400000000000034, -14.799999999999994, -27.10000000000001, -42.0, -49.00000000000005, -24.40000000000004, -52.600000000000016, -45.7, -55.40000000000006, -40.800000000000054, -10.199999999999992, -13.299999999999986, -60.100000000000094, -33.79999999999997, -53.70000000000003, -30.500000000000007, -56.100000000000065, -31.500000000000007, -11.899999999999995, -57.000000000000085, -30.40000000000003, -34.39999999999999, -34.8, -52.30000000000003, -70.40000000000006, -36.500000000000014, -44.40000000000007, -60.800000000000075, -50.60000000000003, -42.50000000000007, -16.79999999999999, -68.29999999999997, -35.60000000000005, -12.499999999999975, -26.100000000000062, -18.9, -25.80000000000002, -33.09999999999998, -50.700000000000095, -17.799999999999997, -82.1, -38.7, -71.60000000000002, -29.500000000000004, -21.200000000000006, -40.60000000000006, -55.600000000000065, -64.70000000000005, -41.80000000000004, -33.00000000000001, -41.4, -12.899999999999993, -12.999999999999996, -36.000000000000064, -51.400000000000006, -33.20000000000002, -152.3, -75.70000000000003, -37.3, -24.499999999999993, -54.10000000000006, -14.799999999999983, -27.89999999999999, -27.700000000000003, -13.599999999999996, -74.79999999999997, -48.10000000000006, -57.20000000000008, -6.299999999999995, -12.499999999999975, -38.199999999999996, -33.600000000000044, -52.400000000000034, -76.69999999999997, -12.299999999999976, -21.0, -35.5, -142.9, -50.90000000000004, -36.500000000000014, -41.00000000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1247993367277176, "mean_inference_ms": 0.7310420718687163, "mean_action_processing_ms": 0.030334964656559684, "mean_env_wait_ms": 3.0149857252084384, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 204000, "timesteps_this_iter": 0, "agent_timesteps_total": 204000, "timers": {"sample_time_ms": 21935.167, "sample_throughput": 182.356, "load_time_ms": 0.27, "load_throughput": 14814318.764, "learn_time_ms": 4249.987, "learn_throughput": 941.179}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0046875, "cur_lr": 0.00010000000000000003, "total_loss": 1.7545241637510918, "policy_loss": -0.0033308082760902503, "vf_loss": 175.78207655670823, "vf_explained_var": 0.00897858879899466, "kl": 0.007307232024293857, "entropy": 0.338119262969622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 204000, "num_agent_steps_sampled": 204000, "num_steps_trained": 204000, "num_agent_steps_trained": 204000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2040, "training_iteration": 51, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-39-17", "timestamp": 1651052357, "time_this_iter_s": 20.452218055725098, "time_total_s": 1421.177523136139, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1421.177523136139, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 15.117857142857144, "ram_util_percent": 94.2785714285714}}
{"episode_reward_max": -6.299999999999995, "episode_reward_min": -152.3, "episode_reward_mean": -40.710000000000015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.39999999999999, -34.8, -52.30000000000003, -70.40000000000006, -36.500000000000014, -44.40000000000007, -60.800000000000075, -50.60000000000003, -42.50000000000007, -16.79999999999999, -68.29999999999997, -35.60000000000005, -12.499999999999975, -26.100000000000062, -18.9, -25.80000000000002, -33.09999999999998, -50.700000000000095, -17.799999999999997, -82.1, -38.7, -71.60000000000002, -29.500000000000004, -21.200000000000006, -40.60000000000006, -55.600000000000065, -64.70000000000005, -41.80000000000004, -33.00000000000001, -41.4, -12.899999999999993, -12.999999999999996, -36.000000000000064, -51.400000000000006, -33.20000000000002, -152.3, -75.70000000000003, -37.3, -24.499999999999993, -54.10000000000006, -14.799999999999983, -27.89999999999999, -27.700000000000003, -13.599999999999996, -74.79999999999997, -48.10000000000006, -57.20000000000008, -6.299999999999995, -12.499999999999975, -38.199999999999996, -33.600000000000044, -52.400000000000034, -76.69999999999997, -12.299999999999976, -21.0, -35.5, -142.9, -50.90000000000004, -36.500000000000014, -41.00000000000007, -35.5, -34.400000000000006, -9.99999999999998, -54.80000000000005, -33.100000000000016, -39.20000000000002, -16.4, -45.80000000000006, -33.2, -14.799999999999992, -107.60000000000001, -50.40000000000003, -123.59999999999982, -28.900000000000045, -11.899999999999977, -53.10000000000008, -9.799999999999981, -36.70000000000005, -13.599999999999998, -19.600000000000033, -103.1, -12.299999999999976, -13.99999999999999, -10.5, -51.00000000000004, -40.50000000000005, -34.60000000000001, -19.900000000000016, -33.90000000000002, -51.800000000000026, -38.59999999999997, -34.4, -43.800000000000026, -43.00000000000001, -41.40000000000002, -18.199999999999996, -50.10000000000006, -55.90000000000006, -25.000000000000036, -9.799999999999981], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.094304472533685, "mean_inference_ms": 0.7291386689931957, "mean_action_processing_ms": 0.030266158328221538, "mean_env_wait_ms": 3.011085296110671, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 208000, "timesteps_this_iter": 0, "agent_timesteps_total": 208000, "timers": {"sample_time_ms": 21422.506, "sample_throughput": 186.72, "load_time_ms": 0.27, "load_throughput": 14789506.347, "learn_time_ms": 4212.929, "learn_throughput": 949.458}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0046875, "cur_lr": 0.00010000000000000003, "total_loss": 1.2910137157208756, "policy_loss": -0.0026500636831887307, "vf_loss": 129.3627841457244, "vf_explained_var": 0.008677782294570759, "kl": 0.007672641872618551, "entropy": 0.33879124972047986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 208000, "num_agent_steps_sampled": 208000, "num_steps_trained": 208000, "num_agent_steps_trained": 208000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2080, "training_iteration": 52, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-39-37", "timestamp": 1651052377, "time_this_iter_s": 19.96790385246277, "time_total_s": 1441.1454269886017, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1441.1454269886017, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 11.003703703703705, "ram_util_percent": 94.09259259259258}}
{"episode_reward_max": -6.299999999999995, "episode_reward_min": -142.9, "episode_reward_mean": -39.998000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.799999999999983, -27.89999999999999, -27.700000000000003, -13.599999999999996, -74.79999999999997, -48.10000000000006, -57.20000000000008, -6.299999999999995, -12.499999999999975, -38.199999999999996, -33.600000000000044, -52.400000000000034, -76.69999999999997, -12.299999999999976, -21.0, -35.5, -142.9, -50.90000000000004, -36.500000000000014, -41.00000000000007, -35.5, -34.400000000000006, -9.99999999999998, -54.80000000000005, -33.100000000000016, -39.20000000000002, -16.4, -45.80000000000006, -33.2, -14.799999999999992, -107.60000000000001, -50.40000000000003, -123.59999999999982, -28.900000000000045, -11.899999999999977, -53.10000000000008, -9.799999999999981, -36.70000000000005, -13.599999999999998, -19.600000000000033, -103.1, -12.299999999999976, -13.99999999999999, -10.5, -51.00000000000004, -40.50000000000005, -34.60000000000001, -19.900000000000016, -33.90000000000002, -51.800000000000026, -38.59999999999997, -34.4, -43.800000000000026, -43.00000000000001, -41.40000000000002, -18.199999999999996, -50.10000000000006, -55.90000000000006, -25.000000000000036, -9.799999999999981, -52.50000000000003, -142.6999999999998, -47.70000000000001, -45.900000000000084, -43.3, -64.3000000000001, -41.0, -25.60000000000001, -19.199999999999996, -24.400000000000006, -61.10000000000002, -50.600000000000044, -110.9999999999999, -31.400000000000045, -9.199999999999989, -61.60000000000005, -30.700000000000045, -50.80000000000003, -15.099999999999994, -33.00000000000004, -12.49999999999998, -41.900000000000055, -32.09999999999999, -41.500000000000085, -23.300000000000026, -34.40000000000001, -32.90000000000001, -41.300000000000026, -11.49999999999999, -55.600000000000016, -53.50000000000001, -67.20000000000007, -26.300000000000004, -48.00000000000007, -32.90000000000002, -30.90000000000001, -11.199999999999983, -35.5, -50.70000000000001, -27.40000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0652188863166514, "mean_inference_ms": 0.7281788674012182, "mean_action_processing_ms": 0.06181778475735219, "mean_env_wait_ms": 3.009524157514369, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 212000, "timesteps_this_iter": 0, "agent_timesteps_total": 212000, "timers": {"sample_time_ms": 21401.608, "sample_throughput": 186.902, "load_time_ms": 0.269, "load_throughput": 14878694.573, "learn_time_ms": 4218.797, "learn_throughput": 948.138}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0046875, "cur_lr": 0.00010000000000000003, "total_loss": 1.4355241973118316, "policy_loss": -0.001520486400332502, "vf_loss": 143.70135501841062, "vf_explained_var": 0.09307779644125251, "kl": 0.0066479552828055555, "entropy": 0.24010362105984842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 212000, "num_agent_steps_sampled": 212000, "num_steps_trained": 212000, "num_agent_steps_trained": 212000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2120, "training_iteration": 53, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-40-16", "timestamp": 1651052416, "time_this_iter_s": 39.24904489517212, "time_total_s": 1480.3944718837738, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1480.3944718837738, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 22.919354838709673, "ram_util_percent": 94.33870967741933}}
{"episode_reward_max": -9.199999999999989, "episode_reward_min": -142.6999999999998, "episode_reward_mean": -41.37900000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-103.1, -12.299999999999976, -13.99999999999999, -10.5, -51.00000000000004, -40.50000000000005, -34.60000000000001, -19.900000000000016, -33.90000000000002, -51.800000000000026, -38.59999999999997, -34.4, -43.800000000000026, -43.00000000000001, -41.40000000000002, -18.199999999999996, -50.10000000000006, -55.90000000000006, -25.000000000000036, -9.799999999999981, -52.50000000000003, -142.6999999999998, -47.70000000000001, -45.900000000000084, -43.3, -64.3000000000001, -41.0, -25.60000000000001, -19.199999999999996, -24.400000000000006, -61.10000000000002, -50.600000000000044, -110.9999999999999, -31.400000000000045, -9.199999999999989, -61.60000000000005, -30.700000000000045, -50.80000000000003, -15.099999999999994, -33.00000000000004, -12.49999999999998, -41.900000000000055, -32.09999999999999, -41.500000000000085, -23.300000000000026, -34.40000000000001, -32.90000000000001, -41.300000000000026, -11.49999999999999, -55.600000000000016, -53.50000000000001, -67.20000000000007, -26.300000000000004, -48.00000000000007, -32.90000000000002, -30.90000000000001, -11.199999999999983, -35.5, -50.70000000000001, -27.40000000000002, -15.199999999999998, -32.70000000000006, -15.099999999999984, -50.10000000000006, -83.20000000000002, -14.799999999999972, -55.0, -116.00000000000001, -53.10000000000004, -12.799999999999999, -124.29999999999986, -28.700000000000003, -28.000000000000007, -43.10000000000002, -33.6, -50.400000000000034, -137.0, -39.20000000000006, -11.799999999999981, -55.500000000000085, -51.5, -43.80000000000006, -20.20000000000001, -56.80000000000006, -32.80000000000001, -51.60000000000002, -22.70000000000003, -31.200000000000014, -14.199999999999973, -36.300000000000026, -32.9, -68.80000000000004, -18.6, -51.100000000000044, -29.80000000000004, -56.300000000000026, -21.400000000000002, -41.70000000000003, -40.3, -12.799999999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.037524683385101, "mean_inference_ms": 0.7279152819969616, "mean_action_processing_ms": 0.09281253642043598, "mean_env_wait_ms": 3.0097656959688446, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 216000, "timesteps_this_iter": 0, "agent_timesteps_total": 216000, "timers": {"sample_time_ms": 21382.814, "sample_throughput": 187.066, "load_time_ms": 0.268, "load_throughput": 14939640.249, "learn_time_ms": 4249.22, "learn_throughput": 941.349}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0046875, "cur_lr": 0.00010000000000000003, "total_loss": 1.719717906151087, "policy_loss": 0.0023572152510525717, "vf_loss": 171.73359422786262, "vf_explained_var": 0.0015823082898252755, "kl": 0.005287187415382786, "entropy": 0.2873297192797225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 216000, "num_agent_steps_sampled": 216000, "num_steps_trained": 216000, "num_agent_steps_trained": 216000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2160, "training_iteration": 54, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-40-38", "timestamp": 1651052438, "time_this_iter_s": 22.20665407180786, "time_total_s": 1502.6011259555817, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1502.6011259555817, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 23.3, "ram_util_percent": 94.65999999999998}}
{"episode_reward_max": -10.799999999999999, "episode_reward_min": -137.0, "episode_reward_mean": -40.38200000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.49999999999998, -41.900000000000055, -32.09999999999999, -41.500000000000085, -23.300000000000026, -34.40000000000001, -32.90000000000001, -41.300000000000026, -11.49999999999999, -55.600000000000016, -53.50000000000001, -67.20000000000007, -26.300000000000004, -48.00000000000007, -32.90000000000002, -30.90000000000001, -11.199999999999983, -35.5, -50.70000000000001, -27.40000000000002, -15.199999999999998, -32.70000000000006, -15.099999999999984, -50.10000000000006, -83.20000000000002, -14.799999999999972, -55.0, -116.00000000000001, -53.10000000000004, -12.799999999999999, -124.29999999999986, -28.700000000000003, -28.000000000000007, -43.10000000000002, -33.6, -50.400000000000034, -137.0, -39.20000000000006, -11.799999999999981, -55.500000000000085, -51.5, -43.80000000000006, -20.20000000000001, -56.80000000000006, -32.80000000000001, -51.60000000000002, -22.70000000000003, -31.200000000000014, -14.199999999999973, -36.300000000000026, -32.9, -68.80000000000004, -18.6, -51.100000000000044, -29.80000000000004, -56.300000000000026, -21.400000000000002, -41.70000000000003, -40.3, -12.799999999999995, -33.40000000000005, -30.500000000000007, -33.4, -14.799999999999978, -32.800000000000004, -52.70000000000005, -77.20000000000005, -51.90000000000005, -12.29999999999998, -15.999999999999998, -52.40000000000005, -95.79999999999994, -37.100000000000044, -45.30000000000001, -73.00000000000006, -38.30000000000001, -18.4, -56.50000000000001, -40.4, -17.099999999999994, -109.8, -41.80000000000004, -51.90000000000007, -27.0, -34.00000000000001, -16.399999999999984, -52.60000000000007, -41.50000000000005, -12.199999999999976, -44.40000000000008, -32.90000000000005, -14.199999999999996, -33.50000000000006, -33.90000000000005, -11.699999999999978, -95.6, -10.799999999999999, -23.200000000000028, -12.799999999999974, -63.700000000000024], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0111265956503166, "mean_inference_ms": 0.7282861188468394, "mean_action_processing_ms": 0.10746943267781127, "mean_env_wait_ms": 3.010403236179968, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 220000, "timesteps_this_iter": 0, "agent_timesteps_total": 220000, "timers": {"sample_time_ms": 21432.874, "sample_throughput": 186.629, "load_time_ms": 0.264, "load_throughput": 15166530.465, "learn_time_ms": 4268.852, "learn_throughput": 937.02}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0046875, "cur_lr": 0.00010000000000000003, "total_loss": 1.160193167155188, "policy_loss": 0.004450018058020261, "vf_loss": 115.57201399854435, "vf_explained_var": -0.027022309905739242, "kl": 0.004913333701505963, "entropy": 0.2539596808693742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 220000, "num_agent_steps_sampled": 220000, "num_steps_trained": 220000, "num_agent_steps_trained": 220000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2200, "training_iteration": 55, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-41-01", "timestamp": 1651052461, "time_this_iter_s": 22.289310932159424, "time_total_s": 1524.890436887741, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1524.890436887741, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 15.030000000000001, "ram_util_percent": 94.54999999999998}}
{"episode_reward_max": -9.699999999999982, "episode_reward_min": -154.29999999999976, "episode_reward_mean": -43.36900000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.5, -43.80000000000006, -20.20000000000001, -56.80000000000006, -32.80000000000001, -51.60000000000002, -22.70000000000003, -31.200000000000014, -14.199999999999973, -36.300000000000026, -32.9, -68.80000000000004, -18.6, -51.100000000000044, -29.80000000000004, -56.300000000000026, -21.400000000000002, -41.70000000000003, -40.3, -12.799999999999995, -33.40000000000005, -30.500000000000007, -33.4, -14.799999999999978, -32.800000000000004, -52.70000000000005, -77.20000000000005, -51.90000000000005, -12.29999999999998, -15.999999999999998, -52.40000000000005, -95.79999999999994, -37.100000000000044, -45.30000000000001, -73.00000000000006, -38.30000000000001, -18.4, -56.50000000000001, -40.4, -17.099999999999994, -109.8, -41.80000000000004, -51.90000000000007, -27.0, -34.00000000000001, -16.399999999999984, -52.60000000000007, -41.50000000000005, -12.199999999999976, -44.40000000000008, -32.90000000000005, -14.199999999999996, -33.50000000000006, -33.90000000000005, -11.699999999999978, -95.6, -10.799999999999999, -23.200000000000028, -12.799999999999974, -63.700000000000024, -31.500000000000007, -47.70000000000009, -66.00000000000007, -53.20000000000001, -12.999999999999996, -46.20000000000007, -35.300000000000004, -60.9, -13.099999999999993, -126.59999999999987, -11.399999999999979, -40.60000000000005, -58.400000000000055, -37.70000000000006, -34.0, -51.900000000000034, -41.10000000000007, -11.799999999999995, -131.09999999999982, -30.30000000000001, -27.900000000000006, -20.299999999999997, -154.29999999999976, -54.10000000000006, -9.699999999999982, -12.79999999999997, -123.6, -26.400000000000038, -50.60000000000009, -132.2, -26.500000000000032, -38.00000000000001, -44.300000000000004, -46.600000000000065, -51.10000000000001, -27.700000000000003, -82.9, -53.9, -51.000000000000064, -33.20000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.986102743556115, "mean_inference_ms": 0.729751219495889, "mean_action_processing_ms": 0.10611244234701568, "mean_env_wait_ms": 3.012052030448412, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 224000, "timesteps_this_iter": 0, "agent_timesteps_total": 224000, "timers": {"sample_time_ms": 21498.488, "sample_throughput": 186.06, "load_time_ms": 0.267, "load_throughput": 14997064.45, "learn_time_ms": 4287.744, "learn_throughput": 932.891}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00234375, "cur_lr": 0.00010000000000000003, "total_loss": 2.575458489689896, "policy_loss": 0.00019761466531343359, "vf_loss": 257.5246773760806, "vf_explained_var": -0.007325477753916094, "kl": 0.006043092358621604, "entropy": 0.2587437732766072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 224000, "num_agent_steps_sampled": 224000, "num_steps_trained": 224000, "num_agent_steps_trained": 224000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2240, "training_iteration": 56, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-41-25", "timestamp": 1651052485, "time_this_iter_s": 24.4216411113739, "time_total_s": 1549.312077999115, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1549.312077999115, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 22.272727272727273, "ram_util_percent": 94.51212121212122}}
{"episode_reward_max": -9.699999999999982, "episode_reward_min": -154.29999999999976, "episode_reward_mean": -48.466000000000015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.8, -41.80000000000004, -51.90000000000007, -27.0, -34.00000000000001, -16.399999999999984, -52.60000000000007, -41.50000000000005, -12.199999999999976, -44.40000000000008, -32.90000000000005, -14.199999999999996, -33.50000000000006, -33.90000000000005, -11.699999999999978, -95.6, -10.799999999999999, -23.200000000000028, -12.799999999999974, -63.700000000000024, -31.500000000000007, -47.70000000000009, -66.00000000000007, -53.20000000000001, -12.999999999999996, -46.20000000000007, -35.300000000000004, -60.9, -13.099999999999993, -126.59999999999987, -11.399999999999979, -40.60000000000005, -58.400000000000055, -37.70000000000006, -34.0, -51.900000000000034, -41.10000000000007, -11.799999999999995, -131.09999999999982, -30.30000000000001, -27.900000000000006, -20.299999999999997, -154.29999999999976, -54.10000000000006, -9.699999999999982, -12.79999999999997, -123.6, -26.400000000000038, -50.60000000000009, -132.2, -26.500000000000032, -38.00000000000001, -44.300000000000004, -46.600000000000065, -51.10000000000001, -27.700000000000003, -82.9, -53.9, -51.000000000000064, -33.20000000000004, -112.5, -98.3000000000001, -52.10000000000006, -34.099999999999994, -15.299999999999999, -27.400000000000038, -60.80000000000006, -75.80000000000003, -56.70000000000008, -153.69999999999976, -12.799999999999974, -33.29999999999998, -14.799999999999974, -50.10000000000002, -152.39999999999975, -11.799999999999974, -53.10000000000003, -14.799999999999994, -12.799999999999974, -20.400000000000034, -98.99999999999994, -44.90000000000006, -15.999999999999993, -22.000000000000007, -40.70000000000003, -32.50000000000005, -54.50000000000007, -141.4, -90.29999999999983, -22.50000000000004, -14.799999999999972, -11.399999999999979, -32.900000000000006, -55.300000000000075, -52.70000000000004, -43.50000000000005, -82.6, -32.3, -107.6999999999999, -13.79999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9624384000552062, "mean_inference_ms": 0.7333678350221271, "mean_action_processing_ms": 0.10486479615822518, "mean_env_wait_ms": 3.017465862871141, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 228000, "timesteps_this_iter": 0, "agent_timesteps_total": 228000, "timers": {"sample_time_ms": 21895.646, "sample_throughput": 182.685, "load_time_ms": 0.28, "load_throughput": 14290643.952, "learn_time_ms": 4385.371, "learn_throughput": 912.124}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00234375, "cur_lr": 0.00010000000000000003, "total_loss": 2.89788052835702, "policy_loss": -0.00024978378787636756, "vf_loss": 289.81117443166755, "vf_explained_var": -0.09617639286543733, "kl": 0.007946338553634264, "entropy": 0.2957256565972041, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 228000, "num_agent_steps_sampled": 228000, "num_steps_trained": 228000, "num_agent_steps_trained": 228000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2280, "training_iteration": 57, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-41-51", "timestamp": 1651052511, "time_this_iter_s": 26.285346031188965, "time_total_s": 1575.597424030304, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1575.597424030304, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 28.811111111111114, "ram_util_percent": 94.73333333333336}}
{"episode_reward_max": -8.799999999999999, "episode_reward_min": -154.29999999999976, "episode_reward_mean": -44.985, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.900000000000006, -20.299999999999997, -154.29999999999976, -54.10000000000006, -9.699999999999982, -12.79999999999997, -123.6, -26.400000000000038, -50.60000000000009, -132.2, -26.500000000000032, -38.00000000000001, -44.300000000000004, -46.600000000000065, -51.10000000000001, -27.700000000000003, -82.9, -53.9, -51.000000000000064, -33.20000000000004, -112.5, -98.3000000000001, -52.10000000000006, -34.099999999999994, -15.299999999999999, -27.400000000000038, -60.80000000000006, -75.80000000000003, -56.70000000000008, -153.69999999999976, -12.799999999999974, -33.29999999999998, -14.799999999999974, -50.10000000000002, -152.39999999999975, -11.799999999999974, -53.10000000000003, -14.799999999999994, -12.799999999999974, -20.400000000000034, -98.99999999999994, -44.90000000000006, -15.999999999999993, -22.000000000000007, -40.70000000000003, -32.50000000000005, -54.50000000000007, -141.4, -90.29999999999983, -22.50000000000004, -14.799999999999972, -11.399999999999979, -32.900000000000006, -55.300000000000075, -52.70000000000004, -43.50000000000005, -82.6, -32.3, -107.6999999999999, -13.79999999999998, -13.799999999999994, -19.00000000000001, -11.799999999999981, -45.2, -28.79999999999996, -13.899999999999997, -90.19999999999996, -11.49999999999998, -47.10000000000001, -12.299999999999997, -33.40000000000004, -36.90000000000005, -33.10000000000003, -14.199999999999992, -41.20000000000008, -16.799999999999997, -32.1, -13.099999999999973, -15.799999999999995, -55.70000000000002, -105.8999999999999, -52.50000000000006, -33.599999999999994, -55.30000000000007, -21.700000000000056, -38.99999999999997, -8.799999999999999, -27.6, -50.400000000000055, -92.30000000000004, -54.10000000000004, -25.600000000000005, -26.10000000000001, -17.399999999999995, -49.90000000000003, -13.099999999999998, -11.699999999999978, -33.79999999999996, -20.70000000000004, -32.199999999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9395776432208987, "mean_inference_ms": 0.7365261114043719, "mean_action_processing_ms": 0.1036506464835599, "mean_env_wait_ms": 3.0228429770312757, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 232000, "timesteps_this_iter": 0, "agent_timesteps_total": 232000, "timers": {"sample_time_ms": 22178.984, "sample_throughput": 180.351, "load_time_ms": 0.274, "load_throughput": 14619393.517, "learn_time_ms": 4412.685, "learn_throughput": 906.478}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00234375, "cur_lr": 0.00010000000000000003, "total_loss": 1.0455357736497317, "policy_loss": -0.003517134431549298, "vf_loss": 104.9039832402301, "vf_explained_var": -0.1029773885203946, "kl": 0.005589973115888167, "entropy": 0.34459433631911396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 232000, "num_agent_steps_sampled": 232000, "num_steps_trained": 232000, "num_agent_steps_trained": 232000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2320, "training_iteration": 58, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-42-14", "timestamp": 1651052534, "time_this_iter_s": 22.706700086593628, "time_total_s": 1598.3041241168976, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1598.3041241168976, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 26.522580645161288, "ram_util_percent": 94.85161290322584}}
{"episode_reward_max": -8.799999999999999, "episode_reward_min": -141.4, "episode_reward_mean": -40.395, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-98.99999999999994, -44.90000000000006, -15.999999999999993, -22.000000000000007, -40.70000000000003, -32.50000000000005, -54.50000000000007, -141.4, -90.29999999999983, -22.50000000000004, -14.799999999999972, -11.399999999999979, -32.900000000000006, -55.300000000000075, -52.70000000000004, -43.50000000000005, -82.6, -32.3, -107.6999999999999, -13.79999999999998, -13.799999999999994, -19.00000000000001, -11.799999999999981, -45.2, -28.79999999999996, -13.899999999999997, -90.19999999999996, -11.49999999999998, -47.10000000000001, -12.299999999999997, -33.40000000000004, -36.90000000000005, -33.10000000000003, -14.199999999999992, -41.20000000000008, -16.799999999999997, -32.1, -13.099999999999973, -15.799999999999995, -55.70000000000002, -105.8999999999999, -52.50000000000006, -33.599999999999994, -55.30000000000007, -21.700000000000056, -38.99999999999997, -8.799999999999999, -27.6, -50.400000000000055, -92.30000000000004, -54.10000000000004, -25.600000000000005, -26.10000000000001, -17.399999999999995, -49.90000000000003, -13.099999999999998, -11.699999999999978, -33.79999999999996, -20.70000000000004, -32.199999999999996, -24.1, -13.499999999999996, -30.00000000000001, -98.69999999999995, -26.6, -68.10000000000004, -58.200000000000045, -54.79999999999992, -12.799999999999981, -92.4999999999999, -36.60000000000007, -45.60000000000008, -23.200000000000003, -33.300000000000004, -49.30000000000006, -45.900000000000055, -35.20000000000006, -44.90000000000001, -41.10000000000007, -47.600000000000065, -79.69999999999996, -49.500000000000014, -53.40000000000004, -53.00000000000005, -64.20000000000006, -38.00000000000006, -42.70000000000005, -68.60000000000012, -36.400000000000006, -31.800000000000008, -9.799999999999981, -14.799999999999981, -10.499999999999979, -52.60000000000003, -73.40000000000003, -12.799999999999974, -53.500000000000036, -16.199999999999996, -13.399999999999995, -14.799999999999974], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9168107547431898, "mean_inference_ms": 0.7382294806940365, "mean_action_processing_ms": 0.10243867688362275, "mean_env_wait_ms": 3.025989818301666, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 236000, "timesteps_this_iter": 0, "agent_timesteps_total": 236000, "timers": {"sample_time_ms": 22332.919, "sample_throughput": 179.108, "load_time_ms": 0.267, "load_throughput": 14986347.477, "learn_time_ms": 4508.351, "learn_throughput": 887.242}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00234375, "cur_lr": 0.00010000000000000003, "total_loss": 1.056930439709185, "policy_loss": 0.0010374451243889428, "vf_loss": 105.58833643287741, "vf_explained_var": 0.08605215671241924, "kl": 0.004118678633189851, "entropy": 0.28315050263478553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 236000, "num_agent_steps_sampled": 236000, "num_steps_trained": 236000, "num_agent_steps_trained": 236000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2360, "training_iteration": 59, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-42-37", "timestamp": 1651052557, "time_this_iter_s": 22.96762490272522, "time_total_s": 1621.2717490196228, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1621.2717490196228, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 26.661290322580644, "ram_util_percent": 94.98387096774195}}
{"episode_reward_max": -8.799999999999999, "episode_reward_min": -136.8, "episode_reward_mean": -42.94000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.8999999999999, -52.50000000000006, -33.599999999999994, -55.30000000000007, -21.700000000000056, -38.99999999999997, -8.799999999999999, -27.6, -50.400000000000055, -92.30000000000004, -54.10000000000004, -25.600000000000005, -26.10000000000001, -17.399999999999995, -49.90000000000003, -13.099999999999998, -11.699999999999978, -33.79999999999996, -20.70000000000004, -32.199999999999996, -24.1, -13.499999999999996, -30.00000000000001, -98.69999999999995, -26.6, -68.10000000000004, -58.200000000000045, -54.79999999999992, -12.799999999999981, -92.4999999999999, -36.60000000000007, -45.60000000000008, -23.200000000000003, -33.300000000000004, -49.30000000000006, -45.900000000000055, -35.20000000000006, -44.90000000000001, -41.10000000000007, -47.600000000000065, -79.69999999999996, -49.500000000000014, -53.40000000000004, -53.00000000000005, -64.20000000000006, -38.00000000000006, -42.70000000000005, -68.60000000000012, -36.400000000000006, -31.800000000000008, -9.799999999999981, -14.799999999999981, -10.499999999999979, -52.60000000000003, -73.40000000000003, -12.799999999999974, -53.500000000000036, -16.199999999999996, -13.399999999999995, -14.799999999999974, -56.10000000000008, -112.69999999999989, -14.799999999999992, -61.900000000000034, -30.500000000000014, -53.10000000000004, -40.20000000000008, -34.10000000000005, -12.499999999999973, -132.99999999999983, -52.80000000000002, -14.999999999999995, -42.600000000000065, -48.399999999999935, -75.70000000000003, -53.60000000000005, -64.50000000000007, -48.10000000000007, -12.799999999999978, -32.400000000000006, -14.699999999999978, -31.399999999999988, -136.8, -27.800000000000026, -99.99999999999994, -33.400000000000006, -46.90000000000007, -12.199999999999992, -70.60000000000007, -53.700000000000045, -41.300000000000004, -42.900000000000006, -53.60000000000008, -14.199999999999996, -12.499999999999975, -39.00000000000005, -28.300000000000004, -73.6, -13.699999999999998, -9.799999999999981], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8949172250930661, "mean_inference_ms": 0.7391284189680155, "mean_action_processing_ms": 0.1012497445114995, "mean_env_wait_ms": 3.0286393948144474, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 240000, "timesteps_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"sample_time_ms": 22741.104, "sample_throughput": 175.893, "load_time_ms": 0.268, "load_throughput": 14910430.146, "learn_time_ms": 4558.992, "learn_throughput": 877.387}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001171875, "cur_lr": 0.00010000000000000003, "total_loss": 1.924412038032296, "policy_loss": 0.0003137098495117439, "vf_loss": 192.40886723815754, "vf_explained_var": 0.01577954125660722, "kl": 0.008282452732367123, "entropy": 0.32087954625246984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 240000, "num_steps_trained": 240000, "num_agent_steps_trained": 240000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2400, "training_iteration": 60, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-43-01", "timestamp": 1651052581, "time_this_iter_s": 23.694126844406128, "time_total_s": 1644.965875864029, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1644.965875864029, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 26.553125, "ram_util_percent": 95.25625}}
{"episode_reward_max": -9.799999999999981, "episode_reward_min": -136.8, "episode_reward_mean": -43.730999999999995, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-79.69999999999996, -49.500000000000014, -53.40000000000004, -53.00000000000005, -64.20000000000006, -38.00000000000006, -42.70000000000005, -68.60000000000012, -36.400000000000006, -31.800000000000008, -9.799999999999981, -14.799999999999981, -10.499999999999979, -52.60000000000003, -73.40000000000003, -12.799999999999974, -53.500000000000036, -16.199999999999996, -13.399999999999995, -14.799999999999974, -56.10000000000008, -112.69999999999989, -14.799999999999992, -61.900000000000034, -30.500000000000014, -53.10000000000004, -40.20000000000008, -34.10000000000005, -12.499999999999973, -132.99999999999983, -52.80000000000002, -14.999999999999995, -42.600000000000065, -48.399999999999935, -75.70000000000003, -53.60000000000005, -64.50000000000007, -48.10000000000007, -12.799999999999978, -32.400000000000006, -14.699999999999978, -31.399999999999988, -136.8, -27.800000000000026, -99.99999999999994, -33.400000000000006, -46.90000000000007, -12.199999999999992, -70.60000000000007, -53.700000000000045, -41.300000000000004, -42.900000000000006, -53.60000000000008, -14.199999999999996, -12.499999999999975, -39.00000000000005, -28.300000000000004, -73.6, -13.699999999999998, -9.799999999999981, -30.8, -38.00000000000002, -55.000000000000064, -36.5, -65.30000000000005, -42.90000000000007, -52.60000000000009, -16.9, -29.599999999999998, -53.70000000000003, -46.60000000000009, -44.500000000000014, -28.300000000000004, -37.5, -35.70000000000001, -14.699999999999994, -10.79999999999998, -53.400000000000034, -60.80000000000002, -60.99999999999994, -48.2, -31.100000000000055, -55.10000000000005, -37.00000000000002, -11.799999999999997, -98.39999999999978, -55.10000000000003, -54.00000000000003, -45.80000000000007, -33.40000000000002, -41.40000000000002, -28.500000000000032, -37.60000000000005, -55.20000000000004, -25.400000000000055, -84.29999999999986, -53.90000000000004, -51.40000000000008, -30.700000000000003, -39.9], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8732395336181447, "mean_inference_ms": 0.7400566732561958, "mean_action_processing_ms": 0.10009501599334605, "mean_env_wait_ms": 3.0309653124683313, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 244000, "timesteps_this_iter": 0, "agent_timesteps_total": 244000, "timers": {"sample_time_ms": 22923.707, "sample_throughput": 174.492, "load_time_ms": 0.271, "load_throughput": 14784293.268, "learn_time_ms": 4591.433, "learn_throughput": 871.188}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001171875, "cur_lr": 0.00010000000000000003, "total_loss": 1.104291142068643, "policy_loss": -0.007448820817855096, "vf_loss": 111.17322779419601, "vf_explained_var": 0.12218220624872433, "kl": 0.006583464581147994, "entropy": 0.23026448630437416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 244000, "num_agent_steps_sampled": 244000, "num_steps_trained": 244000, "num_agent_steps_trained": 244000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2440, "training_iteration": 61, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-43-23", "timestamp": 1651052603, "time_this_iter_s": 22.09087085723877, "time_total_s": 1667.0567467212677, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1667.0567467212677, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 25.4, "ram_util_percent": 95.0933333333333}}
{"episode_reward_max": -9.799999999999981, "episode_reward_min": -136.8, "episode_reward_mean": -44.667000000000016, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.699999999999978, -31.399999999999988, -136.8, -27.800000000000026, -99.99999999999994, -33.400000000000006, -46.90000000000007, -12.199999999999992, -70.60000000000007, -53.700000000000045, -41.300000000000004, -42.900000000000006, -53.60000000000008, -14.199999999999996, -12.499999999999975, -39.00000000000005, -28.300000000000004, -73.6, -13.699999999999998, -9.799999999999981, -30.8, -38.00000000000002, -55.000000000000064, -36.5, -65.30000000000005, -42.90000000000007, -52.60000000000009, -16.9, -29.599999999999998, -53.70000000000003, -46.60000000000009, -44.500000000000014, -28.300000000000004, -37.5, -35.70000000000001, -14.699999999999994, -10.79999999999998, -53.400000000000034, -60.80000000000002, -60.99999999999994, -48.2, -31.100000000000055, -55.10000000000005, -37.00000000000002, -11.799999999999997, -98.39999999999978, -55.10000000000003, -54.00000000000003, -45.80000000000007, -33.40000000000002, -41.40000000000002, -28.500000000000032, -37.60000000000005, -55.20000000000004, -25.400000000000055, -84.29999999999986, -53.90000000000004, -51.40000000000008, -30.700000000000003, -39.9, -46.60000000000006, -52.30000000000003, -44.400000000000034, -49.4, -11.599999999999994, -13.199999999999976, -69.00000000000001, -52.20000000000005, -118.7, -46.20000000000008, -28.700000000000014, -80.3, -31.400000000000002, -53.000000000000036, -32.80000000000007, -32.30000000000002, -15.799999999999978, -13.79999999999998, -33.20000000000001, -55.600000000000044, -58.00000000000006, -14.099999999999998, -36.90000000000008, -42.80000000000007, -59.500000000000064, -52.30000000000004, -64.70000000000006, -72.50000000000003, -50.30000000000005, -64.5, -54.400000000000055, -16.799999999999986, -74.2999999999999, -35.40000000000001, -41.20000000000002, -34.60000000000005, -66.30000000000004, -26.9, -81.4, -50.10000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8526667097252574, "mean_inference_ms": 0.7409233804873645, "mean_action_processing_ms": 0.09897277259791243, "mean_env_wait_ms": 3.0321344770514087, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 248000, "timesteps_this_iter": 0, "agent_timesteps_total": 248000, "timers": {"sample_time_ms": 23175.259, "sample_throughput": 172.598, "load_time_ms": 0.42, "load_throughput": 9521148.629, "learn_time_ms": 4636.444, "learn_throughput": 862.73}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.001171875, "cur_lr": 0.00010000000000000003, "total_loss": 1.295183153983496, "policy_loss": 0.006165349356559736, "vf_loss": 128.901202653044, "vf_explained_var": 0.0018487005464492305, "kl": 0.004960865033582083, "entropy": 0.28859875264667695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 248000, "num_agent_steps_sampled": 248000, "num_steps_trained": 248000, "num_agent_steps_trained": 248000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2480, "training_iteration": 62, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-43-46", "timestamp": 1651052626, "time_this_iter_s": 22.58001208305359, "time_total_s": 1689.6367588043213, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1689.6367588043213, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 23.06451612903226, "ram_util_percent": 95.02258064516128}}
{"episode_reward_max": -10.799999999999978, "episode_reward_min": -118.7, "episode_reward_mean": -41.79000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.2, -31.100000000000055, -55.10000000000005, -37.00000000000002, -11.799999999999997, -98.39999999999978, -55.10000000000003, -54.00000000000003, -45.80000000000007, -33.40000000000002, -41.40000000000002, -28.500000000000032, -37.60000000000005, -55.20000000000004, -25.400000000000055, -84.29999999999986, -53.90000000000004, -51.40000000000008, -30.700000000000003, -39.9, -46.60000000000006, -52.30000000000003, -44.400000000000034, -49.4, -11.599999999999994, -13.199999999999976, -69.00000000000001, -52.20000000000005, -118.7, -46.20000000000008, -28.700000000000014, -80.3, -31.400000000000002, -53.000000000000036, -32.80000000000007, -32.30000000000002, -15.799999999999978, -13.79999999999998, -33.20000000000001, -55.600000000000044, -58.00000000000006, -14.099999999999998, -36.90000000000008, -42.80000000000007, -59.500000000000064, -52.30000000000004, -64.70000000000006, -72.50000000000003, -50.30000000000005, -64.5, -54.400000000000055, -16.799999999999986, -74.2999999999999, -35.40000000000001, -41.20000000000002, -34.60000000000005, -66.30000000000004, -26.9, -81.4, -50.10000000000005, -32.80000000000005, -30.60000000000001, -40.6, -28.20000000000001, -12.599999999999975, -37.800000000000004, -50.400000000000055, -16.9, -17.500000000000004, -63.80000000000002, -11.699999999999994, -14.599999999999993, -41.00000000000006, -11.499999999999977, -54.200000000000024, -40.00000000000004, -31.00000000000001, -23.90000000000003, -33.900000000000034, -42.10000000000002, -89.59999999999992, -13.999999999999995, -37.800000000000004, -55.00000000000006, -39.000000000000014, -38.30000000000007, -24.0, -14.499999999999996, -39.50000000000006, -52.800000000000054, -39.3, -32.699999999999996, -33.90000000000002, -40.20000000000009, -18.8, -53.40000000000005, -54.000000000000036, -11.599999999999973, -10.799999999999978, -49.00000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8329714675326647, "mean_inference_ms": 0.7413900344470234, "mean_action_processing_ms": 0.09787754146678776, "mean_env_wait_ms": 3.032252362325494, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 252000, "timesteps_this_iter": 0, "agent_timesteps_total": 252000, "timers": {"sample_time_ms": 23171.156, "sample_throughput": 172.628, "load_time_ms": 0.426, "load_throughput": 9382180.964, "learn_time_ms": 4626.627, "learn_throughput": 864.561}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0005859375, "cur_lr": 0.00010000000000000003, "total_loss": 0.6501913100531105, "policy_loss": 0.0018168689122283331, "vf_loss": 64.83718751681748, "vf_explained_var": 0.08079216243118369, "kl": 0.004403654149231789, "entropy": 0.23196754183379872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 252000, "num_agent_steps_sampled": 252000, "num_steps_trained": 252000, "num_agent_steps_trained": 252000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2520, "training_iteration": 63, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-44-08", "timestamp": 1651052648, "time_this_iter_s": 22.129314661026, "time_total_s": 1711.7660734653473, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1711.7660734653473, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 25.833333333333332, "ram_util_percent": 94.98666666666668}}
{"episode_reward_max": -10.799999999999978, "episode_reward_min": -741.5000000000006, "episode_reward_mean": -45.04000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.00000000000006, -14.099999999999998, -36.90000000000008, -42.80000000000007, -59.500000000000064, -52.30000000000004, -64.70000000000006, -72.50000000000003, -50.30000000000005, -64.5, -54.400000000000055, -16.799999999999986, -74.2999999999999, -35.40000000000001, -41.20000000000002, -34.60000000000005, -66.30000000000004, -26.9, -81.4, -50.10000000000005, -32.80000000000005, -30.60000000000001, -40.6, -28.20000000000001, -12.599999999999975, -37.800000000000004, -50.400000000000055, -16.9, -17.500000000000004, -63.80000000000002, -11.699999999999994, -14.599999999999993, -41.00000000000006, -11.499999999999977, -54.200000000000024, -40.00000000000004, -31.00000000000001, -23.90000000000003, -33.900000000000034, -42.10000000000002, -89.59999999999992, -13.999999999999995, -37.800000000000004, -55.00000000000006, -39.000000000000014, -38.30000000000007, -24.0, -14.499999999999996, -39.50000000000006, -52.800000000000054, -39.3, -32.699999999999996, -33.90000000000002, -40.20000000000009, -18.8, -53.40000000000005, -54.000000000000036, -11.599999999999973, -10.799999999999978, -49.00000000000001, -34.300000000000004, -16.199999999999992, -30.499999999999986, -62.7, -12.799999999999981, -12.799999999999978, -741.5000000000006, -15.499999999999995, -10.799999999999981, -81.70000000000002, -24.400000000000002, -30.30000000000001, -36.00000000000001, -15.599999999999994, -23.80000000000001, -50.900000000000034, -36.10000000000005, -27.600000000000048, -41.90000000000001, -31.7, -35.699999999999996, -12.799999999999978, -14.799999999999974, -26.400000000000006, -18.1, -35.3, -11.599999999999978, -51.10000000000005, -62.80000000000008, -56.1, -80.09999999999991, -56.3, -41.000000000000036, -10.79999999999999, -35.60000000000008, -53.60000000000004, -38.90000000000001, -44.10000000000007, -56.50000000000006, -45.00000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8144697586294873, "mean_inference_ms": 0.7416753963017291, "mean_action_processing_ms": 0.09683068092916573, "mean_env_wait_ms": 3.0331935459745423, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 256000, "timesteps_this_iter": 0, "agent_timesteps_total": 256000, "timers": {"sample_time_ms": 23269.889, "sample_throughput": 171.896, "load_time_ms": 0.428, "load_throughput": 9336235.949, "learn_time_ms": 4612.674, "learn_throughput": 867.176}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00029296875, "cur_lr": 0.00010000000000000003, "total_loss": 32.099050066043546, "policy_loss": -0.009139266974663222, "vf_loss": 3210.8184923500144, "vf_explained_var": -0.03695572339078432, "kl": 0.01749074659851733, "entropy": 0.35458446075959554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 256000, "num_agent_steps_sampled": 256000, "num_steps_trained": 256000, "num_agent_steps_trained": 256000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2560, "training_iteration": 64, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-44-31", "timestamp": 1651052671, "time_this_iter_s": 23.149735927581787, "time_total_s": 1734.915809392929, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1734.915809392929, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 21.35806451612903, "ram_util_percent": 94.96451612903225}}
{"episode_reward_max": -10.29999999999998, "episode_reward_min": -741.5000000000006, "episode_reward_mean": -43.21700000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-89.59999999999992, -13.999999999999995, -37.800000000000004, -55.00000000000006, -39.000000000000014, -38.30000000000007, -24.0, -14.499999999999996, -39.50000000000006, -52.800000000000054, -39.3, -32.699999999999996, -33.90000000000002, -40.20000000000009, -18.8, -53.40000000000005, -54.000000000000036, -11.599999999999973, -10.799999999999978, -49.00000000000001, -34.300000000000004, -16.199999999999992, -30.499999999999986, -62.7, -12.799999999999981, -12.799999999999978, -741.5000000000006, -15.499999999999995, -10.799999999999981, -81.70000000000002, -24.400000000000002, -30.30000000000001, -36.00000000000001, -15.599999999999994, -23.80000000000001, -50.900000000000034, -36.10000000000005, -27.600000000000048, -41.90000000000001, -31.7, -35.699999999999996, -12.799999999999978, -14.799999999999974, -26.400000000000006, -18.1, -35.3, -11.599999999999978, -51.10000000000005, -62.80000000000008, -56.1, -80.09999999999991, -56.3, -41.000000000000036, -10.79999999999999, -35.60000000000008, -53.60000000000004, -38.90000000000001, -44.10000000000007, -56.50000000000006, -45.00000000000002, -15.699999999999989, -17.999999999999993, -51.20000000000005, -34.40000000000007, -56.800000000000075, -14.799999999999976, -10.799999999999978, -12.299999999999997, -37.50000000000007, -15.099999999999996, -12.4, -28.200000000000035, -50.20000000000001, -54.000000000000036, -53.600000000000044, -63.100000000000094, -44.00000000000002, -36.400000000000006, -29.200000000000028, -10.29999999999998, -13.599999999999978, -18.299999999999997, -25.700000000000006, -59.0, -42.900000000000034, -53.400000000000034, -43.4, -42.60000000000001, -30.799999999999997, -33.90000000000004, -17.6, -45.80000000000004, -56.900000000000134, -52.200000000000045, -28.700000000000006, -52.70000000000004, -60.80000000000003, -34.60000000000003, -39.80000000000008, -49.10000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7962742764849928, "mean_inference_ms": 0.7422112804066617, "mean_action_processing_ms": 0.09582998631399949, "mean_env_wait_ms": 3.034885365254289, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 260000, "timesteps_this_iter": 0, "agent_timesteps_total": 260000, "timers": {"sample_time_ms": 23329.555, "sample_throughput": 171.456, "load_time_ms": 0.43, "load_throughput": 9305166.944, "learn_time_ms": 4624.044, "learn_throughput": 865.044}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00029296875, "cur_lr": 0.00010000000000000003, "total_loss": 0.6324760711509033, "policy_loss": 0.007779068798227336, "vf_loss": 62.4695581723285, "vf_explained_var": 0.018130553025071338, "kl": 0.004904263943893609, "entropy": 0.29771738577513923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 260000, "num_agent_steps_sampled": 260000, "num_steps_trained": 260000, "num_agent_steps_trained": 260000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2600, "training_iteration": 65, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-44-54", "timestamp": 1651052694, "time_this_iter_s": 23.137192964553833, "time_total_s": 1758.053002357483, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1758.053002357483, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 30.696875, "ram_util_percent": 95.190625}}
{"episode_reward_max": -10.29999999999998, "episode_reward_min": -80.09999999999991, "episode_reward_mean": -38.249000000000024, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.699999999999996, -12.799999999999978, -14.799999999999974, -26.400000000000006, -18.1, -35.3, -11.599999999999978, -51.10000000000005, -62.80000000000008, -56.1, -80.09999999999991, -56.3, -41.000000000000036, -10.79999999999999, -35.60000000000008, -53.60000000000004, -38.90000000000001, -44.10000000000007, -56.50000000000006, -45.00000000000002, -15.699999999999989, -17.999999999999993, -51.20000000000005, -34.40000000000007, -56.800000000000075, -14.799999999999976, -10.799999999999978, -12.299999999999997, -37.50000000000007, -15.099999999999996, -12.4, -28.200000000000035, -50.20000000000001, -54.000000000000036, -53.600000000000044, -63.100000000000094, -44.00000000000002, -36.400000000000006, -29.200000000000028, -10.29999999999998, -13.599999999999978, -18.299999999999997, -25.700000000000006, -59.0, -42.900000000000034, -53.400000000000034, -43.4, -42.60000000000001, -30.799999999999997, -33.90000000000004, -17.6, -45.80000000000004, -56.900000000000134, -52.200000000000045, -28.700000000000006, -52.70000000000004, -60.80000000000003, -34.60000000000003, -39.80000000000008, -49.10000000000002, -37.69999999999998, -37.599999999999994, -48.5000000000001, -47.400000000000055, -37.50000000000001, -26.700000000000014, -10.799999999999981, -23.80000000000009, -53.80000000000005, -54.50000000000002, -33.80000000000002, -56.80000000000009, -37.30000000000001, -12.89999999999999, -40.20000000000002, -14.199999999999992, -28.60000000000001, -63.400000000000084, -53.60000000000007, -71.50000000000001, -53.00000000000002, -13.299999999999999, -56.800000000000054, -42.800000000000026, -37.300000000000054, -73.19999999999997, -55.60000000000008, -27.100000000000033, -25.50000000000007, -52.80000000000005, -77.90000000000015, -33.50000000000007, -13.299999999999997, -25.500000000000007, -51.800000000000026, -14.999999999999998, -13.099999999999989, -35.70000000000001, -42.0, -52.70000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7783146456203571, "mean_inference_ms": 0.7436594258550955, "mean_action_processing_ms": 0.09487640308741051, "mean_env_wait_ms": 3.038140588896513, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 264000, "timesteps_this_iter": 0, "agent_timesteps_total": 264000, "timers": {"sample_time_ms": 23384.382, "sample_throughput": 171.054, "load_time_ms": 0.436, "load_throughput": 9166374.911, "learn_time_ms": 4599.038, "learn_throughput": 869.747}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000146484375, "cur_lr": 0.00010000000000000003, "total_loss": 0.8748090625309977, "policy_loss": 0.0031457470599762214, "vf_loss": 87.16621591916649, "vf_explained_var": 0.1316914745556411, "kl": 0.008053485087705994, "entropy": 0.35659344229166223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 264000, "num_agent_steps_sampled": 264000, "num_steps_trained": 264000, "num_agent_steps_trained": 264000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2640, "training_iteration": 66, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-45-19", "timestamp": 1651052719, "time_this_iter_s": 24.582159757614136, "time_total_s": 1782.635162115097, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1782.635162115097, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 30.75757575757576, "ram_util_percent": 95.5}}
{"episode_reward_max": -10.799999999999981, "episode_reward_min": -395.8999999999998, "episode_reward_mean": -44.30700000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.599999999999978, -18.299999999999997, -25.700000000000006, -59.0, -42.900000000000034, -53.400000000000034, -43.4, -42.60000000000001, -30.799999999999997, -33.90000000000004, -17.6, -45.80000000000004, -56.900000000000134, -52.200000000000045, -28.700000000000006, -52.70000000000004, -60.80000000000003, -34.60000000000003, -39.80000000000008, -49.10000000000002, -37.69999999999998, -37.599999999999994, -48.5000000000001, -47.400000000000055, -37.50000000000001, -26.700000000000014, -10.799999999999981, -23.80000000000009, -53.80000000000005, -54.50000000000002, -33.80000000000002, -56.80000000000009, -37.30000000000001, -12.89999999999999, -40.20000000000002, -14.199999999999992, -28.60000000000001, -63.400000000000084, -53.60000000000007, -71.50000000000001, -53.00000000000002, -13.299999999999999, -56.800000000000054, -42.800000000000026, -37.300000000000054, -73.19999999999997, -55.60000000000008, -27.100000000000033, -25.50000000000007, -52.80000000000005, -77.90000000000015, -33.50000000000007, -13.299999999999997, -25.500000000000007, -51.800000000000026, -14.999999999999998, -13.099999999999989, -35.70000000000001, -42.0, -52.70000000000005, -18.800000000000022, -33.700000000000045, -23.500000000000004, -48.90000000000004, -70.70000000000002, -37.2, -34.40000000000001, -35.80000000000009, -39.800000000000054, -45.00000000000007, -16.79999999999999, -52.300000000000026, -52.30000000000005, -38.900000000000055, -31.900000000000006, -40.900000000000055, -52.90000000000005, -15.699999999999998, -11.399999999999979, -52.30000000000004, -31.900000000000027, -32.10000000000005, -30.30000000000001, -52.000000000000036, -14.799999999999994, -395.8999999999998, -18.79999999999998, -53.80000000000003, -29.90000000000002, -35.300000000000054, -63.30000000000003, -32.40000000000007, -35.1, -39.0, -64.0, -203.79999999999956, -52.80000000000005, -12.299999999999974, -29.500000000000007, -60.20000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7619068942513656, "mean_inference_ms": 0.7462721662285964, "mean_action_processing_ms": 0.09398037456235576, "mean_env_wait_ms": 3.043581798003347, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 268000, "timesteps_this_iter": 0, "agent_timesteps_total": 268000, "timers": {"sample_time_ms": 23383.362, "sample_throughput": 171.062, "load_time_ms": 0.426, "load_throughput": 9399000.56, "learn_time_ms": 4568.863, "learn_throughput": 875.491}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000146484375, "cur_lr": 0.00010000000000000003, "total_loss": 9.335555010889808, "policy_loss": -0.008039858143135745, "vf_loss": 934.3592454541114, "vf_explained_var": 0.15477755300460322, "kl": 0.01681049651239489, "entropy": 0.35467490057150525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 268000, "num_agent_steps_sampled": 268000, "num_steps_trained": 268000, "num_agent_steps_trained": 268000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2680, "training_iteration": 67, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-45-45", "timestamp": 1651052745, "time_this_iter_s": 26.203969955444336, "time_total_s": 1808.8391320705414, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1808.8391320705414, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 27.78235294117647, "ram_util_percent": 95.41176470588233}}
{"episode_reward_max": -9.899999999999999, "episode_reward_min": -787.800000000001, "episode_reward_mean": -54.989000000000026, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-53.00000000000002, -13.299999999999999, -56.800000000000054, -42.800000000000026, -37.300000000000054, -73.19999999999997, -55.60000000000008, -27.100000000000033, -25.50000000000007, -52.80000000000005, -77.90000000000015, -33.50000000000007, -13.299999999999997, -25.500000000000007, -51.800000000000026, -14.999999999999998, -13.099999999999989, -35.70000000000001, -42.0, -52.70000000000005, -18.800000000000022, -33.700000000000045, -23.500000000000004, -48.90000000000004, -70.70000000000002, -37.2, -34.40000000000001, -35.80000000000009, -39.800000000000054, -45.00000000000007, -16.79999999999999, -52.300000000000026, -52.30000000000005, -38.900000000000055, -31.900000000000006, -40.900000000000055, -52.90000000000005, -15.699999999999998, -11.399999999999979, -52.30000000000004, -31.900000000000027, -32.10000000000005, -30.30000000000001, -52.000000000000036, -14.799999999999994, -395.8999999999998, -18.79999999999998, -53.80000000000003, -29.90000000000002, -35.300000000000054, -63.30000000000003, -32.40000000000007, -35.1, -39.0, -64.0, -203.79999999999956, -52.80000000000005, -12.299999999999974, -29.500000000000007, -60.20000000000004, -25.3, -54.400000000000055, -65.30000000000008, -164.79999999999973, -13.799999999999974, -42.800000000000004, -9.899999999999999, -37.600000000000065, -30.700000000000003, -25.20000000000001, -87.4, -15.099999999999996, -26.100000000000012, -37.10000000000001, -51.10000000000005, -67.80000000000007, -30.3, -39.70000000000007, -42.10000000000006, -787.800000000001, -32.5, -53.30000000000006, -61.400000000000084, -21.1, -12.99999999999998, -12.799999999999978, -27.900000000000013, -64.80000000000001, -43.40000000000009, -55.5, -115.1, -38.19999999999996, -71.4, -54.10000000000005, -27.20000000000001, -159.79999999999973, -43.7, -10.699999999999982, -42.60000000000005, -57.800000000000054], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7458468259048312, "mean_inference_ms": 0.7479886763681055, "mean_action_processing_ms": 0.09309094061974572, "mean_env_wait_ms": 3.0477359419492096, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 272000, "timesteps_this_iter": 0, "agent_timesteps_total": 272000, "timers": {"sample_time_ms": 23281.305, "sample_throughput": 171.812, "load_time_ms": 0.427, "load_throughput": 9360718.63, "learn_time_ms": 4667.73, "learn_throughput": 856.948}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.000146484375, "cur_lr": 0.00010000000000000003, "total_loss": 35.511567250791416, "policy_loss": -0.008697205964195471, "vf_loss": 3552.0261367018506, "vf_explained_var": -0.015387824145696496, "kl": 0.029709423244071213, "entropy": 0.34928096039320833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 272000, "num_agent_steps_sampled": 272000, "num_steps_trained": 272000, "num_agent_steps_trained": 272000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2720, "training_iteration": 68, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-46-08", "timestamp": 1651052768, "time_this_iter_s": 22.976762294769287, "time_total_s": 1831.8158943653107, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1831.8158943653107, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 12.98125, "ram_util_percent": 95.14999999999999}}
{"episode_reward_max": -9.899999999999999, "episode_reward_min": -787.800000000001, "episode_reward_mean": -58.259000000000015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.900000000000027, -32.10000000000005, -30.30000000000001, -52.000000000000036, -14.799999999999994, -395.8999999999998, -18.79999999999998, -53.80000000000003, -29.90000000000002, -35.300000000000054, -63.30000000000003, -32.40000000000007, -35.1, -39.0, -64.0, -203.79999999999956, -52.80000000000005, -12.299999999999974, -29.500000000000007, -60.20000000000004, -25.3, -54.400000000000055, -65.30000000000008, -164.79999999999973, -13.799999999999974, -42.800000000000004, -9.899999999999999, -37.600000000000065, -30.700000000000003, -25.20000000000001, -87.4, -15.099999999999996, -26.100000000000012, -37.10000000000001, -51.10000000000005, -67.80000000000007, -30.3, -39.70000000000007, -42.10000000000006, -787.800000000001, -32.5, -53.30000000000006, -61.400000000000084, -21.1, -12.99999999999998, -12.799999999999978, -27.900000000000013, -64.80000000000001, -43.40000000000009, -55.5, -115.1, -38.19999999999996, -71.4, -54.10000000000005, -27.20000000000001, -159.79999999999973, -43.7, -10.699999999999982, -42.60000000000005, -57.800000000000054, -10.799999999999981, -35.1, -42.20000000000001, -23.500000000000032, -30.900000000000013, -49.300000000000026, -35.50000000000001, -123.49999999999983, -32.5, -16.299999999999994, -26.800000000000022, -69.90000000000002, -28.900000000000055, -68.60000000000002, -60.500000000000064, -131.3999999999998, -33.6, -28.500000000000007, -70.80000000000001, -43.50000000000002, -102.6, -122.39999999999985, -54.300000000000054, -31.20000000000001, -43.90000000000003, -38.10000000000002, -42.00000000000006, -13.29999999999998, -62.20000000000007, -38.50000000000006, -19.000000000000014, -41.70000000000006, -25.500000000000043, -11.799999999999978, -17.900000000000002, -87.49999999999997, -27.80000000000008, -43.30000000000006, -57.90000000000006, -35.10000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7304324311814676, "mean_inference_ms": 0.7488934464784753, "mean_action_processing_ms": 0.09220762827505849, "mean_env_wait_ms": 3.0500765570703696, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 276000, "timesteps_this_iter": 0, "agent_timesteps_total": 276000, "timers": {"sample_time_ms": 23497.503, "sample_throughput": 170.231, "load_time_ms": 0.427, "load_throughput": 9377985.467, "learn_time_ms": 4596.206, "learn_throughput": 870.283}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00021972656250000006, "cur_lr": 0.00010000000000000003, "total_loss": 2.0254593498864644, "policy_loss": -8.047986975921097e-06, "vf_loss": 202.54665686904744, "vf_explained_var": -0.044077023511291835, "kl": 0.004039372906262509, "entropy": 0.2483958029418543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 276000, "num_agent_steps_sampled": 276000, "num_steps_trained": 276000, "num_agent_steps_trained": 276000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2760, "training_iteration": 69, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-46-31", "timestamp": 1651052791, "time_this_iter_s": 23.430312871932983, "time_total_s": 1855.2462072372437, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1855.2462072372437, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 28.238709677419354, "ram_util_percent": 95.53548387096777}}
{"episode_reward_max": -10.699999999999982, "episode_reward_min": -159.79999999999973, "episode_reward_mean": -44.02400000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-32.5, -53.30000000000006, -61.400000000000084, -21.1, -12.99999999999998, -12.799999999999978, -27.900000000000013, -64.80000000000001, -43.40000000000009, -55.5, -115.1, -38.19999999999996, -71.4, -54.10000000000005, -27.20000000000001, -159.79999999999973, -43.7, -10.699999999999982, -42.60000000000005, -57.800000000000054, -10.799999999999981, -35.1, -42.20000000000001, -23.500000000000032, -30.900000000000013, -49.300000000000026, -35.50000000000001, -123.49999999999983, -32.5, -16.299999999999994, -26.800000000000022, -69.90000000000002, -28.900000000000055, -68.60000000000002, -60.500000000000064, -131.3999999999998, -33.6, -28.500000000000007, -70.80000000000001, -43.50000000000002, -102.6, -122.39999999999985, -54.300000000000054, -31.20000000000001, -43.90000000000003, -38.10000000000002, -42.00000000000006, -13.29999999999998, -62.20000000000007, -38.50000000000006, -19.000000000000014, -41.70000000000006, -25.500000000000043, -11.799999999999978, -17.900000000000002, -87.49999999999997, -27.80000000000008, -43.30000000000006, -57.90000000000006, -35.10000000000002, -44.000000000000064, -32.200000000000045, -59.20000000000008, -39.40000000000004, -13.699999999999994, -34.100000000000044, -35.400000000000006, -41.0, -11.79999999999998, -43.800000000000075, -50.500000000000014, -40.2, -42.70000000000005, -34.00000000000004, -14.799999999999974, -53.20000000000004, -32.3, -39.10000000000008, -55.10000000000004, -15.79999999999998, -33.10000000000001, -17.799999999999986, -46.200000000000074, -53.80000000000004, -31.800000000000043, -11.299999999999983, -26.30000000000002, -36.000000000000014, -29.0, -28.700000000000045, -80.19999999999999, -36.30000000000002, -32.20000000000007, -38.399999999999984, -31.500000000000014, -33.400000000000034, -100.7, -34.80000000000001, -32.30000000000001, -51.90000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.714782446220478, "mean_inference_ms": 0.7492197496736233, "mean_action_processing_ms": 0.09133695199493883, "mean_env_wait_ms": 3.051083515141248, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 280000, "timesteps_this_iter": 0, "agent_timesteps_total": 280000, "timers": {"sample_time_ms": 23284.884, "sample_throughput": 171.785, "load_time_ms": 0.429, "load_throughput": 9323783.483, "learn_time_ms": 4701.403, "learn_throughput": 850.81}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.00010986328125000003, "cur_lr": 0.00010000000000000003, "total_loss": 0.7151839699020349, "policy_loss": 0.013916225196613419, "vf_loss": 70.12674796606905, "vf_explained_var": 0.11521650559158736, "kl": 0.0025508124393323612, "entropy": 0.20408605889527387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 280000, "num_agent_steps_sampled": 280000, "num_steps_trained": 280000, "num_agent_steps_trained": 280000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2800, "training_iteration": 70, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-46-55", "timestamp": 1651052815, "time_this_iter_s": 23.346497058868408, "time_total_s": 1878.592704296112, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1878.592704296112, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 24.7875, "ram_util_percent": 94.496875}}
{"episode_reward_max": -9.499999999999998, "episode_reward_min": -191.79999999999973, "episode_reward_mean": -39.745000000000026, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.6, -122.39999999999985, -54.300000000000054, -31.20000000000001, -43.90000000000003, -38.10000000000002, -42.00000000000006, -13.29999999999998, -62.20000000000007, -38.50000000000006, -19.000000000000014, -41.70000000000006, -25.500000000000043, -11.799999999999978, -17.900000000000002, -87.49999999999997, -27.80000000000008, -43.30000000000006, -57.90000000000006, -35.10000000000002, -44.000000000000064, -32.200000000000045, -59.20000000000008, -39.40000000000004, -13.699999999999994, -34.100000000000044, -35.400000000000006, -41.0, -11.79999999999998, -43.800000000000075, -50.500000000000014, -40.2, -42.70000000000005, -34.00000000000004, -14.799999999999974, -53.20000000000004, -32.3, -39.10000000000008, -55.10000000000004, -15.79999999999998, -33.10000000000001, -17.799999999999986, -46.200000000000074, -53.80000000000004, -31.800000000000043, -11.299999999999983, -26.30000000000002, -36.000000000000014, -29.0, -28.700000000000045, -80.19999999999999, -36.30000000000002, -32.20000000000007, -38.399999999999984, -31.500000000000014, -33.400000000000034, -100.7, -34.80000000000001, -32.30000000000001, -51.90000000000004, -31.200000000000014, -14.699999999999982, -35.600000000000016, -29.1, -23.500000000000025, -16.399999999999995, -11.699999999999978, -32.099999999999994, -19.70000000000001, -53.10000000000009, -11.799999999999978, -32.9, -31.200000000000063, -33.800000000000054, -11.799999999999981, -28.90000000000002, -13.799999999999981, -52.40000000000002, -12.799999999999981, -12.499999999999988, -9.499999999999998, -95.89999999999993, -33.800000000000054, -191.79999999999973, -30.60000000000004, -11.999999999999995, -38.60000000000001, -43.10000000000005, -95.79999999999994, -49.900000000000006, -12.499999999999972, -54.20000000000007, -74.1, -14.299999999999999, -54.50000000000006, -51.99999999999992, -52.400000000000034, -22.400000000000038, -56.80000000000007, -37.300000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.699580005879212, "mean_inference_ms": 0.7507209041831299, "mean_action_processing_ms": 0.0905226574199602, "mean_env_wait_ms": 3.0536113897106416, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 284000, "timesteps_this_iter": 0, "agent_timesteps_total": 284000, "timers": {"sample_time_ms": 23653.53, "sample_throughput": 169.108, "load_time_ms": 0.428, "load_throughput": 9343515.26, "learn_time_ms": 4791.878, "learn_throughput": 834.746}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.4931640625000015e-05, "cur_lr": 0.00010000000000000003, "total_loss": 2.398304299008782, "policy_loss": -0.0056815196249273515, "vf_loss": 240.39854511240478, "vf_explained_var": -0.03191470734534725, "kl": 0.00782801729275332, "entropy": 0.3479838532946443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 284000, "num_agent_steps_sampled": 284000, "num_steps_trained": 284000, "num_agent_steps_trained": 284000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2840, "training_iteration": 71, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-47-20", "timestamp": 1651052840, "time_this_iter_s": 25.630456924438477, "time_total_s": 1904.2231612205505, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1904.2231612205505, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 26.755882352941175, "ram_util_percent": 93.93529411764706}}
{"episode_reward_max": -9.499999999999998, "episode_reward_min": -191.79999999999973, "episode_reward_mean": -38.083000000000006, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.10000000000001, -17.799999999999986, -46.200000000000074, -53.80000000000004, -31.800000000000043, -11.299999999999983, -26.30000000000002, -36.000000000000014, -29.0, -28.700000000000045, -80.19999999999999, -36.30000000000002, -32.20000000000007, -38.399999999999984, -31.500000000000014, -33.400000000000034, -100.7, -34.80000000000001, -32.30000000000001, -51.90000000000004, -31.200000000000014, -14.699999999999982, -35.600000000000016, -29.1, -23.500000000000025, -16.399999999999995, -11.699999999999978, -32.099999999999994, -19.70000000000001, -53.10000000000009, -11.799999999999978, -32.9, -31.200000000000063, -33.800000000000054, -11.799999999999981, -28.90000000000002, -13.799999999999981, -52.40000000000002, -12.799999999999981, -12.499999999999988, -9.499999999999998, -95.89999999999993, -33.800000000000054, -191.79999999999973, -30.60000000000004, -11.999999999999995, -38.60000000000001, -43.10000000000005, -95.79999999999994, -49.900000000000006, -12.499999999999972, -54.20000000000007, -74.1, -14.299999999999999, -54.50000000000006, -51.99999999999992, -52.400000000000034, -22.400000000000038, -56.80000000000007, -37.300000000000004, -53.900000000000034, -29.6, -28.399999999999956, -52.30000000000003, -25.80000000000006, -55.20000000000007, -34.400000000000006, -45.900000000000055, -69.79999999999995, -14.899999999999995, -11.799999999999978, -61.800000000000075, -40.20000000000002, -12.79999999999998, -52.80000000000002, -13.799999999999978, -23.40000000000004, -17.199999999999996, -27.30000000000001, -58.90000000000008, -18.800000000000015, -26.500000000000007, -46.60000000000006, -28.000000000000004, -62.90000000000006, -58.500000000000085, -13.499999999999996, -64.99999999999986, -32.20000000000003, -39.50000000000001, -11.79999999999998, -33.60000000000001, -37.50000000000002, -43.70000000000005, -85.89999999999999, -43.500000000000064, -35.200000000000045, -14.799999999999976, -26.099999999999994, -28.30000000000001], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.685008006480725, "mean_inference_ms": 0.7535682871302498, "mean_action_processing_ms": 0.08977511029876638, "mean_env_wait_ms": 3.0580271230642797, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 288000, "timesteps_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"sample_time_ms": 24033.033, "sample_throughput": 166.438, "load_time_ms": 0.28, "load_throughput": 14268766.797, "learn_time_ms": 4836.623, "learn_throughput": 827.023}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 5.4931640625000015e-05, "cur_lr": 0.00010000000000000003, "total_loss": 0.9050236904527992, "policy_loss": 0.001714476770270736, "vf_loss": 90.33090417513283, "vf_explained_var": 0.11973129248106351, "kl": 0.003521112043247678, "entropy": 0.2819734557301447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 288000, "num_agent_steps_sampled": 288000, "num_steps_trained": 288000, "num_agent_steps_trained": 288000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2880, "training_iteration": 72, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-47-46", "timestamp": 1651052866, "time_this_iter_s": 25.91992497444153, "time_total_s": 1930.143086194992, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1930.143086194992, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 24.95555555555556, "ram_util_percent": 93.1388888888889}}
{"episode_reward_max": -9.499999999999998, "episode_reward_min": -191.79999999999973, "episode_reward_mean": -41.64100000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.499999999999998, -95.89999999999993, -33.800000000000054, -191.79999999999973, -30.60000000000004, -11.999999999999995, -38.60000000000001, -43.10000000000005, -95.79999999999994, -49.900000000000006, -12.499999999999972, -54.20000000000007, -74.1, -14.299999999999999, -54.50000000000006, -51.99999999999992, -52.400000000000034, -22.400000000000038, -56.80000000000007, -37.300000000000004, -53.900000000000034, -29.6, -28.399999999999956, -52.30000000000003, -25.80000000000006, -55.20000000000007, -34.400000000000006, -45.900000000000055, -69.79999999999995, -14.899999999999995, -11.799999999999978, -61.800000000000075, -40.20000000000002, -12.79999999999998, -52.80000000000002, -13.799999999999978, -23.40000000000004, -17.199999999999996, -27.30000000000001, -58.90000000000008, -18.800000000000015, -26.500000000000007, -46.60000000000006, -28.000000000000004, -62.90000000000006, -58.500000000000085, -13.499999999999996, -64.99999999999986, -32.20000000000003, -39.50000000000001, -11.79999999999998, -33.60000000000001, -37.50000000000002, -43.70000000000005, -85.89999999999999, -43.500000000000064, -35.200000000000045, -14.799999999999976, -26.099999999999994, -28.30000000000001, -53.00000000000004, -87.80000000000015, -30.700000000000006, -53.100000000000044, -32.80000000000003, -20.700000000000014, -15.099999999999993, -30.099999999999998, -68.50000000000006, -84.80000000000001, -23.800000000000015, -43.50000000000004, -44.600000000000044, -52.800000000000104, -83.79999999999998, -55.20000000000006, -10.699999999999982, -15.199999999999998, -26.70000000000001, -28.10000000000001, -15.699999999999994, -40.100000000000065, -26.900000000000006, -49.80000000000004, -59.500000000000036, -32.90000000000001, -50.60000000000004, -31.900000000000066, -44.00000000000003, -53.900000000000034, -13.699999999999978, -36.30000000000005, -38.80000000000004, -20.6, -46.20000000000006, -21.600000000000044, -76.89999999999999, -62.00000000000005, -52.50000000000005, -15.599999999999975], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6707496744908568, "mean_inference_ms": 0.75596802142499, "mean_action_processing_ms": 0.0890349628903207, "mean_env_wait_ms": 3.0616419123515346, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 292000, "timesteps_this_iter": 0, "agent_timesteps_total": 292000, "timers": {"sample_time_ms": 24122.943, "sample_throughput": 165.817, "load_time_ms": 0.269, "load_throughput": 14857612.469, "learn_time_ms": 4902.899, "learn_throughput": 815.844}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7465820312500007e-05, "cur_lr": 0.00010000000000000003, "total_loss": 1.111226568264406, "policy_loss": -0.0007893450998811311, "vf_loss": 111.20157878629622, "vf_explained_var": 0.10103276096364504, "kl": 0.005314585015789846, "entropy": 0.24707492574328377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 292000, "num_agent_steps_sampled": 292000, "num_steps_trained": 292000, "num_agent_steps_trained": 292000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2920, "training_iteration": 73, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-48-10", "timestamp": 1651052890, "time_this_iter_s": 23.246907949447632, "time_total_s": 1953.3899941444397, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1953.3899941444397, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 21.461290322580645, "ram_util_percent": 93.5548387096774}}
{"episode_reward_max": -10.699999999999982, "episode_reward_min": -199.9, "episode_reward_mean": -43.87000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.800000000000015, -26.500000000000007, -46.60000000000006, -28.000000000000004, -62.90000000000006, -58.500000000000085, -13.499999999999996, -64.99999999999986, -32.20000000000003, -39.50000000000001, -11.79999999999998, -33.60000000000001, -37.50000000000002, -43.70000000000005, -85.89999999999999, -43.500000000000064, -35.200000000000045, -14.799999999999976, -26.099999999999994, -28.30000000000001, -53.00000000000004, -87.80000000000015, -30.700000000000006, -53.100000000000044, -32.80000000000003, -20.700000000000014, -15.099999999999993, -30.099999999999998, -68.50000000000006, -84.80000000000001, -23.800000000000015, -43.50000000000004, -44.600000000000044, -52.800000000000104, -83.79999999999998, -55.20000000000006, -10.699999999999982, -15.199999999999998, -26.70000000000001, -28.10000000000001, -15.699999999999994, -40.100000000000065, -26.900000000000006, -49.80000000000004, -59.500000000000036, -32.90000000000001, -50.60000000000004, -31.900000000000066, -44.00000000000003, -53.900000000000034, -13.699999999999978, -36.30000000000005, -38.80000000000004, -20.6, -46.20000000000006, -21.600000000000044, -76.89999999999999, -62.00000000000005, -52.50000000000005, -15.599999999999975, -37.0, -52.400000000000034, -51.200000000000045, -60.30000000000003, -133.5, -82.39999999999988, -50.60000000000009, -19.8, -199.9, -42.70000000000008, -76.00000000000003, -36.20000000000004, -49.80000000000006, -15.199999999999989, -25.3, -29.1, -52.30000000000004, -188.19999999999976, -15.799999999999974, -138.6999999999999, -33.3, -48.300000000000075, -16.799999999999997, -55.90000000000007, -31.800000000000033, -25.4, -37.60000000000002, -59.30000000000007, -36.200000000000024, -47.000000000000085, -13.799999999999999, -35.50000000000006, -47.00000000000004, -14.699999999999974, -12.799999999999978, -37.20000000000005, -15.699999999999978, -12.799999999999997, -31.499999999999957, -15.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6569871621470713, "mean_inference_ms": 0.7572019879344198, "mean_action_processing_ms": 0.08828223446629449, "mean_env_wait_ms": 3.063348914028355, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 296000, "timesteps_this_iter": 0, "agent_timesteps_total": 296000, "timers": {"sample_time_ms": 24179.379, "sample_throughput": 165.43, "load_time_ms": 0.267, "load_throughput": 14997064.45, "learn_time_ms": 4923.332, "learn_throughput": 812.458}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7465820312500007e-05, "cur_lr": 0.00010000000000000003, "total_loss": 3.8577430658503085, "policy_loss": -0.007269013463519514, "vf_loss": 386.50117859173844, "vf_explained_var": -0.061629265867253785, "kl": 0.01460021658338433, "entropy": 0.3535898065214516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 296000, "num_agent_steps_sampled": 296000, "num_steps_trained": 296000, "num_agent_steps_trained": 296000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 2960, "training_iteration": 74, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-48-33", "timestamp": 1651052913, "time_this_iter_s": 23.257434844970703, "time_total_s": 1976.6474289894104, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1976.6474289894104, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 24.53125, "ram_util_percent": 93.553125}}
{"episode_reward_max": -9.999999999999995, "episode_reward_min": -199.9, "episode_reward_mean": -43.99100000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.699999999999994, -40.100000000000065, -26.900000000000006, -49.80000000000004, -59.500000000000036, -32.90000000000001, -50.60000000000004, -31.900000000000066, -44.00000000000003, -53.900000000000034, -13.699999999999978, -36.30000000000005, -38.80000000000004, -20.6, -46.20000000000006, -21.600000000000044, -76.89999999999999, -62.00000000000005, -52.50000000000005, -15.599999999999975, -37.0, -52.400000000000034, -51.200000000000045, -60.30000000000003, -133.5, -82.39999999999988, -50.60000000000009, -19.8, -199.9, -42.70000000000008, -76.00000000000003, -36.20000000000004, -49.80000000000006, -15.199999999999989, -25.3, -29.1, -52.30000000000004, -188.19999999999976, -15.799999999999974, -138.6999999999999, -33.3, -48.300000000000075, -16.799999999999997, -55.90000000000007, -31.800000000000033, -25.4, -37.60000000000002, -59.30000000000007, -36.200000000000024, -47.000000000000085, -13.799999999999999, -35.50000000000006, -47.00000000000004, -14.699999999999974, -12.799999999999978, -37.20000000000005, -15.699999999999978, -12.799999999999997, -31.499999999999957, -15.6, -49.50000000000006, -38.400000000000006, -37.00000000000001, -24.100000000000026, -13.799999999999978, -85.29999999999993, -15.7, -40.80000000000007, -31.00000000000001, -67.90000000000003, -49.30000000000007, -12.699999999999978, -32.1, -50.300000000000075, -29.400000000000006, -117.6999999999998, -34.70000000000001, -43.10000000000001, -32.300000000000004, -33.900000000000055, -24.099999999999998, -52.10000000000007, -40.0, -57.400000000000006, -39.30000000000006, -37.60000000000006, -24.299999999999997, -53.40000000000005, -15.799999999999969, -74.50000000000004, -31.800000000000015, -24.300000000000026, -52.40000000000003, -19.400000000000006, -140.1999999999998, -21.80000000000005, -30.400000000000052, -15.399999999999995, -21.800000000000015, -9.999999999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.643452364195304, "mean_inference_ms": 0.7573604273063502, "mean_action_processing_ms": 0.087513304700427, "mean_env_wait_ms": 3.0631510727958187, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 300000, "timesteps_this_iter": 0, "agent_timesteps_total": 300000, "timers": {"sample_time_ms": 24089.901, "sample_throughput": 166.045, "load_time_ms": 0.265, "load_throughput": 15072514.599, "learn_time_ms": 4881.745, "learn_throughput": 819.379}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7465820312500007e-05, "cur_lr": 0.00010000000000000003, "total_loss": 1.5627029590549009, "policy_loss": -0.001567871072479794, "vf_loss": 156.42706477872787, "vf_explained_var": 0.07967476466650604, "kl": 0.008347450036366567, "entropy": 0.3008169307143137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 300000, "num_agent_steps_sampled": 300000, "num_steps_trained": 300000, "num_agent_steps_trained": 300000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3000, "training_iteration": 75, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-48-54", "timestamp": 1651052934, "time_this_iter_s": 21.621970891952515, "time_total_s": 1998.269399881363, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1998.269399881363, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 26.093103448275862, "ram_util_percent": 93.52758620689656}}
{"episode_reward_max": -9.999999999999995, "episode_reward_min": -149.59999999999974, "episode_reward_mean": -38.23400000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.3, -48.300000000000075, -16.799999999999997, -55.90000000000007, -31.800000000000033, -25.4, -37.60000000000002, -59.30000000000007, -36.200000000000024, -47.000000000000085, -13.799999999999999, -35.50000000000006, -47.00000000000004, -14.699999999999974, -12.799999999999978, -37.20000000000005, -15.699999999999978, -12.799999999999997, -31.499999999999957, -15.6, -49.50000000000006, -38.400000000000006, -37.00000000000001, -24.100000000000026, -13.799999999999978, -85.29999999999993, -15.7, -40.80000000000007, -31.00000000000001, -67.90000000000003, -49.30000000000007, -12.699999999999978, -32.1, -50.300000000000075, -29.400000000000006, -117.6999999999998, -34.70000000000001, -43.10000000000001, -32.300000000000004, -33.900000000000055, -24.099999999999998, -52.10000000000007, -40.0, -57.400000000000006, -39.30000000000006, -37.60000000000006, -24.299999999999997, -53.40000000000005, -15.799999999999969, -74.50000000000004, -31.800000000000015, -24.300000000000026, -52.40000000000003, -19.400000000000006, -140.1999999999998, -21.80000000000005, -30.400000000000052, -15.399999999999995, -21.800000000000015, -9.999999999999995, -31.6, -52.00000000000004, -12.499999999999995, -70.4, -42.799999999999926, -34.10000000000005, -12.799999999999981, -42.10000000000004, -52.40000000000004, -13.699999999999992, -40.70000000000008, -25.5, -33.10000000000004, -14.299999999999997, -50.90000000000005, -23.7, -25.700000000000006, -41.0, -52.60000000000005, -11.799999999999981, -72.3, -123.49999999999983, -12.899999999999995, -40.39999999999999, -32.80000000000001, -13.199999999999994, -17.8, -52.20000000000004, -15.799999999999986, -10.599999999999993, -31.10000000000004, -35.5, -97.79999999999978, -52.50000000000003, -36.00000000000001, -149.59999999999974, -31.400000000000052, -28.6, -14.799999999999981, -17.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6301437559676508, "mean_inference_ms": 0.7572187362834479, "mean_action_processing_ms": 0.08675559175064759, "mean_env_wait_ms": 3.062543542119213, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 304000, "timesteps_this_iter": 0, "agent_timesteps_total": 304000, "timers": {"sample_time_ms": 23852.978, "sample_throughput": 167.694, "load_time_ms": 0.254, "load_throughput": 15744384.384, "learn_time_ms": 4894.554, "learn_throughput": 817.235}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 2.7465820312500007e-05, "cur_lr": 0.00010000000000000003, "total_loss": 1.5800491026812984, "policy_loss": -0.005690200518696539, "vf_loss": 158.57391988897837, "vf_explained_var": -0.06622234640582915, "kl": 0.004988684800803714, "entropy": 0.3787598813012723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 304000, "num_agent_steps_sampled": 304000, "num_steps_trained": 304000, "num_agent_steps_trained": 304000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3040, "training_iteration": 76, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-49-17", "timestamp": 1651052957, "time_this_iter_s": 22.782315969467163, "time_total_s": 2021.05171585083, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2021.05171585083, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 20.851612903225806, "ram_util_percent": 93.56774193548384}}
{"episode_reward_max": -9.999999999999995, "episode_reward_min": -245.79999999999993, "episode_reward_mean": -40.79800000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.099999999999998, -52.10000000000007, -40.0, -57.400000000000006, -39.30000000000006, -37.60000000000006, -24.299999999999997, -53.40000000000005, -15.799999999999969, -74.50000000000004, -31.800000000000015, -24.300000000000026, -52.40000000000003, -19.400000000000006, -140.1999999999998, -21.80000000000005, -30.400000000000052, -15.399999999999995, -21.800000000000015, -9.999999999999995, -31.6, -52.00000000000004, -12.499999999999995, -70.4, -42.799999999999926, -34.10000000000005, -12.799999999999981, -42.10000000000004, -52.40000000000004, -13.699999999999992, -40.70000000000008, -25.5, -33.10000000000004, -14.299999999999997, -50.90000000000005, -23.7, -25.700000000000006, -41.0, -52.60000000000005, -11.799999999999981, -72.3, -123.49999999999983, -12.899999999999995, -40.39999999999999, -32.80000000000001, -13.199999999999994, -17.8, -52.20000000000004, -15.799999999999986, -10.599999999999993, -31.10000000000004, -35.5, -97.79999999999978, -52.50000000000003, -36.00000000000001, -149.59999999999974, -31.400000000000052, -28.6, -14.799999999999981, -17.7, -15.19999999999997, -53.20000000000005, -38.60000000000005, -39.80000000000005, -38.20000000000006, -11.799999999999981, -32.600000000000016, -32.7, -20.8, -38.2, -27.000000000000007, -26.50000000000005, -11.399999999999983, -16.499999999999993, -34.400000000000055, -34.200000000000045, -52.70000000000003, -24.200000000000003, -45.200000000000074, -51.90000000000008, -96.49999999999982, -53.200000000000045, -12.799999999999978, -30.800000000000015, -30.700000000000003, -52.10000000000003, -245.79999999999993, -34.5, -31.200000000000003, -40.10000000000007, -35.50000000000004, -38.700000000000074, -26.300000000000004, -43.900000000000055, -55.10000000000005, -21.9, -60.20000000000009, -34.80000000000002, -44.0, -90.4], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6170802462980853, "mean_inference_ms": 0.7570200691799559, "mean_action_processing_ms": 0.08601469559457253, "mean_env_wait_ms": 3.0616849700113242, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 308000, "timesteps_this_iter": 0, "agent_timesteps_total": 308000, "timers": {"sample_time_ms": 23469.65, "sample_throughput": 170.433, "load_time_ms": 0.252, "load_throughput": 15849991.497, "learn_time_ms": 4875.105, "learn_throughput": 820.495}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3732910156250004e-05, "cur_lr": 0.00010000000000000003, "total_loss": 3.875102721490667, "policy_loss": -0.012345521479484535, "vf_loss": 388.7448239049604, "vf_explained_var": 0.10724411933652817, "kl": 0.008842340702886508, "entropy": 0.25193777697220926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 308000, "num_agent_steps_sampled": 308000, "num_steps_trained": 308000, "num_agent_steps_trained": 308000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3080, "training_iteration": 77, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-49-39", "timestamp": 1651052979, "time_this_iter_s": 22.06384825706482, "time_total_s": 2043.115564107895, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2043.115564107895, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 20.35666666666667, "ram_util_percent": 93.45000000000002}}
{"episode_reward_max": -9.899999999999997, "episode_reward_min": -245.79999999999993, "episode_reward_mean": -41.812000000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72.3, -123.49999999999983, -12.899999999999995, -40.39999999999999, -32.80000000000001, -13.199999999999994, -17.8, -52.20000000000004, -15.799999999999986, -10.599999999999993, -31.10000000000004, -35.5, -97.79999999999978, -52.50000000000003, -36.00000000000001, -149.59999999999974, -31.400000000000052, -28.6, -14.799999999999981, -17.7, -15.19999999999997, -53.20000000000005, -38.60000000000005, -39.80000000000005, -38.20000000000006, -11.799999999999981, -32.600000000000016, -32.7, -20.8, -38.2, -27.000000000000007, -26.50000000000005, -11.399999999999983, -16.499999999999993, -34.400000000000055, -34.200000000000045, -52.70000000000003, -24.200000000000003, -45.200000000000074, -51.90000000000008, -96.49999999999982, -53.200000000000045, -12.799999999999978, -30.800000000000015, -30.700000000000003, -52.10000000000003, -245.79999999999993, -34.5, -31.200000000000003, -40.10000000000007, -35.50000000000004, -38.700000000000074, -26.300000000000004, -43.900000000000055, -55.10000000000005, -21.9, -60.20000000000009, -34.80000000000002, -44.0, -90.4, -9.899999999999997, -12.099999999999978, -85.6, -28.100000000000005, -17.799999999999997, -12.699999999999978, -16.7, -31.800000000000026, -24.99999999999996, -40.10000000000005, -25.800000000000022, -46.40000000000009, -52.10000000000004, -25.500000000000004, -30.700000000000003, -53.60000000000005, -11.099999999999984, -58.90000000000008, -40.30000000000006, -70.40000000000005, -120.79999999999987, -22.3, -52.70000000000005, -29.300000000000004, -15.699999999999978, -43.60000000000007, -33.80000000000001, -52.20000000000003, -36.90000000000001, -40.0, -40.5, -53.500000000000036, -104.3, -50.70000000000005, -40.70000000000003, -30.70000000000004, -36.6, -28.299999999999972, -13.399999999999995, -30.500000000000014], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6043839283222099, "mean_inference_ms": 0.7569832598522246, "mean_action_processing_ms": 0.08530226668189066, "mean_env_wait_ms": 3.06117975570176, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 312000, "timesteps_this_iter": 0, "agent_timesteps_total": 312000, "timers": {"sample_time_ms": 23487.434, "sample_throughput": 170.304, "load_time_ms": 0.254, "load_throughput": 15728148.495, "learn_time_ms": 4780.041, "learn_throughput": 836.813}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.3732910156250004e-05, "cur_lr": 0.00010000000000000003, "total_loss": 1.397758343366916, "policy_loss": -0.0009016526627644736, "vf_loss": 139.865997738992, "vf_explained_var": 0.013183809736723541, "kl": 0.004051698093403506, "entropy": 0.2893427541098928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 312000, "num_agent_steps_sampled": 312000, "num_steps_trained": 312000, "num_agent_steps_trained": 312000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3120, "training_iteration": 78, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-50-02", "timestamp": 1651053002, "time_this_iter_s": 22.40018606185913, "time_total_s": 2065.515750169754, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2065.515750169754, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 27.89333333333333, "ram_util_percent": 93.50333333333333}}
{"episode_reward_max": -8.199999999999994, "episode_reward_min": -245.79999999999993, "episode_reward_mean": -41.90400000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-96.49999999999982, -53.200000000000045, -12.799999999999978, -30.800000000000015, -30.700000000000003, -52.10000000000003, -245.79999999999993, -34.5, -31.200000000000003, -40.10000000000007, -35.50000000000004, -38.700000000000074, -26.300000000000004, -43.900000000000055, -55.10000000000005, -21.9, -60.20000000000009, -34.80000000000002, -44.0, -90.4, -9.899999999999997, -12.099999999999978, -85.6, -28.100000000000005, -17.799999999999997, -12.699999999999978, -16.7, -31.800000000000026, -24.99999999999996, -40.10000000000005, -25.800000000000022, -46.40000000000009, -52.10000000000004, -25.500000000000004, -30.700000000000003, -53.60000000000005, -11.099999999999984, -58.90000000000008, -40.30000000000006, -70.40000000000005, -120.79999999999987, -22.3, -52.70000000000005, -29.300000000000004, -15.699999999999978, -43.60000000000007, -33.80000000000001, -52.20000000000003, -36.90000000000001, -40.0, -40.5, -53.500000000000036, -104.3, -50.70000000000005, -40.70000000000003, -30.70000000000004, -36.6, -28.299999999999972, -13.399999999999995, -30.500000000000014, -13.499999999999996, -17.800000000000008, -25.50000000000005, -29.4, -29.100000000000023, -13.799999999999978, -34.900000000000006, -47.90000000000001, -45.40000000000008, -12.199999999999992, -37.80000000000007, -14.299999999999995, -49.60000000000004, -12.299999999999997, -33.50000000000006, -21.500000000000004, -39.40000000000003, -35.40000000000004, -51.60000000000003, -27.500000000000025, -13.899999999999991, -31.900000000000038, -118.29999999999984, -50.40000000000004, -71.90000000000003, -55.20000000000007, -137.7, -36.1, -33.20000000000006, -12.799999999999995, -44.50000000000001, -19.1, -38.90000000000001, -8.199999999999994, -56.300000000000054, -31.000000000000043, -31.500000000000007, -30.600000000000048, -52.30000000000003, -74.60000000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5918059665835829, "mean_inference_ms": 0.7569623576630568, "mean_action_processing_ms": 0.0846059983937265, "mean_env_wait_ms": 3.0605321476894223, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 316000, "timesteps_this_iter": 0, "agent_timesteps_total": 316000, "timers": {"sample_time_ms": 23226.13, "sample_throughput": 172.22, "load_time_ms": 0.252, "load_throughput": 15852986.866, "learn_time_ms": 4796.383, "learn_throughput": 833.962}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 6.866455078125002e-06, "cur_lr": 0.00010000000000000003, "total_loss": 1.499397072094112, "policy_loss": 0.001381729803078117, "vf_loss": 149.80153459938623, "vf_explained_var": -0.002644076398623887, "kl": 0.004489805739287453, "entropy": 0.28975186668015934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 316000, "num_agent_steps_sampled": 316000, "num_steps_trained": 316000, "num_agent_steps_trained": 316000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3160, "training_iteration": 79, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-50-24", "timestamp": 1651053024, "time_this_iter_s": 21.93361806869507, "time_total_s": 2087.449368238449, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2087.449368238449, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 26.246666666666666, "ram_util_percent": 93.50666666666666}}
{"episode_reward_max": -8.199999999999994, "episode_reward_min": -137.7, "episode_reward_mean": -39.51300000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-120.79999999999987, -22.3, -52.70000000000005, -29.300000000000004, -15.699999999999978, -43.60000000000007, -33.80000000000001, -52.20000000000003, -36.90000000000001, -40.0, -40.5, -53.500000000000036, -104.3, -50.70000000000005, -40.70000000000003, -30.70000000000004, -36.6, -28.299999999999972, -13.399999999999995, -30.500000000000014, -13.499999999999996, -17.800000000000008, -25.50000000000005, -29.4, -29.100000000000023, -13.799999999999978, -34.900000000000006, -47.90000000000001, -45.40000000000008, -12.199999999999992, -37.80000000000007, -14.299999999999995, -49.60000000000004, -12.299999999999997, -33.50000000000006, -21.500000000000004, -39.40000000000003, -35.40000000000004, -51.60000000000003, -27.500000000000025, -13.899999999999991, -31.900000000000038, -118.29999999999984, -50.40000000000004, -71.90000000000003, -55.20000000000007, -137.7, -36.1, -33.20000000000006, -12.799999999999995, -44.50000000000001, -19.1, -38.90000000000001, -8.199999999999994, -56.300000000000054, -31.000000000000043, -31.500000000000007, -30.600000000000048, -52.30000000000003, -74.60000000000002, -18.60000000000001, -27.900000000000013, -43.5, -53.50000000000004, -15.499999999999998, -48.90000000000004, -14.299999999999995, -11.09999999999998, -49.00000000000008, -44.800000000000026, -23.700000000000003, -49.90000000000003, -53.00000000000003, -51.90000000000003, -30.900000000000027, -28.500000000000007, -33.6, -40.000000000000064, -38.700000000000024, -50.000000000000014, -27.599999999999998, -15.499999999999995, -11.7, -61.299999999999926, -42.300000000000075, -55.20000000000003, -46.7, -37.200000000000024, -29.200000000000017, -13.599999999999994, -35.2, -52.20000000000003, -44.10000000000006, -55.30000000000006, -129.49999999999991, -30.100000000000037, -15.099999999999996, -21.400000000000002, -28.200000000000003, -55.300000000000054], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5794788330090697, "mean_inference_ms": 0.7571688107487975, "mean_action_processing_ms": 0.08393230416013196, "mean_env_wait_ms": 3.0596863410487947, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 320000, "timesteps_this_iter": 0, "agent_timesteps_total": 320000, "timers": {"sample_time_ms": 23232.149, "sample_throughput": 172.175, "load_time_ms": 0.249, "load_throughput": 16068591.131, "learn_time_ms": 4694.36, "learn_throughput": 852.086}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.433227539062501e-06, "cur_lr": 0.00010000000000000003, "total_loss": 1.1548305084988955, "policy_loss": 0.005990010359755126, "vf_loss": 114.88405104298745, "vf_explained_var": 0.10960529382510852, "kl": 0.00550285562775768, "entropy": 0.22331008164472477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 320000, "num_agent_steps_sampled": 320000, "num_steps_trained": 320000, "num_agent_steps_trained": 320000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3200, "training_iteration": 80, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-50-46", "timestamp": 1651053046, "time_this_iter_s": 22.224267959594727, "time_total_s": 2109.673636198044, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2109.673636198044, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 24.903333333333332, "ram_util_percent": 93.50333333333333}}
{"episode_reward_max": -8.199999999999994, "episode_reward_min": -137.7, "episode_reward_mean": -43.89800000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.899999999999991, -31.900000000000038, -118.29999999999984, -50.40000000000004, -71.90000000000003, -55.20000000000007, -137.7, -36.1, -33.20000000000006, -12.799999999999995, -44.50000000000001, -19.1, -38.90000000000001, -8.199999999999994, -56.300000000000054, -31.000000000000043, -31.500000000000007, -30.600000000000048, -52.30000000000003, -74.60000000000002, -18.60000000000001, -27.900000000000013, -43.5, -53.50000000000004, -15.499999999999998, -48.90000000000004, -14.299999999999995, -11.09999999999998, -49.00000000000008, -44.800000000000026, -23.700000000000003, -49.90000000000003, -53.00000000000003, -51.90000000000003, -30.900000000000027, -28.500000000000007, -33.6, -40.000000000000064, -38.700000000000024, -50.000000000000014, -27.599999999999998, -15.499999999999995, -11.7, -61.299999999999926, -42.300000000000075, -55.20000000000003, -46.7, -37.200000000000024, -29.200000000000017, -13.599999999999994, -35.2, -52.20000000000003, -44.10000000000006, -55.30000000000006, -129.49999999999991, -30.100000000000037, -15.099999999999996, -21.400000000000002, -28.200000000000003, -55.300000000000054, -44.70000000000006, -22.4, -36.800000000000004, -47.50000000000006, -30.400000000000013, -41.00000000000002, -24.70000000000005, -70.90000000000002, -53.30000000000004, -55.40000000000005, -137.10000000000002, -17.0, -17.3, -57.20000000000009, -27.80000000000001, -53.80000000000005, -42.10000000000004, -71.60000000000001, -52.90000000000004, -59.700000000000024, -37.0, -39.50000000000006, -109.69999999999983, -34.90000000000004, -55.60000000000007, -39.600000000000065, -15.799999999999972, -24.700000000000017, -13.699999999999978, -36.30000000000003, -47.000000000000064, -19.800000000000004, -112.69999999999978, -51.300000000000054, -48.50000000000003, -37.400000000000055, -116.49999999999987, -39.40000000000003, -10.69999999999998, -53.70000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.567692204044725, "mean_inference_ms": 0.7579259459427092, "mean_action_processing_ms": 0.08329844571431812, "mean_env_wait_ms": 3.0600238581747488, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 324000, "timesteps_this_iter": 0, "agent_timesteps_total": 324000, "timers": {"sample_time_ms": 23029.268, "sample_throughput": 173.692, "load_time_ms": 0.252, "load_throughput": 15846997.261, "learn_time_ms": 4637.056, "learn_throughput": 862.616}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.433227539062501e-06, "cur_lr": 0.00010000000000000003, "total_loss": 2.270907161017299, "policy_loss": 0.0009533107981726688, "vf_loss": 226.9953877931, "vf_explained_var": -0.035969200954642344, "kl": 0.006225416530284805, "entropy": 0.2842571914276128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 324000, "num_agent_steps_sampled": 324000, "num_steps_trained": 324000, "num_agent_steps_trained": 324000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3240, "training_iteration": 81, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-51-10", "timestamp": 1651053070, "time_this_iter_s": 24.05439519882202, "time_total_s": 2133.728031396866, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2133.728031396866, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 29.145454545454545, "ram_util_percent": 93.63030303030301}}
{"episode_reward_max": -8.799999999999999, "episode_reward_min": -260.7999999999997, "episode_reward_mean": -44.353, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.599999999999998, -15.499999999999995, -11.7, -61.299999999999926, -42.300000000000075, -55.20000000000003, -46.7, -37.200000000000024, -29.200000000000017, -13.599999999999994, -35.2, -52.20000000000003, -44.10000000000006, -55.30000000000006, -129.49999999999991, -30.100000000000037, -15.099999999999996, -21.400000000000002, -28.200000000000003, -55.300000000000054, -44.70000000000006, -22.4, -36.800000000000004, -47.50000000000006, -30.400000000000013, -41.00000000000002, -24.70000000000005, -70.90000000000002, -53.30000000000004, -55.40000000000005, -137.10000000000002, -17.0, -17.3, -57.20000000000009, -27.80000000000001, -53.80000000000005, -42.10000000000004, -71.60000000000001, -52.90000000000004, -59.700000000000024, -37.0, -39.50000000000006, -109.69999999999983, -34.90000000000004, -55.60000000000007, -39.600000000000065, -15.799999999999972, -24.700000000000017, -13.699999999999978, -36.30000000000003, -47.000000000000064, -19.800000000000004, -112.69999999999978, -51.300000000000054, -48.50000000000003, -37.400000000000055, -116.49999999999987, -39.40000000000003, -10.69999999999998, -53.70000000000004, -27.500000000000007, -14.799999999999997, -51.60000000000004, -20.800000000000015, -14.999999999999993, -52.80000000000003, -15.199999999999994, -37.50000000000006, -30.90000000000005, -43.500000000000036, -51.800000000000026, -37.7, -260.7999999999997, -67.10000000000011, -53.700000000000074, -8.799999999999999, -36.50000000000005, -40.60000000000003, -25.0, -53.800000000000054, -13.499999999999975, -31.900000000000002, -39.80000000000002, -50.4999999999999, -31.200000000000014, -53.000000000000036, -31.00000000000003, -12.49999999999998, -26.800000000000004, -27.300000000000058, -53.00000000000002, -31.299999999999997, -39.50000000000002, -38.50000000000003, -28.90000000000001, -31.600000000000048, -129.59999999999982, -47.900000000000055, -37.400000000000006, -20.599999999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5563528478815585, "mean_inference_ms": 0.7588385967903606, "mean_action_processing_ms": 0.08268880322832169, "mean_env_wait_ms": 3.061301169358772, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 328000, "timesteps_this_iter": 0, "agent_timesteps_total": 328000, "timers": {"sample_time_ms": 22726.975, "sample_throughput": 176.002, "load_time_ms": 0.253, "load_throughput": 15793293.796, "learn_time_ms": 4611.282, "learn_throughput": 867.438}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.433227539062501e-06, "cur_lr": 0.00010000000000000003, "total_loss": 3.6491334977574765, "policy_loss": -0.007839204030491972, "vf_loss": 365.69727547348185, "vf_explained_var": -0.043492865754712014, "kl": 0.011160368567487403, "entropy": 0.31943882196660967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 328000, "num_agent_steps_sampled": 328000, "num_steps_trained": 328000, "num_agent_steps_trained": 328000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3280, "training_iteration": 82, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-51-33", "timestamp": 1651053093, "time_this_iter_s": 23.241344213485718, "time_total_s": 2156.9693756103516, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2156.9693756103516, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 31.567741935483873, "ram_util_percent": 93.85483870967741}}
{"episode_reward_max": -8.799999999999999, "episode_reward_min": -260.7999999999997, "episode_reward_mean": -40.38500000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.0, -39.50000000000006, -109.69999999999983, -34.90000000000004, -55.60000000000007, -39.600000000000065, -15.799999999999972, -24.700000000000017, -13.699999999999978, -36.30000000000003, -47.000000000000064, -19.800000000000004, -112.69999999999978, -51.300000000000054, -48.50000000000003, -37.400000000000055, -116.49999999999987, -39.40000000000003, -10.69999999999998, -53.70000000000004, -27.500000000000007, -14.799999999999997, -51.60000000000004, -20.800000000000015, -14.999999999999993, -52.80000000000003, -15.199999999999994, -37.50000000000006, -30.90000000000005, -43.500000000000036, -51.800000000000026, -37.7, -260.7999999999997, -67.10000000000011, -53.700000000000074, -8.799999999999999, -36.50000000000005, -40.60000000000003, -25.0, -53.800000000000054, -13.499999999999975, -31.900000000000002, -39.80000000000002, -50.4999999999999, -31.200000000000014, -53.000000000000036, -31.00000000000003, -12.49999999999998, -26.800000000000004, -27.300000000000058, -53.00000000000002, -31.299999999999997, -39.50000000000002, -38.50000000000003, -28.90000000000001, -31.600000000000048, -129.59999999999982, -47.900000000000055, -37.400000000000006, -20.599999999999998, -12.299999999999978, -46.30000000000004, -32.70000000000004, -13.599999999999973, -44.4, -24.800000000000004, -49.10000000000001, -13.099999999999973, -15.599999999999994, -40.800000000000054, -17.499999999999996, -25.4, -36.10000000000001, -38.300000000000004, -42.50000000000006, -57.90000000000002, -55.300000000000054, -13.799999999999978, -52.900000000000034, -37.2, -22.700000000000003, -24.60000000000003, -69.39999999999999, -31.00000000000006, -19.399999999999988, -43.60000000000008, -24.6, -18.100000000000012, -43.00000000000008, -51.300000000000026, -68.00000000000001, -41.60000000000009, -31.300000000000015, -31.500000000000057, -70.3, -14.699999999999978, -34.1, -22.300000000000043, -27.90000000000002, -14.499999999999993], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5454141439298694, "mean_inference_ms": 0.7599839861378587, "mean_action_processing_ms": 0.08209653869756967, "mean_env_wait_ms": 3.0630161085567282, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 332000, "timesteps_this_iter": 0, "agent_timesteps_total": 332000, "timers": {"sample_time_ms": 22804.883, "sample_throughput": 175.401, "load_time_ms": 0.365, "load_throughput": 10959770.055, "learn_time_ms": 4672.277, "learn_throughput": 856.114}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.433227539062501e-06, "cur_lr": 0.00010000000000000003, "total_loss": 0.8929551336553789, "policy_loss": -0.0034309991084600006, "vf_loss": 89.63861307636384, "vf_explained_var": -0.039015845393621795, "kl": 0.006070813141133669, "entropy": 0.35798407997735726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 332000, "num_agent_steps_sampled": 332000, "num_steps_trained": 332000, "num_agent_steps_trained": 332000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3320, "training_iteration": 83, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-51-58", "timestamp": 1651053118, "time_this_iter_s": 24.896585941314697, "time_total_s": 2181.8659615516663, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2181.8659615516663, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 38.35151515151516, "ram_util_percent": 94.38787878787878}}
{"episode_reward_max": -9.99999999999998, "episode_reward_min": -136.2999999999998, "episode_reward_mean": -35.942, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.499999999999975, -31.900000000000002, -39.80000000000002, -50.4999999999999, -31.200000000000014, -53.000000000000036, -31.00000000000003, -12.49999999999998, -26.800000000000004, -27.300000000000058, -53.00000000000002, -31.299999999999997, -39.50000000000002, -38.50000000000003, -28.90000000000001, -31.600000000000048, -129.59999999999982, -47.900000000000055, -37.400000000000006, -20.599999999999998, -12.299999999999978, -46.30000000000004, -32.70000000000004, -13.599999999999973, -44.4, -24.800000000000004, -49.10000000000001, -13.099999999999973, -15.599999999999994, -40.800000000000054, -17.499999999999996, -25.4, -36.10000000000001, -38.300000000000004, -42.50000000000006, -57.90000000000002, -55.300000000000054, -13.799999999999978, -52.900000000000034, -37.2, -22.700000000000003, -24.60000000000003, -69.39999999999999, -31.00000000000006, -19.399999999999988, -43.60000000000008, -24.6, -18.100000000000012, -43.00000000000008, -51.300000000000026, -68.00000000000001, -41.60000000000009, -31.300000000000015, -31.500000000000057, -70.3, -14.699999999999978, -34.1, -22.300000000000043, -27.90000000000002, -14.499999999999993, -34.000000000000014, -53.900000000000055, -30.20000000000005, -54.90000000000006, -10.099999999999982, -13.899999999999977, -31.300000000000026, -45.199999999999996, -33.300000000000004, -41.20000000000006, -56.700000000000074, -38.40000000000001, -31.10000000000001, -21.80000000000003, -33.599999999999994, -23.400000000000023, -38.70000000000006, -49.90000000000006, -34.700000000000045, -33.40000000000001, -20.7, -53.000000000000036, -9.99999999999998, -53.600000000000065, -31.299999999999958, -34.200000000000045, -12.699999999999987, -48.50000000000006, -136.2999999999998, -16.09999999999999, -41.800000000000004, -34.5, -19.00000000000003, -19.299999999999997, -30.900000000000002, -11.299999999999985, -35.0, -41.200000000000045, -53.10000000000004, -32.7], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5347368594998567, "mean_inference_ms": 0.7607080234047692, "mean_action_processing_ms": 0.08149994951075187, "mean_env_wait_ms": 3.064053971361458, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 336000, "timesteps_this_iter": 0, "agent_timesteps_total": 336000, "timers": {"sample_time_ms": 22815.0, "sample_throughput": 175.323, "load_time_ms": 0.364, "load_throughput": 10974825.669, "learn_time_ms": 4631.323, "learn_throughput": 863.684}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.433227539062501e-06, "cur_lr": 0.00010000000000000003, "total_loss": 1.060257048159337, "policy_loss": -0.001894415463370982, "vf_loss": 106.21514653441727, "vf_explained_var": 0.05278903156198481, "kl": 0.005357227423259119, "entropy": 0.2510677307563764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 336000, "num_agent_steps_sampled": 336000, "num_steps_trained": 336000, "num_agent_steps_trained": 336000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3360, "training_iteration": 84, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-52-21", "timestamp": 1651053141, "time_this_iter_s": 22.324458122253418, "time_total_s": 2204.1904196739197, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2204.1904196739197, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 24.456666666666663, "ram_util_percent": 94.37333333333335}}
{"episode_reward_max": -9.99999999999998, "episode_reward_min": -136.2999999999998, "episode_reward_mean": -38.33900000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.700000000000003, -24.60000000000003, -69.39999999999999, -31.00000000000006, -19.399999999999988, -43.60000000000008, -24.6, -18.100000000000012, -43.00000000000008, -51.300000000000026, -68.00000000000001, -41.60000000000009, -31.300000000000015, -31.500000000000057, -70.3, -14.699999999999978, -34.1, -22.300000000000043, -27.90000000000002, -14.499999999999993, -34.000000000000014, -53.900000000000055, -30.20000000000005, -54.90000000000006, -10.099999999999982, -13.899999999999977, -31.300000000000026, -45.199999999999996, -33.300000000000004, -41.20000000000006, -56.700000000000074, -38.40000000000001, -31.10000000000001, -21.80000000000003, -33.599999999999994, -23.400000000000023, -38.70000000000006, -49.90000000000006, -34.700000000000045, -33.40000000000001, -20.7, -53.000000000000036, -9.99999999999998, -53.600000000000065, -31.299999999999958, -34.200000000000045, -12.699999999999987, -48.50000000000006, -136.2999999999998, -16.09999999999999, -41.800000000000004, -34.5, -19.00000000000003, -19.299999999999997, -30.900000000000002, -11.299999999999985, -35.0, -41.200000000000045, -53.10000000000004, -32.7, -45.00000000000009, -52.90000000000006, -37.60000000000003, -52.000000000000036, -20.900000000000002, -45.09999999999998, -36.9, -10.999999999999984, -11.199999999999983, -54.300000000000026, -52.20000000000003, -52.80000000000004, -31.700000000000017, -28.600000000000005, -40.4, -37.100000000000065, -13.59999999999998, -66.89999999999999, -54.40000000000005, -54.50000000000006, -62.30000000000001, -13.699999999999974, -55.90000000000008, -40.90000000000004, -54.00000000000002, -49.30000000000002, -28.500000000000007, -52.50000000000003, -52.700000000000045, -77.7, -57.70000000000009, -25.10000000000004, -35.60000000000001, -36.10000000000003, -18.600000000000023, -51.900000000000006, -69.6, -40.40000000000006, -35.90000000000008, -27.600000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5242442966298242, "mean_inference_ms": 0.7610765812350812, "mean_action_processing_ms": 0.08090888754706055, "mean_env_wait_ms": 3.064663745633244, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 340000, "timesteps_this_iter": 0, "agent_timesteps_total": 340000, "timers": {"sample_time_ms": 22866.181, "sample_throughput": 174.931, "load_time_ms": 0.455, "load_throughput": 8785722.664, "learn_time_ms": 4660.994, "learn_throughput": 858.186}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 3.433227539062501e-06, "cur_lr": 0.00010000000000000003, "total_loss": 0.8130330964166831, "policy_loss": 0.004117576655761529, "vf_loss": 80.89155329837594, "vf_explained_var": 0.05548484690727726, "kl": 0.002334471590217584, "entropy": 0.22530835910590105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 340000, "num_agent_steps_sampled": 340000, "num_steps_trained": 340000, "num_agent_steps_trained": 340000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3400, "training_iteration": 85, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-52-43", "timestamp": 1651053163, "time_this_iter_s": 22.842450857162476, "time_total_s": 2227.032870531082, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2227.032870531082, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 25.703225806451613, "ram_util_percent": 94.2774193548387}}
{"episode_reward_max": -8.299999999999999, "episode_reward_min": -136.2999999999998, "episode_reward_mean": -39.47800000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.7, -53.000000000000036, -9.99999999999998, -53.600000000000065, -31.299999999999958, -34.200000000000045, -12.699999999999987, -48.50000000000006, -136.2999999999998, -16.09999999999999, -41.800000000000004, -34.5, -19.00000000000003, -19.299999999999997, -30.900000000000002, -11.299999999999985, -35.0, -41.200000000000045, -53.10000000000004, -32.7, -45.00000000000009, -52.90000000000006, -37.60000000000003, -52.000000000000036, -20.900000000000002, -45.09999999999998, -36.9, -10.999999999999984, -11.199999999999983, -54.300000000000026, -52.20000000000003, -52.80000000000004, -31.700000000000017, -28.600000000000005, -40.4, -37.100000000000065, -13.59999999999998, -66.89999999999999, -54.40000000000005, -54.50000000000006, -62.30000000000001, -13.699999999999974, -55.90000000000008, -40.90000000000004, -54.00000000000002, -49.30000000000002, -28.500000000000007, -52.50000000000003, -52.700000000000045, -77.7, -57.70000000000009, -25.10000000000004, -35.60000000000001, -36.10000000000003, -18.600000000000023, -51.900000000000006, -69.6, -40.40000000000006, -35.90000000000008, -27.600000000000005, -92.89999999999989, -12.699999999999978, -42.90000000000004, -35.300000000000026, -27.90000000000001, -53.50000000000004, -52.30000000000005, -29.300000000000008, -50.50000000000004, -14.999999999999991, -27.300000000000015, -53.400000000000055, -29.800000000000004, -22.30000000000004, -35.99999999999997, -54.60000000000006, -53.30000000000003, -39.30000000000004, -15.499999999999979, -45.30000000000005, -35.20000000000005, -54.30000000000003, -51.80000000000003, -44.60000000000007, -20.599999999999998, -35.40000000000006, -30.20000000000003, -34.300000000000026, -57.10000000000008, -41.500000000000064, -38.10000000000001, -12.599999999999994, -49.700000000000045, -11.89999999999998, -33.400000000000055, -8.299999999999999, -50.90000000000006, -38.200000000000045, -37.60000000000006, -52.70000000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5138406394288075, "mean_inference_ms": 0.7609054539657117, "mean_action_processing_ms": 0.08031914883028854, "mean_env_wait_ms": 3.064298666771557, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 344000, "timesteps_this_iter": 0, "agent_timesteps_total": 344000, "timers": {"sample_time_ms": 22843.576, "sample_throughput": 175.104, "load_time_ms": 0.453, "load_throughput": 8821292.392, "learn_time_ms": 4581.259, "learn_throughput": 873.122}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 1.7166137695312505e-06, "cur_lr": 0.00010000000000000003, "total_loss": 0.7432392266909441, "policy_loss": 0.00467842149658389, "vf_loss": 73.85608140576271, "vf_explained_var": 0.13399693760820613, "kl": 0.004723450516852401, "entropy": 0.24393636084371997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 344000, "num_agent_steps_sampled": 344000, "num_steps_trained": 344000, "num_agent_steps_trained": 344000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3440, "training_iteration": 86, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-53-05", "timestamp": 1651053185, "time_this_iter_s": 21.4598388671875, "time_total_s": 2248.4927093982697, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2248.4927093982697, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 34.04827586206897, "ram_util_percent": 94.1206896551724}}
{"episode_reward_max": -8.299999999999999, "episode_reward_min": -110.30000000000001, "episode_reward_mean": -39.550000000000026, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.30000000000001, -13.699999999999974, -55.90000000000008, -40.90000000000004, -54.00000000000002, -49.30000000000002, -28.500000000000007, -52.50000000000003, -52.700000000000045, -77.7, -57.70000000000009, -25.10000000000004, -35.60000000000001, -36.10000000000003, -18.600000000000023, -51.900000000000006, -69.6, -40.40000000000006, -35.90000000000008, -27.600000000000005, -92.89999999999989, -12.699999999999978, -42.90000000000004, -35.300000000000026, -27.90000000000001, -53.50000000000004, -52.30000000000005, -29.300000000000008, -50.50000000000004, -14.999999999999991, -27.300000000000015, -53.400000000000055, -29.800000000000004, -22.30000000000004, -35.99999999999997, -54.60000000000006, -53.30000000000003, -39.30000000000004, -15.499999999999979, -45.30000000000005, -35.20000000000005, -54.30000000000003, -51.80000000000003, -44.60000000000007, -20.599999999999998, -35.40000000000006, -30.20000000000003, -34.300000000000026, -57.10000000000008, -41.500000000000064, -38.10000000000001, -12.599999999999994, -49.700000000000045, -11.89999999999998, -33.400000000000055, -8.299999999999999, -50.90000000000006, -38.200000000000045, -37.60000000000006, -52.70000000000003, -18.5, -60.00000000000001, -49.00000000000004, -37.900000000000055, -15.499999999999973, -34.400000000000084, -33.70000000000006, -14.199999999999982, -31.300000000000004, -12.699999999999976, -37.90000000000002, -50.00000000000004, -30.90000000000003, -12.999999999999977, -35.900000000000055, -36.20000000000006, -38.20000000000007, -64.30000000000014, -66.00000000000007, -53.90000000000004, -39.900000000000084, -53.20000000000006, -52.800000000000054, -11.799999999999995, -39.20000000000003, -33.0, -34.400000000000006, -13.699999999999982, -50.300000000000026, -110.30000000000001, -38.80000000000008, -12.700000000000001, -52.300000000000026, -24.70000000000001, -54.50000000000004, -41.099999999999994, -54.00000000000005, -17.89999999999999, -53.80000000000005, -19.6], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.503595664418578, "mean_inference_ms": 0.7607792824458096, "mean_action_processing_ms": 0.0797500091434065, "mean_env_wait_ms": 3.0641698718333497, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 348000, "timesteps_this_iter": 0, "agent_timesteps_total": 348000, "timers": {"sample_time_ms": 22832.803, "sample_throughput": 175.187, "load_time_ms": 0.457, "load_throughput": 8748157.264, "learn_time_ms": 4563.964, "learn_throughput": 876.431}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.583068847656252e-07, "cur_lr": 0.00010000000000000003, "total_loss": 0.9418529683969394, "policy_loss": 0.00045506139861680166, "vf_loss": 94.13979238592168, "vf_explained_var": 0.12203813887411548, "kl": 0.00543246389912687, "entropy": 0.27896902356697345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 348000, "num_agent_steps_sampled": 348000, "num_steps_trained": 348000, "num_agent_steps_trained": 348000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3480, "training_iteration": 87, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-53-28", "timestamp": 1651053208, "time_this_iter_s": 22.58042287826538, "time_total_s": 2271.073132276535, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2271.073132276535, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 31.183870967741935, "ram_util_percent": 94.34193548387096}}
{"episode_reward_max": -8.299999999999999, "episode_reward_min": -110.30000000000001, "episode_reward_mean": -37.63200000000003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.20000000000005, -54.30000000000003, -51.80000000000003, -44.60000000000007, -20.599999999999998, -35.40000000000006, -30.20000000000003, -34.300000000000026, -57.10000000000008, -41.500000000000064, -38.10000000000001, -12.599999999999994, -49.700000000000045, -11.89999999999998, -33.400000000000055, -8.299999999999999, -50.90000000000006, -38.200000000000045, -37.60000000000006, -52.70000000000003, -18.5, -60.00000000000001, -49.00000000000004, -37.900000000000055, -15.499999999999973, -34.400000000000084, -33.70000000000006, -14.199999999999982, -31.300000000000004, -12.699999999999976, -37.90000000000002, -50.00000000000004, -30.90000000000003, -12.999999999999977, -35.900000000000055, -36.20000000000006, -38.20000000000007, -64.30000000000014, -66.00000000000007, -53.90000000000004, -39.900000000000084, -53.20000000000006, -52.800000000000054, -11.799999999999995, -39.20000000000003, -33.0, -34.400000000000006, -13.699999999999982, -50.300000000000026, -110.30000000000001, -38.80000000000008, -12.700000000000001, -52.300000000000026, -24.70000000000001, -54.50000000000004, -41.099999999999994, -54.00000000000005, -17.89999999999999, -53.80000000000005, -19.6, -51.70000000000006, -12.299999999999976, -29.800000000000054, -53.100000000000044, -35.50000000000002, -38.90000000000005, -42.10000000000007, -47.10000000000002, -12.0, -26.40000000000002, -14.999999999999993, -31.50000000000002, -35.700000000000045, -36.50000000000006, -33.4, -51.90000000000004, -38.20000000000005, -49.5, -28.700000000000003, -43.60000000000007, -41.800000000000054, -44.90000000000007, -54.00000000000006, -37.70000000000007, -30.000000000000007, -10.799999999999978, -11.299999999999983, -35.40000000000006, -51.30000000000004, -52.700000000000045, -55.60000000000004, -36.6, -39.00000000000005, -26.600000000000016, -51.00000000000004, -53.30000000000005, -29.4, -34.10000000000001, -36.900000000000006, -38.000000000000014], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4938501394884067, "mean_inference_ms": 0.7612069262806872, "mean_action_processing_ms": 0.07921143338439446, "mean_env_wait_ms": 3.0649724335809605, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 352000, "timesteps_this_iter": 0, "agent_timesteps_total": 352000, "timers": {"sample_time_ms": 22948.768, "sample_throughput": 174.301, "load_time_ms": 0.456, "load_throughput": 8770566.156, "learn_time_ms": 4564.616, "learn_throughput": 876.306}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.583068847656252e-07, "cur_lr": 0.00010000000000000003, "total_loss": 0.5867753280787378, "policy_loss": -0.001973057866737407, "vf_loss": 58.87483958275087, "vf_explained_var": 0.14833445491329317, "kl": 0.005377115524755415, "entropy": 0.23029302426724024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 352000, "num_agent_steps_sampled": 352000, "num_steps_trained": 352000, "num_agent_steps_trained": 352000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3520, "training_iteration": 88, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-53-51", "timestamp": 1651053231, "time_this_iter_s": 23.73556876182556, "time_total_s": 2294.8087010383606, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2294.8087010383606, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 21.790625, "ram_util_percent": 94.74375}}
{"episode_reward_max": -8.299999999999997, "episode_reward_min": -153.6999999999996, "episode_reward_mean": -40.030000000000015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.900000000000084, -53.20000000000006, -52.800000000000054, -11.799999999999995, -39.20000000000003, -33.0, -34.400000000000006, -13.699999999999982, -50.300000000000026, -110.30000000000001, -38.80000000000008, -12.700000000000001, -52.300000000000026, -24.70000000000001, -54.50000000000004, -41.099999999999994, -54.00000000000005, -17.89999999999999, -53.80000000000005, -19.6, -51.70000000000006, -12.299999999999976, -29.800000000000054, -53.100000000000044, -35.50000000000002, -38.90000000000005, -42.10000000000007, -47.10000000000002, -12.0, -26.40000000000002, -14.999999999999993, -31.50000000000002, -35.700000000000045, -36.50000000000006, -33.4, -51.90000000000004, -38.20000000000005, -49.5, -28.700000000000003, -43.60000000000007, -41.800000000000054, -44.90000000000007, -54.00000000000006, -37.70000000000007, -30.000000000000007, -10.799999999999978, -11.299999999999983, -35.40000000000006, -51.30000000000004, -52.700000000000045, -55.60000000000004, -36.6, -39.00000000000005, -26.600000000000016, -51.00000000000004, -53.30000000000005, -29.4, -34.10000000000001, -36.900000000000006, -38.000000000000014, -50.700000000000074, -32.60000000000001, -42.60000000000001, -38.90000000000004, -101.79999999999986, -39.80000000000006, -34.40000000000004, -52.10000000000004, -14.599999999999975, -28.70000000000007, -138.1999999999998, -47.30000000000004, -50.000000000000036, -30.399999999999995, -54.50000000000004, -22.900000000000027, -52.700000000000045, -54.90000000000004, -34.10000000000006, -19.599999999999998, -29.700000000000003, -54.10000000000002, -32.599999999999966, -31.20000000000001, -38.100000000000044, -8.7, -38.700000000000045, -30.6, -13.7, -26.099999999999998, -50.900000000000034, -29.50000000000001, -153.6999999999996, -12.099999999999977, -8.299999999999997, -31.50000000000001, -49.00000000000005, -53.30000000000004, -25.800000000000004, -53.30000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.48414454687597, "mean_inference_ms": 0.7617526440877159, "mean_action_processing_ms": 0.0786844187852245, "mean_env_wait_ms": 3.065810833243987, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 356000, "timesteps_this_iter": 0, "agent_timesteps_total": 356000, "timers": {"sample_time_ms": 22983.721, "sample_throughput": 174.036, "load_time_ms": 0.457, "load_throughput": 8759118.722, "learn_time_ms": 4534.067, "learn_throughput": 882.21}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.583068847656252e-07, "cur_lr": 0.00010000000000000003, "total_loss": 1.8890670985243814, "policy_loss": -0.008326146292990895, "vf_loss": 189.73932702669532, "vf_explained_var": 0.10483644322682452, "kl": 0.008015645564613512, "entropy": 0.2251505663918872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 356000, "num_agent_steps_sampled": 356000, "num_steps_trained": 356000, "num_agent_steps_trained": 356000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3560, "training_iteration": 89, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-54-13", "timestamp": 1651053253, "time_this_iter_s": 21.96578311920166, "time_total_s": 2316.7744841575623, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2316.7744841575623, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 19.466666666666665, "ram_util_percent": 94.65666666666665}}
{"episode_reward_max": -8.299999999999997, "episode_reward_min": -153.6999999999996, "episode_reward_mean": -40.021000000000015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.800000000000054, -44.90000000000007, -54.00000000000006, -37.70000000000007, -30.000000000000007, -10.799999999999978, -11.299999999999983, -35.40000000000006, -51.30000000000004, -52.700000000000045, -55.60000000000004, -36.6, -39.00000000000005, -26.600000000000016, -51.00000000000004, -53.30000000000005, -29.4, -34.10000000000001, -36.900000000000006, -38.000000000000014, -50.700000000000074, -32.60000000000001, -42.60000000000001, -38.90000000000004, -101.79999999999986, -39.80000000000006, -34.40000000000004, -52.10000000000004, -14.599999999999975, -28.70000000000007, -138.1999999999998, -47.30000000000004, -50.000000000000036, -30.399999999999995, -54.50000000000004, -22.900000000000027, -52.700000000000045, -54.90000000000004, -34.10000000000006, -19.599999999999998, -29.700000000000003, -54.10000000000002, -32.599999999999966, -31.20000000000001, -38.100000000000044, -8.7, -38.700000000000045, -30.6, -13.7, -26.099999999999998, -50.900000000000034, -29.50000000000001, -153.6999999999996, -12.099999999999977, -8.299999999999997, -31.50000000000001, -49.00000000000005, -53.30000000000004, -25.800000000000004, -53.30000000000005, -33.50000000000005, -35.9, -132.49999999999983, -29.800000000000004, -17.799999999999997, -55.10000000000009, -41.00000000000001, -40.900000000000055, -53.10000000000006, -12.399999999999983, -38.19999999999999, -39.00000000000005, -52.80000000000003, -44.900000000000034, -11.89999999999998, -11.89999999999998, -11.899999999999983, -19.200000000000028, -48.90000000000009, -13.399999999999983, -54.700000000000074, -17.8, -38.5, -53.80000000000006, -54.70000000000007, -21.6, -38.80000000000007, -21.700000000000035, -38.70000000000005, -9.599999999999998, -55.90000000000008, -34.20000000000001, -28.000000000000025, -61.80000000000008, -30.9, -12.899999999999977, -63.90000000000004, -56.100000000000065, -27.60000000000001, -54.70000000000008], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.47422479666084, "mean_inference_ms": 0.7616805865661078, "mean_action_processing_ms": 0.07814806772040594, "mean_env_wait_ms": 3.0654388663782073, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 360000, "timesteps_this_iter": 0, "agent_timesteps_total": 360000, "timers": {"sample_time_ms": 22855.388, "sample_throughput": 175.013, "load_time_ms": 0.458, "load_throughput": 8732220.892, "learn_time_ms": 4488.102, "learn_throughput": 891.245}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.583068847656252e-07, "cur_lr": 0.00010000000000000003, "total_loss": 1.2261359908457805, "policy_loss": -0.00852192453339055, "vf_loss": 123.4657937511321, "vf_explained_var": 0.030825282681372856, "kl": 0.009174061606427775, "entropy": 0.31254935942750467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 360000, "num_agent_steps_sampled": 360000, "num_steps_trained": 360000, "num_agent_steps_trained": 360000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3600, "training_iteration": 90, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-54-34", "timestamp": 1651053274, "time_this_iter_s": 20.789554834365845, "time_total_s": 2337.564038991928, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2337.564038991928, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 8.842857142857143, "ram_util_percent": 94.78214285714287}}
{"episode_reward_max": -8.299999999999997, "episode_reward_min": -153.6999999999996, "episode_reward_mean": -37.06000000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.700000000000003, -54.10000000000002, -32.599999999999966, -31.20000000000001, -38.100000000000044, -8.7, -38.700000000000045, -30.6, -13.7, -26.099999999999998, -50.900000000000034, -29.50000000000001, -153.6999999999996, -12.099999999999977, -8.299999999999997, -31.50000000000001, -49.00000000000005, -53.30000000000004, -25.800000000000004, -53.30000000000005, -33.50000000000005, -35.9, -132.49999999999983, -29.800000000000004, -17.799999999999997, -55.10000000000009, -41.00000000000001, -40.900000000000055, -53.10000000000006, -12.399999999999983, -38.19999999999999, -39.00000000000005, -52.80000000000003, -44.900000000000034, -11.89999999999998, -11.89999999999998, -11.899999999999983, -19.200000000000028, -48.90000000000009, -13.399999999999983, -54.700000000000074, -17.8, -38.5, -53.80000000000006, -54.70000000000007, -21.6, -38.80000000000007, -21.700000000000035, -38.70000000000005, -9.599999999999998, -55.90000000000008, -34.20000000000001, -28.000000000000025, -61.80000000000008, -30.9, -12.899999999999977, -63.90000000000004, -56.100000000000065, -27.60000000000001, -54.70000000000008, -40.000000000000014, -54.500000000000064, -21.7, -41.800000000000054, -28.20000000000002, -115.29999999999988, -90.6999999999999, -43.30000000000005, -42.000000000000036, -33.80000000000006, -15.7, -35.2, -11.199999999999976, -49.40000000000007, -40.80000000000007, -54.700000000000045, -34.10000000000005, -15.199999999999976, -13.399999999999977, -36.40000000000002, -35.10000000000001, -14.499999999999996, -10.899999999999983, -12.299999999999981, -41.60000000000007, -8.999999999999998, -14.29999999999998, -59.000000000000064, -10.099999999999984, -38.20000000000001, -42.800000000000004, -53.90000000000005, -57.30000000000008, -40.300000000000026, -12.299999999999986, -13.899999999999977, -53.80000000000006, -18.9, -48.60000000000004, -10.899999999999983], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4641776441900263, "mean_inference_ms": 0.7608216318615827, "mean_action_processing_ms": 0.07760504918142011, "mean_env_wait_ms": 3.0640330362185915, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 364000, "timesteps_this_iter": 0, "agent_timesteps_total": 364000, "timers": {"sample_time_ms": 22537.851, "sample_throughput": 177.479, "load_time_ms": 0.452, "load_throughput": 8857618.922, "learn_time_ms": 4433.349, "learn_throughput": 902.253}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.583068847656252e-07, "cur_lr": 0.00010000000000000003, "total_loss": 1.0090231646307974, "policy_loss": -0.0013160832356461274, "vf_loss": 101.03392718120288, "vf_explained_var": -0.09266296163682014, "kl": 0.008458574357251256, "entropy": 0.36933339617605654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 364000, "num_agent_steps_sampled": 364000, "num_steps_trained": 364000, "num_agent_steps_trained": 364000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3640, "training_iteration": 91, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-54-55", "timestamp": 1651053295, "time_this_iter_s": 20.76188087463379, "time_total_s": 2358.325919866562, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2358.325919866562, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 11.820689655172414, "ram_util_percent": 94.78275862068963}}
{"episode_reward_max": -8.999999999999998, "episode_reward_min": -115.29999999999988, "episode_reward_mean": -37.77500000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.700000000000074, -17.8, -38.5, -53.80000000000006, -54.70000000000007, -21.6, -38.80000000000007, -21.700000000000035, -38.70000000000005, -9.599999999999998, -55.90000000000008, -34.20000000000001, -28.000000000000025, -61.80000000000008, -30.9, -12.899999999999977, -63.90000000000004, -56.100000000000065, -27.60000000000001, -54.70000000000008, -40.000000000000014, -54.500000000000064, -21.7, -41.800000000000054, -28.20000000000002, -115.29999999999988, -90.6999999999999, -43.30000000000005, -42.000000000000036, -33.80000000000006, -15.7, -35.2, -11.199999999999976, -49.40000000000007, -40.80000000000007, -54.700000000000045, -34.10000000000005, -15.199999999999976, -13.399999999999977, -36.40000000000002, -35.10000000000001, -14.499999999999996, -10.899999999999983, -12.299999999999981, -41.60000000000007, -8.999999999999998, -14.29999999999998, -59.000000000000064, -10.099999999999984, -38.20000000000001, -42.800000000000004, -53.90000000000005, -57.30000000000008, -40.300000000000026, -12.299999999999986, -13.899999999999977, -53.80000000000006, -18.9, -48.60000000000004, -10.899999999999983, -49.20000000000007, -12.299999999999992, -18.499999999999982, -52.40000000000003, -38.10000000000002, -16.799999999999994, -26.1, -27.400000000000045, -52.400000000000034, -42.60000000000001, -40.10000000000001, -67.00000000000003, -28.800000000000004, -35.60000000000004, -41.30000000000003, -14.099999999999978, -70.70000000000002, -51.00000000000008, -49.7000000000001, -27.4, -52.40000000000004, -55.400000000000055, -53.50000000000006, -35.40000000000002, -14.2, -33.5, -20.799999999999997, -40.200000000000074, -24.299999999999997, -13.199999999999996, -71.30000000000001, -52.30000000000004, -53.40000000000004, -25.800000000000026, -17.0, -18.0, -80.29999999999998, -54.60000000000005, -54.10000000000004, -55.30000000000005], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4545532154951473, "mean_inference_ms": 0.7600769309320328, "mean_action_processing_ms": 0.077077177258327, "mean_env_wait_ms": 3.0627801563991954, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 368000, "timesteps_this_iter": 0, "agent_timesteps_total": 368000, "timers": {"sample_time_ms": 22388.052, "sample_throughput": 178.667, "load_time_ms": 0.45, "load_throughput": 8894245.878, "learn_time_ms": 4407.617, "learn_throughput": 907.52}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.583068847656252e-07, "cur_lr": 0.00010000000000000003, "total_loss": 0.892717374526515, "policy_loss": 0.004905699129386615, "vf_loss": 88.78116885359569, "vf_explained_var": 0.03797834682208236, "kl": 0.005558581587736985, "entropy": 0.2481848188726011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 368000, "num_agent_steps_sampled": 368000, "num_steps_trained": 368000, "num_agent_steps_trained": 368000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3680, "training_iteration": 92, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-55-17", "timestamp": 1651053317, "time_this_iter_s": 22.03453302383423, "time_total_s": 2380.360452890396, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2380.360452890396, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 20.266666666666666, "ram_util_percent": 94.89666666666669}}
{"episode_reward_max": -8.999999999999998, "episode_reward_min": -144.19999999999976, "episode_reward_mean": -37.428000000000026, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-35.10000000000001, -14.499999999999996, -10.899999999999983, -12.299999999999981, -41.60000000000007, -8.999999999999998, -14.29999999999998, -59.000000000000064, -10.099999999999984, -38.20000000000001, -42.800000000000004, -53.90000000000005, -57.30000000000008, -40.300000000000026, -12.299999999999986, -13.899999999999977, -53.80000000000006, -18.9, -48.60000000000004, -10.899999999999983, -49.20000000000007, -12.299999999999992, -18.499999999999982, -52.40000000000003, -38.10000000000002, -16.799999999999994, -26.1, -27.400000000000045, -52.400000000000034, -42.60000000000001, -40.10000000000001, -67.00000000000003, -28.800000000000004, -35.60000000000004, -41.30000000000003, -14.099999999999978, -70.70000000000002, -51.00000000000008, -49.7000000000001, -27.4, -52.40000000000004, -55.400000000000055, -53.50000000000006, -35.40000000000002, -14.2, -33.5, -20.799999999999997, -40.200000000000074, -24.299999999999997, -13.199999999999996, -71.30000000000001, -52.30000000000004, -53.40000000000004, -25.800000000000026, -17.0, -18.0, -80.29999999999998, -54.60000000000005, -54.10000000000004, -55.30000000000005, -53.900000000000034, -16.799999999999997, -31.4, -14.899999999999999, -53.70000000000003, -22.799999999999997, -54.30000000000009, -52.500000000000036, -60.50000000000009, -38.00000000000004, -31.00000000000003, -14.899999999999995, -53.50000000000006, -54.20000000000004, -14.899999999999997, -14.499999999999995, -29.1, -40.30000000000005, -144.19999999999976, -45.00000000000008, -25.200000000000003, -30.300000000000004, -14.099999999999987, -121.10000000000012, -14.699999999999998, -33.50000000000006, -29.8, -15.099999999999985, -40.700000000000045, -13.299999999999995, -16.499999999999982, -57.30000000000005, -54.60000000000005, -29.400000000000013, -53.00000000000009, -16.799999999999997, -60.30000000000004, -58.70000000000009, -19.899999999999977, -13.899999999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4454568238368042, "mean_inference_ms": 0.7594531024969114, "mean_action_processing_ms": 0.07656443388317331, "mean_env_wait_ms": 3.061640842487094, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 372000, "timesteps_this_iter": 0, "agent_timesteps_total": 372000, "timers": {"sample_time_ms": 22152.825, "sample_throughput": 180.564, "load_time_ms": 0.339, "load_throughput": 11784235.443, "learn_time_ms": 4263.296, "learn_throughput": 938.241}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 8.583068847656252e-07, "cur_lr": 0.00010000000000000003, "total_loss": 1.788231183278064, "policy_loss": 0.0047950333294769125, "vf_loss": 178.34361803403465, "vf_explained_var": -0.02894800632230697, "kl": 0.00474940942314191, "entropy": 0.35761730827951943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 372000, "num_agent_steps_sampled": 372000, "num_steps_trained": 372000, "num_agent_steps_trained": 372000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3720, "training_iteration": 93, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-55-38", "timestamp": 1651053338, "time_this_iter_s": 21.36612296104431, "time_total_s": 2401.7265758514404, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2401.7265758514404, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 15.73448275862069, "ram_util_percent": 94.73793103448271}}
{"episode_reward_max": -10.699999999999989, "episode_reward_min": -144.19999999999976, "episode_reward_mean": -37.76800000000002, "episode_len_mean": 100.0, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-52.40000000000004, -55.400000000000055, -53.50000000000006, -35.40000000000002, -14.2, -33.5, -20.799999999999997, -40.200000000000074, -24.299999999999997, -13.199999999999996, -71.30000000000001, -52.30000000000004, -53.40000000000004, -25.800000000000026, -17.0, -18.0, -80.29999999999998, -54.60000000000005, -54.10000000000004, -55.30000000000005, -53.900000000000034, -16.799999999999997, -31.4, -14.899999999999999, -53.70000000000003, -22.799999999999997, -54.30000000000009, -52.500000000000036, -60.50000000000009, -38.00000000000004, -31.00000000000003, -14.899999999999995, -53.50000000000006, -54.20000000000004, -14.899999999999997, -14.499999999999995, -29.1, -40.30000000000005, -144.19999999999976, -45.00000000000008, -25.200000000000003, -30.300000000000004, -14.099999999999987, -121.10000000000012, -14.699999999999998, -33.50000000000006, -29.8, -15.099999999999985, -40.700000000000045, -13.299999999999995, -16.499999999999982, -57.30000000000005, -54.60000000000005, -29.400000000000013, -53.00000000000009, -16.799999999999997, -60.30000000000004, -58.70000000000009, -19.899999999999977, -13.899999999999999, -34.10000000000001, -16.799999999999997, -27.400000000000006, -51.59999999999992, -51.90000000000006, -54.50000000000007, -28.500000000000007, -42.500000000000064, -52.70000000000003, -19.400000000000002, -33.600000000000016, -12.399999999999991, -35.2, -32.60000000000003, -11.099999999999994, -54.20000000000007, -10.699999999999989, -52.20000000000004, -16.299999999999994, -22.200000000000003, -42.60000000000001, -29.500000000000007, -14.199999999999987, -30.00000000000001, -11.29999999999998, -34.2, -12.499999999999995, -31.80000000000004, -75.80000000000001, -23.200000000000003, -56.30000000000004, -32.6, -27.1, -53.600000000000044, -39.30000000000007, -54.30000000000004, -59.90000000000009, -50.30000000000005, -22.0, -32.80000000000004], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4365636936630053, "mean_inference_ms": 0.7587292494098983, "mean_action_processing_ms": 0.07605840534333011, "mean_env_wait_ms": 3.060081407027764, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 0, "timesteps_total": 376000, "timesteps_this_iter": 0, "agent_timesteps_total": 376000, "timers": {"sample_time_ms": 21859.189, "sample_throughput": 182.989, "load_time_ms": 0.338, "load_throughput": 11823267.089, "learn_time_ms": 4275.189, "learn_throughput": 935.631}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 4.291534423828126e-07, "cur_lr": 0.00010000000000000003, "total_loss": 0.6736636586927919, "policy_loss": 0.004502800808498456, "vf_loss": 66.91608712801369, "vf_explained_var": 0.065357163388242, "kl": 0.0062063136089060295, "entropy": 0.25238378934802547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 376000, "num_agent_steps_sampled": 376000, "num_steps_trained": 376000, "num_agent_steps_trained": 376000, "num_steps_trained_this_iter": 0}, "done": false, "episodes_total": 3760, "training_iteration": 94, "trial_id": "94bef_00000", "experiment_id": "884f1da158ee43d3ad8f466f6238abbc", "date": "2022-04-27_10-55-59", "timestamp": 1651053359, "time_this_iter_s": 20.951685905456543, "time_total_s": 2422.678261756897, "pid": 61146, "hostname": "dyn3141-2.wlan.ic.ac.uk", "node_ip": "127.0.0.1", "config": {"num_workers": 0, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 200, "batch_mode": "truncate_episodes", "gamma": 0.99, "lr": 0.0001, "train_batch_size": 4000, "model": {"_use_default_native_models": false, "_disable_preprocessor_api": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "CybORG_hier_Model", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "HierEnv", "observation_space": null, "action_space": null, "env_config": {"null": 0}, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": true, "eager_max_retraces": 20, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": [null, null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_loss_coeff": 0.01, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 2422.678261756897, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 18.193103448275863, "ram_util_percent": 94.66896551724135}}
